var BI=s=>{throw TypeError(s)};var _u=(s,e,t)=>e.has(s)?BI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t);function FI(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in s)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(s,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function up(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Mg={exports:{}},wu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ew;function GI(){if(ew)return wu;ew=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:s,type:n,key:c,ref:a!==void 0?a:null,props:l}}return wu.Fragment=e,wu.jsx=t,wu.jsxs=t,wu}var tw;function qI(){return tw||(tw=1,Mg.exports=GI()),Mg.exports}var h=qI(),Vg={exports:{}},ze={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nw;function HI(){if(nw)return ze;nw=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),E=Symbol.iterator;function A(M){return M===null||typeof M!="object"?null:(M=E&&M[E]||M["@@iterator"],typeof M=="function"?M:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,J={};function se(M,ne,fe){this.props=M,this.context=ne,this.refs=J,this.updater=fe||O}se.prototype.isReactComponent={},se.prototype.setState=function(M,ne){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,ne,"setState")},se.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function ce(){}ce.prototype=se.prototype;function le(M,ne,fe){this.props=M,this.context=ne,this.refs=J,this.updater=fe||O}var me=le.prototype=new ce;me.constructor=le,F(me,se.prototype),me.isPureReactComponent=!0;var Ee=Array.isArray;function be(){}var I={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function R(M,ne,fe){var ve=fe.ref;return{$$typeof:s,type:M,key:ne,ref:ve!==void 0?ve:null,props:fe}}function L(M,ne){return R(M.type,ne,M.props)}function j(M){return typeof M=="object"&&M!==null&&M.$$typeof===s}function P(M){var ne={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(fe){return ne[fe]})}var k=/\/+/g;function at(M,ne){return typeof M=="object"&&M!==null&&M.key!=null?P(""+M.key):ne.toString(36)}function _t(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(be,be):(M.status="pending",M.then(function(ne){M.status==="pending"&&(M.status="fulfilled",M.value=ne)},function(ne){M.status==="pending"&&(M.status="rejected",M.reason=ne)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function X(M,ne,fe,ve,Ce){var Ve=typeof M;(Ve==="undefined"||Ve==="boolean")&&(M=null);var Be=!1;if(M===null)Be=!0;else switch(Ve){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(M.$$typeof){case s:case e:Be=!0;break;case v:return Be=M._init,X(Be(M._payload),ne,fe,ve,Ce)}}if(Be)return Ce=Ce(M),Be=ve===""?"."+at(M,0):ve,Ee(Ce)?(fe="",Be!=null&&(fe=Be.replace(k,"$&/")+"/"),X(Ce,ne,fe,"",function(is){return is})):Ce!=null&&(j(Ce)&&(Ce=L(Ce,fe+(Ce.key==null||M&&M.key===Ce.key?"":(""+Ce.key).replace(k,"$&/")+"/")+Be)),ne.push(Ce)),1;Be=0;var Ut=ve===""?".":ve+":";if(Ee(M))for(var We=0;We<M.length;We++)ve=M[We],Ve=Ut+at(ve,We),Be+=X(ve,ne,fe,Ve,Ce);else if(We=A(M),typeof We=="function")for(M=We.call(M),We=0;!(ve=M.next()).done;)ve=ve.value,Ve=Ut+at(ve,We++),Be+=X(ve,ne,fe,Ve,Ce);else if(Ve==="object"){if(typeof M.then=="function")return X(_t(M),ne,fe,ve,Ce);throw ne=String(M),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Be}function ue(M,ne,fe){if(M==null)return M;var ve=[],Ce=0;return X(M,ve,"","",function(Ve){return ne.call(fe,Ve,Ce++)}),ve}function Ae(M){if(M._status===-1){var ne=M._result;ne=ne(),ne.then(function(fe){(M._status===0||M._status===-1)&&(M._status=1,M._result=fe)},function(fe){(M._status===0||M._status===-1)&&(M._status=2,M._result=fe)}),M._status===-1&&(M._status=0,M._result=ne)}if(M._status===1)return M._result.default;throw M._result}var He=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},Je={map:ue,forEach:function(M,ne,fe){ue(M,function(){ne.apply(this,arguments)},fe)},count:function(M){var ne=0;return ue(M,function(){ne++}),ne},toArray:function(M){return ue(M,function(ne){return ne})||[]},only:function(M){if(!j(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return ze.Activity=x,ze.Children=Je,ze.Component=se,ze.Fragment=t,ze.Profiler=a,ze.PureComponent=le,ze.StrictMode=n,ze.Suspense=p,ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,ze.__COMPILER_RUNTIME={__proto__:null,c:function(M){return I.H.useMemoCache(M)}},ze.cache=function(M){return function(){return M.apply(null,arguments)}},ze.cacheSignal=function(){return null},ze.cloneElement=function(M,ne,fe){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var ve=F({},M.props),Ce=M.key;if(ne!=null)for(Ve in ne.key!==void 0&&(Ce=""+ne.key),ne)!C.call(ne,Ve)||Ve==="key"||Ve==="__self"||Ve==="__source"||Ve==="ref"&&ne.ref===void 0||(ve[Ve]=ne[Ve]);var Ve=arguments.length-2;if(Ve===1)ve.children=fe;else if(1<Ve){for(var Be=Array(Ve),Ut=0;Ut<Ve;Ut++)Be[Ut]=arguments[Ut+2];ve.children=Be}return R(M.type,Ce,ve)},ze.createContext=function(M){return M={$$typeof:c,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:l,_context:M},M},ze.createElement=function(M,ne,fe){var ve,Ce={},Ve=null;if(ne!=null)for(ve in ne.key!==void 0&&(Ve=""+ne.key),ne)C.call(ne,ve)&&ve!=="key"&&ve!=="__self"&&ve!=="__source"&&(Ce[ve]=ne[ve]);var Be=arguments.length-2;if(Be===1)Ce.children=fe;else if(1<Be){for(var Ut=Array(Be),We=0;We<Be;We++)Ut[We]=arguments[We+2];Ce.children=Ut}if(M&&M.defaultProps)for(ve in Be=M.defaultProps,Be)Ce[ve]===void 0&&(Ce[ve]=Be[ve]);return R(M,Ve,Ce)},ze.createRef=function(){return{current:null}},ze.forwardRef=function(M){return{$$typeof:d,render:M}},ze.isValidElement=j,ze.lazy=function(M){return{$$typeof:v,_payload:{_status:-1,_result:M},_init:Ae}},ze.memo=function(M,ne){return{$$typeof:g,type:M,compare:ne===void 0?null:ne}},ze.startTransition=function(M){var ne=I.T,fe={};I.T=fe;try{var ve=M(),Ce=I.S;Ce!==null&&Ce(fe,ve),typeof ve=="object"&&ve!==null&&typeof ve.then=="function"&&ve.then(be,He)}catch(Ve){He(Ve)}finally{ne!==null&&fe.types!==null&&(ne.types=fe.types),I.T=ne}},ze.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},ze.use=function(M){return I.H.use(M)},ze.useActionState=function(M,ne,fe){return I.H.useActionState(M,ne,fe)},ze.useCallback=function(M,ne){return I.H.useCallback(M,ne)},ze.useContext=function(M){return I.H.useContext(M)},ze.useDebugValue=function(){},ze.useDeferredValue=function(M,ne){return I.H.useDeferredValue(M,ne)},ze.useEffect=function(M,ne){return I.H.useEffect(M,ne)},ze.useEffectEvent=function(M){return I.H.useEffectEvent(M)},ze.useId=function(){return I.H.useId()},ze.useImperativeHandle=function(M,ne,fe){return I.H.useImperativeHandle(M,ne,fe)},ze.useInsertionEffect=function(M,ne){return I.H.useInsertionEffect(M,ne)},ze.useLayoutEffect=function(M,ne){return I.H.useLayoutEffect(M,ne)},ze.useMemo=function(M,ne){return I.H.useMemo(M,ne)},ze.useOptimistic=function(M,ne){return I.H.useOptimistic(M,ne)},ze.useReducer=function(M,ne,fe){return I.H.useReducer(M,ne,fe)},ze.useRef=function(M){return I.H.useRef(M)},ze.useState=function(M){return I.H.useState(M)},ze.useSyncExternalStore=function(M,ne,fe){return I.H.useSyncExternalStore(M,ne,fe)},ze.useTransition=function(){return I.H.useTransition()},ze.version="19.2.4",ze}var rw;function wh(){return rw||(rw=1,Vg.exports=HI()),Vg.exports}var ie=wh();const $I=up(ie);var Lg={exports:{}},Eu={},Ug={exports:{}},zg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sw;function KI(){return sw||(sw=1,(function(s){function e(X,ue){var Ae=X.length;X.push(ue);e:for(;0<Ae;){var He=Ae-1>>>1,Je=X[He];if(0<a(Je,ue))X[He]=ue,X[Ae]=Je,Ae=He;else break e}}function t(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var ue=X[0],Ae=X.pop();if(Ae!==ue){X[0]=Ae;e:for(var He=0,Je=X.length,M=Je>>>1;He<M;){var ne=2*(He+1)-1,fe=X[ne],ve=ne+1,Ce=X[ve];if(0>a(fe,Ae))ve<Je&&0>a(Ce,fe)?(X[He]=Ce,X[ve]=Ae,He=ve):(X[He]=fe,X[ne]=Ae,He=ne);else if(ve<Je&&0>a(Ce,Ae))X[He]=Ce,X[ve]=Ae,He=ve;else break e}}return ue}function a(X,ue){var Ae=X.sortIndex-ue.sortIndex;return Ae!==0?Ae:X.id-ue.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();s.unstable_now=function(){return c.now()-d}}var p=[],g=[],v=1,x=null,E=3,A=!1,O=!1,F=!1,J=!1,se=typeof setTimeout=="function"?setTimeout:null,ce=typeof clearTimeout=="function"?clearTimeout:null,le=typeof setImmediate<"u"?setImmediate:null;function me(X){for(var ue=t(g);ue!==null;){if(ue.callback===null)n(g);else if(ue.startTime<=X)n(g),ue.sortIndex=ue.expirationTime,e(p,ue);else break;ue=t(g)}}function Ee(X){if(F=!1,me(X),!O)if(t(p)!==null)O=!0,be||(be=!0,P());else{var ue=t(g);ue!==null&&_t(Ee,ue.startTime-X)}}var be=!1,I=-1,C=5,R=-1;function L(){return J?!0:!(s.unstable_now()-R<C)}function j(){if(J=!1,be){var X=s.unstable_now();R=X;var ue=!0;try{e:{O=!1,F&&(F=!1,ce(I),I=-1),A=!0;var Ae=E;try{t:{for(me(X),x=t(p);x!==null&&!(x.expirationTime>X&&L());){var He=x.callback;if(typeof He=="function"){x.callback=null,E=x.priorityLevel;var Je=He(x.expirationTime<=X);if(X=s.unstable_now(),typeof Je=="function"){x.callback=Je,me(X),ue=!0;break t}x===t(p)&&n(p),me(X)}else n(p);x=t(p)}if(x!==null)ue=!0;else{var M=t(g);M!==null&&_t(Ee,M.startTime-X),ue=!1}}break e}finally{x=null,E=Ae,A=!1}ue=void 0}}finally{ue?P():be=!1}}}var P;if(typeof le=="function")P=function(){le(j)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,at=k.port2;k.port1.onmessage=j,P=function(){at.postMessage(null)}}else P=function(){se(j,0)};function _t(X,ue){I=se(function(){X(s.unstable_now())},ue)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(X){X.callback=null},s.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<X?Math.floor(1e3/X):5},s.unstable_getCurrentPriorityLevel=function(){return E},s.unstable_next=function(X){switch(E){case 1:case 2:case 3:var ue=3;break;default:ue=E}var Ae=E;E=ue;try{return X()}finally{E=Ae}},s.unstable_requestPaint=function(){J=!0},s.unstable_runWithPriority=function(X,ue){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var Ae=E;E=X;try{return ue()}finally{E=Ae}},s.unstable_scheduleCallback=function(X,ue,Ae){var He=s.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?He+Ae:He):Ae=He,X){case 1:var Je=-1;break;case 2:Je=250;break;case 5:Je=1073741823;break;case 4:Je=1e4;break;default:Je=5e3}return Je=Ae+Je,X={id:v++,callback:ue,priorityLevel:X,startTime:Ae,expirationTime:Je,sortIndex:-1},Ae>He?(X.sortIndex=Ae,e(g,X),t(p)===null&&X===t(g)&&(F?(ce(I),I=-1):F=!0,_t(Ee,Ae-He))):(X.sortIndex=Je,e(p,X),O||A||(O=!0,be||(be=!0,P()))),X},s.unstable_shouldYield=L,s.unstable_wrapCallback=function(X){var ue=E;return function(){var Ae=E;E=ue;try{return X.apply(this,arguments)}finally{E=Ae}}}})(zg)),zg}var iw;function QI(){return iw||(iw=1,Ug.exports=KI()),Ug.exports}var Bg={exports:{}},zn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aw;function YI(){if(aw)return zn;aw=1;var s=wh();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)g+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(p,g,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:p,containerInfo:g,implementation:v}}var c=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return zn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,zn.createPortal=function(p,g){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(p,g,null,v)},zn.flushSync=function(p){var g=c.T,v=n.p;try{if(c.T=null,n.p=2,p)return p()}finally{c.T=g,n.p=v,n.d.f()}},zn.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,n.d.C(p,g))},zn.prefetchDNS=function(p){typeof p=="string"&&n.d.D(p)},zn.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var v=g.as,x=d(v,g.crossOrigin),E=typeof g.integrity=="string"?g.integrity:void 0,A=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;v==="style"?n.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:E,fetchPriority:A}):v==="script"&&n.d.X(p,{crossOrigin:x,integrity:E,fetchPriority:A,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},zn.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var v=d(g.as,g.crossOrigin);n.d.M(p,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&n.d.M(p)},zn.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var v=g.as,x=d(v,g.crossOrigin);n.d.L(p,v,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},zn.preloadModule=function(p,g){if(typeof p=="string")if(g){var v=d(g.as,g.crossOrigin);n.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else n.d.m(p)},zn.requestFormReset=function(p){n.d.r(p)},zn.unstable_batchedUpdates=function(p,g){return p(g)},zn.useFormState=function(p,g,v){return c.H.useFormState(p,g,v)},zn.useFormStatus=function(){return c.H.useHostTransitionStatus()},zn.version="19.2.4",zn}var ow;function XI(){if(ow)return Bg.exports;ow=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Bg.exports=YI(),Bg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lw;function JI(){if(lw)return Eu;lw=1;var s=QI(),e=wh(),t=XI();function n(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function c(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function d(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function p(r){if(l(r)!==r)throw Error(n(188))}function g(r){var i=r.alternate;if(!i){if(i=l(r),i===null)throw Error(n(188));return i!==r?null:r}for(var o=r,u=i;;){var m=o.return;if(m===null)break;var y=m.alternate;if(y===null){if(u=m.return,u!==null){o=u;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===o)return p(m),r;if(y===u)return p(m),i;y=y.sibling}throw Error(n(188))}if(o.return!==u.return)o=m,u=y;else{for(var _=!1,S=m.child;S;){if(S===o){_=!0,o=m,u=y;break}if(S===u){_=!0,u=m,o=y;break}S=S.sibling}if(!_){for(S=y.child;S;){if(S===o){_=!0,o=y,u=m;break}if(S===u){_=!0,u=y,o=m;break}S=S.sibling}if(!_)throw Error(n(189))}}if(o.alternate!==u)throw Error(n(190))}if(o.tag!==3)throw Error(n(188));return o.stateNode.current===o?r:i}function v(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=v(r),i!==null)return i;r=r.sibling}return null}var x=Object.assign,E=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),O=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),J=Symbol.for("react.strict_mode"),se=Symbol.for("react.profiler"),ce=Symbol.for("react.consumer"),le=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),Ee=Symbol.for("react.suspense"),be=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function P(r){return r===null||typeof r!="object"?null:(r=j&&r[j]||r["@@iterator"],typeof r=="function"?r:null)}var k=Symbol.for("react.client.reference");function at(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===k?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case F:return"Fragment";case se:return"Profiler";case J:return"StrictMode";case Ee:return"Suspense";case be:return"SuspenseList";case R:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case O:return"Portal";case le:return r.displayName||"Context";case ce:return(r._context.displayName||"Context")+".Consumer";case me:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case I:return i=r.displayName||null,i!==null?i:at(r.type)||"Memo";case C:i=r._payload,r=r._init;try{return at(r(i))}catch{}}return null}var _t=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae={pending:!1,data:null,method:null,action:null},He=[],Je=-1;function M(r){return{current:r}}function ne(r){0>Je||(r.current=He[Je],He[Je]=null,Je--)}function fe(r,i){Je++,He[Je]=r.current,r.current=i}var ve=M(null),Ce=M(null),Ve=M(null),Be=M(null);function Ut(r,i){switch(fe(Ve,i),fe(Ce,r),fe(ve,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?E_(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=E_(i),r=T_(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ne(ve),fe(ve,r)}function We(){ne(ve),ne(Ce),ne(Ve)}function is(r){r.memoizedState!==null&&fe(Be,r);var i=ve.current,o=T_(i,r.type);i!==o&&(fe(Ce,r),fe(ve,o))}function Qs(r){Ce.current===r&&(ne(ve),ne(Ce)),Be.current===r&&(ne(Be),yu._currentValue=Ae)}var Vr,as;function vr(r){if(Vr===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);Vr=i&&i[1]||"",as=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vr+r+as}var zt=!1;function os(r,i){if(!r||zt)return"";zt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(Y){var $=Y}Reflect.construct(r,[],re)}else{try{re.call()}catch(Y){$=Y}r.call(re.prototype)}}else{try{throw Error()}catch(Y){$=Y}(re=r())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(Y){if(Y&&$&&typeof Y.stack=="string")return[Y.stack,$.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),_=y[0],S=y[1];if(_&&S){var D=_.split(`
`),H=S.split(`
`);for(m=u=0;u<D.length&&!D[u].includes("DetermineComponentFrameRoot");)u++;for(;m<H.length&&!H[m].includes("DetermineComponentFrameRoot");)m++;if(u===D.length||m===H.length)for(u=D.length-1,m=H.length-1;1<=u&&0<=m&&D[u]!==H[m];)m--;for(;1<=u&&0<=m;u--,m--)if(D[u]!==H[m]){if(u!==1||m!==1)do if(u--,m--,0>m||D[u]!==H[m]){var W=`
`+D[u].replace(" at new "," at ");return r.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",r.displayName)),W}while(1<=u&&0<=m);break}}}finally{zt=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?vr(o):""}function Ys(r,i){switch(r.tag){case 26:case 27:case 5:return vr(r.type);case 16:return vr("Lazy");case 13:return r.child!==i&&i!==null?vr("Suspense Fallback"):vr("Suspense");case 19:return vr("SuspenseList");case 0:case 15:return os(r.type,!1);case 11:return os(r.type.render,!1);case 1:return os(r.type,!0);case 31:return vr("Activity");default:return""}}function Di(r){try{var i="",o=null;do i+=Ys(r,o),o=r,r=r.return;while(r);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var wt=Object.prototype.hasOwnProperty,It=s.unstable_scheduleCallback,kn=s.unstable_cancelCallback,Xs=s.unstable_shouldYield,sr=s.unstable_requestPaint,dn=s.unstable_now,Bt=s.unstable_getCurrentPriorityLevel,Xn=s.unstable_ImmediatePriority,Jn=s.unstable_UserBlockingPriority,ir=s.unstable_NormalPriority,Js=s.unstable_LowPriority,Lr=s.unstable_IdlePriority,ls=s.log,K=s.unstable_setDisableYieldValue,he=null,Fe=null;function Xe(r){if(typeof ls=="function"&&K(r),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode(he,r)}catch{}}var Ke=Math.clz32?Math.clz32:Ur,je=Math.log,Ht=Math.LN2;function Ur(r){return r>>>=0,r===0?32:31-(je(r)/Ht|0)|0}var Dt=256,Sn=262144,jt=4194304;function an(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function xn(r,i,o){var u=r.pendingLanes;if(u===0)return 0;var m=0,y=r.suspendedLanes,_=r.pingedLanes;r=r.warmLanes;var S=u&134217727;return S!==0?(u=S&~y,u!==0?m=an(u):(_&=S,_!==0?m=an(_):o||(o=S&~r,o!==0&&(m=an(o))))):(S=u&~y,S!==0?m=an(S):_!==0?m=an(_):o||(o=u&~r,o!==0&&(m=an(o)))),m===0?0:i!==0&&i!==m&&(i&y)===0&&(y=m&-m,o=i&-i,y>=o||y===32&&(o&4194048)!==0)?i:m}function br(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function ji(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ha(){var r=jt;return jt<<=1,(jt&62914560)===0&&(jt=4194304),r}function ar(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function Ts(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function kc(r,i,o,u,m,y){var _=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var S=r.entanglements,D=r.expirationTimes,H=r.hiddenUpdates;for(o=_&~o;0<o;){var W=31-Ke(o),re=1<<W;S[W]=0,D[W]=-1;var $=H[W];if($!==null)for(H[W]=null,W=0;W<$.length;W++){var Y=$[W];Y!==null&&(Y.lane&=-536870913)}o&=~re}u!==0&&cs(r,u,0),y!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=y&~(_&~i))}function cs(r,i,o){r.pendingLanes|=i,r.suspendedLanes&=~i;var u=31-Ke(i);r.entangledLanes|=i,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function Ws(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var u=31-Ke(o),m=1<<u;m&i|r[u]&i&&(r[u]|=i),o&=~m}}function Xt(r,i){var o=i&-i;return o=(o&42)!==0?1:_e(o),(o&(r.suspendedLanes|i))!==0?0:o}function _e(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function zr(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Wo(){var r=ue.p;return r!==0?r:(r=window.event,r===void 0?32:K_(r.type))}function or(r,i){var o=ue.p;try{return ue.p=r,i()}finally{ue.p=o}}var xr=Math.random().toString(36).slice(2),$t="__reactFiber$"+xr,Jt="__reactProps$"+xr,lr="__reactContainer$"+xr,Oi="__reactEvents$"+xr,Dc="__reactListeners$"+xr,Zs="__reactHandles$"+xr,$a="__reactResources$"+xr,Br="__reactMarker$"+xr;function ei(r){delete r[$t],delete r[Jt],delete r[Oi],delete r[Dc],delete r[Zs]}function _r(r){var i=r[$t];if(i)return i;for(var o=r.parentNode;o;){if(i=o[lr]||o[$t]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=k_(r);r!==null;){if(o=r[$t])return o;r=k_(r)}return i}r=o,o=r.parentNode}return null}function Wn(r){if(r=r[$t]||r[lr]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function Un(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(n(33))}function wr(r){var i=r[$a];return i||(i=r[$a]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Wt(r){r[Br]=!0}var Ka=new Set,Pi={};function Fr(r,i){Gr(r,i),Gr(r+"Capture",i)}function Gr(r,i){for(Pi[r]=i,r=0;r<i.length;r++)Ka.add(i[r])}var Qa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qr={},Ss={};function Ya(r){return wt.call(Ss,r)?!0:wt.call(qr,r)?!1:Qa.test(r)?Ss[r]=!0:(qr[r]=!0,!1)}function Mi(r,i,o){if(Ya(i))if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+o)}}function Zt(r,i,o){if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+o)}}function Ct(r,i,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(i,o,""+u)}}function en(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Hr(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function us(r,i,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,y=u.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return m.call(this)},set:function(_){o=""+_,y.call(this,_)}}),Object.defineProperty(r,i,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(_){o=""+_},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function lt(r){if(!r._valueTracker){var i=Hr(r)?"checked":"value";r._valueTracker=us(r,i,""+r[i])}}function Er(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),u="";return r&&(u=Hr(r)?r.checked?"true":"false":r.value),r=u,r!==o?(i.setValue(r),!0):!1}function Ot(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ns=/[\n"\\]/g;function Dn(r){return r.replace(Ns,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Vi(r,i,o,u,m,y,_,S){r.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?r.type=_:r.removeAttribute("type"),i!=null?_==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+en(i)):r.value!==""+en(i)&&(r.value=""+en(i)):_!=="submit"&&_!=="reset"||r.removeAttribute("value"),i!=null?Li(r,_,en(i)):o!=null?Li(r,_,en(o)):u!=null&&r.removeAttribute("value"),m==null&&y!=null&&(r.defaultChecked=!!y),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.name=""+en(S):r.removeAttribute("name")}function Zo(r,i,o,u,m,y,_,S){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),i!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||i!=null)){lt(r);return}o=o!=null?""+en(o):"",i=i!=null?""+en(i):o,S||i===r.value||(r.value=i),r.defaultValue=i}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=S?r.checked:!!u,r.defaultChecked=!!u,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(r.name=_),lt(r)}function Li(r,i,o){i==="number"&&Ot(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function hs(r,i,o,u){if(r=r.options,i){i={};for(var m=0;m<o.length;m++)i["$"+o[m]]=!0;for(o=0;o<r.length;o++)m=i.hasOwnProperty("$"+r[o].value),r[o].selected!==m&&(r[o].selected=m),m&&u&&(r[o].defaultSelected=!0)}else{for(o=""+en(o),i=null,m=0;m<r.length;m++){if(r[m].value===o){r[m].selected=!0,u&&(r[m].defaultSelected=!0);return}i!==null||r[m].disabled||(i=r[m])}i!==null&&(i.selected=!0)}}function T(r,i,o){if(i!=null&&(i=""+en(i),i!==r.value&&(r.value=i),o==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=o!=null?""+en(o):""}function ee(r,i,o,u){if(i==null){if(u!=null){if(o!=null)throw Error(n(92));if(_t(u)){if(1<u.length)throw Error(n(93));u=u[0]}o=u}o==null&&(o=""),i=o}o=en(i),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),lt(r)}function U(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var oe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ye(r,i,o){var u=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":u?r.setProperty(i,o):typeof o!="number"||o===0||oe.has(i)?i==="float"?r.cssFloat=o:r[i]=(""+o).trim():r[i]=o+"px"}function Ue(r,i,o){if(i!=null&&typeof i!="object")throw Error(n(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var m in i)u=i[m],i.hasOwnProperty(m)&&o[m]!==u&&ye(r,m,u)}else for(var y in i)i.hasOwnProperty(y)&&ye(r,y,i[y])}function Rt(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ui=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function el(r){return Ui.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function ds(){}var jc=null;function $r(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var zi=null,As=null;function Xa(r){var i=Wn(r);if(i&&(r=i.stateNode)){var o=r[Jt]||null;e:switch(r=i.stateNode,i.type){case"input":if(Vi(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Dn(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var u=o[i];if(u!==r&&u.form===r.form){var m=u[Jt]||null;if(!m)throw Error(n(90));Vi(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<o.length;i++)u=o[i],u.form===r.form&&Er(u)}break e;case"textarea":T(r,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&hs(r,!!o.multiple,i,!1)}}}var tl=!1;function Bi(r,i,o){if(tl)return r(i,o);tl=!0;try{var u=r(i);return u}finally{if(tl=!1,(zi!==null||As!==null)&&(Dd(),zi&&(i=zi,r=As,As=zi=null,Xa(i),r)))for(i=0;i<r.length;i++)Xa(r[i])}}function fs(r,i){var o=r.stateNode;if(o===null)return null;var u=o[Jt]||null;if(u===null)return null;o=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(n(231,i,typeof o));return o}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ja=!1;if(Kr)try{var Et={};Object.defineProperty(Et,"passive",{get:function(){Ja=!0}}),window.addEventListener("test",Et,Et),window.removeEventListener("test",Et,Et)}catch{Ja=!1}var Is=null,Oc=null,Wa=null;function Pc(){if(Wa)return Wa;var r,i=Oc,o=i.length,u,m="value"in Is?Is.value:Is.textContent,y=m.length;for(r=0;r<o&&i[r]===m[r];r++);var _=o-r;for(u=1;u<=_&&i[o-u]===m[y-u];u++);return Wa=m.slice(r,1<u?1-u:void 0)}function Za(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function ti(){return!0}function ps(){return!1}function jn(r){function i(o,u,m,y,_){this._reactName=o,this._targetInst=m,this.type=u,this.nativeEvent=y,this.target=_,this.currentTarget=null;for(var S in r)r.hasOwnProperty(S)&&(o=r[S],this[S]=o?o(y):y[S]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ti:ps,this.isPropagationStopped=ps,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ti)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ti)},persist:function(){},isPersistent:ti}),i}var ni={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cs=jn(ni),Fi=x({},ni,{view:0,detail:0}),Mc=jn(Fi),Gi,nl,Rs,rl=x({},Fi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qi,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Rs&&(Rs&&r.type==="mousemove"?(Gi=r.screenX-Rs.screenX,nl=r.screenY-Rs.screenY):nl=Gi=0,Rs=r),Gi)},movementY:function(r){return"movementY"in r?r.movementY:nl}}),Vc=jn(rl),eo=x({},rl,{dataTransfer:0}),zh=jn(eo),Bh=x({},Fi,{relatedTarget:0}),to=jn(Bh),Lc=x({},ni,{animationName:0,elapsedTime:0,pseudoElement:0}),Fh=jn(Lc),sl=x({},ni,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Gh=jn(sl),qh=x({},ni,{data:0}),ks=jn(qh),Hh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$h={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Kh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qh(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Kh[r])?!!i[r]:!1}function qi(){return Qh}var Zn=x({},Fi,{key:function(r){if(r.key){var i=Hh[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Za(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?$h[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qi,charCode:function(r){return r.type==="keypress"?Za(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Za(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Yh=jn(Zn),Xh=x({},rl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ri=jn(Xh),f=x({},Fi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qi}),b=jn(f),w=x({},ni,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=jn(w),G=x({},rl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Q=jn(G),pe=x({},ni,{newState:0,oldState:0}),Ge=jn(pe),on=[9,13,27,32],ht=Kr&&"CompositionEvent"in window,Ft=null;Kr&&"documentMode"in document&&(Ft=document.documentMode);var Qr=Kr&&"TextEvent"in window&&!Ft,Ds=Kr&&(!ht||Ft&&8<Ft&&11>=Ft),ms=" ",gs=!1;function no(r,i){switch(r){case"keyup":return on.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function il(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var al=!1;function hA(r,i){switch(r){case"compositionend":return il(i);case"keypress":return i.which!==32?null:(gs=!0,ms);case"textInput":return r=i.data,r===ms&&gs?null:r;default:return null}}function dA(r,i){if(al)return r==="compositionend"||!ht&&no(r,i)?(r=Pc(),Wa=Oc=Is=null,al=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ds&&i.locale!=="ko"?null:i.data;default:return null}}var fA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ov(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!fA[r.type]:i==="textarea"}function Pv(r,i,o,u){zi?As?As.push(u):As=[u]:zi=u,i=Ud(i,"onChange"),0<i.length&&(o=new Cs("onChange","change",null,o,u),r.push({event:o,listeners:i}))}var Uc=null,zc=null;function pA(r){y_(r,0)}function Jh(r){var i=Un(r);if(Er(i))return r}function Mv(r,i){if(r==="change")return i}var Vv=!1;if(Kr){var Gp;if(Kr){var qp="oninput"in document;if(!qp){var Lv=document.createElement("div");Lv.setAttribute("oninput","return;"),qp=typeof Lv.oninput=="function"}Gp=qp}else Gp=!1;Vv=Gp&&(!document.documentMode||9<document.documentMode)}function Uv(){Uc&&(Uc.detachEvent("onpropertychange",zv),zc=Uc=null)}function zv(r){if(r.propertyName==="value"&&Jh(zc)){var i=[];Pv(i,zc,r,$r(r)),Bi(pA,i)}}function mA(r,i,o){r==="focusin"?(Uv(),Uc=i,zc=o,Uc.attachEvent("onpropertychange",zv)):r==="focusout"&&Uv()}function gA(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Jh(zc)}function yA(r,i){if(r==="click")return Jh(i)}function vA(r,i){if(r==="input"||r==="change")return Jh(i)}function bA(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var Sr=typeof Object.is=="function"?Object.is:bA;function Bc(r,i){if(Sr(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),u=Object.keys(i);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var m=o[u];if(!wt.call(i,m)||!Sr(r[m],i[m]))return!1}return!0}function Bv(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Fv(r,i){var o=Bv(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=i&&u>=i)return{node:o,offset:i-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Bv(o)}}function Gv(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Gv(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function qv(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=Ot(r.document);i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=Ot(r.document)}return i}function Hp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var xA=Kr&&"documentMode"in document&&11>=document.documentMode,ol=null,$p=null,Fc=null,Kp=!1;function Hv(r,i,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Kp||ol==null||ol!==Ot(u)||(u=ol,"selectionStart"in u&&Hp(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Fc&&Bc(Fc,u)||(Fc=u,u=Ud($p,"onSelect"),0<u.length&&(i=new Cs("onSelect","select",null,i,o),r.push({event:i,listeners:u}),i.target=ol)))}function ro(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var ll={animationend:ro("Animation","AnimationEnd"),animationiteration:ro("Animation","AnimationIteration"),animationstart:ro("Animation","AnimationStart"),transitionrun:ro("Transition","TransitionRun"),transitionstart:ro("Transition","TransitionStart"),transitioncancel:ro("Transition","TransitionCancel"),transitionend:ro("Transition","TransitionEnd")},Qp={},$v={};Kr&&($v=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function so(r){if(Qp[r])return Qp[r];if(!ll[r])return r;var i=ll[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in $v)return Qp[r]=i[o];return r}var Kv=so("animationend"),Qv=so("animationiteration"),Yv=so("animationstart"),_A=so("transitionrun"),wA=so("transitionstart"),EA=so("transitioncancel"),Xv=so("transitionend"),Jv=new Map,Yp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Yp.push("scrollEnd");function ys(r,i){Jv.set(r,i),Fr(i,[r])}var Wh=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Yr=[],cl=0,Xp=0;function Zh(){for(var r=cl,i=Xp=cl=0;i<r;){var o=Yr[i];Yr[i++]=null;var u=Yr[i];Yr[i++]=null;var m=Yr[i];Yr[i++]=null;var y=Yr[i];if(Yr[i++]=null,u!==null&&m!==null){var _=u.pending;_===null?m.next=m:(m.next=_.next,_.next=m),u.pending=m}y!==0&&Wv(o,m,y)}}function ed(r,i,o,u){Yr[cl++]=r,Yr[cl++]=i,Yr[cl++]=o,Yr[cl++]=u,Xp|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function Jp(r,i,o,u){return ed(r,i,o,u),td(r)}function io(r,i){return ed(r,null,null,i),td(r)}function Wv(r,i,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var m=!1,y=r.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(m=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,m&&i!==null&&(m=31-Ke(o),r=y.hiddenUpdates,u=r[m],u===null?r[m]=[i]:u.push(i),i.lane=o|536870912),y):null}function td(r){if(50<uu)throw uu=0,ag=null,Error(n(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var ul={};function TA(r,i,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(r,i,o,u){return new TA(r,i,o,u)}function Wp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function si(r,i){var o=r.alternate;return o===null?(o=Nr(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function Zv(r,i){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,i=o.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function nd(r,i,o,u,m,y){var _=0;if(u=r,typeof r=="function")Wp(r)&&(_=1);else if(typeof r=="string")_=CI(r,o,ve.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case R:return r=Nr(31,o,i,m),r.elementType=R,r.lanes=y,r;case F:return ao(o.children,m,y,i);case J:_=8,m|=24;break;case se:return r=Nr(12,o,i,m|2),r.elementType=se,r.lanes=y,r;case Ee:return r=Nr(13,o,i,m),r.elementType=Ee,r.lanes=y,r;case be:return r=Nr(19,o,i,m),r.elementType=be,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case le:_=10;break e;case ce:_=9;break e;case me:_=11;break e;case I:_=14;break e;case C:_=16,u=null;break e}_=29,o=Error(n(130,r===null?"null":typeof r,"")),u=null}return i=Nr(_,o,i,m),i.elementType=r,i.type=u,i.lanes=y,i}function ao(r,i,o,u){return r=Nr(7,r,u,i),r.lanes=o,r}function Zp(r,i,o){return r=Nr(6,r,null,i),r.lanes=o,r}function eb(r){var i=Nr(18,null,null,0);return i.stateNode=r,i}function em(r,i,o){return i=Nr(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var tb=new WeakMap;function Xr(r,i){if(typeof r=="object"&&r!==null){var o=tb.get(r);return o!==void 0?o:(i={value:r,source:i,stack:Di(i)},tb.set(r,i),i)}return{value:r,source:i,stack:Di(i)}}var hl=[],dl=0,rd=null,Gc=0,Jr=[],Wr=0,Hi=null,js=1,Os="";function ii(r,i){hl[dl++]=Gc,hl[dl++]=rd,rd=r,Gc=i}function nb(r,i,o){Jr[Wr++]=js,Jr[Wr++]=Os,Jr[Wr++]=Hi,Hi=r;var u=js;r=Os;var m=32-Ke(u)-1;u&=~(1<<m),o+=1;var y=32-Ke(i)+m;if(30<y){var _=m-m%5;y=(u&(1<<_)-1).toString(32),u>>=_,m-=_,js=1<<32-Ke(i)+m|o<<m|u,Os=y+r}else js=1<<y|o<<m|u,Os=r}function tm(r){r.return!==null&&(ii(r,1),nb(r,1,0))}function nm(r){for(;r===rd;)rd=hl[--dl],hl[dl]=null,Gc=hl[--dl],hl[dl]=null;for(;r===Hi;)Hi=Jr[--Wr],Jr[Wr]=null,Os=Jr[--Wr],Jr[Wr]=null,js=Jr[--Wr],Jr[Wr]=null}function rb(r,i){Jr[Wr++]=js,Jr[Wr++]=Os,Jr[Wr++]=Hi,js=i.id,Os=i.overflow,Hi=r}var On=null,Mt=null,it=!1,$i=null,Zr=!1,rm=Error(n(519));function Ki(r){var i=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw qc(Xr(i,r)),rm}function sb(r){var i=r.stateNode,o=r.type,u=r.memoizedProps;switch(i[$t]=r,i[Jt]=u,o){case"dialog":et("cancel",i),et("close",i);break;case"iframe":case"object":case"embed":et("load",i);break;case"video":case"audio":for(o=0;o<du.length;o++)et(du[o],i);break;case"source":et("error",i);break;case"img":case"image":case"link":et("error",i),et("load",i);break;case"details":et("toggle",i);break;case"input":et("invalid",i),Zo(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":et("invalid",i);break;case"textarea":et("invalid",i),ee(i,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||u.suppressHydrationWarning===!0||__(i.textContent,o)?(u.popover!=null&&(et("beforetoggle",i),et("toggle",i)),u.onScroll!=null&&et("scroll",i),u.onScrollEnd!=null&&et("scrollend",i),u.onClick!=null&&(i.onclick=ds),i=!0):i=!1,i||Ki(r,!0)}function ib(r){for(On=r.return;On;)switch(On.tag){case 5:case 31:case 13:Zr=!1;return;case 27:case 3:Zr=!0;return;default:On=On.return}}function fl(r){if(r!==On)return!1;if(!it)return ib(r),it=!0,!1;var i=r.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||_g(r.type,r.memoizedProps)),o=!o),o&&Mt&&Ki(r),ib(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Mt=R_(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Mt=R_(r)}else i===27?(i=Mt,oa(r.type)?(r=Ng,Ng=null,Mt=r):Mt=i):Mt=On?ts(r.stateNode.nextSibling):null;return!0}function oo(){Mt=On=null,it=!1}function sm(){var r=$i;return r!==null&&(dr===null?dr=r:dr.push.apply(dr,r),$i=null),r}function qc(r){$i===null?$i=[r]:$i.push(r)}var im=M(null),lo=null,ai=null;function Qi(r,i,o){fe(im,i._currentValue),i._currentValue=o}function oi(r){r._currentValue=im.current,ne(im)}function am(r,i,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),r===o)break;r=r.return}}function om(r,i,o,u){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var y=m.dependencies;if(y!==null){var _=m.child;y=y.firstContext;e:for(;y!==null;){var S=y;y=m;for(var D=0;D<i.length;D++)if(S.context===i[D]){y.lanes|=o,S=y.alternate,S!==null&&(S.lanes|=o),am(y.return,o,r),u||(_=null);break e}y=S.next}}else if(m.tag===18){if(_=m.return,_===null)throw Error(n(341));_.lanes|=o,y=_.alternate,y!==null&&(y.lanes|=o),am(_,o,r),_=null}else _=m.child;if(_!==null)_.return=m;else for(_=m;_!==null;){if(_===r){_=null;break}if(m=_.sibling,m!==null){m.return=_.return,_=m;break}_=_.return}m=_}}function pl(r,i,o,u){r=null;for(var m=i,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var _=m.alternate;if(_===null)throw Error(n(387));if(_=_.memoizedProps,_!==null){var S=m.type;Sr(m.pendingProps.value,_.value)||(r!==null?r.push(S):r=[S])}}else if(m===Be.current){if(_=m.alternate,_===null)throw Error(n(387));_.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(yu):r=[yu])}m=m.return}r!==null&&om(i,r,o,u),i.flags|=262144}function sd(r){for(r=r.firstContext;r!==null;){if(!Sr(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function co(r){lo=r,ai=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Pn(r){return ab(lo,r)}function id(r,i){return lo===null&&co(r),ab(r,i)}function ab(r,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},ai===null){if(r===null)throw Error(n(308));ai=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else ai=ai.next=i;return o}var SA=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){i.aborted=!0,r.forEach(function(o){return o()})}},NA=s.unstable_scheduleCallback,AA=s.unstable_NormalPriority,fn={$$typeof:le,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lm(){return{controller:new SA,data:new Map,refCount:0}}function Hc(r){r.refCount--,r.refCount===0&&NA(AA,function(){r.controller.abort()})}var $c=null,cm=0,ml=0,gl=null;function IA(r,i){if($c===null){var o=$c=[];cm=0,ml=dg(),gl={status:"pending",value:void 0,then:function(u){o.push(u)}}}return cm++,i.then(ob,ob),i}function ob(){if(--cm===0&&$c!==null){gl!==null&&(gl.status="fulfilled");var r=$c;$c=null,ml=0,gl=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function CA(r,i){var o=[],u={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return r.then(function(){u.status="fulfilled",u.value=i;for(var m=0;m<o.length;m++)(0,o[m])(i)},function(m){for(u.status="rejected",u.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),u}var lb=X.S;X.S=function(r,i){Hx=dn(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&IA(r,i),lb!==null&&lb(r,i)};var uo=M(null);function um(){var r=uo.current;return r!==null?r:kt.pooledCache}function ad(r,i){i===null?fe(uo,uo.current):fe(uo,i.pool)}function cb(){var r=um();return r===null?null:{parent:fn._currentValue,pool:r}}var yl=Error(n(460)),hm=Error(n(474)),od=Error(n(542)),ld={then:function(){}};function ub(r){return r=r.status,r==="fulfilled"||r==="rejected"}function hb(r,i,o){switch(o=r[o],o===void 0?r.push(i):o!==i&&(i.then(ds,ds),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,fb(r),r;default:if(typeof i.status=="string")i.then(ds,ds);else{if(r=kt,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=i,r.status="pending",r.then(function(u){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=u}},function(u){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,fb(r),r}throw fo=i,yl}}function ho(r){try{var i=r._init;return i(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(fo=o,yl):o}}var fo=null;function db(){if(fo===null)throw Error(n(459));var r=fo;return fo=null,r}function fb(r){if(r===yl||r===od)throw Error(n(483))}var vl=null,Kc=0;function cd(r){var i=Kc;return Kc+=1,vl===null&&(vl=[]),hb(vl,r,i)}function Qc(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function ud(r,i){throw i.$$typeof===E?Error(n(525)):(r=Object.prototype.toString.call(i),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function pb(r){function i(z,V){if(r){var q=z.deletions;q===null?(z.deletions=[V],z.flags|=16):q.push(V)}}function o(z,V){if(!r)return null;for(;V!==null;)i(z,V),V=V.sibling;return null}function u(z){for(var V=new Map;z!==null;)z.key!==null?V.set(z.key,z):V.set(z.index,z),z=z.sibling;return V}function m(z,V){return z=si(z,V),z.index=0,z.sibling=null,z}function y(z,V,q){return z.index=q,r?(q=z.alternate,q!==null?(q=q.index,q<V?(z.flags|=67108866,V):q):(z.flags|=67108866,V)):(z.flags|=1048576,V)}function _(z){return r&&z.alternate===null&&(z.flags|=67108866),z}function S(z,V,q,te){return V===null||V.tag!==6?(V=Zp(q,z.mode,te),V.return=z,V):(V=m(V,q),V.return=z,V)}function D(z,V,q,te){var Re=q.type;return Re===F?W(z,V,q.props.children,te,q.key):V!==null&&(V.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===C&&ho(Re)===V.type)?(V=m(V,q.props),Qc(V,q),V.return=z,V):(V=nd(q.type,q.key,q.props,null,z.mode,te),Qc(V,q),V.return=z,V)}function H(z,V,q,te){return V===null||V.tag!==4||V.stateNode.containerInfo!==q.containerInfo||V.stateNode.implementation!==q.implementation?(V=em(q,z.mode,te),V.return=z,V):(V=m(V,q.children||[]),V.return=z,V)}function W(z,V,q,te,Re){return V===null||V.tag!==7?(V=ao(q,z.mode,te,Re),V.return=z,V):(V=m(V,q),V.return=z,V)}function re(z,V,q){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Zp(""+V,z.mode,q),V.return=z,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case A:return q=nd(V.type,V.key,V.props,null,z.mode,q),Qc(q,V),q.return=z,q;case O:return V=em(V,z.mode,q),V.return=z,V;case C:return V=ho(V),re(z,V,q)}if(_t(V)||P(V))return V=ao(V,z.mode,q,null),V.return=z,V;if(typeof V.then=="function")return re(z,cd(V),q);if(V.$$typeof===le)return re(z,id(z,V),q);ud(z,V)}return null}function $(z,V,q,te){var Re=V!==null?V.key:null;if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return Re!==null?null:S(z,V,""+q,te);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case A:return q.key===Re?D(z,V,q,te):null;case O:return q.key===Re?H(z,V,q,te):null;case C:return q=ho(q),$(z,V,q,te)}if(_t(q)||P(q))return Re!==null?null:W(z,V,q,te,null);if(typeof q.then=="function")return $(z,V,cd(q),te);if(q.$$typeof===le)return $(z,V,id(z,q),te);ud(z,q)}return null}function Y(z,V,q,te,Re){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return z=z.get(q)||null,S(V,z,""+te,Re);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case A:return z=z.get(te.key===null?q:te.key)||null,D(V,z,te,Re);case O:return z=z.get(te.key===null?q:te.key)||null,H(V,z,te,Re);case C:return te=ho(te),Y(z,V,q,te,Re)}if(_t(te)||P(te))return z=z.get(q)||null,W(V,z,te,Re,null);if(typeof te.then=="function")return Y(z,V,q,cd(te),Re);if(te.$$typeof===le)return Y(z,V,q,id(V,te),Re);ud(V,te)}return null}function we(z,V,q,te){for(var Re=null,ct=null,Ne=V,$e=V=0,nt=null;Ne!==null&&$e<q.length;$e++){Ne.index>$e?(nt=Ne,Ne=null):nt=Ne.sibling;var ut=$(z,Ne,q[$e],te);if(ut===null){Ne===null&&(Ne=nt);break}r&&Ne&&ut.alternate===null&&i(z,Ne),V=y(ut,V,$e),ct===null?Re=ut:ct.sibling=ut,ct=ut,Ne=nt}if($e===q.length)return o(z,Ne),it&&ii(z,$e),Re;if(Ne===null){for(;$e<q.length;$e++)Ne=re(z,q[$e],te),Ne!==null&&(V=y(Ne,V,$e),ct===null?Re=Ne:ct.sibling=Ne,ct=Ne);return it&&ii(z,$e),Re}for(Ne=u(Ne);$e<q.length;$e++)nt=Y(Ne,z,$e,q[$e],te),nt!==null&&(r&&nt.alternate!==null&&Ne.delete(nt.key===null?$e:nt.key),V=y(nt,V,$e),ct===null?Re=nt:ct.sibling=nt,ct=nt);return r&&Ne.forEach(function(da){return i(z,da)}),it&&ii(z,$e),Re}function De(z,V,q,te){if(q==null)throw Error(n(151));for(var Re=null,ct=null,Ne=V,$e=V=0,nt=null,ut=q.next();Ne!==null&&!ut.done;$e++,ut=q.next()){Ne.index>$e?(nt=Ne,Ne=null):nt=Ne.sibling;var da=$(z,Ne,ut.value,te);if(da===null){Ne===null&&(Ne=nt);break}r&&Ne&&da.alternate===null&&i(z,Ne),V=y(da,V,$e),ct===null?Re=da:ct.sibling=da,ct=da,Ne=nt}if(ut.done)return o(z,Ne),it&&ii(z,$e),Re;if(Ne===null){for(;!ut.done;$e++,ut=q.next())ut=re(z,ut.value,te),ut!==null&&(V=y(ut,V,$e),ct===null?Re=ut:ct.sibling=ut,ct=ut);return it&&ii(z,$e),Re}for(Ne=u(Ne);!ut.done;$e++,ut=q.next())ut=Y(Ne,z,$e,ut.value,te),ut!==null&&(r&&ut.alternate!==null&&Ne.delete(ut.key===null?$e:ut.key),V=y(ut,V,$e),ct===null?Re=ut:ct.sibling=ut,ct=ut);return r&&Ne.forEach(function(zI){return i(z,zI)}),it&&ii(z,$e),Re}function Nt(z,V,q,te){if(typeof q=="object"&&q!==null&&q.type===F&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case A:e:{for(var Re=q.key;V!==null;){if(V.key===Re){if(Re=q.type,Re===F){if(V.tag===7){o(z,V.sibling),te=m(V,q.props.children),te.return=z,z=te;break e}}else if(V.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===C&&ho(Re)===V.type){o(z,V.sibling),te=m(V,q.props),Qc(te,q),te.return=z,z=te;break e}o(z,V);break}else i(z,V);V=V.sibling}q.type===F?(te=ao(q.props.children,z.mode,te,q.key),te.return=z,z=te):(te=nd(q.type,q.key,q.props,null,z.mode,te),Qc(te,q),te.return=z,z=te)}return _(z);case O:e:{for(Re=q.key;V!==null;){if(V.key===Re)if(V.tag===4&&V.stateNode.containerInfo===q.containerInfo&&V.stateNode.implementation===q.implementation){o(z,V.sibling),te=m(V,q.children||[]),te.return=z,z=te;break e}else{o(z,V);break}else i(z,V);V=V.sibling}te=em(q,z.mode,te),te.return=z,z=te}return _(z);case C:return q=ho(q),Nt(z,V,q,te)}if(_t(q))return we(z,V,q,te);if(P(q)){if(Re=P(q),typeof Re!="function")throw Error(n(150));return q=Re.call(q),De(z,V,q,te)}if(typeof q.then=="function")return Nt(z,V,cd(q),te);if(q.$$typeof===le)return Nt(z,V,id(z,q),te);ud(z,q)}return typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint"?(q=""+q,V!==null&&V.tag===6?(o(z,V.sibling),te=m(V,q),te.return=z,z=te):(o(z,V),te=Zp(q,z.mode,te),te.return=z,z=te),_(z)):o(z,V)}return function(z,V,q,te){try{Kc=0;var Re=Nt(z,V,q,te);return vl=null,Re}catch(Ne){if(Ne===yl||Ne===od)throw Ne;var ct=Nr(29,Ne,null,z.mode);return ct.lanes=te,ct.return=z,ct}finally{}}}var po=pb(!0),mb=pb(!1),Yi=!1;function dm(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fm(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Xi(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ji(r,i,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(dt&2)!==0){var m=u.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),u.pending=i,i=td(r),Wv(r,null,o),i}return ed(r,u,i,o),td(r)}function Yc(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,Ws(r,o)}}function pm(r,i){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var m=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var _={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?m=y=_:y=y.next=_,o=o.next}while(o!==null);y===null?m=y=i:y=y.next=i}else m=y=i;o={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}var mm=!1;function Xc(){if(mm){var r=gl;if(r!==null)throw r}}function Jc(r,i,o,u){mm=!1;var m=r.updateQueue;Yi=!1;var y=m.firstBaseUpdate,_=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var D=S,H=D.next;D.next=null,_===null?y=H:_.next=H,_=D;var W=r.alternate;W!==null&&(W=W.updateQueue,S=W.lastBaseUpdate,S!==_&&(S===null?W.firstBaseUpdate=H:S.next=H,W.lastBaseUpdate=D))}if(y!==null){var re=m.baseState;_=0,W=H=D=null,S=y;do{var $=S.lane&-536870913,Y=$!==S.lane;if(Y?(tt&$)===$:(u&$)===$){$!==0&&$===ml&&(mm=!0),W!==null&&(W=W.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var we=r,De=S;$=i;var Nt=o;switch(De.tag){case 1:if(we=De.payload,typeof we=="function"){re=we.call(Nt,re,$);break e}re=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=De.payload,$=typeof we=="function"?we.call(Nt,re,$):we,$==null)break e;re=x({},re,$);break e;case 2:Yi=!0}}$=S.callback,$!==null&&(r.flags|=64,Y&&(r.flags|=8192),Y=m.callbacks,Y===null?m.callbacks=[$]:Y.push($))}else Y={lane:$,tag:S.tag,payload:S.payload,callback:S.callback,next:null},W===null?(H=W=Y,D=re):W=W.next=Y,_|=$;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;Y=S,S=Y.next,Y.next=null,m.lastBaseUpdate=Y,m.shared.pending=null}}while(!0);W===null&&(D=re),m.baseState=D,m.firstBaseUpdate=H,m.lastBaseUpdate=W,y===null&&(m.shared.lanes=0),na|=_,r.lanes=_,r.memoizedState=re}}function gb(r,i){if(typeof r!="function")throw Error(n(191,r));r.call(i)}function yb(r,i){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)gb(o[r],i)}var bl=M(null),hd=M(0);function vb(r,i){r=gi,fe(hd,r),fe(bl,i),gi=r|i.baseLanes}function gm(){fe(hd,gi),fe(bl,bl.current)}function ym(){gi=hd.current,ne(bl),ne(hd)}var Ar=M(null),es=null;function Wi(r){var i=r.alternate;fe(ln,ln.current&1),fe(Ar,r),es===null&&(i===null||bl.current!==null||i.memoizedState!==null)&&(es=r)}function vm(r){fe(ln,ln.current),fe(Ar,r),es===null&&(es=r)}function bb(r){r.tag===22?(fe(ln,ln.current),fe(Ar,r),es===null&&(es=r)):Zi()}function Zi(){fe(ln,ln.current),fe(Ar,Ar.current)}function Ir(r){ne(Ar),es===r&&(es=null),ne(ln)}var ln=M(0);function dd(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Tg(o)||Sg(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var li=0,qe=null,Tt=null,pn=null,fd=!1,xl=!1,mo=!1,pd=0,Wc=0,_l=null,RA=0;function tn(){throw Error(n(321))}function bm(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!Sr(r[o],i[o]))return!1;return!0}function xm(r,i,o,u,m,y){return li=y,qe=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,X.H=r===null||r.memoizedState===null?nx:Pm,mo=!1,y=o(u,m),mo=!1,xl&&(y=_b(i,o,u,m)),xb(r),y}function xb(r){X.H=tu;var i=Tt!==null&&Tt.next!==null;if(li=0,pn=Tt=qe=null,fd=!1,Wc=0,_l=null,i)throw Error(n(300));r===null||mn||(r=r.dependencies,r!==null&&sd(r)&&(mn=!0))}function _b(r,i,o,u){qe=r;var m=0;do{if(xl&&(_l=null),Wc=0,xl=!1,25<=m)throw Error(n(301));if(m+=1,pn=Tt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}X.H=rx,y=i(o,u)}while(xl);return y}function kA(){var r=X.H,i=r.useState()[0];return i=typeof i.then=="function"?Zc(i):i,r=r.useState()[0],(Tt!==null?Tt.memoizedState:null)!==r&&(qe.flags|=1024),i}function _m(){var r=pd!==0;return pd=0,r}function wm(r,i,o){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~o}function Em(r){if(fd){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}fd=!1}li=0,pn=Tt=qe=null,xl=!1,Wc=pd=0,_l=null}function er(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?qe.memoizedState=pn=r:pn=pn.next=r,pn}function cn(){if(Tt===null){var r=qe.alternate;r=r!==null?r.memoizedState:null}else r=Tt.next;var i=pn===null?qe.memoizedState:pn.next;if(i!==null)pn=i,Tt=r;else{if(r===null)throw qe.alternate===null?Error(n(467)):Error(n(310));Tt=r,r={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},pn===null?qe.memoizedState=pn=r:pn=pn.next=r}return pn}function md(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zc(r){var i=Wc;return Wc+=1,_l===null&&(_l=[]),r=hb(_l,r,i),i=qe,(pn===null?i.memoizedState:pn.next)===null&&(i=i.alternate,X.H=i===null||i.memoizedState===null?nx:Pm),r}function gd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Zc(r);if(r.$$typeof===le)return Pn(r)}throw Error(n(438,String(r)))}function Tm(r){var i=null,o=qe.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var u=qe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=md(),qe.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(r),u=0;u<r;u++)o[u]=L;return i.index++,o}function ci(r,i){return typeof i=="function"?i(r):i}function yd(r){var i=cn();return Sm(i,Tt,r)}function Sm(r,i,o){var u=r.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=o;var m=r.baseQueue,y=u.pending;if(y!==null){if(m!==null){var _=m.next;m.next=y.next,y.next=_}i.baseQueue=m=y,u.pending=null}if(y=r.baseState,m===null)r.memoizedState=y;else{i=m.next;var S=_=null,D=null,H=i,W=!1;do{var re=H.lane&-536870913;if(re!==H.lane?(tt&re)===re:(li&re)===re){var $=H.revertLane;if($===0)D!==null&&(D=D.next={lane:0,revertLane:0,gesture:null,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null}),re===ml&&(W=!0);else if((li&$)===$){H=H.next,$===ml&&(W=!0);continue}else re={lane:0,revertLane:H.revertLane,gesture:null,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null},D===null?(S=D=re,_=y):D=D.next=re,qe.lanes|=$,na|=$;re=H.action,mo&&o(y,re),y=H.hasEagerState?H.eagerState:o(y,re)}else $={lane:re,revertLane:H.revertLane,gesture:H.gesture,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null},D===null?(S=D=$,_=y):D=D.next=$,qe.lanes|=re,na|=re;H=H.next}while(H!==null&&H!==i);if(D===null?_=y:D.next=S,!Sr(y,r.memoizedState)&&(mn=!0,W&&(o=gl,o!==null)))throw o;r.memoizedState=y,r.baseState=_,r.baseQueue=D,u.lastRenderedState=y}return m===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function Nm(r){var i=cn(),o=i.queue;if(o===null)throw Error(n(311));o.lastRenderedReducer=r;var u=o.dispatch,m=o.pending,y=i.memoizedState;if(m!==null){o.pending=null;var _=m=m.next;do y=r(y,_.action),_=_.next;while(_!==m);Sr(y,i.memoizedState)||(mn=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),o.lastRenderedState=y}return[y,u]}function wb(r,i,o){var u=qe,m=cn(),y=it;if(y){if(o===void 0)throw Error(n(407));o=o()}else o=i();var _=!Sr((Tt||m).memoizedState,o);if(_&&(m.memoizedState=o,mn=!0),m=m.queue,Cm(Sb.bind(null,u,m,r),[r]),m.getSnapshot!==i||_||pn!==null&&pn.memoizedState.tag&1){if(u.flags|=2048,wl(9,{destroy:void 0},Tb.bind(null,u,m,o,i),null),kt===null)throw Error(n(349));y||(li&127)!==0||Eb(u,i,o)}return o}function Eb(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=qe.updateQueue,i===null?(i=md(),qe.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function Tb(r,i,o,u){i.value=o,i.getSnapshot=u,Nb(i)&&Ab(r)}function Sb(r,i,o){return o(function(){Nb(i)&&Ab(r)})}function Nb(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!Sr(r,o)}catch{return!0}}function Ab(r){var i=io(r,2);i!==null&&fr(i,r,2)}function Am(r){var i=er();if(typeof r=="function"){var o=r;if(r=o(),mo){Xe(!0);try{o()}finally{Xe(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:r},i}function Ib(r,i,o,u){return r.baseState=o,Sm(r,Tt,typeof u=="function"?u:ci)}function DA(r,i,o,u,m){if(xd(r))throw Error(n(485));if(r=i.action,r!==null){var y={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){y.listeners.push(_)}};X.T!==null?o(!0):y.isTransition=!1,u(y),o=i.pending,o===null?(y.next=i.pending=y,Cb(i,y)):(y.next=o.next,i.pending=o.next=y)}}function Cb(r,i){var o=i.action,u=i.payload,m=r.state;if(i.isTransition){var y=X.T,_={};X.T=_;try{var S=o(m,u),D=X.S;D!==null&&D(_,S),Rb(r,i,S)}catch(H){Im(r,i,H)}finally{y!==null&&_.types!==null&&(y.types=_.types),X.T=y}}else try{y=o(m,u),Rb(r,i,y)}catch(H){Im(r,i,H)}}function Rb(r,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){kb(r,i,u)},function(u){return Im(r,i,u)}):kb(r,i,o)}function kb(r,i,o){i.status="fulfilled",i.value=o,Db(i),r.state=o,i=r.pending,i!==null&&(o=i.next,o===i?r.pending=null:(o=o.next,i.next=o,Cb(r,o)))}function Im(r,i,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=o,Db(i),i=i.next;while(i!==u)}r.action=null}function Db(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function jb(r,i){return i}function Ob(r,i){if(it){var o=kt.formState;if(o!==null){e:{var u=qe;if(it){if(Mt){t:{for(var m=Mt,y=Zr;m.nodeType!==8;){if(!y){m=null;break t}if(m=ts(m.nextSibling),m===null){m=null;break t}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){Mt=ts(m.nextSibling),u=m.data==="F!";break e}}Ki(u)}u=!1}u&&(i=o[0])}}return o=er(),o.memoizedState=o.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jb,lastRenderedState:i},o.queue=u,o=Zb.bind(null,qe,u),u.dispatch=o,u=Am(!1),y=Om.bind(null,qe,!1,u.queue),u=er(),m={state:i,dispatch:null,action:r,pending:null},u.queue=m,o=DA.bind(null,qe,m,y,o),m.dispatch=o,u.memoizedState=r,[i,o,!1]}function Pb(r){var i=cn();return Mb(i,Tt,r)}function Mb(r,i,o){if(i=Sm(r,i,jb)[0],r=yd(ci)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Zc(i)}catch(_){throw _===yl?od:_}else u=i;i=cn();var m=i.queue,y=m.dispatch;return o!==i.memoizedState&&(qe.flags|=2048,wl(9,{destroy:void 0},jA.bind(null,m,o),null)),[u,y,r]}function jA(r,i){r.action=i}function Vb(r){var i=cn(),o=Tt;if(o!==null)return Mb(i,o,r);cn(),i=i.memoizedState,o=cn();var u=o.queue.dispatch;return o.memoizedState=r,[i,u,!1]}function wl(r,i,o,u){return r={tag:r,create:o,deps:u,inst:i,next:null},i=qe.updateQueue,i===null&&(i=md(),qe.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,i.lastEffect=r),r}function Lb(){return cn().memoizedState}function vd(r,i,o,u){var m=er();qe.flags|=r,m.memoizedState=wl(1|i,{destroy:void 0},o,u===void 0?null:u)}function bd(r,i,o,u){var m=cn();u=u===void 0?null:u;var y=m.memoizedState.inst;Tt!==null&&u!==null&&bm(u,Tt.memoizedState.deps)?m.memoizedState=wl(i,y,o,u):(qe.flags|=r,m.memoizedState=wl(1|i,y,o,u))}function Ub(r,i){vd(8390656,8,r,i)}function Cm(r,i){bd(2048,8,r,i)}function OA(r){qe.flags|=4;var i=qe.updateQueue;if(i===null)i=md(),qe.updateQueue=i,i.events=[r];else{var o=i.events;o===null?i.events=[r]:o.push(r)}}function zb(r){var i=cn().memoizedState;return OA({ref:i,nextImpl:r}),function(){if((dt&2)!==0)throw Error(n(440));return i.impl.apply(void 0,arguments)}}function Bb(r,i){return bd(4,2,r,i)}function Fb(r,i){return bd(4,4,r,i)}function Gb(r,i){if(typeof i=="function"){r=r();var o=i(r);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function qb(r,i,o){o=o!=null?o.concat([r]):null,bd(4,4,Gb.bind(null,i,r),o)}function Rm(){}function Hb(r,i){var o=cn();i=i===void 0?null:i;var u=o.memoizedState;return i!==null&&bm(i,u[1])?u[0]:(o.memoizedState=[r,i],r)}function $b(r,i){var o=cn();i=i===void 0?null:i;var u=o.memoizedState;if(i!==null&&bm(i,u[1]))return u[0];if(u=r(),mo){Xe(!0);try{r()}finally{Xe(!1)}}return o.memoizedState=[u,i],u}function km(r,i,o){return o===void 0||(li&1073741824)!==0&&(tt&261930)===0?r.memoizedState=i:(r.memoizedState=o,r=Kx(),qe.lanes|=r,na|=r,o)}function Kb(r,i,o,u){return Sr(o,i)?o:bl.current!==null?(r=km(r,o,u),Sr(r,i)||(mn=!0),r):(li&42)===0||(li&1073741824)!==0&&(tt&261930)===0?(mn=!0,r.memoizedState=o):(r=Kx(),qe.lanes|=r,na|=r,i)}function Qb(r,i,o,u,m){var y=ue.p;ue.p=y!==0&&8>y?y:8;var _=X.T,S={};X.T=S,Om(r,!1,i,o);try{var D=m(),H=X.S;if(H!==null&&H(S,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var W=CA(D,u);eu(r,i,W,kr(r))}else eu(r,i,u,kr(r))}catch(re){eu(r,i,{then:function(){},status:"rejected",reason:re},kr())}finally{ue.p=y,_!==null&&S.types!==null&&(_.types=S.types),X.T=_}}function PA(){}function Dm(r,i,o,u){if(r.tag!==5)throw Error(n(476));var m=Yb(r).queue;Qb(r,m,i,Ae,o===null?PA:function(){return Xb(r),o(u)})}function Yb(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:Ae,baseState:Ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:Ae},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:o},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function Xb(r){var i=Yb(r);i.next===null&&(i=r.alternate.memoizedState),eu(r,i.next.queue,{},kr())}function jm(){return Pn(yu)}function Jb(){return cn().memoizedState}function Wb(){return cn().memoizedState}function MA(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var o=kr();r=Xi(o);var u=Ji(i,r,o);u!==null&&(fr(u,i,o),Yc(u,i,o)),i={cache:lm()},r.payload=i;return}i=i.return}}function VA(r,i,o){var u=kr();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},xd(r)?ex(i,o):(o=Jp(r,i,o,u),o!==null&&(fr(o,r,u),tx(o,i,u)))}function Zb(r,i,o){var u=kr();eu(r,i,o,u)}function eu(r,i,o,u){var m={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(xd(r))ex(i,m);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var _=i.lastRenderedState,S=y(_,o);if(m.hasEagerState=!0,m.eagerState=S,Sr(S,_))return ed(r,i,m,0),kt===null&&Zh(),!1}catch{}finally{}if(o=Jp(r,i,m,u),o!==null)return fr(o,r,u),tx(o,i,u),!0}return!1}function Om(r,i,o,u){if(u={lane:2,revertLane:dg(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},xd(r)){if(i)throw Error(n(479))}else i=Jp(r,o,u,2),i!==null&&fr(i,r,2)}function xd(r){var i=r.alternate;return r===qe||i!==null&&i===qe}function ex(r,i){xl=fd=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function tx(r,i,o){if((o&4194048)!==0){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,Ws(r,o)}}var tu={readContext:Pn,use:gd,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useLayoutEffect:tn,useInsertionEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useSyncExternalStore:tn,useId:tn,useHostTransitionStatus:tn,useFormState:tn,useActionState:tn,useOptimistic:tn,useMemoCache:tn,useCacheRefresh:tn};tu.useEffectEvent=tn;var nx={readContext:Pn,use:gd,useCallback:function(r,i){return er().memoizedState=[r,i===void 0?null:i],r},useContext:Pn,useEffect:Ub,useImperativeHandle:function(r,i,o){o=o!=null?o.concat([r]):null,vd(4194308,4,Gb.bind(null,i,r),o)},useLayoutEffect:function(r,i){return vd(4194308,4,r,i)},useInsertionEffect:function(r,i){vd(4,2,r,i)},useMemo:function(r,i){var o=er();i=i===void 0?null:i;var u=r();if(mo){Xe(!0);try{r()}finally{Xe(!1)}}return o.memoizedState=[u,i],u},useReducer:function(r,i,o){var u=er();if(o!==void 0){var m=o(i);if(mo){Xe(!0);try{o(i)}finally{Xe(!1)}}}else m=i;return u.memoizedState=u.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},u.queue=r,r=r.dispatch=VA.bind(null,qe,r),[u.memoizedState,r]},useRef:function(r){var i=er();return r={current:r},i.memoizedState=r},useState:function(r){r=Am(r);var i=r.queue,o=Zb.bind(null,qe,i);return i.dispatch=o,[r.memoizedState,o]},useDebugValue:Rm,useDeferredValue:function(r,i){var o=er();return km(o,r,i)},useTransition:function(){var r=Am(!1);return r=Qb.bind(null,qe,r.queue,!0,!1),er().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,o){var u=qe,m=er();if(it){if(o===void 0)throw Error(n(407));o=o()}else{if(o=i(),kt===null)throw Error(n(349));(tt&127)!==0||Eb(u,i,o)}m.memoizedState=o;var y={value:o,getSnapshot:i};return m.queue=y,Ub(Sb.bind(null,u,y,r),[r]),u.flags|=2048,wl(9,{destroy:void 0},Tb.bind(null,u,y,o,i),null),o},useId:function(){var r=er(),i=kt.identifierPrefix;if(it){var o=Os,u=js;o=(u&~(1<<32-Ke(u)-1)).toString(32)+o,i="_"+i+"R_"+o,o=pd++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=RA++,i="_"+i+"r_"+o.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:jm,useFormState:Ob,useActionState:Ob,useOptimistic:function(r){var i=er();i.memoizedState=i.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=Om.bind(null,qe,!0,o),o.dispatch=i,[r,i]},useMemoCache:Tm,useCacheRefresh:function(){return er().memoizedState=MA.bind(null,qe)},useEffectEvent:function(r){var i=er(),o={impl:r};return i.memoizedState=o,function(){if((dt&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}},Pm={readContext:Pn,use:gd,useCallback:Hb,useContext:Pn,useEffect:Cm,useImperativeHandle:qb,useInsertionEffect:Bb,useLayoutEffect:Fb,useMemo:$b,useReducer:yd,useRef:Lb,useState:function(){return yd(ci)},useDebugValue:Rm,useDeferredValue:function(r,i){var o=cn();return Kb(o,Tt.memoizedState,r,i)},useTransition:function(){var r=yd(ci)[0],i=cn().memoizedState;return[typeof r=="boolean"?r:Zc(r),i]},useSyncExternalStore:wb,useId:Jb,useHostTransitionStatus:jm,useFormState:Pb,useActionState:Pb,useOptimistic:function(r,i){var o=cn();return Ib(o,Tt,r,i)},useMemoCache:Tm,useCacheRefresh:Wb};Pm.useEffectEvent=zb;var rx={readContext:Pn,use:gd,useCallback:Hb,useContext:Pn,useEffect:Cm,useImperativeHandle:qb,useInsertionEffect:Bb,useLayoutEffect:Fb,useMemo:$b,useReducer:Nm,useRef:Lb,useState:function(){return Nm(ci)},useDebugValue:Rm,useDeferredValue:function(r,i){var o=cn();return Tt===null?km(o,r,i):Kb(o,Tt.memoizedState,r,i)},useTransition:function(){var r=Nm(ci)[0],i=cn().memoizedState;return[typeof r=="boolean"?r:Zc(r),i]},useSyncExternalStore:wb,useId:Jb,useHostTransitionStatus:jm,useFormState:Vb,useActionState:Vb,useOptimistic:function(r,i){var o=cn();return Tt!==null?Ib(o,Tt,r,i):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:Tm,useCacheRefresh:Wb};rx.useEffectEvent=zb;function Mm(r,i,o,u){i=r.memoizedState,o=o(u,i),o=o==null?i:x({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var Vm={enqueueSetState:function(r,i,o){r=r._reactInternals;var u=kr(),m=Xi(u);m.payload=i,o!=null&&(m.callback=o),i=Ji(r,m,u),i!==null&&(fr(i,r,u),Yc(i,r,u))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var u=kr(),m=Xi(u);m.tag=1,m.payload=i,o!=null&&(m.callback=o),i=Ji(r,m,u),i!==null&&(fr(i,r,u),Yc(i,r,u))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=kr(),u=Xi(o);u.tag=2,i!=null&&(u.callback=i),i=Ji(r,u,o),i!==null&&(fr(i,r,o),Yc(i,r,o))}};function sx(r,i,o,u,m,y,_){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,_):i.prototype&&i.prototype.isPureReactComponent?!Bc(o,u)||!Bc(m,y):!0}function ix(r,i,o,u){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,u),i.state!==r&&Vm.enqueueReplaceState(i,i.state,null)}function go(r,i){var o=i;if("ref"in i){o={};for(var u in i)u!=="ref"&&(o[u]=i[u])}if(r=r.defaultProps){o===i&&(o=x({},o));for(var m in r)o[m]===void 0&&(o[m]=r[m])}return o}function ax(r){Wh(r)}function ox(r){console.error(r)}function lx(r){Wh(r)}function _d(r,i){try{var o=r.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function cx(r,i,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Lm(r,i,o){return o=Xi(o),o.tag=3,o.payload={element:null},o.callback=function(){_d(r,i)},o}function ux(r){return r=Xi(r),r.tag=3,r}function hx(r,i,o,u){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var y=u.value;r.payload=function(){return m(y)},r.callback=function(){cx(i,o,u)}}var _=o.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(r.callback=function(){cx(i,o,u),typeof m!="function"&&(ra===null?ra=new Set([this]):ra.add(this));var S=u.stack;this.componentDidCatch(u.value,{componentStack:S!==null?S:""})})}function LA(r,i,o,u,m){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=o.alternate,i!==null&&pl(i,o,m,!0),o=Ar.current,o!==null){switch(o.tag){case 31:case 13:return es===null?jd():o.alternate===null&&nn===0&&(nn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,u===ld?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([u]):i.add(u),cg(r,u,m)),!1;case 22:return o.flags|=65536,u===ld?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([u]):o.add(u)),cg(r,u,m)),!1}throw Error(n(435,o.tag))}return cg(r,u,m),jd(),!1}if(it)return i=Ar.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,u!==rm&&(r=Error(n(422),{cause:u}),qc(Xr(r,o)))):(u!==rm&&(i=Error(n(423),{cause:u}),qc(Xr(i,o))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,u=Xr(u,o),m=Lm(r.stateNode,u,m),pm(r,m),nn!==4&&(nn=2)),!1;var y=Error(n(520),{cause:u});if(y=Xr(y,o),cu===null?cu=[y]:cu.push(y),nn!==4&&(nn=2),i===null)return!0;u=Xr(u,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,r=m&-m,o.lanes|=r,r=Lm(o.stateNode,u,r),pm(o,r),!1;case 1:if(i=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ra===null||!ra.has(y))))return o.flags|=65536,m&=-m,o.lanes|=m,m=ux(m),hx(m,r,o,u),pm(o,m),!1}o=o.return}while(o!==null);return!1}var Um=Error(n(461)),mn=!1;function Mn(r,i,o,u){i.child=r===null?mb(i,null,o,u):po(i,r.child,o,u)}function dx(r,i,o,u,m){o=o.render;var y=i.ref;if("ref"in u){var _={};for(var S in u)S!=="ref"&&(_[S]=u[S])}else _=u;return co(i),u=xm(r,i,o,_,y,m),S=_m(),r!==null&&!mn?(wm(r,i,m),ui(r,i,m)):(it&&S&&tm(i),i.flags|=1,Mn(r,i,u,m),i.child)}function fx(r,i,o,u,m){if(r===null){var y=o.type;return typeof y=="function"&&!Wp(y)&&y.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=y,px(r,i,y,u,m)):(r=nd(o.type,null,u,i,i.mode,m),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,!Km(r,m)){var _=y.memoizedProps;if(o=o.compare,o=o!==null?o:Bc,o(_,u)&&r.ref===i.ref)return ui(r,i,m)}return i.flags|=1,r=si(y,u),r.ref=i.ref,r.return=i,i.child=r}function px(r,i,o,u,m){if(r!==null){var y=r.memoizedProps;if(Bc(y,u)&&r.ref===i.ref)if(mn=!1,i.pendingProps=u=y,Km(r,m))(r.flags&131072)!==0&&(mn=!0);else return i.lanes=r.lanes,ui(r,i,m)}return zm(r,i,o,u,m)}function mx(r,i,o,u){var m=u.children,y=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((i.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(u=i.child=r.child,m=0;u!==null;)m=m|u.lanes|u.childLanes,u=u.sibling;u=m&~y}else u=0,i.child=null;return gx(r,i,y,o,u)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&ad(i,y!==null?y.cachePool:null),y!==null?vb(i,y):gm(),bb(i);else return u=i.lanes=536870912,gx(r,i,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(ad(i,y.cachePool),vb(i,y),Zi(),i.memoizedState=null):(r!==null&&ad(i,null),gm(),Zi());return Mn(r,i,m,o),i.child}function nu(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function gx(r,i,o,u,m){var y=um();return y=y===null?null:{parent:fn._currentValue,pool:y},i.memoizedState={baseLanes:o,cachePool:y},r!==null&&ad(i,null),gm(),bb(i),r!==null&&pl(r,i,u,!0),i.childLanes=m,null}function wd(r,i){return i=Td({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function yx(r,i,o){return po(i,r.child,null,o),r=wd(i,i.pendingProps),r.flags|=2,Ir(i),i.memoizedState=null,r}function UA(r,i,o){var u=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(it){if(u.mode==="hidden")return r=wd(i,u),i.lanes=536870912,nu(null,r);if(vm(i),(r=Mt)?(r=C_(r,Zr),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:Hi!==null?{id:js,overflow:Os}:null,retryLane:536870912,hydrationErrors:null},o=eb(r),o.return=i,i.child=o,On=i,Mt=null)):r=null,r===null)throw Ki(i);return i.lanes=536870912,null}return wd(i,u)}var y=r.memoizedState;if(y!==null){var _=y.dehydrated;if(vm(i),m)if(i.flags&256)i.flags&=-257,i=yx(r,i,o);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(n(558));else if(mn||pl(r,i,o,!1),m=(o&r.childLanes)!==0,mn||m){if(u=kt,u!==null&&(_=Xt(u,o),_!==0&&_!==y.retryLane))throw y.retryLane=_,io(r,_),fr(u,r,_),Um;jd(),i=yx(r,i,o)}else r=y.treeContext,Mt=ts(_.nextSibling),On=i,it=!0,$i=null,Zr=!1,r!==null&&rb(i,r),i=wd(i,u),i.flags|=4096;return i}return r=si(r.child,{mode:u.mode,children:u.children}),r.ref=i.ref,i.child=r,r.return=i,r}function Ed(r,i){var o=i.ref;if(o===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(n(284));(r===null||r.ref!==o)&&(i.flags|=4194816)}}function zm(r,i,o,u,m){return co(i),o=xm(r,i,o,u,void 0,m),u=_m(),r!==null&&!mn?(wm(r,i,m),ui(r,i,m)):(it&&u&&tm(i),i.flags|=1,Mn(r,i,o,m),i.child)}function vx(r,i,o,u,m,y){return co(i),i.updateQueue=null,o=_b(i,u,o,m),xb(r),u=_m(),r!==null&&!mn?(wm(r,i,y),ui(r,i,y)):(it&&u&&tm(i),i.flags|=1,Mn(r,i,o,y),i.child)}function bx(r,i,o,u,m){if(co(i),i.stateNode===null){var y=ul,_=o.contextType;typeof _=="object"&&_!==null&&(y=Pn(_)),y=new o(u,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Vm,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=u,y.state=i.memoizedState,y.refs={},dm(i),_=o.contextType,y.context=typeof _=="object"&&_!==null?Pn(_):ul,y.state=i.memoizedState,_=o.getDerivedStateFromProps,typeof _=="function"&&(Mm(i,o,_,u),y.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(_=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),_!==y.state&&Vm.enqueueReplaceState(y,y.state,null),Jc(i,u,y,m),Xc(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(r===null){y=i.stateNode;var S=i.memoizedProps,D=go(o,S);y.props=D;var H=y.context,W=o.contextType;_=ul,typeof W=="object"&&W!==null&&(_=Pn(W));var re=o.getDerivedStateFromProps;W=typeof re=="function"||typeof y.getSnapshotBeforeUpdate=="function",S=i.pendingProps!==S,W||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S||H!==_)&&ix(i,y,u,_),Yi=!1;var $=i.memoizedState;y.state=$,Jc(i,u,y,m),Xc(),H=i.memoizedState,S||$!==H||Yi?(typeof re=="function"&&(Mm(i,o,re,u),H=i.memoizedState),(D=Yi||sx(i,o,D,u,$,H,_))?(W||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=H),y.props=u,y.state=H,y.context=_,u=D):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{y=i.stateNode,fm(r,i),_=i.memoizedProps,W=go(o,_),y.props=W,re=i.pendingProps,$=y.context,H=o.contextType,D=ul,typeof H=="object"&&H!==null&&(D=Pn(H)),S=o.getDerivedStateFromProps,(H=typeof S=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(_!==re||$!==D)&&ix(i,y,u,D),Yi=!1,$=i.memoizedState,y.state=$,Jc(i,u,y,m),Xc();var Y=i.memoizedState;_!==re||$!==Y||Yi||r!==null&&r.dependencies!==null&&sd(r.dependencies)?(typeof S=="function"&&(Mm(i,o,S,u),Y=i.memoizedState),(W=Yi||sx(i,o,W,u,$,Y,D)||r!==null&&r.dependencies!==null&&sd(r.dependencies))?(H||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,Y,D),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,Y,D)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||_===r.memoizedProps&&$===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||_===r.memoizedProps&&$===r.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=Y),y.props=u,y.state=Y,y.context=D,u=W):(typeof y.componentDidUpdate!="function"||_===r.memoizedProps&&$===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||_===r.memoizedProps&&$===r.memoizedState||(i.flags|=1024),u=!1)}return y=u,Ed(r,i),u=(i.flags&128)!==0,y||u?(y=i.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,r!==null&&u?(i.child=po(i,r.child,null,m),i.child=po(i,null,o,m)):Mn(r,i,o,m),i.memoizedState=y.state,r=i.child):r=ui(r,i,m),r}function xx(r,i,o,u){return oo(),i.flags|=256,Mn(r,i,o,u),i.child}var Bm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Fm(r){return{baseLanes:r,cachePool:cb()}}function Gm(r,i,o){return r=r!==null?r.childLanes&~o:0,i&&(r|=Rr),r}function _x(r,i,o){var u=i.pendingProps,m=!1,y=(i.flags&128)!==0,_;if((_=y)||(_=r!==null&&r.memoizedState===null?!1:(ln.current&2)!==0),_&&(m=!0,i.flags&=-129),_=(i.flags&32)!==0,i.flags&=-33,r===null){if(it){if(m?Wi(i):Zi(),(r=Mt)?(r=C_(r,Zr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:Hi!==null?{id:js,overflow:Os}:null,retryLane:536870912,hydrationErrors:null},o=eb(r),o.return=i,i.child=o,On=i,Mt=null)):r=null,r===null)throw Ki(i);return Sg(r)?i.lanes=32:i.lanes=536870912,null}var S=u.children;return u=u.fallback,m?(Zi(),m=i.mode,S=Td({mode:"hidden",children:S},m),u=ao(u,m,o,null),S.return=i,u.return=i,S.sibling=u,i.child=S,u=i.child,u.memoizedState=Fm(o),u.childLanes=Gm(r,_,o),i.memoizedState=Bm,nu(null,u)):(Wi(i),qm(i,S))}var D=r.memoizedState;if(D!==null&&(S=D.dehydrated,S!==null)){if(y)i.flags&256?(Wi(i),i.flags&=-257,i=Hm(r,i,o)):i.memoizedState!==null?(Zi(),i.child=r.child,i.flags|=128,i=null):(Zi(),S=u.fallback,m=i.mode,u=Td({mode:"visible",children:u.children},m),S=ao(S,m,o,null),S.flags|=2,u.return=i,S.return=i,u.sibling=S,i.child=u,po(i,r.child,null,o),u=i.child,u.memoizedState=Fm(o),u.childLanes=Gm(r,_,o),i.memoizedState=Bm,i=nu(null,u));else if(Wi(i),Sg(S)){if(_=S.nextSibling&&S.nextSibling.dataset,_)var H=_.dgst;_=H,u=Error(n(419)),u.stack="",u.digest=_,qc({value:u,source:null,stack:null}),i=Hm(r,i,o)}else if(mn||pl(r,i,o,!1),_=(o&r.childLanes)!==0,mn||_){if(_=kt,_!==null&&(u=Xt(_,o),u!==0&&u!==D.retryLane))throw D.retryLane=u,io(r,u),fr(_,r,u),Um;Tg(S)||jd(),i=Hm(r,i,o)}else Tg(S)?(i.flags|=192,i.child=r.child,i=null):(r=D.treeContext,Mt=ts(S.nextSibling),On=i,it=!0,$i=null,Zr=!1,r!==null&&rb(i,r),i=qm(i,u.children),i.flags|=4096);return i}return m?(Zi(),S=u.fallback,m=i.mode,D=r.child,H=D.sibling,u=si(D,{mode:"hidden",children:u.children}),u.subtreeFlags=D.subtreeFlags&65011712,H!==null?S=si(H,S):(S=ao(S,m,o,null),S.flags|=2),S.return=i,u.return=i,u.sibling=S,i.child=u,nu(null,u),u=i.child,S=r.child.memoizedState,S===null?S=Fm(o):(m=S.cachePool,m!==null?(D=fn._currentValue,m=m.parent!==D?{parent:D,pool:D}:m):m=cb(),S={baseLanes:S.baseLanes|o,cachePool:m}),u.memoizedState=S,u.childLanes=Gm(r,_,o),i.memoizedState=Bm,nu(r.child,u)):(Wi(i),o=r.child,r=o.sibling,o=si(o,{mode:"visible",children:u.children}),o.return=i,o.sibling=null,r!==null&&(_=i.deletions,_===null?(i.deletions=[r],i.flags|=16):_.push(r)),i.child=o,i.memoizedState=null,o)}function qm(r,i){return i=Td({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function Td(r,i){return r=Nr(22,r,null,i),r.lanes=0,r}function Hm(r,i,o){return po(i,r.child,null,o),r=qm(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function wx(r,i,o){r.lanes|=i;var u=r.alternate;u!==null&&(u.lanes|=i),am(r.return,i,o)}function $m(r,i,o,u,m,y){var _=r.memoizedState;_===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:m,treeForkCount:y}:(_.isBackwards=i,_.rendering=null,_.renderingStartTime=0,_.last=u,_.tail=o,_.tailMode=m,_.treeForkCount=y)}function Ex(r,i,o){var u=i.pendingProps,m=u.revealOrder,y=u.tail;u=u.children;var _=ln.current,S=(_&2)!==0;if(S?(_=_&1|2,i.flags|=128):_&=1,fe(ln,_),Mn(r,i,u,o),u=it?Gc:0,!S&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&wx(r,o,i);else if(r.tag===19)wx(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(m){case"forwards":for(o=i.child,m=null;o!==null;)r=o.alternate,r!==null&&dd(r)===null&&(m=o),o=o.sibling;o=m,o===null?(m=i.child,i.child=null):(m=o.sibling,o.sibling=null),$m(i,!1,m,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=i.child,i.child=null;m!==null;){if(r=m.alternate,r!==null&&dd(r)===null){i.child=m;break}r=m.sibling,m.sibling=o,o=m,m=r}$m(i,!0,o,null,y,u);break;case"together":$m(i,!1,null,null,void 0,u);break;default:i.memoizedState=null}return i.child}function ui(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),na|=i.lanes,(o&i.childLanes)===0)if(r!==null){if(pl(r,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(n(153));if(i.child!==null){for(r=i.child,o=si(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=si(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function Km(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&sd(r)))}function zA(r,i,o){switch(i.tag){case 3:Ut(i,i.stateNode.containerInfo),Qi(i,fn,r.memoizedState.cache),oo();break;case 27:case 5:is(i);break;case 4:Ut(i,i.stateNode.containerInfo);break;case 10:Qi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,vm(i),null;break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Wi(i),i.flags|=128,null):(o&i.child.childLanes)!==0?_x(r,i,o):(Wi(i),r=ui(r,i,o),r!==null?r.sibling:null);Wi(i);break;case 19:var m=(r.flags&128)!==0;if(u=(o&i.childLanes)!==0,u||(pl(r,i,o,!1),u=(o&i.childLanes)!==0),m){if(u)return Ex(r,i,o);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),fe(ln,ln.current),u)break;return null;case 22:return i.lanes=0,mx(r,i,o,i.pendingProps);case 24:Qi(i,fn,r.memoizedState.cache)}return ui(r,i,o)}function Tx(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps)mn=!0;else{if(!Km(r,o)&&(i.flags&128)===0)return mn=!1,zA(r,i,o);mn=(r.flags&131072)!==0}else mn=!1,it&&(i.flags&1048576)!==0&&nb(i,Gc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var u=i.pendingProps;if(r=ho(i.elementType),i.type=r,typeof r=="function")Wp(r)?(u=go(r,u),i.tag=1,i=bx(null,i,r,u,o)):(i.tag=0,i=zm(null,i,r,u,o));else{if(r!=null){var m=r.$$typeof;if(m===me){i.tag=11,i=dx(null,i,r,u,o);break e}else if(m===I){i.tag=14,i=fx(null,i,r,u,o);break e}}throw i=at(r)||r,Error(n(306,i,""))}}return i;case 0:return zm(r,i,i.type,i.pendingProps,o);case 1:return u=i.type,m=go(u,i.pendingProps),bx(r,i,u,m,o);case 3:e:{if(Ut(i,i.stateNode.containerInfo),r===null)throw Error(n(387));u=i.pendingProps;var y=i.memoizedState;m=y.element,fm(r,i),Jc(i,u,null,o);var _=i.memoizedState;if(u=_.cache,Qi(i,fn,u),u!==y.cache&&om(i,[fn],o,!0),Xc(),u=_.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:_.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=xx(r,i,u,o);break e}else if(u!==m){m=Xr(Error(n(424)),i),qc(m),i=xx(r,i,u,o);break e}else{switch(r=i.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Mt=ts(r.firstChild),On=i,it=!0,$i=null,Zr=!0,o=mb(i,null,u,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(oo(),u===m){i=ui(r,i,o);break e}Mn(r,i,u,o)}i=i.child}return i;case 26:return Ed(r,i),r===null?(o=P_(i.type,null,i.pendingProps,null))?i.memoizedState=o:it||(o=i.type,r=i.pendingProps,u=zd(Ve.current).createElement(o),u[$t]=i,u[Jt]=r,Vn(u,o,r),Wt(u),i.stateNode=u):i.memoizedState=P_(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return is(i),r===null&&it&&(u=i.stateNode=D_(i.type,i.pendingProps,Ve.current),On=i,Zr=!0,m=Mt,oa(i.type)?(Ng=m,Mt=ts(u.firstChild)):Mt=m),Mn(r,i,i.pendingProps.children,o),Ed(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&it&&((m=u=Mt)&&(u=gI(u,i.type,i.pendingProps,Zr),u!==null?(i.stateNode=u,On=i,Mt=ts(u.firstChild),Zr=!1,m=!0):m=!1),m||Ki(i)),is(i),m=i.type,y=i.pendingProps,_=r!==null?r.memoizedProps:null,u=y.children,_g(m,y)?u=null:_!==null&&_g(m,_)&&(i.flags|=32),i.memoizedState!==null&&(m=xm(r,i,kA,null,null,o),yu._currentValue=m),Ed(r,i),Mn(r,i,u,o),i.child;case 6:return r===null&&it&&((r=o=Mt)&&(o=yI(o,i.pendingProps,Zr),o!==null?(i.stateNode=o,On=i,Mt=null,r=!0):r=!1),r||Ki(i)),null;case 13:return _x(r,i,o);case 4:return Ut(i,i.stateNode.containerInfo),u=i.pendingProps,r===null?i.child=po(i,null,u,o):Mn(r,i,u,o),i.child;case 11:return dx(r,i,i.type,i.pendingProps,o);case 7:return Mn(r,i,i.pendingProps,o),i.child;case 8:return Mn(r,i,i.pendingProps.children,o),i.child;case 12:return Mn(r,i,i.pendingProps.children,o),i.child;case 10:return u=i.pendingProps,Qi(i,i.type,u.value),Mn(r,i,u.children,o),i.child;case 9:return m=i.type._context,u=i.pendingProps.children,co(i),m=Pn(m),u=u(m),i.flags|=1,Mn(r,i,u,o),i.child;case 14:return fx(r,i,i.type,i.pendingProps,o);case 15:return px(r,i,i.type,i.pendingProps,o);case 19:return Ex(r,i,o);case 31:return UA(r,i,o);case 22:return mx(r,i,o,i.pendingProps);case 24:return co(i),u=Pn(fn),r===null?(m=um(),m===null&&(m=kt,y=lm(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=o),m=y),i.memoizedState={parent:u,cache:m},dm(i),Qi(i,fn,m)):((r.lanes&o)!==0&&(fm(r,i),Jc(i,null,null,o),Xc()),m=r.memoizedState,y=i.memoizedState,m.parent!==u?(m={parent:u,cache:u},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Qi(i,fn,u)):(u=y.cache,Qi(i,fn,u),u!==m.cache&&om(i,[fn],o,!0))),Mn(r,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function hi(r){r.flags|=4}function Qm(r,i,o,u,m){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(m&335544128)===m)if(r.stateNode.complete)r.flags|=8192;else if(Jx())r.flags|=8192;else throw fo=ld,hm}else r.flags&=-16777217}function Sx(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!z_(i))if(Jx())r.flags|=8192;else throw fo=ld,hm}function Sd(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?Ha():536870912,r.lanes|=i,Nl|=i)}function ru(r,i){if(!it)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function Vt(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(i)for(var m=r.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=u,r.childLanes=o,i}function BA(r,i,o){var u=i.pendingProps;switch(nm(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(i),null;case 1:return Vt(i),null;case 3:return o=i.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),oi(fn),We(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(fl(i)?hi(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,sm())),Vt(i),null;case 26:var m=i.type,y=i.memoizedState;return r===null?(hi(i),y!==null?(Vt(i),Sx(i,y)):(Vt(i),Qm(i,m,null,u,o))):y?y!==r.memoizedState?(hi(i),Vt(i),Sx(i,y)):(Vt(i),i.flags&=-16777217):(r=r.memoizedProps,r!==u&&hi(i),Vt(i),Qm(i,m,r,u,o)),null;case 27:if(Qs(i),o=Ve.current,m=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&hi(i);else{if(!u){if(i.stateNode===null)throw Error(n(166));return Vt(i),null}r=ve.current,fl(i)?sb(i):(r=D_(m,u,o),i.stateNode=r,hi(i))}return Vt(i),null;case 5:if(Qs(i),m=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&hi(i);else{if(!u){if(i.stateNode===null)throw Error(n(166));return Vt(i),null}if(y=ve.current,fl(i))sb(i);else{var _=zd(Ve.current);switch(y){case 1:y=_.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=_.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=_.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=_.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=_.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?_.createElement("select",{is:u.is}):_.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?_.createElement(m,{is:u.is}):_.createElement(m)}}y[$t]=i,y[Jt]=u;e:for(_=i.child;_!==null;){if(_.tag===5||_.tag===6)y.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===i)break e;for(;_.sibling===null;){if(_.return===null||_.return===i)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}i.stateNode=y;e:switch(Vn(y,m,u),m){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&hi(i)}}return Vt(i),Qm(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,o),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==u&&hi(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(n(166));if(r=Ve.current,fl(i)){if(r=i.stateNode,o=i.memoizedProps,u=null,m=On,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}r[$t]=i,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||__(r.nodeValue,o)),r||Ki(i,!0)}else r=zd(r).createTextNode(u),r[$t]=i,i.stateNode=r}return Vt(i),null;case 31:if(o=i.memoizedState,r===null||r.memoizedState!==null){if(u=fl(i),o!==null){if(r===null){if(!u)throw Error(n(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[$t]=i}else oo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Vt(i),r=!1}else o=sm(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return i.flags&256?(Ir(i),i):(Ir(i),null);if((i.flags&128)!==0)throw Error(n(558))}return Vt(i),null;case 13:if(u=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=fl(i),u!==null&&u.dehydrated!==null){if(r===null){if(!m)throw Error(n(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[$t]=i}else oo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Vt(i),m=!1}else m=sm(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(Ir(i),i):(Ir(i),null)}return Ir(i),(i.flags&128)!==0?(i.lanes=o,i):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=i.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==m&&(u.flags|=2048)),o!==r&&o&&(i.child.flags|=8192),Sd(i,i.updateQueue),Vt(i),null);case 4:return We(),r===null&&gg(i.stateNode.containerInfo),Vt(i),null;case 10:return oi(i.type),Vt(i),null;case 19:if(ne(ln),u=i.memoizedState,u===null)return Vt(i),null;if(m=(i.flags&128)!==0,y=u.rendering,y===null)if(m)ru(u,!1);else{if(nn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(y=dd(r),y!==null){for(i.flags|=128,ru(u,!1),r=y.updateQueue,i.updateQueue=r,Sd(i,r),i.subtreeFlags=0,r=o,o=i.child;o!==null;)Zv(o,r),o=o.sibling;return fe(ln,ln.current&1|2),it&&ii(i,u.treeForkCount),i.child}r=r.sibling}u.tail!==null&&dn()>Rd&&(i.flags|=128,m=!0,ru(u,!1),i.lanes=4194304)}else{if(!m)if(r=dd(y),r!==null){if(i.flags|=128,m=!0,r=r.updateQueue,i.updateQueue=r,Sd(i,r),ru(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!it)return Vt(i),null}else 2*dn()-u.renderingStartTime>Rd&&o!==536870912&&(i.flags|=128,m=!0,ru(u,!1),i.lanes=4194304);u.isBackwards?(y.sibling=i.child,i.child=y):(r=u.last,r!==null?r.sibling=y:i.child=y,u.last=y)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=dn(),r.sibling=null,o=ln.current,fe(ln,m?o&1|2:o&1),it&&ii(i,u.treeForkCount),r):(Vt(i),null);case 22:case 23:return Ir(i),ym(),u=i.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(o&536870912)!==0&&(i.flags&128)===0&&(Vt(i),i.subtreeFlags&6&&(i.flags|=8192)):Vt(i),o=i.updateQueue,o!==null&&Sd(i,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048),r!==null&&ne(uo),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),oi(fn),Vt(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function FA(r,i){switch(nm(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return oi(fn),We(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return Qs(i),null;case 31:if(i.memoizedState!==null){if(Ir(i),i.alternate===null)throw Error(n(340));oo()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(Ir(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(n(340));oo()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return ne(ln),null;case 4:return We(),null;case 10:return oi(i.type),null;case 22:case 23:return Ir(i),ym(),r!==null&&ne(uo),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return oi(fn),null;case 25:return null;default:return null}}function Nx(r,i){switch(nm(i),i.tag){case 3:oi(fn),We();break;case 26:case 27:case 5:Qs(i);break;case 4:We();break;case 31:i.memoizedState!==null&&Ir(i);break;case 13:Ir(i);break;case 19:ne(ln);break;case 10:oi(i.type);break;case 22:case 23:Ir(i),ym(),r!==null&&ne(uo);break;case 24:oi(fn)}}function su(r,i){try{var o=i.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var m=u.next;o=m;do{if((o.tag&r)===r){u=void 0;var y=o.create,_=o.inst;u=y(),_.destroy=u}o=o.next}while(o!==m)}}catch(S){gt(i,i.return,S)}}function ea(r,i,o){try{var u=i.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var y=m.next;u=y;do{if((u.tag&r)===r){var _=u.inst,S=_.destroy;if(S!==void 0){_.destroy=void 0,m=i;var D=o,H=S;try{H()}catch(W){gt(m,D,W)}}}u=u.next}while(u!==y)}}catch(W){gt(i,i.return,W)}}function Ax(r){var i=r.updateQueue;if(i!==null){var o=r.stateNode;try{yb(i,o)}catch(u){gt(r,r.return,u)}}}function Ix(r,i,o){o.props=go(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){gt(r,i,u)}}function iu(r,i){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(m){gt(r,i,m)}}function Ps(r,i){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(m){gt(r,i,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){gt(r,i,m)}else o.current=null}function Cx(r){var i=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(m){gt(r,r.return,m)}}function Ym(r,i,o){try{var u=r.stateNode;uI(u,r.type,o,i),u[Jt]=i}catch(m){gt(r,r.return,m)}}function Rx(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&oa(r.type)||r.tag===4}function Xm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Rx(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&oa(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Jm(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(r),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=ds));else if(u!==4&&(u===27&&oa(r.type)&&(o=r.stateNode,i=null),r=r.child,r!==null))for(Jm(r,i,o),r=r.sibling;r!==null;)Jm(r,i,o),r=r.sibling}function Nd(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(u!==4&&(u===27&&oa(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(Nd(r,i,o),r=r.sibling;r!==null;)Nd(r,i,o),r=r.sibling}function kx(r){var i=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);Vn(i,u,o),i[$t]=r,i[Jt]=o}catch(y){gt(r,r.return,y)}}var di=!1,gn=!1,Wm=!1,Dx=typeof WeakSet=="function"?WeakSet:Set,Nn=null;function GA(r,i){if(r=r.containerInfo,bg=Kd,r=qv(r),Hp(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var m=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var _=0,S=-1,D=-1,H=0,W=0,re=r,$=null;t:for(;;){for(var Y;re!==o||m!==0&&re.nodeType!==3||(S=_+m),re!==y||u!==0&&re.nodeType!==3||(D=_+u),re.nodeType===3&&(_+=re.nodeValue.length),(Y=re.firstChild)!==null;)$=re,re=Y;for(;;){if(re===r)break t;if($===o&&++H===m&&(S=_),$===y&&++W===u&&(D=_),(Y=re.nextSibling)!==null)break;re=$,$=re.parentNode}re=Y}o=S===-1||D===-1?null:{start:S,end:D}}else o=null}o=o||{start:0,end:0}}else o=null;for(xg={focusedElem:r,selectionRange:o},Kd=!1,Nn=i;Nn!==null;)if(i=Nn,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,Nn=r;else for(;Nn!==null;){switch(i=Nn,y=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)m=r[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=i,m=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var we=go(o.type,m);r=u.getSnapshotBeforeUpdate(we,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(De){gt(o,o.return,De)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,o=r.nodeType,o===9)Eg(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Eg(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=i.sibling,r!==null){r.return=i.return,Nn=r;break}Nn=i.return}}function jx(r,i,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:pi(r,o),u&4&&su(5,o);break;case 1:if(pi(r,o),u&4)if(r=o.stateNode,i===null)try{r.componentDidMount()}catch(_){gt(o,o.return,_)}else{var m=go(o.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(m,i,r.__reactInternalSnapshotBeforeUpdate)}catch(_){gt(o,o.return,_)}}u&64&&Ax(o),u&512&&iu(o,o.return);break;case 3:if(pi(r,o),u&64&&(r=o.updateQueue,r!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{yb(r,i)}catch(_){gt(o,o.return,_)}}break;case 27:i===null&&u&4&&kx(o);case 26:case 5:pi(r,o),i===null&&u&4&&Cx(o),u&512&&iu(o,o.return);break;case 12:pi(r,o);break;case 31:pi(r,o),u&4&&Mx(r,o);break;case 13:pi(r,o),u&4&&Vx(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=WA.bind(null,o),vI(r,o))));break;case 22:if(u=o.memoizedState!==null||di,!u){i=i!==null&&i.memoizedState!==null||gn,m=di;var y=gn;di=u,(gn=i)&&!y?mi(r,o,(o.subtreeFlags&8772)!==0):pi(r,o),di=m,gn=y}break;case 30:break;default:pi(r,o)}}function Ox(r){var i=r.alternate;i!==null&&(r.alternate=null,Ox(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&ei(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Gt=null,cr=!1;function fi(r,i,o){for(o=o.child;o!==null;)Px(r,i,o),o=o.sibling}function Px(r,i,o){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount(he,o)}catch{}switch(o.tag){case 26:gn||Ps(o,i),fi(r,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:gn||Ps(o,i);var u=Gt,m=cr;oa(o.type)&&(Gt=o.stateNode,cr=!1),fi(r,i,o),pu(o.stateNode),Gt=u,cr=m;break;case 5:gn||Ps(o,i);case 6:if(u=Gt,m=cr,Gt=null,fi(r,i,o),Gt=u,cr=m,Gt!==null)if(cr)try{(Gt.nodeType===9?Gt.body:Gt.nodeName==="HTML"?Gt.ownerDocument.body:Gt).removeChild(o.stateNode)}catch(y){gt(o,i,y)}else try{Gt.removeChild(o.stateNode)}catch(y){gt(o,i,y)}break;case 18:Gt!==null&&(cr?(r=Gt,A_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Ol(r)):A_(Gt,o.stateNode));break;case 4:u=Gt,m=cr,Gt=o.stateNode.containerInfo,cr=!0,fi(r,i,o),Gt=u,cr=m;break;case 0:case 11:case 14:case 15:ea(2,o,i),gn||ea(4,o,i),fi(r,i,o);break;case 1:gn||(Ps(o,i),u=o.stateNode,typeof u.componentWillUnmount=="function"&&Ix(o,i,u)),fi(r,i,o);break;case 21:fi(r,i,o);break;case 22:gn=(u=gn)||o.memoizedState!==null,fi(r,i,o),gn=u;break;default:fi(r,i,o)}}function Mx(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Ol(r)}catch(o){gt(i,i.return,o)}}}function Vx(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ol(r)}catch(o){gt(i,i.return,o)}}function qA(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new Dx),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new Dx),i;default:throw Error(n(435,r.tag))}}function Ad(r,i){var o=qA(r);i.forEach(function(u){if(!o.has(u)){o.add(u);var m=ZA.bind(null,r,u);u.then(m,m)}})}function ur(r,i){var o=i.deletions;if(o!==null)for(var u=0;u<o.length;u++){var m=o[u],y=r,_=i,S=_;e:for(;S!==null;){switch(S.tag){case 27:if(oa(S.type)){Gt=S.stateNode,cr=!1;break e}break;case 5:Gt=S.stateNode,cr=!1;break e;case 3:case 4:Gt=S.stateNode.containerInfo,cr=!0;break e}S=S.return}if(Gt===null)throw Error(n(160));Px(y,_,m),Gt=null,cr=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Lx(i,r),i=i.sibling}var vs=null;function Lx(r,i){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:ur(i,r),hr(r),u&4&&(ea(3,r,r.return),su(3,r),ea(5,r,r.return));break;case 1:ur(i,r),hr(r),u&512&&(gn||o===null||Ps(o,o.return)),u&64&&di&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var m=vs;if(ur(i,r),hr(r),u&512&&(gn||o===null||Ps(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":y=m.getElementsByTagName("title")[0],(!y||y[Br]||y[$t]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(u),m.head.insertBefore(y,m.querySelector("head > title"))),Vn(y,u,o),y[$t]=r,Wt(y),u=y;break e;case"link":var _=L_("link","href",m).get(u+(o.href||""));if(_){for(var S=0;S<_.length;S++)if(y=_[S],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){_.splice(S,1);break t}}y=m.createElement(u),Vn(y,u,o),m.head.appendChild(y);break;case"meta":if(_=L_("meta","content",m).get(u+(o.content||""))){for(S=0;S<_.length;S++)if(y=_[S],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){_.splice(S,1);break t}}y=m.createElement(u),Vn(y,u,o),m.head.appendChild(y);break;default:throw Error(n(468,u))}y[$t]=r,Wt(y),u=y}r.stateNode=u}else U_(m,r.type,r.stateNode);else r.stateNode=V_(m,u,r.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?U_(m,r.type,r.stateNode):V_(m,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Ym(r,r.memoizedProps,o.memoizedProps)}break;case 27:ur(i,r),hr(r),u&512&&(gn||o===null||Ps(o,o.return)),o!==null&&u&4&&Ym(r,r.memoizedProps,o.memoizedProps);break;case 5:if(ur(i,r),hr(r),u&512&&(gn||o===null||Ps(o,o.return)),r.flags&32){m=r.stateNode;try{U(m,"")}catch(we){gt(r,r.return,we)}}u&4&&r.stateNode!=null&&(m=r.memoizedProps,Ym(r,m,o!==null?o.memoizedProps:m)),u&1024&&(Wm=!0);break;case 6:if(ur(i,r),hr(r),u&4){if(r.stateNode===null)throw Error(n(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(we){gt(r,r.return,we)}}break;case 3:if(Gd=null,m=vs,vs=Bd(i.containerInfo),ur(i,r),vs=m,hr(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Ol(i.containerInfo)}catch(we){gt(r,r.return,we)}Wm&&(Wm=!1,Ux(r));break;case 4:u=vs,vs=Bd(r.stateNode.containerInfo),ur(i,r),hr(r),vs=u;break;case 12:ur(i,r),hr(r);break;case 31:ur(i,r),hr(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Ad(r,u)));break;case 13:ur(i,r),hr(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Cd=dn()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Ad(r,u)));break;case 22:m=r.memoizedState!==null;var D=o!==null&&o.memoizedState!==null,H=di,W=gn;if(di=H||m,gn=W||D,ur(i,r),gn=W,di=H,hr(r),u&8192)e:for(i=r.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(o===null||D||di||gn||yo(r)),o=null,i=r;;){if(i.tag===5||i.tag===26){if(o===null){D=o=i;try{if(y=D.stateNode,m)_=y.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{S=D.stateNode;var re=D.memoizedProps.style,$=re!=null&&re.hasOwnProperty("display")?re.display:null;S.style.display=$==null||typeof $=="boolean"?"":(""+$).trim()}}catch(we){gt(D,D.return,we)}}}else if(i.tag===6){if(o===null){D=i;try{D.stateNode.nodeValue=m?"":D.memoizedProps}catch(we){gt(D,D.return,we)}}}else if(i.tag===18){if(o===null){D=i;try{var Y=D.stateNode;m?I_(Y,!0):I_(D.stateNode,!1)}catch(we){gt(D,D.return,we)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Ad(r,o))));break;case 19:ur(i,r),hr(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Ad(r,u)));break;case 30:break;case 21:break;default:ur(i,r),hr(r)}}function hr(r){var i=r.flags;if(i&2){try{for(var o,u=r.return;u!==null;){if(Rx(u)){o=u;break}u=u.return}if(o==null)throw Error(n(160));switch(o.tag){case 27:var m=o.stateNode,y=Xm(r);Nd(r,y,m);break;case 5:var _=o.stateNode;o.flags&32&&(U(_,""),o.flags&=-33);var S=Xm(r);Nd(r,S,_);break;case 3:case 4:var D=o.stateNode.containerInfo,H=Xm(r);Jm(r,H,D);break;default:throw Error(n(161))}}catch(W){gt(r,r.return,W)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Ux(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;Ux(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function pi(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)jx(r,i.alternate,i),i=i.sibling}function yo(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:ea(4,i,i.return),yo(i);break;case 1:Ps(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&Ix(i,i.return,o),yo(i);break;case 27:pu(i.stateNode);case 26:case 5:Ps(i,i.return),yo(i);break;case 22:i.memoizedState===null&&yo(i);break;case 30:yo(i);break;default:yo(i)}r=r.sibling}}function mi(r,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,m=r,y=i,_=y.flags;switch(y.tag){case 0:case 11:case 15:mi(m,y,o),su(4,y);break;case 1:if(mi(m,y,o),u=y,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(H){gt(u,u.return,H)}if(u=y,m=u.updateQueue,m!==null){var S=u.stateNode;try{var D=m.shared.hiddenCallbacks;if(D!==null)for(m.shared.hiddenCallbacks=null,m=0;m<D.length;m++)gb(D[m],S)}catch(H){gt(u,u.return,H)}}o&&_&64&&Ax(y),iu(y,y.return);break;case 27:kx(y);case 26:case 5:mi(m,y,o),o&&u===null&&_&4&&Cx(y),iu(y,y.return);break;case 12:mi(m,y,o);break;case 31:mi(m,y,o),o&&_&4&&Mx(m,y);break;case 13:mi(m,y,o),o&&_&4&&Vx(m,y);break;case 22:y.memoizedState===null&&mi(m,y,o),iu(y,y.return);break;case 30:break;default:mi(m,y,o)}i=i.sibling}}function Zm(r,i){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&Hc(o))}function eg(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&Hc(r))}function bs(r,i,o,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)zx(r,i,o,u),i=i.sibling}function zx(r,i,o,u){var m=i.flags;switch(i.tag){case 0:case 11:case 15:bs(r,i,o,u),m&2048&&su(9,i);break;case 1:bs(r,i,o,u);break;case 3:bs(r,i,o,u),m&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&Hc(r)));break;case 12:if(m&2048){bs(r,i,o,u),r=i.stateNode;try{var y=i.memoizedProps,_=y.id,S=y.onPostCommit;typeof S=="function"&&S(_,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(D){gt(i,i.return,D)}}else bs(r,i,o,u);break;case 31:bs(r,i,o,u);break;case 13:bs(r,i,o,u);break;case 23:break;case 22:y=i.stateNode,_=i.alternate,i.memoizedState!==null?y._visibility&2?bs(r,i,o,u):au(r,i):y._visibility&2?bs(r,i,o,u):(y._visibility|=2,El(r,i,o,u,(i.subtreeFlags&10256)!==0||!1)),m&2048&&Zm(_,i);break;case 24:bs(r,i,o,u),m&2048&&eg(i.alternate,i);break;default:bs(r,i,o,u)}}function El(r,i,o,u,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var y=r,_=i,S=o,D=u,H=_.flags;switch(_.tag){case 0:case 11:case 15:El(y,_,S,D,m),su(8,_);break;case 23:break;case 22:var W=_.stateNode;_.memoizedState!==null?W._visibility&2?El(y,_,S,D,m):au(y,_):(W._visibility|=2,El(y,_,S,D,m)),m&&H&2048&&Zm(_.alternate,_);break;case 24:El(y,_,S,D,m),m&&H&2048&&eg(_.alternate,_);break;default:El(y,_,S,D,m)}i=i.sibling}}function au(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=r,u=i,m=u.flags;switch(u.tag){case 22:au(o,u),m&2048&&Zm(u.alternate,u);break;case 24:au(o,u),m&2048&&eg(u.alternate,u);break;default:au(o,u)}i=i.sibling}}var ou=8192;function Tl(r,i,o){if(r.subtreeFlags&ou)for(r=r.child;r!==null;)Bx(r,i,o),r=r.sibling}function Bx(r,i,o){switch(r.tag){case 26:Tl(r,i,o),r.flags&ou&&r.memoizedState!==null&&RI(o,vs,r.memoizedState,r.memoizedProps);break;case 5:Tl(r,i,o);break;case 3:case 4:var u=vs;vs=Bd(r.stateNode.containerInfo),Tl(r,i,o),vs=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=ou,ou=16777216,Tl(r,i,o),ou=u):Tl(r,i,o));break;default:Tl(r,i,o)}}function Fx(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function lu(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];Nn=u,qx(u,r)}Fx(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Gx(r),r=r.sibling}function Gx(r){switch(r.tag){case 0:case 11:case 15:lu(r),r.flags&2048&&ea(9,r,r.return);break;case 3:lu(r);break;case 12:lu(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,Id(r)):lu(r);break;default:lu(r)}}function Id(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];Nn=u,qx(u,r)}Fx(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:ea(8,i,i.return),Id(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,Id(i));break;default:Id(i)}r=r.sibling}}function qx(r,i){for(;Nn!==null;){var o=Nn;switch(o.tag){case 0:case 11:case 15:ea(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Hc(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Nn=u;else e:for(o=r;Nn!==null;){u=Nn;var m=u.sibling,y=u.return;if(Ox(u),u===o){Nn=null;break e}if(m!==null){m.return=y,Nn=m;break e}Nn=y}}}var HA={getCacheForType:function(r){var i=Pn(fn),o=i.data.get(r);return o===void 0&&(o=r(),i.data.set(r,o)),o},cacheSignal:function(){return Pn(fn).controller.signal}},$A=typeof WeakMap=="function"?WeakMap:Map,dt=0,kt=null,Ze=null,tt=0,mt=0,Cr=null,ta=!1,Sl=!1,tg=!1,gi=0,nn=0,na=0,vo=0,ng=0,Rr=0,Nl=0,cu=null,dr=null,rg=!1,Cd=0,Hx=0,Rd=1/0,kd=null,ra=null,_n=0,sa=null,Al=null,yi=0,sg=0,ig=null,$x=null,uu=0,ag=null;function kr(){return(dt&2)!==0&&tt!==0?tt&-tt:X.T!==null?dg():Wo()}function Kx(){if(Rr===0)if((tt&536870912)===0||it){var r=Sn;Sn<<=1,(Sn&3932160)===0&&(Sn=262144),Rr=r}else Rr=536870912;return r=Ar.current,r!==null&&(r.flags|=32),Rr}function fr(r,i,o){(r===kt&&(mt===2||mt===9)||r.cancelPendingCommit!==null)&&(Il(r,0),ia(r,tt,Rr,!1)),Ts(r,o),((dt&2)===0||r!==kt)&&(r===kt&&((dt&2)===0&&(vo|=o),nn===4&&ia(r,tt,Rr,!1)),Ms(r))}function Qx(r,i,o){if((dt&6)!==0)throw Error(n(327));var u=!o&&(i&127)===0&&(i&r.expiredLanes)===0||br(r,i),m=u?YA(r,i):lg(r,i,!0),y=u;do{if(m===0){Sl&&!u&&ia(r,i,0,!1);break}else{if(o=r.current.alternate,y&&!KA(o)){m=lg(r,i,!1),y=!1;continue}if(m===2){if(y=i,r.errorRecoveryDisabledLanes&y)var _=0;else _=r.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){i=_;e:{var S=r;m=cu;var D=S.current.memoizedState.isDehydrated;if(D&&(Il(S,_).flags|=256),_=lg(S,_,!1),_!==2){if(tg&&!D){S.errorRecoveryDisabledLanes|=y,vo|=y,m=4;break e}y=dr,dr=m,y!==null&&(dr===null?dr=y:dr.push.apply(dr,y))}m=_}if(y=!1,m!==2)continue}}if(m===1){Il(r,0),ia(r,i,0,!0);break}e:{switch(u=r,y=m,y){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:ia(u,i,Rr,!ta);break e;case 2:dr=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(m=Cd+300-dn(),10<m)){if(ia(u,i,Rr,!ta),xn(u,0,!0)!==0)break e;yi=i,u.timeoutHandle=S_(Yx.bind(null,u,o,dr,kd,rg,i,Rr,vo,Nl,ta,y,"Throttled",-0,0),m);break e}Yx(u,o,dr,kd,rg,i,Rr,vo,Nl,ta,y,null,-0,0)}}break}while(!0);Ms(r)}function Yx(r,i,o,u,m,y,_,S,D,H,W,re,$,Y){if(r.timeoutHandle=-1,re=i.subtreeFlags,re&8192||(re&16785408)===16785408){re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ds},Bx(i,y,re);var we=(y&62914560)===y?Cd-dn():(y&4194048)===y?Hx-dn():0;if(we=kI(re,we),we!==null){yi=y,r.cancelPendingCommit=we(r_.bind(null,r,i,y,o,u,m,_,S,D,W,re,null,$,Y)),ia(r,y,_,!H);return}}r_(r,i,y,o,u,m,_,S,D)}function KA(r){for(var i=r;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var m=o[u],y=m.getSnapshot;m=m.value;try{if(!Sr(y(),m))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ia(r,i,o,u){i&=~ng,i&=~vo,r.suspendedLanes|=i,r.pingedLanes&=~i,u&&(r.warmLanes|=i),u=r.expirationTimes;for(var m=i;0<m;){var y=31-Ke(m),_=1<<y;u[y]=-1,m&=~_}o!==0&&cs(r,o,i)}function Dd(){return(dt&6)===0?(hu(0),!1):!0}function og(){if(Ze!==null){if(mt===0)var r=Ze.return;else r=Ze,ai=lo=null,Em(r),vl=null,Kc=0,r=Ze;for(;r!==null;)Nx(r.alternate,r),r=r.return;Ze=null}}function Il(r,i){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,fI(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),yi=0,og(),kt=r,Ze=o=si(r.current,null),tt=i,mt=0,Cr=null,ta=!1,Sl=br(r,i),tg=!1,Nl=Rr=ng=vo=na=nn=0,dr=cu=null,rg=!1,(i&8)!==0&&(i|=i&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=i;0<u;){var m=31-Ke(u),y=1<<m;i|=r[m],u&=~y}return gi=i,Zh(),o}function Xx(r,i){qe=null,X.H=tu,i===yl||i===od?(i=db(),mt=3):i===hm?(i=db(),mt=4):mt=i===Um?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Cr=i,Ze===null&&(nn=1,_d(r,Xr(i,r.current)))}function Jx(){var r=Ar.current;return r===null?!0:(tt&4194048)===tt?es===null:(tt&62914560)===tt||(tt&536870912)!==0?r===es:!1}function Wx(){var r=X.H;return X.H=tu,r===null?tu:r}function Zx(){var r=X.A;return X.A=HA,r}function jd(){nn=4,ta||(tt&4194048)!==tt&&Ar.current!==null||(Sl=!0),(na&134217727)===0&&(vo&134217727)===0||kt===null||ia(kt,tt,Rr,!1)}function lg(r,i,o){var u=dt;dt|=2;var m=Wx(),y=Zx();(kt!==r||tt!==i)&&(kd=null,Il(r,i)),i=!1;var _=nn;e:do try{if(mt!==0&&Ze!==null){var S=Ze,D=Cr;switch(mt){case 8:og(),_=6;break e;case 3:case 2:case 9:case 6:Ar.current===null&&(i=!0);var H=mt;if(mt=0,Cr=null,Cl(r,S,D,H),o&&Sl){_=0;break e}break;default:H=mt,mt=0,Cr=null,Cl(r,S,D,H)}}QA(),_=nn;break}catch(W){Xx(r,W)}while(!0);return i&&r.shellSuspendCounter++,ai=lo=null,dt=u,X.H=m,X.A=y,Ze===null&&(kt=null,tt=0,Zh()),_}function QA(){for(;Ze!==null;)e_(Ze)}function YA(r,i){var o=dt;dt|=2;var u=Wx(),m=Zx();kt!==r||tt!==i?(kd=null,Rd=dn()+500,Il(r,i)):Sl=br(r,i);e:do try{if(mt!==0&&Ze!==null){i=Ze;var y=Cr;t:switch(mt){case 1:mt=0,Cr=null,Cl(r,i,y,1);break;case 2:case 9:if(ub(y)){mt=0,Cr=null,t_(i);break}i=function(){mt!==2&&mt!==9||kt!==r||(mt=7),Ms(r)},y.then(i,i);break e;case 3:mt=7;break e;case 4:mt=5;break e;case 7:ub(y)?(mt=0,Cr=null,t_(i)):(mt=0,Cr=null,Cl(r,i,y,7));break;case 5:var _=null;switch(Ze.tag){case 26:_=Ze.memoizedState;case 5:case 27:var S=Ze;if(_?z_(_):S.stateNode.complete){mt=0,Cr=null;var D=S.sibling;if(D!==null)Ze=D;else{var H=S.return;H!==null?(Ze=H,Od(H)):Ze=null}break t}}mt=0,Cr=null,Cl(r,i,y,5);break;case 6:mt=0,Cr=null,Cl(r,i,y,6);break;case 8:og(),nn=6;break e;default:throw Error(n(462))}}XA();break}catch(W){Xx(r,W)}while(!0);return ai=lo=null,X.H=u,X.A=m,dt=o,Ze!==null?0:(kt=null,tt=0,Zh(),nn)}function XA(){for(;Ze!==null&&!Xs();)e_(Ze)}function e_(r){var i=Tx(r.alternate,r,gi);r.memoizedProps=r.pendingProps,i===null?Od(r):Ze=i}function t_(r){var i=r,o=i.alternate;switch(i.tag){case 15:case 0:i=vx(o,i,i.pendingProps,i.type,void 0,tt);break;case 11:i=vx(o,i,i.pendingProps,i.type.render,i.ref,tt);break;case 5:Em(i);default:Nx(o,i),i=Ze=Zv(i,gi),i=Tx(o,i,gi)}r.memoizedProps=r.pendingProps,i===null?Od(r):Ze=i}function Cl(r,i,o,u){ai=lo=null,Em(i),vl=null,Kc=0;var m=i.return;try{if(LA(r,m,i,o,tt)){nn=1,_d(r,Xr(o,r.current)),Ze=null;return}}catch(y){if(m!==null)throw Ze=m,y;nn=1,_d(r,Xr(o,r.current)),Ze=null;return}i.flags&32768?(it||u===1?r=!0:Sl||(tt&536870912)!==0?r=!1:(ta=r=!0,(u===2||u===9||u===3||u===6)&&(u=Ar.current,u!==null&&u.tag===13&&(u.flags|=16384))),n_(i,r)):Od(i)}function Od(r){var i=r;do{if((i.flags&32768)!==0){n_(i,ta);return}r=i.return;var o=BA(i.alternate,i,gi);if(o!==null){Ze=o;return}if(i=i.sibling,i!==null){Ze=i;return}Ze=i=r}while(i!==null);nn===0&&(nn=5)}function n_(r,i){do{var o=FA(r.alternate,r);if(o!==null){o.flags&=32767,Ze=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(r=r.sibling,r!==null)){Ze=r;return}Ze=r=o}while(r!==null);nn=6,Ze=null}function r_(r,i,o,u,m,y,_,S,D){r.cancelPendingCommit=null;do Pd();while(_n!==0);if((dt&6)!==0)throw Error(n(327));if(i!==null){if(i===r.current)throw Error(n(177));if(y=i.lanes|i.childLanes,y|=Xp,kc(r,o,y,_,S,D),r===kt&&(Ze=kt=null,tt=0),Al=i,sa=r,yi=o,sg=y,ig=m,$x=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,eI(ir,function(){return l_(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=X.T,X.T=null,m=ue.p,ue.p=2,_=dt,dt|=4;try{GA(r,i,o)}finally{dt=_,ue.p=m,X.T=u}}_n=1,s_(),i_(),a_()}}function s_(){if(_n===1){_n=0;var r=sa,i=Al,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=X.T,X.T=null;var u=ue.p;ue.p=2;var m=dt;dt|=4;try{Lx(i,r);var y=xg,_=qv(r.containerInfo),S=y.focusedElem,D=y.selectionRange;if(_!==S&&S&&S.ownerDocument&&Gv(S.ownerDocument.documentElement,S)){if(D!==null&&Hp(S)){var H=D.start,W=D.end;if(W===void 0&&(W=H),"selectionStart"in S)S.selectionStart=H,S.selectionEnd=Math.min(W,S.value.length);else{var re=S.ownerDocument||document,$=re&&re.defaultView||window;if($.getSelection){var Y=$.getSelection(),we=S.textContent.length,De=Math.min(D.start,we),Nt=D.end===void 0?De:Math.min(D.end,we);!Y.extend&&De>Nt&&(_=Nt,Nt=De,De=_);var z=Fv(S,De),V=Fv(S,Nt);if(z&&V&&(Y.rangeCount!==1||Y.anchorNode!==z.node||Y.anchorOffset!==z.offset||Y.focusNode!==V.node||Y.focusOffset!==V.offset)){var q=re.createRange();q.setStart(z.node,z.offset),Y.removeAllRanges(),De>Nt?(Y.addRange(q),Y.extend(V.node,V.offset)):(q.setEnd(V.node,V.offset),Y.addRange(q))}}}}for(re=[],Y=S;Y=Y.parentNode;)Y.nodeType===1&&re.push({element:Y,left:Y.scrollLeft,top:Y.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<re.length;S++){var te=re[S];te.element.scrollLeft=te.left,te.element.scrollTop=te.top}}Kd=!!bg,xg=bg=null}finally{dt=m,ue.p=u,X.T=o}}r.current=i,_n=2}}function i_(){if(_n===2){_n=0;var r=sa,i=Al,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=X.T,X.T=null;var u=ue.p;ue.p=2;var m=dt;dt|=4;try{jx(r,i.alternate,i)}finally{dt=m,ue.p=u,X.T=o}}_n=3}}function a_(){if(_n===4||_n===3){_n=0,sr();var r=sa,i=Al,o=yi,u=$x;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?_n=5:(_n=0,Al=sa=null,o_(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(ra=null),zr(o),i=i.stateNode,Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot(he,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=X.T,m=ue.p,ue.p=2,X.T=null;try{for(var y=r.onRecoverableError,_=0;_<u.length;_++){var S=u[_];y(S.value,{componentStack:S.stack})}}finally{X.T=i,ue.p=m}}(yi&3)!==0&&Pd(),Ms(r),m=r.pendingLanes,(o&261930)!==0&&(m&42)!==0?r===ag?uu++:(uu=0,ag=r):uu=0,hu(0)}}function o_(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,Hc(i)))}function Pd(){return s_(),i_(),a_(),l_()}function l_(){if(_n!==5)return!1;var r=sa,i=sg;sg=0;var o=zr(yi),u=X.T,m=ue.p;try{ue.p=32>o?32:o,X.T=null,o=ig,ig=null;var y=sa,_=yi;if(_n=0,Al=sa=null,yi=0,(dt&6)!==0)throw Error(n(331));var S=dt;if(dt|=4,Gx(y.current),zx(y,y.current,_,o),dt=S,hu(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot(he,y)}catch{}return!0}finally{ue.p=m,X.T=u,o_(r,i)}}function c_(r,i,o){i=Xr(o,i),i=Lm(r.stateNode,i,2),r=Ji(r,i,2),r!==null&&(Ts(r,2),Ms(r))}function gt(r,i,o){if(r.tag===3)c_(r,r,o);else for(;i!==null;){if(i.tag===3){c_(i,r,o);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ra===null||!ra.has(u))){r=Xr(o,r),o=ux(2),u=Ji(i,o,2),u!==null&&(hx(o,u,i,r),Ts(u,2),Ms(u));break}}i=i.return}}function cg(r,i,o){var u=r.pingCache;if(u===null){u=r.pingCache=new $A;var m=new Set;u.set(i,m)}else m=u.get(i),m===void 0&&(m=new Set,u.set(i,m));m.has(o)||(tg=!0,m.add(o),r=JA.bind(null,r,i,o),i.then(r,r))}function JA(r,i,o){var u=r.pingCache;u!==null&&u.delete(i),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,kt===r&&(tt&o)===o&&(nn===4||nn===3&&(tt&62914560)===tt&&300>dn()-Cd?(dt&2)===0&&Il(r,0):ng|=o,Nl===tt&&(Nl=0)),Ms(r)}function u_(r,i){i===0&&(i=Ha()),r=io(r,i),r!==null&&(Ts(r,i),Ms(r))}function WA(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),u_(r,o)}function ZA(r,i){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,m=r.memoizedState;m!==null&&(o=m.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(n(314))}u!==null&&u.delete(i),u_(r,o)}function eI(r,i){return It(r,i)}var Md=null,Rl=null,ug=!1,Vd=!1,hg=!1,aa=0;function Ms(r){r!==Rl&&r.next===null&&(Rl===null?Md=Rl=r:Rl=Rl.next=r),Vd=!0,ug||(ug=!0,nI())}function hu(r,i){if(!hg&&Vd){hg=!0;do for(var o=!1,u=Md;u!==null;){if(r!==0){var m=u.pendingLanes;if(m===0)var y=0;else{var _=u.suspendedLanes,S=u.pingedLanes;y=(1<<31-Ke(42|r)+1)-1,y&=m&~(_&~S),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,p_(u,y))}else y=tt,y=xn(u,u===kt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||br(u,y)||(o=!0,p_(u,y));u=u.next}while(o);hg=!1}}function tI(){h_()}function h_(){Vd=ug=!1;var r=0;aa!==0&&dI()&&(r=aa);for(var i=dn(),o=null,u=Md;u!==null;){var m=u.next,y=d_(u,i);y===0?(u.next=null,o===null?Md=m:o.next=m,m===null&&(Rl=o)):(o=u,(r!==0||(y&3)!==0)&&(Vd=!0)),u=m}_n!==0&&_n!==5||hu(r),aa!==0&&(aa=0)}function d_(r,i){for(var o=r.suspendedLanes,u=r.pingedLanes,m=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var _=31-Ke(y),S=1<<_,D=m[_];D===-1?((S&o)===0||(S&u)!==0)&&(m[_]=ji(S,i)):D<=i&&(r.expiredLanes|=S),y&=~S}if(i=kt,o=tt,o=xn(r,r===i?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===i&&(mt===2||mt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&kn(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||br(r,o)){if(i=o&-o,i===r.callbackPriority)return i;switch(u!==null&&kn(u),zr(o)){case 2:case 8:o=Jn;break;case 32:o=ir;break;case 268435456:o=Lr;break;default:o=ir}return u=f_.bind(null,r),o=It(o,u),r.callbackPriority=i,r.callbackNode=o,i}return u!==null&&u!==null&&kn(u),r.callbackPriority=2,r.callbackNode=null,2}function f_(r,i){if(_n!==0&&_n!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Pd()&&r.callbackNode!==o)return null;var u=tt;return u=xn(r,r===kt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(Qx(r,u,i),d_(r,dn()),r.callbackNode!=null&&r.callbackNode===o?f_.bind(null,r):null)}function p_(r,i){if(Pd())return null;Qx(r,i,!0)}function nI(){pI(function(){(dt&6)!==0?It(Xn,tI):h_()})}function dg(){if(aa===0){var r=ml;r===0&&(r=Dt,Dt<<=1,(Dt&261888)===0&&(Dt=256)),aa=r}return aa}function m_(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:el(""+r)}function g_(r,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,r.id&&o.setAttribute("form",r.id),i.parentNode.insertBefore(o,i),r=new FormData(r),o.parentNode.removeChild(o),r}function rI(r,i,o,u,m){if(i==="submit"&&o&&o.stateNode===m){var y=m_((m[Jt]||null).action),_=u.submitter;_&&(i=(i=_[Jt]||null)?m_(i.formAction):_.getAttribute("formAction"),i!==null&&(y=i,_=null));var S=new Cs("action","action",null,u,m);r.push({event:S,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(aa!==0){var D=_?g_(m,_):new FormData(m);Dm(o,{pending:!0,data:D,method:m.method,action:y},null,D)}}else typeof y=="function"&&(S.preventDefault(),D=_?g_(m,_):new FormData(m),Dm(o,{pending:!0,data:D,method:m.method,action:y},y,D))},currentTarget:m}]})}}for(var fg=0;fg<Yp.length;fg++){var pg=Yp[fg],sI=pg.toLowerCase(),iI=pg[0].toUpperCase()+pg.slice(1);ys(sI,"on"+iI)}ys(Kv,"onAnimationEnd"),ys(Qv,"onAnimationIteration"),ys(Yv,"onAnimationStart"),ys("dblclick","onDoubleClick"),ys("focusin","onFocus"),ys("focusout","onBlur"),ys(_A,"onTransitionRun"),ys(wA,"onTransitionStart"),ys(EA,"onTransitionCancel"),ys(Xv,"onTransitionEnd"),Gr("onMouseEnter",["mouseout","mouseover"]),Gr("onMouseLeave",["mouseout","mouseover"]),Gr("onPointerEnter",["pointerout","pointerover"]),Gr("onPointerLeave",["pointerout","pointerover"]),Fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aI=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(du));function y_(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],m=u.event;u=u.listeners;e:{var y=void 0;if(i)for(var _=u.length-1;0<=_;_--){var S=u[_],D=S.instance,H=S.currentTarget;if(S=S.listener,D!==y&&m.isPropagationStopped())break e;y=S,m.currentTarget=H;try{y(m)}catch(W){Wh(W)}m.currentTarget=null,y=D}else for(_=0;_<u.length;_++){if(S=u[_],D=S.instance,H=S.currentTarget,S=S.listener,D!==y&&m.isPropagationStopped())break e;y=S,m.currentTarget=H;try{y(m)}catch(W){Wh(W)}m.currentTarget=null,y=D}}}}function et(r,i){var o=i[Oi];o===void 0&&(o=i[Oi]=new Set);var u=r+"__bubble";o.has(u)||(v_(i,r,2,!1),o.add(u))}function mg(r,i,o){var u=0;i&&(u|=4),v_(o,r,u,i)}var Ld="_reactListening"+Math.random().toString(36).slice(2);function gg(r){if(!r[Ld]){r[Ld]=!0,Ka.forEach(function(o){o!=="selectionchange"&&(aI.has(o)||mg(o,!1,r),mg(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Ld]||(i[Ld]=!0,mg("selectionchange",!1,i))}}function v_(r,i,o,u){switch(K_(i)){case 2:var m=OI;break;case 8:m=PI;break;default:m=kg}o=m.bind(null,i,o,r),m=void 0,!Ja||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),u?m!==void 0?r.addEventListener(i,o,{capture:!0,passive:m}):r.addEventListener(i,o,!0):m!==void 0?r.addEventListener(i,o,{passive:m}):r.addEventListener(i,o,!1)}function yg(r,i,o,u,m){var y=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var _=u.tag;if(_===3||_===4){var S=u.stateNode.containerInfo;if(S===m)break;if(_===4)for(_=u.return;_!==null;){var D=_.tag;if((D===3||D===4)&&_.stateNode.containerInfo===m)return;_=_.return}for(;S!==null;){if(_=_r(S),_===null)return;if(D=_.tag,D===5||D===6||D===26||D===27){u=y=_;continue e}S=S.parentNode}}u=u.return}Bi(function(){var H=y,W=$r(o),re=[];e:{var $=Jv.get(r);if($!==void 0){var Y=Cs,we=r;switch(r){case"keypress":if(Za(o)===0)break e;case"keydown":case"keyup":Y=Yh;break;case"focusin":we="focus",Y=to;break;case"focusout":we="blur",Y=to;break;case"beforeblur":case"afterblur":Y=to;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=Vc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=zh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=b;break;case Kv:case Qv:case Yv:Y=Fh;break;case Xv:Y=N;break;case"scroll":case"scrollend":Y=Mc;break;case"wheel":Y=Q;break;case"copy":case"cut":case"paste":Y=Gh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=ri;break;case"toggle":case"beforetoggle":Y=Ge}var De=(i&4)!==0,Nt=!De&&(r==="scroll"||r==="scrollend"),z=De?$!==null?$+"Capture":null:$;De=[];for(var V=H,q;V!==null;){var te=V;if(q=te.stateNode,te=te.tag,te!==5&&te!==26&&te!==27||q===null||z===null||(te=fs(V,z),te!=null&&De.push(fu(V,te,q))),Nt)break;V=V.return}0<De.length&&($=new Y($,we,null,o,W),re.push({event:$,listeners:De}))}}if((i&7)===0){e:{if($=r==="mouseover"||r==="pointerover",Y=r==="mouseout"||r==="pointerout",$&&o!==jc&&(we=o.relatedTarget||o.fromElement)&&(_r(we)||we[lr]))break e;if((Y||$)&&($=W.window===W?W:($=W.ownerDocument)?$.defaultView||$.parentWindow:window,Y?(we=o.relatedTarget||o.toElement,Y=H,we=we?_r(we):null,we!==null&&(Nt=l(we),De=we.tag,we!==Nt||De!==5&&De!==27&&De!==6)&&(we=null)):(Y=null,we=H),Y!==we)){if(De=Vc,te="onMouseLeave",z="onMouseEnter",V="mouse",(r==="pointerout"||r==="pointerover")&&(De=ri,te="onPointerLeave",z="onPointerEnter",V="pointer"),Nt=Y==null?$:Un(Y),q=we==null?$:Un(we),$=new De(te,V+"leave",Y,o,W),$.target=Nt,$.relatedTarget=q,te=null,_r(W)===H&&(De=new De(z,V+"enter",we,o,W),De.target=q,De.relatedTarget=Nt,te=De),Nt=te,Y&&we)t:{for(De=oI,z=Y,V=we,q=0,te=z;te;te=De(te))q++;te=0;for(var Re=V;Re;Re=De(Re))te++;for(;0<q-te;)z=De(z),q--;for(;0<te-q;)V=De(V),te--;for(;q--;){if(z===V||V!==null&&z===V.alternate){De=z;break t}z=De(z),V=De(V)}De=null}else De=null;Y!==null&&b_(re,$,Y,De,!1),we!==null&&Nt!==null&&b_(re,Nt,we,De,!0)}}e:{if($=H?Un(H):window,Y=$.nodeName&&$.nodeName.toLowerCase(),Y==="select"||Y==="input"&&$.type==="file")var ct=Mv;else if(Ov($))if(Vv)ct=vA;else{ct=gA;var Ne=mA}else Y=$.nodeName,!Y||Y.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?H&&Rt(H.elementType)&&(ct=Mv):ct=yA;if(ct&&(ct=ct(r,H))){Pv(re,ct,o,W);break e}Ne&&Ne(r,$,H),r==="focusout"&&H&&$.type==="number"&&H.memoizedProps.value!=null&&Li($,"number",$.value)}switch(Ne=H?Un(H):window,r){case"focusin":(Ov(Ne)||Ne.contentEditable==="true")&&(ol=Ne,$p=H,Fc=null);break;case"focusout":Fc=$p=ol=null;break;case"mousedown":Kp=!0;break;case"contextmenu":case"mouseup":case"dragend":Kp=!1,Hv(re,o,W);break;case"selectionchange":if(xA)break;case"keydown":case"keyup":Hv(re,o,W)}var $e;if(ht)e:{switch(r){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else al?no(r,o)&&(nt="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(nt="onCompositionStart");nt&&(Ds&&o.locale!=="ko"&&(al||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&al&&($e=Pc()):(Is=W,Oc="value"in Is?Is.value:Is.textContent,al=!0)),Ne=Ud(H,nt),0<Ne.length&&(nt=new ks(nt,r,null,o,W),re.push({event:nt,listeners:Ne}),$e?nt.data=$e:($e=il(o),$e!==null&&(nt.data=$e)))),($e=Qr?hA(r,o):dA(r,o))&&(nt=Ud(H,"onBeforeInput"),0<nt.length&&(Ne=new ks("onBeforeInput","beforeinput",null,o,W),re.push({event:Ne,listeners:nt}),Ne.data=$e)),rI(re,r,H,o,W)}y_(re,i)})}function fu(r,i,o){return{instance:r,listener:i,currentTarget:o}}function Ud(r,i){for(var o=i+"Capture",u=[];r!==null;){var m=r,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=fs(r,o),m!=null&&u.unshift(fu(r,m,y)),m=fs(r,i),m!=null&&u.push(fu(r,m,y))),r.tag===3)return u;r=r.return}return[]}function oI(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function b_(r,i,o,u,m){for(var y=i._reactName,_=[];o!==null&&o!==u;){var S=o,D=S.alternate,H=S.stateNode;if(S=S.tag,D!==null&&D===u)break;S!==5&&S!==26&&S!==27||H===null||(D=H,m?(H=fs(o,y),H!=null&&_.unshift(fu(o,H,D))):m||(H=fs(o,y),H!=null&&_.push(fu(o,H,D)))),o=o.return}_.length!==0&&r.push({event:i,listeners:_})}var lI=/\r\n?/g,cI=/\u0000|\uFFFD/g;function x_(r){return(typeof r=="string"?r:""+r).replace(lI,`
`).replace(cI,"")}function __(r,i){return i=x_(i),x_(r)===i}function St(r,i,o,u,m,y){switch(o){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||U(r,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&U(r,""+u);break;case"className":Zt(r,"class",u);break;case"tabIndex":Zt(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Zt(r,o,u);break;case"style":Ue(r,u,y);break;case"data":if(i!=="object"){Zt(r,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=el(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(i!=="input"&&St(r,i,"name",m.name,m,null),St(r,i,"formEncType",m.formEncType,m,null),St(r,i,"formMethod",m.formMethod,m,null),St(r,i,"formTarget",m.formTarget,m,null)):(St(r,i,"encType",m.encType,m,null),St(r,i,"method",m.method,m,null),St(r,i,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=el(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=ds);break;case"onScroll":u!=null&&et("scroll",r);break;case"onScrollEnd":u!=null&&et("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(n(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=el(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":et("beforetoggle",r),et("toggle",r),Mi(r,"popover",u);break;case"xlinkActuate":Ct(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ct(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ct(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ct(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ct(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ct(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ct(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ct(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ct(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Mi(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Tr.get(o)||o,Mi(r,o,u))}}function vg(r,i,o,u,m,y){switch(o){case"style":Ue(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(n(60));r.innerHTML=o}}break;case"children":typeof u=="string"?U(r,u):(typeof u=="number"||typeof u=="bigint")&&U(r,""+u);break;case"onScroll":u!=null&&et("scroll",r);break;case"onScrollEnd":u!=null&&et("scrollend",r);break;case"onClick":u!=null&&(r.onclick=ds);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Pi.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),i=o.slice(2,m?o.length-7:void 0),y=r[Jt]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(i,y,m),typeof u=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(i,u,m);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):Mi(r,o,u)}}}function Vn(r,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":et("error",r),et("load",r);var u=!1,m=!1,y;for(y in o)if(o.hasOwnProperty(y)){var _=o[y];if(_!=null)switch(y){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:St(r,i,y,_,o,null)}}m&&St(r,i,"srcSet",o.srcSet,o,null),u&&St(r,i,"src",o.src,o,null);return;case"input":et("invalid",r);var S=y=_=m=null,D=null,H=null;for(u in o)if(o.hasOwnProperty(u)){var W=o[u];if(W!=null)switch(u){case"name":m=W;break;case"type":_=W;break;case"checked":D=W;break;case"defaultChecked":H=W;break;case"value":y=W;break;case"defaultValue":S=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,i));break;default:St(r,i,u,W,o,null)}}Zo(r,y,S,D,H,_,m,!1);return;case"select":et("invalid",r),u=_=y=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":y=S;break;case"defaultValue":_=S;break;case"multiple":u=S;default:St(r,i,m,S,o,null)}i=y,o=_,r.multiple=!!u,i!=null?hs(r,!!u,i,!1):o!=null&&hs(r,!!u,o,!0);return;case"textarea":et("invalid",r),y=m=u=null;for(_ in o)if(o.hasOwnProperty(_)&&(S=o[_],S!=null))switch(_){case"value":u=S;break;case"defaultValue":m=S;break;case"children":y=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:St(r,i,_,S,o,null)}ee(r,u,m,y);return;case"option":for(D in o)if(o.hasOwnProperty(D)&&(u=o[D],u!=null))switch(D){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:St(r,i,D,u,o,null)}return;case"dialog":et("beforetoggle",r),et("toggle",r),et("cancel",r),et("close",r);break;case"iframe":case"object":et("load",r);break;case"video":case"audio":for(u=0;u<du.length;u++)et(du[u],r);break;case"image":et("error",r),et("load",r);break;case"details":et("toggle",r);break;case"embed":case"source":case"link":et("error",r),et("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(H in o)if(o.hasOwnProperty(H)&&(u=o[H],u!=null))switch(H){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:St(r,i,H,u,o,null)}return;default:if(Rt(i)){for(W in o)o.hasOwnProperty(W)&&(u=o[W],u!==void 0&&vg(r,i,W,u,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(u=o[S],u!=null&&St(r,i,S,u,o,null))}function uI(r,i,o,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,_=null,S=null,D=null,H=null,W=null;for(Y in o){var re=o[Y];if(o.hasOwnProperty(Y)&&re!=null)switch(Y){case"checked":break;case"value":break;case"defaultValue":D=re;default:u.hasOwnProperty(Y)||St(r,i,Y,null,u,re)}}for(var $ in u){var Y=u[$];if(re=o[$],u.hasOwnProperty($)&&(Y!=null||re!=null))switch($){case"type":y=Y;break;case"name":m=Y;break;case"checked":H=Y;break;case"defaultChecked":W=Y;break;case"value":_=Y;break;case"defaultValue":S=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(n(137,i));break;default:Y!==re&&St(r,i,$,Y,u,re)}}Vi(r,_,S,D,H,W,y,m);return;case"select":Y=_=S=$=null;for(y in o)if(D=o[y],o.hasOwnProperty(y)&&D!=null)switch(y){case"value":break;case"multiple":Y=D;default:u.hasOwnProperty(y)||St(r,i,y,null,u,D)}for(m in u)if(y=u[m],D=o[m],u.hasOwnProperty(m)&&(y!=null||D!=null))switch(m){case"value":$=y;break;case"defaultValue":S=y;break;case"multiple":_=y;default:y!==D&&St(r,i,m,y,u,D)}i=S,o=_,u=Y,$!=null?hs(r,!!o,$,!1):!!u!=!!o&&(i!=null?hs(r,!!o,i,!0):hs(r,!!o,o?[]:"",!1));return;case"textarea":Y=$=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!u.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:St(r,i,S,null,u,m)}for(_ in u)if(m=u[_],y=o[_],u.hasOwnProperty(_)&&(m!=null||y!=null))switch(_){case"value":$=m;break;case"defaultValue":Y=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==y&&St(r,i,_,m,u,y)}T(r,$,Y);return;case"option":for(var we in o)if($=o[we],o.hasOwnProperty(we)&&$!=null&&!u.hasOwnProperty(we))switch(we){case"selected":r.selected=!1;break;default:St(r,i,we,null,u,$)}for(D in u)if($=u[D],Y=o[D],u.hasOwnProperty(D)&&$!==Y&&($!=null||Y!=null))switch(D){case"selected":r.selected=$&&typeof $!="function"&&typeof $!="symbol";break;default:St(r,i,D,$,u,Y)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var De in o)$=o[De],o.hasOwnProperty(De)&&$!=null&&!u.hasOwnProperty(De)&&St(r,i,De,null,u,$);for(H in u)if($=u[H],Y=o[H],u.hasOwnProperty(H)&&$!==Y&&($!=null||Y!=null))switch(H){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(n(137,i));break;default:St(r,i,H,$,u,Y)}return;default:if(Rt(i)){for(var Nt in o)$=o[Nt],o.hasOwnProperty(Nt)&&$!==void 0&&!u.hasOwnProperty(Nt)&&vg(r,i,Nt,void 0,u,$);for(W in u)$=u[W],Y=o[W],!u.hasOwnProperty(W)||$===Y||$===void 0&&Y===void 0||vg(r,i,W,$,u,Y);return}}for(var z in o)$=o[z],o.hasOwnProperty(z)&&$!=null&&!u.hasOwnProperty(z)&&St(r,i,z,null,u,$);for(re in u)$=u[re],Y=o[re],!u.hasOwnProperty(re)||$===Y||$==null&&Y==null||St(r,i,re,$,u,Y)}function w_(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function hI(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var m=o[u],y=m.transferSize,_=m.initiatorType,S=m.duration;if(y&&S&&w_(_)){for(_=0,S=m.responseEnd,u+=1;u<o.length;u++){var D=o[u],H=D.startTime;if(H>S)break;var W=D.transferSize,re=D.initiatorType;W&&w_(re)&&(D=D.responseEnd,_+=W*(D<S?1:(S-H)/(D-H)))}if(--u,i+=8*(y+_)/(m.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var bg=null,xg=null;function zd(r){return r.nodeType===9?r:r.ownerDocument}function E_(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function T_(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function _g(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var wg=null;function dI(){var r=window.event;return r&&r.type==="popstate"?r===wg?!1:(wg=r,!0):(wg=null,!1)}var S_=typeof setTimeout=="function"?setTimeout:void 0,fI=typeof clearTimeout=="function"?clearTimeout:void 0,N_=typeof Promise=="function"?Promise:void 0,pI=typeof queueMicrotask=="function"?queueMicrotask:typeof N_<"u"?function(r){return N_.resolve(null).then(r).catch(mI)}:S_;function mI(r){setTimeout(function(){throw r})}function oa(r){return r==="head"}function A_(r,i){var o=i,u=0;do{var m=o.nextSibling;if(r.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(m),Ol(i);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")pu(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,pu(o);for(var y=o.firstChild;y;){var _=y.nextSibling,S=y.nodeName;y[Br]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=_}}else o==="body"&&pu(r.ownerDocument.body);o=m}while(o);Ol(i)}function I_(r,i){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function Eg(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Eg(o),ei(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function gI(r,i,o,u){for(;r.nodeType===1;){var m=o;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Br])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=ts(r.nextSibling),r===null)break}return null}function yI(r,i,o){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=ts(r.nextSibling),r===null))return null;return r}function C_(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=ts(r.nextSibling),r===null))return null;return r}function Tg(r){return r.data==="$?"||r.data==="$~"}function Sg(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function vI(r,i){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||o.readyState!=="loading")i();else{var u=function(){i(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function ts(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var Ng=null;function R_(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(i===0)return ts(r.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}r=r.nextSibling}return null}function k_(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return r;i--}else o!=="/$"&&o!=="/&"||i++}r=r.previousSibling}return null}function D_(r,i,o){switch(i=zd(o),r){case"html":if(r=i.documentElement,!r)throw Error(n(452));return r;case"head":if(r=i.head,!r)throw Error(n(453));return r;case"body":if(r=i.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function pu(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);ei(r)}var ns=new Map,j_=new Set;function Bd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var vi=ue.d;ue.d={f:bI,r:xI,D:_I,C:wI,L:EI,m:TI,X:NI,S:SI,M:AI};function bI(){var r=vi.f(),i=Dd();return r||i}function xI(r){var i=Wn(r);i!==null&&i.tag===5&&i.type==="form"?Xb(i):vi.r(r)}var kl=typeof document>"u"?null:document;function O_(r,i,o){var u=kl;if(u&&typeof i=="string"&&i){var m=Dn(i);m='link[rel="'+r+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),j_.has(m)||(j_.add(m),r={rel:r,crossOrigin:o,href:i},u.querySelector(m)===null&&(i=u.createElement("link"),Vn(i,"link",r),Wt(i),u.head.appendChild(i)))}}function _I(r){vi.D(r),O_("dns-prefetch",r,null)}function wI(r,i){vi.C(r,i),O_("preconnect",r,i)}function EI(r,i,o){vi.L(r,i,o);var u=kl;if(u&&r&&i){var m='link[rel="preload"][as="'+Dn(i)+'"]';i==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Dn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Dn(o.imageSizes)+'"]')):m+='[href="'+Dn(r)+'"]';var y=m;switch(i){case"style":y=Dl(r);break;case"script":y=jl(r)}ns.has(y)||(r=x({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:r,as:i},o),ns.set(y,r),u.querySelector(m)!==null||i==="style"&&u.querySelector(mu(y))||i==="script"&&u.querySelector(gu(y))||(i=u.createElement("link"),Vn(i,"link",r),Wt(i),u.head.appendChild(i)))}}function TI(r,i){vi.m(r,i);var o=kl;if(o&&r){var u=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Dn(u)+'"][href="'+Dn(r)+'"]',y=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=jl(r)}if(!ns.has(y)&&(r=x({rel:"modulepreload",href:r},i),ns.set(y,r),o.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(gu(y)))return}u=o.createElement("link"),Vn(u,"link",r),Wt(u),o.head.appendChild(u)}}}function SI(r,i,o){vi.S(r,i,o);var u=kl;if(u&&r){var m=wr(u).hoistableStyles,y=Dl(r);i=i||"default";var _=m.get(y);if(!_){var S={loading:0,preload:null};if(_=u.querySelector(mu(y)))S.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":i},o),(o=ns.get(y))&&Ag(r,o);var D=_=u.createElement("link");Wt(D),Vn(D,"link",r),D._p=new Promise(function(H,W){D.onload=H,D.onerror=W}),D.addEventListener("load",function(){S.loading|=1}),D.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Fd(_,i,u)}_={type:"stylesheet",instance:_,count:1,state:S},m.set(y,_)}}}function NI(r,i){vi.X(r,i);var o=kl;if(o&&r){var u=wr(o).hoistableScripts,m=jl(r),y=u.get(m);y||(y=o.querySelector(gu(m)),y||(r=x({src:r,async:!0},i),(i=ns.get(m))&&Ig(r,i),y=o.createElement("script"),Wt(y),Vn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(m,y))}}function AI(r,i){vi.M(r,i);var o=kl;if(o&&r){var u=wr(o).hoistableScripts,m=jl(r),y=u.get(m);y||(y=o.querySelector(gu(m)),y||(r=x({src:r,async:!0,type:"module"},i),(i=ns.get(m))&&Ig(r,i),y=o.createElement("script"),Wt(y),Vn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(m,y))}}function P_(r,i,o,u){var m=(m=Ve.current)?Bd(m):null;if(!m)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=Dl(o.href),o=wr(m).hoistableStyles,u=o.get(i),u||(u={type:"style",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Dl(o.href);var y=wr(m).hoistableStyles,_=y.get(r);if(_||(m=m.ownerDocument||m,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,_),(y=m.querySelector(mu(r)))&&!y._p&&(_.instance=y,_.state.loading=5),ns.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ns.set(r,o),y||II(m,r,o,_.state))),i&&u===null)throw Error(n(528,""));return _}if(i&&u!==null)throw Error(n(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=jl(o),o=wr(m).hoistableScripts,u=o.get(i),u||(u={type:"script",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Dl(r){return'href="'+Dn(r)+'"'}function mu(r){return'link[rel="stylesheet"]['+r+"]"}function M_(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function II(r,i,o,u){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=r.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),Vn(i,"link",o),Wt(i),r.head.appendChild(i))}function jl(r){return'[src="'+Dn(r)+'"]'}function gu(r){return"script[async]"+r}function V_(r,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var u=r.querySelector('style[data-href~="'+Dn(o.href)+'"]');if(u)return i.instance=u,Wt(u),u;var m=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Wt(u),Vn(u,"style",m),Fd(u,o.precedence,r),i.instance=u;case"stylesheet":m=Dl(o.href);var y=r.querySelector(mu(m));if(y)return i.state.loading|=4,i.instance=y,Wt(y),y;u=M_(o),(m=ns.get(m))&&Ag(u,m),y=(r.ownerDocument||r).createElement("link"),Wt(y);var _=y;return _._p=new Promise(function(S,D){_.onload=S,_.onerror=D}),Vn(y,"link",u),i.state.loading|=4,Fd(y,o.precedence,r),i.instance=y;case"script":return y=jl(o.src),(m=r.querySelector(gu(y)))?(i.instance=m,Wt(m),m):(u=o,(m=ns.get(y))&&(u=x({},o),Ig(u,m)),r=r.ownerDocument||r,m=r.createElement("script"),Wt(m),Vn(m,"link",u),r.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,Fd(u,o.precedence,r));return i.instance}function Fd(r,i,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,y=m,_=0;_<u.length;_++){var S=u[_];if(S.dataset.precedence===i)y=S;else if(y!==m)break}y?y.parentNode.insertBefore(r,y.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(r,i.firstChild))}function Ag(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function Ig(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var Gd=null;function L_(r,i,o){if(Gd===null){var u=new Map,m=Gd=new Map;m.set(o,u)}else m=Gd,u=m.get(o),u||(u=new Map,m.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),m=0;m<o.length;m++){var y=o[m];if(!(y[Br]||y[$t]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var _=y.getAttribute(i)||"";_=r+_;var S=u.get(_);S?S.push(y):u.set(_,[y])}}return u}function U_(r,i,o){r=r.ownerDocument||r,r.head.insertBefore(o,i==="title"?r.querySelector("head > title"):null)}function CI(r,i,o){if(o===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return r=i.disabled,typeof i.precedence=="string"&&r==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function z_(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function RI(r,i,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Dl(u.href),y=i.querySelector(mu(m));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=qd.bind(r),i.then(r,r)),o.state.loading|=4,o.instance=y,Wt(y);return}y=i.ownerDocument||i,u=M_(u),(m=ns.get(m))&&Ag(u,m),y=y.createElement("link"),Wt(y);var _=y;_._p=new Promise(function(S,D){_.onload=S,_.onerror=D}),Vn(y,"link",u),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=qd.bind(r),i.addEventListener("load",o),i.addEventListener("error",o))}}var Cg=0;function kI(r,i){return r.stylesheets&&r.count===0&&$d(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&$d(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+i);0<r.imgBytes&&Cg===0&&(Cg=62500*hI());var m=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&$d(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>Cg?50:800)+i);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(m)}}:null}function qd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)$d(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Hd=null;function $d(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Hd=new Map,i.forEach(DI,r),Hd=null,qd.call(r))}function DI(r,i){if(!(i.state.loading&4)){var o=Hd.get(r);if(o)var u=o.get(null);else{o=new Map,Hd.set(r,o);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var _=m[y];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(o.set(_.dataset.precedence,_),u=_)}u&&o.set(null,u)}m=i.instance,_=m.getAttribute("data-precedence"),y=o.get(_)||u,y===u&&o.set(null,m),o.set(_,m),this.count++,u=qd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),y?y.parentNode.insertBefore(m,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),i.state.loading|=4}}var yu={$$typeof:le,Provider:null,Consumer:null,_currentValue:Ae,_currentValue2:Ae,_threadCount:0};function jI(r,i,o,u,m,y,_,S,D){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ar(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ar(0),this.hiddenUpdates=ar(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function B_(r,i,o,u,m,y,_,S,D,H,W,re){return r=new jI(r,i,o,_,D,H,W,re,S),i=1,y===!0&&(i|=24),y=Nr(3,null,null,i),r.current=y,y.stateNode=r,i=lm(),i.refCount++,r.pooledCache=i,i.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:i},dm(y),r}function F_(r){return r?(r=ul,r):ul}function G_(r,i,o,u,m,y){m=F_(m),u.context===null?u.context=m:u.pendingContext=m,u=Xi(i),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=Ji(r,u,i),o!==null&&(fr(o,r,i),Yc(o,r,i))}function q_(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function Rg(r,i){q_(r,i),(r=r.alternate)&&q_(r,i)}function H_(r){if(r.tag===13||r.tag===31){var i=io(r,67108864);i!==null&&fr(i,r,67108864),Rg(r,67108864)}}function $_(r){if(r.tag===13||r.tag===31){var i=kr();i=_e(i);var o=io(r,i);o!==null&&fr(o,r,i),Rg(r,i)}}var Kd=!0;function OI(r,i,o,u){var m=X.T;X.T=null;var y=ue.p;try{ue.p=2,kg(r,i,o,u)}finally{ue.p=y,X.T=m}}function PI(r,i,o,u){var m=X.T;X.T=null;var y=ue.p;try{ue.p=8,kg(r,i,o,u)}finally{ue.p=y,X.T=m}}function kg(r,i,o,u){if(Kd){var m=Dg(u);if(m===null)yg(r,i,u,Qd,o),Q_(r,u);else if(VI(m,r,i,o,u))u.stopPropagation();else if(Q_(r,u),i&4&&-1<MI.indexOf(r)){for(;m!==null;){var y=Wn(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var _=an(y.pendingLanes);if(_!==0){var S=y;for(S.pendingLanes|=2,S.entangledLanes|=2;_;){var D=1<<31-Ke(_);S.entanglements[1]|=D,_&=~D}Ms(y),(dt&6)===0&&(Rd=dn()+500,hu(0))}}break;case 31:case 13:S=io(y,2),S!==null&&fr(S,y,2),Dd(),Rg(y,2)}if(y=Dg(u),y===null&&yg(r,i,u,Qd,o),y===m)break;m=y}m!==null&&u.stopPropagation()}else yg(r,i,u,null,o)}}function Dg(r){return r=$r(r),jg(r)}var Qd=null;function jg(r){if(Qd=null,r=_r(r),r!==null){var i=l(r);if(i===null)r=null;else{var o=i.tag;if(o===13){if(r=c(i),r!==null)return r;r=null}else if(o===31){if(r=d(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Qd=r,null}function K_(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bt()){case Xn:return 2;case Jn:return 8;case ir:case Js:return 32;case Lr:return 268435456;default:return 32}default:return 32}}var Og=!1,la=null,ca=null,ua=null,vu=new Map,bu=new Map,ha=[],MI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Q_(r,i){switch(r){case"focusin":case"focusout":la=null;break;case"dragenter":case"dragleave":ca=null;break;case"mouseover":case"mouseout":ua=null;break;case"pointerover":case"pointerout":vu.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":bu.delete(i.pointerId)}}function xu(r,i,o,u,m,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[m]},i!==null&&(i=Wn(i),i!==null&&H_(i)),r):(r.eventSystemFlags|=u,i=r.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),r)}function VI(r,i,o,u,m){switch(i){case"focusin":return la=xu(la,r,i,o,u,m),!0;case"dragenter":return ca=xu(ca,r,i,o,u,m),!0;case"mouseover":return ua=xu(ua,r,i,o,u,m),!0;case"pointerover":var y=m.pointerId;return vu.set(y,xu(vu.get(y)||null,r,i,o,u,m)),!0;case"gotpointercapture":return y=m.pointerId,bu.set(y,xu(bu.get(y)||null,r,i,o,u,m)),!0}return!1}function Y_(r){var i=_r(r.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){r.blockedOn=i,or(r.priority,function(){$_(o)});return}}else if(i===31){if(i=d(o),i!==null){r.blockedOn=i,or(r.priority,function(){$_(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Yd(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Dg(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);jc=u,o.target.dispatchEvent(u),jc=null}else return i=Wn(o),i!==null&&H_(i),r.blockedOn=o,!1;i.shift()}return!0}function X_(r,i,o){Yd(r)&&o.delete(i)}function LI(){Og=!1,la!==null&&Yd(la)&&(la=null),ca!==null&&Yd(ca)&&(ca=null),ua!==null&&Yd(ua)&&(ua=null),vu.forEach(X_),bu.forEach(X_)}function Xd(r,i){r.blockedOn===i&&(r.blockedOn=null,Og||(Og=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,LI)))}var Jd=null;function J_(r){Jd!==r&&(Jd=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Jd===r&&(Jd=null);for(var i=0;i<r.length;i+=3){var o=r[i],u=r[i+1],m=r[i+2];if(typeof u!="function"){if(jg(u||o)===null)continue;break}var y=Wn(o);y!==null&&(r.splice(i,3),i-=3,Dm(y,{pending:!0,data:m,method:o.method,action:u},u,m))}}))}function Ol(r){function i(D){return Xd(D,r)}la!==null&&Xd(la,r),ca!==null&&Xd(ca,r),ua!==null&&Xd(ua,r),vu.forEach(i),bu.forEach(i);for(var o=0;o<ha.length;o++){var u=ha[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<ha.length&&(o=ha[0],o.blockedOn===null);)Y_(o),o.blockedOn===null&&ha.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var m=o[u],y=o[u+1],_=m[Jt]||null;if(typeof y=="function")_||J_(o);else if(_){var S=null;if(y&&y.hasAttribute("formAction")){if(m=y,_=y[Jt]||null)S=_.formAction;else if(jg(m)!==null)continue}else S=_.action;typeof S=="function"?o[u+1]=S:(o.splice(u,3),u-=3),J_(o)}}}function W_(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(_){return m=_})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,m=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function Pg(r){this._internalRoot=r}Wd.prototype.render=Pg.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(n(409));var o=i.current,u=kr();G_(o,u,r,i,null,null)},Wd.prototype.unmount=Pg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;G_(r.current,2,null,r,null,null),Dd(),i[lr]=null}};function Wd(r){this._internalRoot=r}Wd.prototype.unstable_scheduleHydration=function(r){if(r){var i=Wo();r={blockedOn:null,target:r,priority:i};for(var o=0;o<ha.length&&i!==0&&i<ha[o].priority;o++);ha.splice(o,0,r),o===0&&Y_(r)}};var Z_=e.version;if(Z_!=="19.2.4")throw Error(n(527,Z_,"19.2.4"));ue.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=g(i),r=r!==null?v(r):null,r=r===null?null:r.stateNode,r};var UI={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zd.isDisabled&&Zd.supportsFiber)try{he=Zd.inject(UI),Fe=Zd}catch{}}return Eu.createRoot=function(r,i){if(!a(r))throw Error(n(299));var o=!1,u="",m=ax,y=ox,_=lx;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(_=i.onRecoverableError)),i=B_(r,1,!1,null,null,o,u,null,m,y,_,W_),r[lr]=i.current,gg(r),new Pg(i)},Eu.hydrateRoot=function(r,i,o){if(!a(r))throw Error(n(299));var u=!1,m="",y=ax,_=ox,S=lx,D=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(_=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(D=o.formState)),i=B_(r,1,!0,i,o??null,u,m,D,y,_,S,W_),i.context=F_(null),o=i.current,u=kr(),u=_e(u),m=Xi(u),m.callback=null,Ji(o,m,u),o=u,i.current.lanes=o,Ts(i,o),Ms(i),r[lr]=i.current,gg(r),new Wd(i)},Eu.version="19.2.4",Eu}var cw;function WI(){if(cw)return Lg.exports;cw=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Lg.exports=JI(),Lg.exports}var ZI=WI();const eC=up(ZI);var Pl={},Fg={exports:{}},Gg,uw;function tC(){if(uw)return Gg;uw=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Gg=s,Gg}var qg,hw;function nC(){if(hw)return qg;hw=1;var s=tC();function e(){}function t(){}return t.resetWarningCache=e,qg=function(){function n(c,d,p,g,v,x){if(x!==s){var E=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw E.name="Invariant Violation",E}}n.isRequired=n;function a(){return n}var l={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:t,resetWarningCache:e};return l.PropTypes=l,l},qg}var dw;function BE(){return dw||(dw=1,Fg.exports=nC()()),Fg.exports}var Hg,fw;function FE(){return fw||(fw=1,Hg={L:1,M:0,Q:3,H:2}),Hg}var $g,pw;function GE(){return pw||(pw=1,$g={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),$g}var Kg,mw;function rC(){if(mw)return Kg;mw=1;var s=GE();function e(t){this.mode=s.MODE_8BIT_BYTE,this.data=t}return e.prototype={getLength:function(t){return this.data.length},write:function(t){for(var n=0;n<this.data.length;n++)t.put(this.data.charCodeAt(n),8)}},Kg=e,Kg}var Qg,gw;function sC(){if(gw)return Qg;gw=1;var s=FE();function e(t,n){this.totalCount=t,this.dataCount=n}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,n){var a=e.getRsBlockTable(t,n);if(a==null)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+n);for(var l=a.length/3,c=new Array,d=0;d<l;d++)for(var p=a[d*3+0],g=a[d*3+1],v=a[d*3+2],x=0;x<p;x++)c.push(new e(g,v));return c},e.getRsBlockTable=function(t,n){switch(n){case s.L:return e.RS_BLOCK_TABLE[(t-1)*4+0];case s.M:return e.RS_BLOCK_TABLE[(t-1)*4+1];case s.Q:return e.RS_BLOCK_TABLE[(t-1)*4+2];case s.H:return e.RS_BLOCK_TABLE[(t-1)*4+3];default:return}},Qg=e,Qg}var Yg,yw;function iC(){if(yw)return Yg;yw=1;function s(){this.buffer=new Array,this.length=0}return s.prototype={get:function(e){var t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(var n=0;n<t;n++)this.putBit((e>>>t-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},Yg=s,Yg}var Xg,vw;function qE(){if(vw)return Xg;vw=1;for(var s={glog:function(t){if(t<1)throw new Error("glog("+t+")");return s.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return s.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},e=0;e<8;e++)s.EXP_TABLE[e]=1<<e;for(var e=8;e<256;e++)s.EXP_TABLE[e]=s.EXP_TABLE[e-4]^s.EXP_TABLE[e-5]^s.EXP_TABLE[e-6]^s.EXP_TABLE[e-8];for(var e=0;e<255;e++)s.LOG_TABLE[s.EXP_TABLE[e]]=e;return Xg=s,Xg}var Jg,bw;function HE(){if(bw)return Jg;bw=1;var s=qE();function e(t,n){if(t.length==null)throw new Error(t.length+"/"+n);for(var a=0;a<t.length&&t[a]==0;)a++;this.num=new Array(t.length-a+n);for(var l=0;l<t.length-a;l++)this.num[l]=t[l+a]}return e.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var n=new Array(this.getLength()+t.getLength()-1),a=0;a<this.getLength();a++)for(var l=0;l<t.getLength();l++)n[a+l]^=s.gexp(s.glog(this.get(a))+s.glog(t.get(l)));return new e(n,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var n=s.glog(this.get(0))-s.glog(t.get(0)),a=new Array(this.getLength()),l=0;l<this.getLength();l++)a[l]=this.get(l);for(var l=0;l<t.getLength();l++)a[l]^=s.gexp(s.glog(t.get(l))+n);return new e(a,0).mod(t)}},Jg=e,Jg}var Wg,xw;function aC(){if(xw)return Wg;xw=1;var s=GE(),e=HE(),t=qE(),n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},a={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(l){for(var c=l<<10;a.getBCHDigit(c)-a.getBCHDigit(a.G15)>=0;)c^=a.G15<<a.getBCHDigit(c)-a.getBCHDigit(a.G15);return(l<<10|c)^a.G15_MASK},getBCHTypeNumber:function(l){for(var c=l<<12;a.getBCHDigit(c)-a.getBCHDigit(a.G18)>=0;)c^=a.G18<<a.getBCHDigit(c)-a.getBCHDigit(a.G18);return l<<12|c},getBCHDigit:function(l){for(var c=0;l!=0;)c++,l>>>=1;return c},getPatternPosition:function(l){return a.PATTERN_POSITION_TABLE[l-1]},getMask:function(l,c,d){switch(l){case n.PATTERN000:return(c+d)%2==0;case n.PATTERN001:return c%2==0;case n.PATTERN010:return d%3==0;case n.PATTERN011:return(c+d)%3==0;case n.PATTERN100:return(Math.floor(c/2)+Math.floor(d/3))%2==0;case n.PATTERN101:return c*d%2+c*d%3==0;case n.PATTERN110:return(c*d%2+c*d%3)%2==0;case n.PATTERN111:return(c*d%3+(c+d)%2)%2==0;default:throw new Error("bad maskPattern:"+l)}},getErrorCorrectPolynomial:function(l){for(var c=new e([1],0),d=0;d<l;d++)c=c.multiply(new e([1,t.gexp(d)],0));return c},getLengthInBits:function(l,c){if(1<=c&&c<10)switch(l){case s.MODE_NUMBER:return 10;case s.MODE_ALPHA_NUM:return 9;case s.MODE_8BIT_BYTE:return 8;case s.MODE_KANJI:return 8;default:throw new Error("mode:"+l)}else if(c<27)switch(l){case s.MODE_NUMBER:return 12;case s.MODE_ALPHA_NUM:return 11;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 10;default:throw new Error("mode:"+l)}else if(c<41)switch(l){case s.MODE_NUMBER:return 14;case s.MODE_ALPHA_NUM:return 13;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 12;default:throw new Error("mode:"+l)}else throw new Error("type:"+c)},getLostPoint:function(l){for(var c=l.getModuleCount(),d=0,p=0;p<c;p++)for(var g=0;g<c;g++){for(var v=0,x=l.isDark(p,g),E=-1;E<=1;E++)if(!(p+E<0||c<=p+E))for(var A=-1;A<=1;A++)g+A<0||c<=g+A||E==0&&A==0||x==l.isDark(p+E,g+A)&&v++;v>5&&(d+=3+v-5)}for(var p=0;p<c-1;p++)for(var g=0;g<c-1;g++){var O=0;l.isDark(p,g)&&O++,l.isDark(p+1,g)&&O++,l.isDark(p,g+1)&&O++,l.isDark(p+1,g+1)&&O++,(O==0||O==4)&&(d+=3)}for(var p=0;p<c;p++)for(var g=0;g<c-6;g++)l.isDark(p,g)&&!l.isDark(p,g+1)&&l.isDark(p,g+2)&&l.isDark(p,g+3)&&l.isDark(p,g+4)&&!l.isDark(p,g+5)&&l.isDark(p,g+6)&&(d+=40);for(var g=0;g<c;g++)for(var p=0;p<c-6;p++)l.isDark(p,g)&&!l.isDark(p+1,g)&&l.isDark(p+2,g)&&l.isDark(p+3,g)&&l.isDark(p+4,g)&&!l.isDark(p+5,g)&&l.isDark(p+6,g)&&(d+=40);for(var F=0,g=0;g<c;g++)for(var p=0;p<c;p++)l.isDark(p,g)&&F++;var J=Math.abs(100*F/c/c-50)/5;return d+=J*10,d}};return Wg=a,Wg}var Zg,_w;function oC(){if(_w)return Zg;_w=1;var s=rC(),e=sC(),t=iC(),n=aC(),a=HE();function l(d,p){this.typeNumber=d,this.errorCorrectLevel=p,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var c=l.prototype;return c.addData=function(d){var p=new s(d);this.dataList.push(p),this.dataCache=null},c.isDark=function(d,p){if(d<0||this.moduleCount<=d||p<0||this.moduleCount<=p)throw new Error(d+","+p);return this.modules[d][p]},c.getModuleCount=function(){return this.moduleCount},c.make=function(){if(this.typeNumber<1){var d=1;for(d=1;d<40;d++){for(var p=e.getRSBlocks(d,this.errorCorrectLevel),g=new t,v=0,x=0;x<p.length;x++)v+=p[x].dataCount;for(var x=0;x<this.dataList.length;x++){var E=this.dataList[x];g.put(E.mode,4),g.put(E.getLength(),n.getLengthInBits(E.mode,d)),E.write(g)}if(g.getLengthInBits()<=v*8)break}this.typeNumber=d}this.makeImpl(!1,this.getBestMaskPattern())},c.makeImpl=function(d,p){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var g=0;g<this.moduleCount;g++){this.modules[g]=new Array(this.moduleCount);for(var v=0;v<this.moduleCount;v++)this.modules[g][v]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(d,p),this.typeNumber>=7&&this.setupTypeNumber(d),this.dataCache==null&&(this.dataCache=l.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,p)},c.setupPositionProbePattern=function(d,p){for(var g=-1;g<=7;g++)if(!(d+g<=-1||this.moduleCount<=d+g))for(var v=-1;v<=7;v++)p+v<=-1||this.moduleCount<=p+v||(0<=g&&g<=6&&(v==0||v==6)||0<=v&&v<=6&&(g==0||g==6)||2<=g&&g<=4&&2<=v&&v<=4?this.modules[d+g][p+v]=!0:this.modules[d+g][p+v]=!1)},c.getBestMaskPattern=function(){for(var d=0,p=0,g=0;g<8;g++){this.makeImpl(!0,g);var v=n.getLostPoint(this);(g==0||d>v)&&(d=v,p=g)}return p},c.createMovieClip=function(d,p,g){var v=d.createEmptyMovieClip(p,g),x=1;this.make();for(var E=0;E<this.modules.length;E++)for(var A=E*x,O=0;O<this.modules[E].length;O++){var F=O*x,J=this.modules[E][O];J&&(v.beginFill(0,100),v.moveTo(F,A),v.lineTo(F+x,A),v.lineTo(F+x,A+x),v.lineTo(F,A+x),v.endFill())}return v},c.setupTimingPattern=function(){for(var d=8;d<this.moduleCount-8;d++)this.modules[d][6]==null&&(this.modules[d][6]=d%2==0);for(var p=8;p<this.moduleCount-8;p++)this.modules[6][p]==null&&(this.modules[6][p]=p%2==0)},c.setupPositionAdjustPattern=function(){for(var d=n.getPatternPosition(this.typeNumber),p=0;p<d.length;p++)for(var g=0;g<d.length;g++){var v=d[p],x=d[g];if(this.modules[v][x]==null)for(var E=-2;E<=2;E++)for(var A=-2;A<=2;A++)E==-2||E==2||A==-2||A==2||E==0&&A==0?this.modules[v+E][x+A]=!0:this.modules[v+E][x+A]=!1}},c.setupTypeNumber=function(d){for(var p=n.getBCHTypeNumber(this.typeNumber),g=0;g<18;g++){var v=!d&&(p>>g&1)==1;this.modules[Math.floor(g/3)][g%3+this.moduleCount-8-3]=v}for(var g=0;g<18;g++){var v=!d&&(p>>g&1)==1;this.modules[g%3+this.moduleCount-8-3][Math.floor(g/3)]=v}},c.setupTypeInfo=function(d,p){for(var g=this.errorCorrectLevel<<3|p,v=n.getBCHTypeInfo(g),x=0;x<15;x++){var E=!d&&(v>>x&1)==1;x<6?this.modules[x][8]=E:x<8?this.modules[x+1][8]=E:this.modules[this.moduleCount-15+x][8]=E}for(var x=0;x<15;x++){var E=!d&&(v>>x&1)==1;x<8?this.modules[8][this.moduleCount-x-1]=E:x<9?this.modules[8][15-x-1+1]=E:this.modules[8][15-x-1]=E}this.modules[this.moduleCount-8][8]=!d},c.mapData=function(d,p){for(var g=-1,v=this.moduleCount-1,x=7,E=0,A=this.moduleCount-1;A>0;A-=2)for(A==6&&A--;;){for(var O=0;O<2;O++)if(this.modules[v][A-O]==null){var F=!1;E<d.length&&(F=(d[E]>>>x&1)==1);var J=n.getMask(p,v,A-O);J&&(F=!F),this.modules[v][A-O]=F,x--,x==-1&&(E++,x=7)}if(v+=g,v<0||this.moduleCount<=v){v-=g,g=-g;break}}},l.PAD0=236,l.PAD1=17,l.createData=function(d,p,g){for(var v=e.getRSBlocks(d,p),x=new t,E=0;E<g.length;E++){var A=g[E];x.put(A.mode,4),x.put(A.getLength(),n.getLengthInBits(A.mode,d)),A.write(x)}for(var O=0,E=0;E<v.length;E++)O+=v[E].dataCount;if(x.getLengthInBits()>O*8)throw new Error("code length overflow. ("+x.getLengthInBits()+">"+O*8+")");for(x.getLengthInBits()+4<=O*8&&x.put(0,4);x.getLengthInBits()%8!=0;)x.putBit(!1);for(;!(x.getLengthInBits()>=O*8||(x.put(l.PAD0,8),x.getLengthInBits()>=O*8));)x.put(l.PAD1,8);return l.createBytes(x,v)},l.createBytes=function(d,p){for(var g=0,v=0,x=0,E=new Array(p.length),A=new Array(p.length),O=0;O<p.length;O++){var F=p[O].dataCount,J=p[O].totalCount-F;v=Math.max(v,F),x=Math.max(x,J),E[O]=new Array(F);for(var se=0;se<E[O].length;se++)E[O][se]=255&d.buffer[se+g];g+=F;var ce=n.getErrorCorrectPolynomial(J),le=new a(E[O],ce.getLength()-1),me=le.mod(ce);A[O]=new Array(ce.getLength()-1);for(var se=0;se<A[O].length;se++){var Ee=se+me.getLength()-A[O].length;A[O][se]=Ee>=0?me.get(Ee):0}}for(var be=0,se=0;se<p.length;se++)be+=p[se].totalCount;for(var I=new Array(be),C=0,se=0;se<v;se++)for(var O=0;O<p.length;O++)se<E[O].length&&(I[C++]=E[O][se]);for(var se=0;se<x;se++)for(var O=0;O<p.length;O++)se<A[O].length&&(I[C++]=A[O][se]);return I},Zg=l,Zg}var ef={},ww;function lC(){if(ww)return ef;ww=1,Object.defineProperty(ef,"__esModule",{value:!0});var s=Object.assign||function(g){for(var v=1;v<arguments.length;v++){var x=arguments[v];for(var E in x)Object.prototype.hasOwnProperty.call(x,E)&&(g[E]=x[E])}return g},e=BE(),t=l(e),n=wh(),a=l(n);function l(g){return g&&g.__esModule?g:{default:g}}function c(g,v){var x={};for(var E in g)v.indexOf(E)>=0||Object.prototype.hasOwnProperty.call(g,E)&&(x[E]=g[E]);return x}var d={bgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,bgD:t.default.string.isRequired,fgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,fgD:t.default.string.isRequired,size:t.default.number.isRequired,title:t.default.string,viewBoxSize:t.default.number.isRequired,xmlns:t.default.string},p=(0,n.forwardRef)(function(g,v){var x=g.bgColor,E=g.bgD,A=g.fgD,O=g.fgColor,F=g.size,J=g.title,se=g.viewBoxSize,ce=g.xmlns,le=ce===void 0?"http://www.w3.org/2000/svg":ce,me=c(g,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return a.default.createElement("svg",s({},me,{height:F,ref:v,viewBox:"0 0 "+se+" "+se,width:F,xmlns:le}),J?a.default.createElement("title",null,J):null,a.default.createElement("path",{d:E,fill:x}),a.default.createElement("path",{d:A,fill:O}))});return p.displayName="QRCodeSvg",p.propTypes=d,ef.default=p,ef}var Ew;function cC(){if(Ew)return Pl;Ew=1,Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.QRCode=void 0;var s=Object.assign||function(F){for(var J=1;J<arguments.length;J++){var se=arguments[J];for(var ce in se)Object.prototype.hasOwnProperty.call(se,ce)&&(F[ce]=se[ce])}return F},e=BE(),t=x(e),n=FE(),a=x(n),l=oC(),c=x(l),d=wh(),p=x(d),g=lC(),v=x(g);function x(F){return F&&F.__esModule?F:{default:F}}function E(F,J){var se={};for(var ce in F)J.indexOf(ce)>=0||Object.prototype.hasOwnProperty.call(F,ce)&&(se[ce]=F[ce]);return se}var A={bgColor:t.default.oneOfType([t.default.object,t.default.string]),fgColor:t.default.oneOfType([t.default.object,t.default.string]),level:t.default.string,size:t.default.number,value:t.default.string.isRequired},O=(0,d.forwardRef)(function(F,J){var se=F.bgColor,ce=se===void 0?"#FFFFFF":se,le=F.fgColor,me=le===void 0?"#000000":le,Ee=F.level,be=Ee===void 0?"L":Ee,I=F.size,C=I===void 0?256:I,R=F.value,L=E(F,["bgColor","fgColor","level","size","value"]),j=new c.default(-1,a.default[be]);j.addData(R),j.make();var P=j.modules;return p.default.createElement(v.default,s({},L,{bgColor:ce,bgD:P.map(function(k,at){return k.map(function(_t,X){return _t?"":"M "+X+" "+at+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:me,fgD:P.map(function(k,at){return k.map(function(_t,X){return _t?"M "+X+" "+at+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:J,size:C,viewBoxSize:P.length}))});return Pl.QRCode=O,O.displayName="QRCode",O.propTypes=A,Pl.default=O,Pl}var uC=cC();const Tw=up(uC);var Kt=(s=>(s.READY="ready to sing",s.STANDBY="standby",s))(Kt||{}),ft=(s=>(s.SINGING="Singing",s.LISTENING="Listening",s))(ft||{}),Pe=(s=>(s.PENDING="Pending Approval",s.APPROVED="Approved",s.DONE="Done",s))(Pe||{}),Ls=(s=>(s.FRESH_MEAT="FRESH_MEAT",s.FAIR_ROTATION="FAIR_ROTATION",s.FIFO="FIFO",s.OLDEST_MEMBER="OLDEST_MEMBER",s.RANDOM="RANDOM",s))(Ls||{});class hC{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const t of this._parts)e.push(t);return dC(e).buffer}}function dC(s){let e=0;for(const a of s)e+=a.byteLength;const t=new Uint8Array(e);let n=0;for(const a of s){const l=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);t.set(l,n),n+=a.byteLength}return t}function $E(s){return new fC(s).unpack()}function KE(s){const e=new pC,t=e.pack(s);return t instanceof Promise?t.then(()=>e.getBuffer()):e.getBuffer()}class fC{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t}unpack_uint32(){const e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t}unpack_uint64(){const e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t}unpack_string(e){const t=this.read(e);let n=0,a="",l,c;for(;n<e;)l=t[n],l<160?(c=l,n++):(l^192)<32?(c=(l&31)<<6|t[n+1]&63,n+=2):(l^224)<16?(c=(l&15)<<12|(t[n+1]&63)<<6|t[n+2]&63,n+=3):(c=(l&7)<<18|(t[n+1]&63)<<12|(t[n+2]&63)<<6|t[n+3]&63,n+=4),a+=String.fromCodePoint(c);return this.index+=e,a}unpack_array(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=this.unpack();return t}unpack_map(e){const t={};for(let n=0;n<e;n++){const a=this.unpack();t[a]=this.unpack()}return t}unpack_float(){const e=this.unpack_uint32(),t=e>>31,n=(e>>23&255)-127,a=e&8388607|8388608;return(t===0?1:-1)*a*2**(n-23)}unpack_double(){const e=this.unpack_uint32(),t=this.unpack_uint32(),n=e>>31,a=(e>>20&2047)-1023,c=(e&1048575|1048576)*2**(a-20)+t*2**(a-52);return(n===0?1:-1)*c}read(e){const t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")}}class pC{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const t=e.constructor;if(e instanceof Array){const n=this.pack_array(e);if(n instanceof Promise)return n.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const n=e;this.pack_bin(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(n=>{this.pack_bin(new Uint8Array(n)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const n=this.pack_object(e);if(n instanceof Promise)return n.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const t=e.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const t=this._textEncoder.encode(e),n=t.length;if(n<=15)this.pack_uint8(176+n);else if(n<=65535)this._bufferBuilder.append(216),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(e){const t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const n=a=>{if(a<t){const l=this.pack(e[a]);return l instanceof Promise?l.then(()=>n(a+1)):n(a+1)}};return n(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let t=0;e<0&&(t=1,e=-e);const n=Math.floor(Math.log(e)/Math.LN2),a=e/2**n-1,l=Math.floor(a*2**52),c=2**32,d=t<<31|n+1023<<20|l/c&1048575,p=l%c;this._bufferBuilder.append(203),this.pack_int32(d),this.pack_int32(p)}pack_object(e){const t=Object.keys(e),n=t.length;if(n<=15)this.pack_uint8(128+n);else if(n<=65535)this._bufferBuilder.append(222),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(n);else throw new Error("Invalid length");const a=l=>{if(l<t.length){const c=t[l];if(e.hasOwnProperty(c)){this.pack(c);const d=this.pack(e[c]);if(d instanceof Promise)return d.then(()=>a(l+1))}return a(l+1)}};return a(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const t=e&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(e){const t=e/4294967296,n=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const t=Math.floor(e/4294967296),n=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}constructor(){this._bufferBuilder=new hC,this._textEncoder=new TextEncoder}}let QE=!0,YE=!0;function Ou(s,e,t){const n=s.match(e);return n&&n.length>=t&&parseFloat(n[t],10)}function $o(s,e,t){if(!s.RTCPeerConnection)return;const n=s.RTCPeerConnection.prototype,a=n.addEventListener;n.addEventListener=function(c,d){if(c!==e)return a.apply(this,arguments);const p=g=>{const v=t(g);v&&(d.handleEvent?d.handleEvent(v):d(v))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(d,p),a.apply(this,[c,p])};const l=n.removeEventListener;n.removeEventListener=function(c,d){if(c!==e||!this._eventMap||!this._eventMap[e])return l.apply(this,arguments);if(!this._eventMap[e].has(d))return l.apply(this,arguments);const p=this._eventMap[e].get(d);return this._eventMap[e].delete(d),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[c,p])},Object.defineProperty(n,"on"+e,{get(){return this["_on"+e]},set(c){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),c&&this.addEventListener(e,this["_on"+e]=c)},enumerable:!0,configurable:!0})}function mC(s){return typeof s!="boolean"?new Error("Argument type: "+typeof s+". Please use a boolean."):(QE=s,s?"adapter.js logging disabled":"adapter.js logging enabled")}function gC(s){return typeof s!="boolean"?new Error("Argument type: "+typeof s+". Please use a boolean."):(YE=!s,"adapter.js deprecation warnings "+(s?"disabled":"enabled"))}function XE(){if(typeof window=="object"){if(QE)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function by(s,e){YE&&console.warn(s+" is deprecated, please use "+e+" instead.")}function yC(s){const e={browser:null,version:null};if(typeof s>"u"||!s.navigator||!s.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=s;if(t.userAgentData&&t.userAgentData.brands){const n=t.userAgentData.brands.find(a=>a.brand==="Chromium");if(n)return{browser:"chrome",version:parseInt(n.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Ou(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||s.isSecureContext===!1&&s.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Ou(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(s.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Ou(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=s.RTCRtpTransceiver&&"currentDirection"in s.RTCRtpTransceiver.prototype,e._safariVersion=Ou(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function Sw(s){return Object.prototype.toString.call(s)==="[object Object]"}function JE(s){return Sw(s)?Object.keys(s).reduce(function(e,t){const n=Sw(s[t]),a=n?JE(s[t]):s[t],l=n&&!Object.keys(a).length;return a===void 0||l?e:Object.assign(e,{[t]:a})},{}):s}function x0(s,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(n=>{n.endsWith("Id")?x0(s,s.get(e[n]),t):n.endsWith("Ids")&&e[n].forEach(a=>{x0(s,s.get(a),t)})}))}function Nw(s,e,t){const n=t?"outbound-rtp":"inbound-rtp",a=new Map;if(e===null)return a;const l=[];return s.forEach(c=>{c.type==="track"&&c.trackIdentifier===e.id&&l.push(c)}),l.forEach(c=>{s.forEach(d=>{d.type===n&&d.trackId===c.id&&x0(s,d,a)})}),a}const Aw=XE;function WE(s,e){const t=s&&s.navigator;if(!t.mediaDevices)return;const n=function(d){if(typeof d!="object"||d.mandatory||d.optional)return d;const p={};return Object.keys(d).forEach(g=>{if(g==="require"||g==="advanced"||g==="mediaSource")return;const v=typeof d[g]=="object"?d[g]:{ideal:d[g]};v.exact!==void 0&&typeof v.exact=="number"&&(v.min=v.max=v.exact);const x=function(E,A){return E?E+A.charAt(0).toUpperCase()+A.slice(1):A==="deviceId"?"sourceId":A};if(v.ideal!==void 0){p.optional=p.optional||[];let E={};typeof v.ideal=="number"?(E[x("min",g)]=v.ideal,p.optional.push(E),E={},E[x("max",g)]=v.ideal,p.optional.push(E)):(E[x("",g)]=v.ideal,p.optional.push(E))}v.exact!==void 0&&typeof v.exact!="number"?(p.mandatory=p.mandatory||{},p.mandatory[x("",g)]=v.exact):["min","max"].forEach(E=>{v[E]!==void 0&&(p.mandatory=p.mandatory||{},p.mandatory[x(E,g)]=v[E])})}),d.advanced&&(p.optional=(p.optional||[]).concat(d.advanced)),p},a=function(d,p){if(e.version>=61)return p(d);if(d=JSON.parse(JSON.stringify(d)),d&&typeof d.audio=="object"){const g=function(v,x,E){x in v&&!(E in v)&&(v[E]=v[x],delete v[x])};d=JSON.parse(JSON.stringify(d)),g(d.audio,"autoGainControl","googAutoGainControl"),g(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=n(d.audio)}if(d&&typeof d.video=="object"){let g=d.video.facingMode;g=g&&(typeof g=="object"?g:{ideal:g});const v=e.version<66;if(g&&(g.exact==="user"||g.exact==="environment"||g.ideal==="user"||g.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!v)){delete d.video.facingMode;let x;if(g.exact==="environment"||g.ideal==="environment"?x=["back","rear"]:(g.exact==="user"||g.ideal==="user")&&(x=["front"]),x)return t.mediaDevices.enumerateDevices().then(E=>{E=E.filter(O=>O.kind==="videoinput");let A=E.find(O=>x.some(F=>O.label.toLowerCase().includes(F)));return!A&&E.length&&x.includes("back")&&(A=E[E.length-1]),A&&(d.video.deviceId=g.exact?{exact:A.deviceId}:{ideal:A.deviceId}),d.video=n(d.video),Aw("chrome: "+JSON.stringify(d)),p(d)})}d.video=n(d.video)}return Aw("chrome: "+JSON.stringify(d)),p(d)},l=function(d){return e.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},c=function(d,p,g){a(d,v=>{t.webkitGetUserMedia(v,p,x=>{g&&g(l(x))})})};if(t.getUserMedia=c.bind(t),t.mediaDevices.getUserMedia){const d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(p){return a(p,g=>d(g).then(v=>{if(g.audio&&!v.getAudioTracks().length||g.video&&!v.getVideoTracks().length)throw v.getTracks().forEach(x=>{x.stop()}),new DOMException("","NotFoundError");return v},v=>Promise.reject(l(v))))}}}function ZE(s){s.MediaStream=s.MediaStream||s.webkitMediaStream}function eT(s){if(typeof s=="object"&&s.RTCPeerConnection&&!("ontrack"in s.RTCPeerConnection.prototype)){Object.defineProperty(s.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",a=>{let l;s.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(d=>d.track&&d.track.id===a.track.id):l={track:a.track};const c=new Event("track");c.track=a.track,c.receiver=l,c.transceiver={receiver:l},c.streams=[n.stream],this.dispatchEvent(c)}),n.stream.getTracks().forEach(a=>{let l;s.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(d=>d.track&&d.track.id===a.id):l={track:a};const c=new Event("track");c.track=a,c.receiver=l,c.transceiver={receiver:l},c.streams=[n.stream],this.dispatchEvent(c)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else $o(s,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function tT(s){if(typeof s=="object"&&s.RTCPeerConnection&&!("getSenders"in s.RTCPeerConnection.prototype)&&"createDTMFSender"in s.RTCPeerConnection.prototype){const e=function(a,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=a.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:a}};if(!s.RTCPeerConnection.prototype.getSenders){s.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const a=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addTrack=function(d,p){let g=a.apply(this,arguments);return g||(g=e(this,d),this._senders.push(g)),g};const l=s.RTCPeerConnection.prototype.removeTrack;s.RTCPeerConnection.prototype.removeTrack=function(d){l.apply(this,arguments);const p=this._senders.indexOf(d);p!==-1&&this._senders.splice(p,1)}}const t=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],t.apply(this,[l]),l.getTracks().forEach(c=>{this._senders.push(e(this,c))})};const n=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],n.apply(this,[l]),l.getTracks().forEach(c=>{const d=this._senders.find(p=>p.track===c);d&&this._senders.splice(this._senders.indexOf(d),1)})}}else if(typeof s=="object"&&s.RTCPeerConnection&&"getSenders"in s.RTCPeerConnection.prototype&&"createDTMFSender"in s.RTCPeerConnection.prototype&&s.RTCRtpSender&&!("dtmf"in s.RTCRtpSender.prototype)){const e=s.RTCPeerConnection.prototype.getSenders;s.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(a=>a._pc=this),n},Object.defineProperty(s.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function nT(s){if(!(typeof s=="object"&&s.RTCPeerConnection&&s.RTCRtpSender&&s.RTCRtpReceiver))return;if(!("getStats"in s.RTCRtpSender.prototype)){const t=s.RTCPeerConnection.prototype.getSenders;t&&(s.RTCPeerConnection.prototype.getSenders=function(){const l=t.apply(this,[]);return l.forEach(c=>c._pc=this),l});const n=s.RTCPeerConnection.prototype.addTrack;n&&(s.RTCPeerConnection.prototype.addTrack=function(){const l=n.apply(this,arguments);return l._pc=this,l}),s.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(c=>Nw(c,l.track,!0))}}if(!("getStats"in s.RTCRtpReceiver.prototype)){const t=s.RTCPeerConnection.prototype.getReceivers;t&&(s.RTCPeerConnection.prototype.getReceivers=function(){const a=t.apply(this,[]);return a.forEach(l=>l._pc=this),a}),$o(s,"track",n=>(n.receiver._pc=n.srcElement,n)),s.RTCRtpReceiver.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>Nw(l,a.track,!1))}}if(!("getStats"in s.RTCRtpSender.prototype&&"getStats"in s.RTCRtpReceiver.prototype))return;const e=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof s.MediaStreamTrack){const n=arguments[0];let a,l,c;return this.getSenders().forEach(d=>{d.track===n&&(a?c=!0:a=d)}),this.getReceivers().forEach(d=>(d.track===n&&(l?c=!0:l=d),d.track===n)),c||a&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):a?a.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function rT(s){s.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(c=>this._shimmedLocalStreams[c][0])};const e=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addTrack=function(c,d){if(!d)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const p=e.apply(this,arguments);return this._shimmedLocalStreams[d.id]?this._shimmedLocalStreams[d.id].indexOf(p)===-1&&this._shimmedLocalStreams[d.id].push(p):this._shimmedLocalStreams[d.id]=[d,p],p};const t=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(c){this._shimmedLocalStreams=this._shimmedLocalStreams||{},c.getTracks().forEach(g=>{if(this.getSenders().find(x=>x.track===g))throw new DOMException("Track already exists.","InvalidAccessError")});const d=this.getSenders();t.apply(this,arguments);const p=this.getSenders().filter(g=>d.indexOf(g)===-1);this._shimmedLocalStreams[c.id]=[c].concat(p)};const n=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[c.id],n.apply(this,arguments)};const a=s.RTCPeerConnection.prototype.removeTrack;s.RTCPeerConnection.prototype.removeTrack=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},c&&Object.keys(this._shimmedLocalStreams).forEach(d=>{const p=this._shimmedLocalStreams[d].indexOf(c);p!==-1&&this._shimmedLocalStreams[d].splice(p,1),this._shimmedLocalStreams[d].length===1&&delete this._shimmedLocalStreams[d]}),a.apply(this,arguments)}}function sT(s,e){if(!s.RTCPeerConnection)return;if(s.RTCPeerConnection.prototype.addTrack&&e.version>=65)return rT(s);const t=s.RTCPeerConnection.prototype.getLocalStreams;s.RTCPeerConnection.prototype.getLocalStreams=function(){const v=t.apply(this);return this._reverseStreams=this._reverseStreams||{},v.map(x=>this._reverseStreams[x.id])};const n=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(v){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},v.getTracks().forEach(x=>{if(this.getSenders().find(A=>A.track===x))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[v.id]){const x=new s.MediaStream(v.getTracks());this._streams[v.id]=x,this._reverseStreams[x.id]=v,v=x}n.apply(this,[v])};const a=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(v){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[v.id]||v]),delete this._reverseStreams[this._streams[v.id]?this._streams[v.id].id:v.id],delete this._streams[v.id]},s.RTCPeerConnection.prototype.addTrack=function(v,x){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const E=[].slice.call(arguments,1);if(E.length!==1||!E[0].getTracks().find(F=>F===v))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(F=>F.track===v))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const O=this._streams[x.id];if(O)O.addTrack(v),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const F=new s.MediaStream([v]);this._streams[x.id]=F,this._reverseStreams[F.id]=x,this.addStream(F)}return this.getSenders().find(F=>F.track===v)};function l(g,v){let x=v.sdp;return Object.keys(g._reverseStreams||[]).forEach(E=>{const A=g._reverseStreams[E],O=g._streams[A.id];x=x.replace(new RegExp(O.id,"g"),A.id)}),new RTCSessionDescription({type:v.type,sdp:x})}function c(g,v){let x=v.sdp;return Object.keys(g._reverseStreams||[]).forEach(E=>{const A=g._reverseStreams[E],O=g._streams[A.id];x=x.replace(new RegExp(A.id,"g"),O.id)}),new RTCSessionDescription({type:v.type,sdp:x})}["createOffer","createAnswer"].forEach(function(g){const v=s.RTCPeerConnection.prototype[g],x={[g](){const E=arguments;return arguments.length&&typeof arguments[0]=="function"?v.apply(this,[O=>{const F=l(this,O);E[0].apply(null,[F])},O=>{E[1]&&E[1].apply(null,O)},arguments[2]]):v.apply(this,arguments).then(O=>l(this,O))}};s.RTCPeerConnection.prototype[g]=x[g]});const d=s.RTCPeerConnection.prototype.setLocalDescription;s.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?d.apply(this,arguments):(arguments[0]=c(this,arguments[0]),d.apply(this,arguments))};const p=Object.getOwnPropertyDescriptor(s.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(s.RTCPeerConnection.prototype,"localDescription",{get(){const g=p.get.apply(this);return g.type===""?g:l(this,g)}}),s.RTCPeerConnection.prototype.removeTrack=function(v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!v._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(v._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let E;Object.keys(this._streams).forEach(A=>{this._streams[A].getTracks().find(F=>v.track===F)&&(E=this._streams[A])}),E&&(E.getTracks().length===1?this.removeStream(this._reverseStreams[E.id]):E.removeTrack(v.track),this.dispatchEvent(new Event("negotiationneeded")))}}function _0(s,e){!s.RTCPeerConnection&&s.webkitRTCPeerConnection&&(s.RTCPeerConnection=s.webkitRTCPeerConnection),s.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=s.RTCPeerConnection.prototype[t],a={[t](){return arguments[0]=new(t==="addIceCandidate"?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};s.RTCPeerConnection.prototype[t]=a[t]})}function iT(s,e){$o(s,"negotiationneeded",t=>{const n=t.target;if(!((e.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return t})}const Iw=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:iT,shimAddTrackRemoveTrack:sT,shimAddTrackRemoveTrackWithNative:rT,shimGetSendersWithDtmf:tT,shimGetUserMedia:WE,shimMediaStream:ZE,shimOnTrack:eT,shimPeerConnection:_0,shimSenderReceiverGetStats:nT},Symbol.toStringTag,{value:"Module"}));function aT(s,e){const t=s&&s.navigator,n=s&&s.MediaStreamTrack;if(t.getUserMedia=function(a,l,c){by("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(a).then(l,c)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const a=function(c,d,p){d in c&&!(p in c)&&(c[p]=c[d],delete c[d])},l=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(c){return typeof c=="object"&&typeof c.audio=="object"&&(c=JSON.parse(JSON.stringify(c)),a(c.audio,"autoGainControl","mozAutoGainControl"),a(c.audio,"noiseSuppression","mozNoiseSuppression")),l(c)},n&&n.prototype.getSettings){const c=n.prototype.getSettings;n.prototype.getSettings=function(){const d=c.apply(this,arguments);return a(d,"mozAutoGainControl","autoGainControl"),a(d,"mozNoiseSuppression","noiseSuppression"),d}}if(n&&n.prototype.applyConstraints){const c=n.prototype.applyConstraints;n.prototype.applyConstraints=function(d){return this.kind==="audio"&&typeof d=="object"&&(d=JSON.parse(JSON.stringify(d)),a(d,"autoGainControl","mozAutoGainControl"),a(d,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[d])}}}}function vC(s,e){s.navigator.mediaDevices&&"getDisplayMedia"in s.navigator.mediaDevices||s.navigator.mediaDevices&&(s.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const a=new DOMException("getDisplayMedia without video constraints is undefined");return a.name="NotFoundError",a.code=8,Promise.reject(a)}return n.video===!0?n.video={mediaSource:e}:n.video.mediaSource=e,s.navigator.mediaDevices.getUserMedia(n)})}function oT(s){typeof s=="object"&&s.RTCTrackEvent&&"receiver"in s.RTCTrackEvent.prototype&&!("transceiver"in s.RTCTrackEvent.prototype)&&Object.defineProperty(s.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function w0(s,e){if(typeof s!="object"||!(s.RTCPeerConnection||s.mozRTCPeerConnection))return;!s.RTCPeerConnection&&s.mozRTCPeerConnection&&(s.RTCPeerConnection=s.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){const l=s.RTCPeerConnection.prototype[a],c={[a](){return arguments[0]=new(a==="addIceCandidate"?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};s.RTCPeerConnection.prototype[a]=c[a]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(){const[l,c,d]=arguments;return n.apply(this,[l||null]).then(p=>{if(e.version<53&&!c)try{p.forEach(g=>{g.type=t[g.type]||g.type})}catch(g){if(g.name!=="TypeError")throw g;p.forEach((v,x)=>{p.set(x,Object.assign({},v,{type:t[v.type]||v.type}))})}return p}).then(c,d)}}function lT(s){if(!(typeof s=="object"&&s.RTCPeerConnection&&s.RTCRtpSender)||s.RTCRtpSender&&"getStats"in s.RTCRtpSender.prototype)return;const e=s.RTCPeerConnection.prototype.getSenders;e&&(s.RTCPeerConnection.prototype.getSenders=function(){const a=e.apply(this,[]);return a.forEach(l=>l._pc=this),a});const t=s.RTCPeerConnection.prototype.addTrack;t&&(s.RTCPeerConnection.prototype.addTrack=function(){const a=t.apply(this,arguments);return a._pc=this,a}),s.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function cT(s){if(!(typeof s=="object"&&s.RTCPeerConnection&&s.RTCRtpSender)||s.RTCRtpSender&&"getStats"in s.RTCRtpReceiver.prototype)return;const e=s.RTCPeerConnection.prototype.getReceivers;e&&(s.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach(a=>a._pc=this),n}),$o(s,"track",t=>(t.receiver._pc=t.srcElement,t)),s.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function uT(s){!s.RTCPeerConnection||"removeStream"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.removeStream=function(t){by("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function hT(s){s.DataChannel&&!s.RTCDataChannel&&(s.RTCDataChannel=s.DataChannel)}function dT(s){if(!(typeof s=="object"&&s.RTCPeerConnection))return;const e=s.RTCPeerConnection.prototype.addTransceiver;e&&(s.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const a=n.length>0;a&&n.forEach(c=>{if("rid"in c&&!/^[a-z0-9]{0,16}$/i.test(c.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in c&&!(parseFloat(c.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in c&&!(parseFloat(c.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=e.apply(this,arguments);if(a){const{sender:c}=l,d=c.getParameters();(!("encodings"in d)||d.encodings.length===1&&Object.keys(d.encodings[0]).length===0)&&(d.encodings=n,c.sendEncodings=n,this.setParametersPromises.push(c.setParameters(d).then(()=>{delete c.sendEncodings}).catch(()=>{delete c.sendEncodings})))}return l})}function fT(s){if(!(typeof s=="object"&&s.RTCRtpSender))return;const e=s.RTCRtpSender.prototype.getParameters;e&&(s.RTCRtpSender.prototype.getParameters=function(){const n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function pT(s){if(!(typeof s=="object"&&s.RTCPeerConnection))return;const e=s.RTCPeerConnection.prototype.createOffer;s.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function mT(s){if(!(typeof s=="object"&&s.RTCPeerConnection))return;const e=s.RTCPeerConnection.prototype.createAnswer;s.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const Cw=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:dT,shimCreateAnswer:mT,shimCreateOffer:pT,shimGetDisplayMedia:vC,shimGetParameters:fT,shimGetUserMedia:aT,shimOnTrack:oT,shimPeerConnection:w0,shimRTCDataChannel:hT,shimReceiverGetStats:cT,shimRemoveStream:uT,shimSenderGetStats:lT},Symbol.toStringTag,{value:"Module"}));function gT(s){if(!(typeof s!="object"||!s.RTCPeerConnection)){if("getLocalStreams"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in s.RTCPeerConnection.prototype)){const e=s.RTCPeerConnection.prototype.addTrack;s.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(a=>e.call(this,a,n)),n.getVideoTracks().forEach(a=>e.call(this,a,n))},s.RTCPeerConnection.prototype.addTrack=function(n,...a){return a&&a.forEach(l=>{this._localStreams?this._localStreams.includes(l)||this._localStreams.push(l):this._localStreams=[l]}),e.apply(this,arguments)}}"removeStream"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);const a=t.getTracks();this.getSenders().forEach(l=>{a.includes(l.track)&&this.removeTrack(l)})})}}function yT(s){if(!(typeof s!="object"||!s.RTCPeerConnection)&&("getRemoteStreams"in s.RTCPeerConnection.prototype||(s.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in s.RTCPeerConnection.prototype))){Object.defineProperty(s.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(a=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(a))return;this._remoteStreams.push(a);const l=new Event("addstream");l.stream=a,this.dispatchEvent(l)})})}});const e=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(l=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(l)>=0)return;n._remoteStreams.push(l);const c=new Event("addstream");c.stream=l,n.dispatchEvent(c)})}),e.apply(n,arguments)}}}function vT(s){if(typeof s!="object"||!s.RTCPeerConnection)return;const e=s.RTCPeerConnection.prototype,t=e.createOffer,n=e.createAnswer,a=e.setLocalDescription,l=e.setRemoteDescription,c=e.addIceCandidate;e.createOffer=function(g,v){const x=arguments.length>=2?arguments[2]:arguments[0],E=t.apply(this,[x]);return v?(E.then(g,v),Promise.resolve()):E},e.createAnswer=function(g,v){const x=arguments.length>=2?arguments[2]:arguments[0],E=n.apply(this,[x]);return v?(E.then(g,v),Promise.resolve()):E};let d=function(p,g,v){const x=a.apply(this,[p]);return v?(x.then(g,v),Promise.resolve()):x};e.setLocalDescription=d,d=function(p,g,v){const x=l.apply(this,[p]);return v?(x.then(g,v),Promise.resolve()):x},e.setRemoteDescription=d,d=function(p,g,v){const x=c.apply(this,[p]);return v?(x.then(g,v),Promise.resolve()):x},e.addIceCandidate=d}function bT(s){const e=s&&s.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,n=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=a=>n(xT(a))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(n,a,l){e.mediaDevices.getUserMedia(n).then(a,l)}).bind(e))}function xT(s){return s&&s.video!==void 0?Object.assign({},s,{video:JE(s.video)}):s}function _T(s){if(!s.RTCPeerConnection)return;const e=s.RTCPeerConnection;s.RTCPeerConnection=function(n,a){if(n&&n.iceServers){const l=[];for(let c=0;c<n.iceServers.length;c++){let d=n.iceServers[c];d.urls===void 0&&d.url?(by("RTCIceServer.url","RTCIceServer.urls"),d=JSON.parse(JSON.stringify(d)),d.urls=d.url,delete d.url,l.push(d)):l.push(n.iceServers[c])}n.iceServers=l}return new e(n,a)},s.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(s.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function wT(s){typeof s=="object"&&s.RTCTrackEvent&&"receiver"in s.RTCTrackEvent.prototype&&!("transceiver"in s.RTCTrackEvent.prototype)&&Object.defineProperty(s.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ET(s){const e=s.RTCPeerConnection.prototype.createOffer;s.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const a=this.getTransceivers().find(c=>c.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):n.offerToReceiveAudio===!0&&!a&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const l=this.getTransceivers().find(c=>c.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):n.offerToReceiveVideo===!0&&!l&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function TT(s){typeof s!="object"||s.AudioContext||(s.AudioContext=s.webkitAudioContext)}const Rw=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:TT,shimCallbacksAPI:vT,shimConstraints:xT,shimCreateOfferLegacy:ET,shimGetUserMedia:bT,shimLocalStreamsAPI:gT,shimRTCIceServerUrls:_T,shimRemoteStreamsAPI:yT,shimTrackEventTransceiver:wT},Symbol.toStringTag,{value:"Module"}));var e0={exports:{}},kw;function bC(){return kw||(kw=1,(function(s){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(n=>n.trim())},e.splitSections=function(t){return t.split(`
m=`).map((a,l)=>(l>0?"m="+a:a).trim()+`\r
`)},e.getDescription=function(t){const n=e.splitSections(t);return n&&n[0]},e.getMediaSections=function(t){const n=e.splitSections(t);return n.shift(),n},e.matchPrefix=function(t,n){return e.splitLines(t).filter(a=>a.indexOf(n)===0)},e.parseCandidate=function(t){let n;t.indexOf("a=candidate:")===0?n=t.substring(12).split(" "):n=t.substring(10).split(" ");const a={foundation:n[0],component:{1:"rtp",2:"rtcp"}[n[1]]||n[1],protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]};for(let l=8;l<n.length;l+=2)switch(n[l]){case"raddr":a.relatedAddress=n[l+1];break;case"rport":a.relatedPort=parseInt(n[l+1],10);break;case"tcptype":a.tcpType=n[l+1];break;case"ufrag":a.ufrag=n[l+1],a.usernameFragment=n[l+1];break;default:a[n[l]]===void 0&&(a[n[l]]=n[l+1]);break}return a},e.writeCandidate=function(t){const n=[];n.push(t.foundation);const a=t.component;a==="rtp"?n.push(1):a==="rtcp"?n.push(2):n.push(a),n.push(t.protocol.toUpperCase()),n.push(t.priority),n.push(t.address||t.ip),n.push(t.port);const l=t.type;return n.push("typ"),n.push(l),l!=="host"&&t.relatedAddress&&t.relatedPort&&(n.push("raddr"),n.push(t.relatedAddress),n.push("rport"),n.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(n.push("ufrag"),n.push(t.usernameFragment||t.ufrag)),"candidate:"+n.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let n=t.substring(9).split(" ");const a={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),a.name=n[0],a.clockRate=parseInt(n[1],10),a.channels=n.length===3?parseInt(n[2],10):1,a.numChannels=a.channels,a},e.writeRtpMap=function(t){let n=t.payloadType;t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType);const a=t.channels||t.numChannels||1;return"a=rtpmap:"+n+" "+t.name+"/"+t.clockRate+(a!==1?"/"+a:"")+`\r
`},e.parseExtmap=function(t){const n=t.substring(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1],attributes:n.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const n={};let a;const l=t.substring(t.indexOf(" ")+1).split(";");for(let c=0;c<l.length;c++)a=l[c].trim().split("="),n[a[0].trim()]=a[1];return n},e.writeFmtp=function(t){let n="",a=t.payloadType;if(t.preferredPayloadType!==void 0&&(a=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const l=[];Object.keys(t.parameters).forEach(c=>{t.parameters[c]!==void 0?l.push(c+"="+t.parameters[c]):l.push(c)}),n+="a=fmtp:"+a+" "+l.join(";")+`\r
`}return n},e.parseRtcpFb=function(t){const n=t.substring(t.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},e.writeRtcpFb=function(t){let n="",a=t.payloadType;return t.preferredPayloadType!==void 0&&(a=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(l=>{n+="a=rtcp-fb:"+a+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),n},e.parseSsrcMedia=function(t){const n=t.indexOf(" "),a={ssrc:parseInt(t.substring(7,n),10)},l=t.indexOf(":",n);return l>-1?(a.attribute=t.substring(n+1,l),a.value=t.substring(l+1)):a.attribute=t.substring(n+1),a},e.parseSsrcGroup=function(t){const n=t.substring(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(a=>parseInt(a,10))}},e.getMid=function(t){const n=e.matchPrefix(t,"a=mid:")[0];if(n)return n.substring(6)},e.parseFingerprint=function(t){const n=t.substring(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1].toUpperCase()}},e.getDtlsParameters=function(t,n){return{role:"auto",fingerprints:e.matchPrefix(t+n,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,n){let a="a=setup:"+n+`\r
`;return t.fingerprints.forEach(l=>{a+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),a},e.parseCryptoLine=function(t){const n=t.substring(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const n=t.substring(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,n){return e.matchPrefix(t+n,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,n){const a=e.matchPrefix(t+n,"a=ice-ufrag:")[0],l=e.matchPrefix(t+n,"a=ice-pwd:")[0];return a&&l?{usernameFragment:a.substring(12),password:l.substring(10)}:null},e.writeIceParameters=function(t){let n="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(n+=`a=ice-lite\r
`),n},e.parseRtpParameters=function(t){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=e.splitLines(t)[0].split(" ");n.profile=l[2];for(let d=3;d<l.length;d++){const p=l[d],g=e.matchPrefix(t,"a=rtpmap:"+p+" ")[0];if(g){const v=e.parseRtpMap(g),x=e.matchPrefix(t,"a=fmtp:"+p+" ");switch(v.parameters=x.length?e.parseFmtp(x[0]):{},v.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+p+" ").map(e.parseRtcpFb),n.codecs.push(v),v.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(v.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(d=>{n.headerExtensions.push(e.parseExtmap(d))});const c=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return n.codecs.forEach(d=>{c.forEach(p=>{d.rtcpFeedback.find(v=>v.type===p.type&&v.parameter===p.parameter)||d.rtcpFeedback.push(p)})}),n},e.writeRtpDescription=function(t,n){let a="";a+="m="+t+" ",a+=n.codecs.length>0?"9":"0",a+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",a+=n.codecs.map(c=>c.preferredPayloadType!==void 0?c.preferredPayloadType:c.payloadType).join(" ")+`\r
`,a+=`c=IN IP4 0.0.0.0\r
`,a+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(c=>{a+=e.writeRtpMap(c),a+=e.writeFmtp(c),a+=e.writeRtcpFb(c)});let l=0;return n.codecs.forEach(c=>{c.maxptime>l&&(l=c.maxptime)}),l>0&&(a+="a=maxptime:"+l+`\r
`),n.headerExtensions&&n.headerExtensions.forEach(c=>{a+=e.writeExtmap(c)}),a},e.parseRtpEncodingParameters=function(t){const n=[],a=e.parseRtpParameters(t),l=a.fecMechanisms.indexOf("RED")!==-1,c=a.fecMechanisms.indexOf("ULPFEC")!==-1,d=e.matchPrefix(t,"a=ssrc:").map(E=>e.parseSsrcMedia(E)).filter(E=>E.attribute==="cname"),p=d.length>0&&d[0].ssrc;let g;const v=e.matchPrefix(t,"a=ssrc-group:FID").map(E=>E.substring(17).split(" ").map(O=>parseInt(O,10)));v.length>0&&v[0].length>1&&v[0][0]===p&&(g=v[0][1]),a.codecs.forEach(E=>{if(E.name.toUpperCase()==="RTX"&&E.parameters.apt){let A={ssrc:p,codecPayloadType:parseInt(E.parameters.apt,10)};p&&g&&(A.rtx={ssrc:g}),n.push(A),l&&(A=JSON.parse(JSON.stringify(A)),A.fec={ssrc:p,mechanism:c?"red+ulpfec":"red"},n.push(A))}}),n.length===0&&p&&n.push({ssrc:p});let x=e.matchPrefix(t,"b=");return x.length&&(x[0].indexOf("b=TIAS:")===0?x=parseInt(x[0].substring(7),10):x[0].indexOf("b=AS:")===0?x=parseInt(x[0].substring(5),10)*1e3*.95-2e3*8:x=void 0,n.forEach(E=>{E.maxBitrate=x})),n},e.parseRtcpParameters=function(t){const n={},a=e.matchPrefix(t,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname")[0];a&&(n.cname=a.value,n.ssrc=a.ssrc);const l=e.matchPrefix(t,"a=rtcp-rsize");n.reducedSize=l.length>0,n.compound=l.length===0;const c=e.matchPrefix(t,"a=rtcp-mux");return n.mux=c.length>0,n},e.writeRtcpParameters=function(t){let n="";return t.reducedSize&&(n+=`a=rtcp-rsize\r
`),t.mux&&(n+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(n+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),n},e.parseMsid=function(t){let n;const a=e.matchPrefix(t,"a=msid:");if(a.length===1)return n=a[0].substring(7).split(" "),{stream:n[0],track:n[1]};const l=e.matchPrefix(t,"a=ssrc:").map(c=>e.parseSsrcMedia(c)).filter(c=>c.attribute==="msid");if(l.length>0)return n=l[0].value.split(" "),{stream:n[0],track:n[1]}},e.parseSctpDescription=function(t){const n=e.parseMLine(t),a=e.matchPrefix(t,"a=max-message-size:");let l;a.length>0&&(l=parseInt(a[0].substring(19),10)),isNaN(l)&&(l=65536);const c=e.matchPrefix(t,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substring(12),10),protocol:n.fmt,maxMessageSize:l};const d=e.matchPrefix(t,"a=sctpmap:");if(d.length>0){const p=d[0].substring(10).split(" ");return{port:parseInt(p[0],10),protocol:p[1],maxMessageSize:l}}},e.writeSctpDescription=function(t,n){let a=[];return t.protocol!=="DTLS/SCTP"?a=["m="+t.kind+" 9 "+t.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:a=["m="+t.kind+" 9 "+t.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&a.push("a=max-message-size:"+n.maxMessageSize+`\r
`),a.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,n,a){let l;const c=n!==void 0?n:2;return t?l=t:l=e.generateSessionId(),`v=0\r
o=`+(a||"thisisadapterortc")+" "+l+" "+c+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,n){const a=e.splitLines(t);for(let l=0;l<a.length;l++)switch(a[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[l].substring(2)}return n?e.getDirection(n):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const a=e.splitLines(t)[0].substring(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}},e.parseOLine=function(t){const a=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const n=e.splitLines(t);for(let a=0;a<n.length;a++)if(n[a].length<2||n[a].charAt(1)!=="=")return!1;return!0},s.exports=e})(e0)),e0.exports}var ST=bC();const Yl=up(ST),xC=FI({__proto__:null,default:Yl},[ST]);function uf(s){if(!s.RTCIceCandidate||s.RTCIceCandidate&&"foundation"in s.RTCIceCandidate.prototype)return;const e=s.RTCIceCandidate;s.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substring(2)),n.candidate&&n.candidate.length){const a=new e(n),l=Yl.parseCandidate(n.candidate);for(const c in l)c in a||Object.defineProperty(a,c,{value:l[c]});return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new e(n)},s.RTCIceCandidate.prototype=e.prototype,$o(s,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new s.RTCIceCandidate(t.candidate),writable:"false"}),t))}function E0(s){!s.RTCIceCandidate||s.RTCIceCandidate&&"relayProtocol"in s.RTCIceCandidate.prototype||$o(s,"icecandidate",e=>{if(e.candidate){const t=Yl.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function hf(s,e){if(!s.RTCPeerConnection)return;"sctp"in s.RTCPeerConnection.prototype||Object.defineProperty(s.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(d){if(!d||!d.sdp)return!1;const p=Yl.splitSections(d.sdp);return p.shift(),p.some(g=>{const v=Yl.parseMLine(g);return v&&v.kind==="application"&&v.protocol.indexOf("SCTP")!==-1})},n=function(d){const p=d.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(p===null||p.length<2)return-1;const g=parseInt(p[1],10);return g!==g?-1:g},a=function(d){let p=65536;return e.browser==="firefox"&&(e.version<57?d===-1?p=16384:p=2147483637:e.version<60?p=e.version===57?65535:65536:p=2147483637),p},l=function(d,p){let g=65536;e.browser==="firefox"&&e.version===57&&(g=65535);const v=Yl.matchPrefix(d.sdp,"a=max-message-size:");return v.length>0?g=parseInt(v[0].substring(19),10):e.browser==="firefox"&&p!==-1&&(g=2147483637),g},c=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:p}=this.getConfiguration();p==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const p=n(arguments[0]),g=a(p),v=l(arguments[0],p);let x;g===0&&v===0?x=Number.POSITIVE_INFINITY:g===0||v===0?x=Math.max(g,v):x=Math.min(g,v);const E={};Object.defineProperty(E,"maxMessageSize",{get(){return x}}),this._sctp=E}return c.apply(this,arguments)}}function df(s){if(!(s.RTCPeerConnection&&"createDataChannel"in s.RTCPeerConnection.prototype))return;function e(n,a){const l=n.send;n.send=function(){const d=arguments[0],p=d.length||d.size||d.byteLength;if(n.readyState==="open"&&a.sctp&&p>a.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)");return l.apply(n,arguments)}}const t=s.RTCPeerConnection.prototype.createDataChannel;s.RTCPeerConnection.prototype.createDataChannel=function(){const a=t.apply(this,arguments);return e(a,this),a},$o(s,"datachannel",n=>(e(n.channel,n.target),n))}function T0(s){if(!s.RTCPeerConnection||"connectionState"in s.RTCPeerConnection.prototype)return;const e=s.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const n=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=a=>{const l=a.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const c=new Event("connectionstatechange",a);l.dispatchEvent(c)}return a},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function S0(s,e){if(!s.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=s.RTCPeerConnection.prototype.setRemoteDescription;s.RTCPeerConnection.prototype.setRemoteDescription=function(a){if(a&&a.sdp&&a.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=a.sdp.split(`
`).filter(c=>c.trim()!=="a=extmap-allow-mixed").join(`
`);s.RTCSessionDescription&&a instanceof s.RTCSessionDescription?arguments[0]=new s.RTCSessionDescription({type:a.type,sdp:l}):a.sdp=l}return t.apply(this,arguments)}}function ff(s,e){if(!(s.RTCPeerConnection&&s.RTCPeerConnection.prototype))return;const t=s.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(s.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function pf(s,e){if(!(s.RTCPeerConnection&&s.RTCPeerConnection.prototype))return;const t=s.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(s.RTCPeerConnection.prototype.setLocalDescription=function(){let a=arguments[0]||{};if(typeof a!="object"||a.type&&a.sdp)return t.apply(this,arguments);if(a={type:a.type,sdp:a.sdp},!a.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":a.type="offer";break;default:a.type="answer";break}return a.sdp||a.type!=="offer"&&a.type!=="answer"?t.apply(this,[a]):(a.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(c=>t.apply(this,[c]))})}const _C=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:S0,shimAddIceCandidateNullOrEmpty:ff,shimConnectionState:T0,shimMaxMessageSize:hf,shimParameterlessSetLocalDescription:pf,shimRTCIceCandidate:uf,shimRTCIceCandidateRelayProtocol:E0,shimSendThrowTypeError:df},Symbol.toStringTag,{value:"Module"}));function wC({window:s}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=XE,n=yC(s),a={browserDetails:n,commonShim:_C,extractVersion:Ou,disableLog:mC,disableWarnings:gC,sdp:xC};switch(n.browser){case"chrome":if(!Iw||!_0||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),a;if(n.version===null)return t("Chrome shim can not determine version, not shimming."),a;t("adapter.js shimming chrome."),a.browserShim=Iw,ff(s,n),pf(s),WE(s,n),ZE(s),_0(s,n),eT(s),sT(s,n),tT(s),nT(s),iT(s,n),uf(s),E0(s),T0(s),hf(s,n),df(s),S0(s,n);break;case"firefox":if(!Cw||!w0||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),a;t("adapter.js shimming firefox."),a.browserShim=Cw,ff(s,n),pf(s),aT(s,n),w0(s,n),oT(s),uT(s),lT(s),cT(s),hT(s),dT(s),fT(s),pT(s),mT(s),uf(s),T0(s),hf(s,n),df(s);break;case"safari":if(!Rw||!e.shimSafari)return t("Safari shim is not included in this adapter release."),a;t("adapter.js shimming safari."),a.browserShim=Rw,ff(s,n),pf(s),_T(s),ET(s),vT(s),gT(s),yT(s),wT(s),bT(s),TT(s),uf(s),E0(s),hf(s,n),df(s),S0(s,n);break;default:t("Unsupported browser!");break}return a}const Dw=wC({window:typeof window>"u"?void 0:window});function Ko(s,e,t,n){Object.defineProperty(s,e,{get:t,set:n,enumerable:!0,configurable:!0})}class NT{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const t=[],n=e.byteLength,a=Math.ceil(n/this.chunkedMTU);let l=0,c=0;for(;c<n;){const d=Math.min(n,c+this.chunkedMTU),p=e.slice(c,d),g={__peerData:this._dataCount,n:l,data:p,total:a};t.push(g),c=d,l++}return this._dataCount++,t}}}function EC(s){let e=0;for(const a of s)e+=a.byteLength;const t=new Uint8Array(e);let n=0;for(const a of s)t.set(a,n),n+=a.byteLength;return t}const t0=Dw.default||Dw,Tu=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const s=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(s)?s==="chrome"?e>=this.minChromeVersion:s==="firefox"?e>=this.minFirefoxVersion:s==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return t0.browserDetails.browser}getVersion(){return t0.browserDetails.version||0}isUnifiedPlanSupported(){const s=this.getBrowser(),e=t0.browserDetails.version||0;if(s==="chrome"&&e<this.minChromeVersion)return!1;if(s==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,n=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),n=!0}catch{}finally{t&&t.close()}return n}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},TC=s=>!s||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(s),AT=()=>Math.random().toString(36).slice(2),jw={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class SC extends NT{noop(){}blobToArrayBuffer(e,t){const n=new FileReader;return n.onload=function(a){a.target&&t(a.target.result)},n.readAsArrayBuffer(e),n}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=jw,this.browser=Tu.getBrowser(),this.browserVersion=Tu.getVersion(),this.pack=KE,this.unpack=$E,this.supports=(function(){const t={browser:Tu.isBrowserSupported(),webRTC:Tu.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let n;try{n=new RTCPeerConnection(jw),t.audioVideo=!0;let a;try{a=n.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!a.ordered;try{a.binaryType="blob",t.binaryBlob=!Tu.isIOS}catch{}}catch{}finally{a&&a.close()}}catch{}finally{n&&n.close()}return t})(),this.validateId=TC,this.randomToken=AT}}const pr=new SC,NC="PeerJS: ";class AC{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const n=[NC,...t];for(const a in n)n[a]instanceof Error&&(n[a]="("+n[a].name+") "+n[a].message);e>=3?console.log(...n):e>=2?console.warn("WARNING",...n):e>=1&&console.error("ERROR",...n)}constructor(){this._logLevel=0}}var Te=new AC,xy={},IC=Object.prototype.hasOwnProperty,nr="~";function rh(){}Object.create&&(rh.prototype=Object.create(null),new rh().__proto__||(nr=!1));function CC(s,e,t){this.fn=s,this.context=e,this.once=t||!1}function IT(s,e,t,n,a){if(typeof t!="function")throw new TypeError("The listener must be a function");var l=new CC(t,n||s,a),c=nr?nr+e:e;return s._events[c]?s._events[c].fn?s._events[c]=[s._events[c],l]:s._events[c].push(l):(s._events[c]=l,s._eventsCount++),s}function mf(s,e){--s._eventsCount===0?s._events=new rh:delete s._events[e]}function Yn(){this._events=new rh,this._eventsCount=0}Yn.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)IC.call(t,n)&&e.push(nr?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};Yn.prototype.listeners=function(e){var t=nr?nr+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,l=n.length,c=new Array(l);a<l;a++)c[a]=n[a].fn;return c};Yn.prototype.listenerCount=function(e){var t=nr?nr+e:e,n=this._events[t];return n?n.fn?1:n.length:0};Yn.prototype.emit=function(e,t,n,a,l,c){var d=nr?nr+e:e;if(!this._events[d])return!1;var p=this._events[d],g=arguments.length,v,x;if(p.fn){switch(p.once&&this.removeListener(e,p.fn,void 0,!0),g){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,t),!0;case 3:return p.fn.call(p.context,t,n),!0;case 4:return p.fn.call(p.context,t,n,a),!0;case 5:return p.fn.call(p.context,t,n,a,l),!0;case 6:return p.fn.call(p.context,t,n,a,l,c),!0}for(x=1,v=new Array(g-1);x<g;x++)v[x-1]=arguments[x];p.fn.apply(p.context,v)}else{var E=p.length,A;for(x=0;x<E;x++)switch(p[x].once&&this.removeListener(e,p[x].fn,void 0,!0),g){case 1:p[x].fn.call(p[x].context);break;case 2:p[x].fn.call(p[x].context,t);break;case 3:p[x].fn.call(p[x].context,t,n);break;case 4:p[x].fn.call(p[x].context,t,n,a);break;default:if(!v)for(A=1,v=new Array(g-1);A<g;A++)v[A-1]=arguments[A];p[x].fn.apply(p[x].context,v)}}return!0};Yn.prototype.on=function(e,t,n){return IT(this,e,t,n,!1)};Yn.prototype.once=function(e,t,n){return IT(this,e,t,n,!0)};Yn.prototype.removeListener=function(e,t,n,a){var l=nr?nr+e:e;if(!this._events[l])return this;if(!t)return mf(this,l),this;var c=this._events[l];if(c.fn)c.fn===t&&(!a||c.once)&&(!n||c.context===n)&&mf(this,l);else{for(var d=0,p=[],g=c.length;d<g;d++)(c[d].fn!==t||a&&!c[d].once||n&&c[d].context!==n)&&p.push(c[d]);p.length?this._events[l]=p.length===1?p[0]:p:mf(this,l)}return this};Yn.prototype.removeAllListeners=function(e){var t;return e?(t=nr?nr+e:e,this._events[t]&&mf(this,t)):(this._events=new rh,this._eventsCount=0),this};Yn.prototype.off=Yn.prototype.removeListener;Yn.prototype.addListener=Yn.prototype.on;Yn.prefixed=nr;Yn.EventEmitter=Yn;xy=Yn;var Qo={};Ko(Qo,"ConnectionType",()=>Ia);Ko(Qo,"PeerErrorType",()=>vn);Ko(Qo,"BaseConnectionErrorType",()=>N0);Ko(Qo,"DataConnectionErrorType",()=>_y);Ko(Qo,"SerializationType",()=>hp);Ko(Qo,"SocketEventType",()=>Sa);Ko(Qo,"ServerMessageType",()=>qn);var Ia=(function(s){return s.Data="data",s.Media="media",s})({}),vn=(function(s){return s.BrowserIncompatible="browser-incompatible",s.Disconnected="disconnected",s.InvalidID="invalid-id",s.InvalidKey="invalid-key",s.Network="network",s.PeerUnavailable="peer-unavailable",s.SslUnavailable="ssl-unavailable",s.ServerError="server-error",s.SocketError="socket-error",s.SocketClosed="socket-closed",s.UnavailableID="unavailable-id",s.WebRTC="webrtc",s})({}),N0=(function(s){return s.NegotiationFailed="negotiation-failed",s.ConnectionClosed="connection-closed",s})({}),_y=(function(s){return s.NotOpenYet="not-open-yet",s.MessageToBig="message-too-big",s})({}),hp=(function(s){return s.Binary="binary",s.BinaryUTF8="binary-utf8",s.JSON="json",s.None="raw",s})({}),Sa=(function(s){return s.Message="message",s.Disconnected="disconnected",s.Error="error",s.Close="close",s})({}),qn=(function(s){return s.Heartbeat="HEARTBEAT",s.Candidate="CANDIDATE",s.Offer="OFFER",s.Answer="ANSWER",s.Open="OPEN",s.Error="ERROR",s.IdTaken="ID-TAKEN",s.InvalidKey="INVALID-KEY",s.Leave="LEAVE",s.Expire="EXPIRE",s})({});const CT="1.5.5";class RC extends xy.EventEmitter{constructor(e,t,n,a,l,c=5e3){super(),this.pingInterval=c,this._disconnected=!0,this._messagesQueue=[];const d=e?"wss://":"ws://";this._baseUrl=d+t+":"+n+a+"peerjs?key="+l}start(e,t){this._id=e;const n=`${this._baseUrl}&id=${e}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(n+"&version="+CT),this._disconnected=!1,this._socket.onmessage=a=>{let l;try{l=JSON.parse(a.data),Te.log("Server message received:",l)}catch{Te.log("Invalid server message",a.data);return}this.emit(Sa.Message,l)},this._socket.onclose=a=>{this._disconnected||(Te.log("Socket closed.",a),this._cleanup(),this._disconnected=!0,this.emit(Sa.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),Te.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){Te.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:qn.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(Sa.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class RT{constructor(e){this.connection=e}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===Ia.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){const n=this.connection,a={ordered:!!e.reliable},l=t.createDataChannel(n.label,a);n._initializeDataChannel(l),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){Te.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,n=this.connection.connectionId,a=this.connection.type,l=this.connection.provider;Te.log("Listening for ICE candidates."),e.onicecandidate=c=>{!c.candidate||!c.candidate.candidate||(Te.log(`Received ICE candidates for ${t}:`,c.candidate),l.socket.send({type:qn.Candidate,payload:{candidate:c.candidate,type:a,connectionId:n},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":Te.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(N0.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":Te.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(N0.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":Te.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},Te.log("Listening for data channel"),e.ondatachannel=c=>{Te.log("Received data channel");const d=c.channel;l.getConnection(t,n)._initializeDataChannel(d)},Te.log("Listening for remote stream"),e.ontrack=c=>{Te.log("Received remote stream");const d=c.streams[0],p=l.getConnection(t,n);if(p.type===Ia.Media){const g=p;this._addStreamToMediaConnection(d,g)}}}cleanup(){Te.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const t=e.signalingState!=="closed";let n=!1;const a=this.connection.dataChannel;a&&(n=!!a.readyState&&a.readyState!=="closed"),(t||n)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const n=await e.createOffer(this.connection.options.constraints);Te.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await e.setLocalDescription(n),Te.log("Set localDescription:",n,`for:${this.connection.peer}`);let a={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===Ia.Data){const l=this.connection;a={...a,label:l.label,reliable:l.reliable,serialization:l.serialization}}t.socket.send({type:qn.Offer,payload:a,dst:this.connection.peer})}catch(a){a!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(vn.WebRTC,a),Te.log("Failed to setLocalDescription, ",a))}}catch(n){t.emitError(vn.WebRTC,n),Te.log("Failed to createOffer, ",n)}}async _makeAnswer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const n=await e.createAnswer();Te.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await e.setLocalDescription(n),Te.log("Set localDescription:",n,`for:${this.connection.peer}`),t.socket.send({type:qn.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(a){t.emitError(vn.WebRTC,a),Te.log("Failed to setLocalDescription, ",a)}}catch(n){t.emitError(vn.WebRTC,n),Te.log("Failed to create answer, ",n)}}async handleSDP(e,t){t=new RTCSessionDescription(t);const n=this.connection.peerConnection,a=this.connection.provider;Te.log("Setting remote description",t);const l=this;try{await n.setRemoteDescription(t),Te.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await l._makeAnswer()}catch(c){a.emitError(vn.WebRTC,c),Te.log("Failed to setRemoteDescription, ",c)}}async handleCandidate(e){Te.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),Te.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(vn.WebRTC,t),Te.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(e,t){if(Te.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return Te.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(n=>{t.addTrack(n,e)})}_addStreamToMediaConnection(e,t){Te.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}}class kT extends xy.EventEmitter{emitError(e,t){Te.error("Error:",t),this.emit("error",new kC(`${e}`,t))}}class kC extends Error{constructor(e,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=e}}class DT extends kT{get open(){return this._open}constructor(e,t,n){super(),this.peer=e,this.provider=t,this.options=n,this._open=!1,this.metadata=n.metadata}}var my;const th=class th extends DT{get type(){return Ia.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,n){super(e,t,n),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||th.ID_PREFIX+pr.randomToken(),this._negotiator=new RT(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Te.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{Te.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){Te.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,n=e.payload;switch(e.type){case qn.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case qn.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:Te.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(e,t={}){if(this._localStream){Te.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const n=this.provider._getMessages(this.connectionId);for(const a of n)this.handleMessage(a);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};my=new WeakMap,_u(th,my,th.ID_PREFIX="mc_");let jf=th;class DC{constructor(e){this._options=e}_buildRequest(e){const t=this._options.secure?"https":"http",{host:n,port:a,path:l,key:c}=this._options,d=new URL(`${t}://${n}:${a}${l}${c}/${e}`);return d.searchParams.set("ts",`${Date.now()}${Math.random()}`),d.searchParams.set("version",CT),fetch(d.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){Te.error("Error retrieving ID",e);let t="";throw this._options.path==="/"&&this._options.host!==pr.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let t="";throw this._options.host===pr.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw Te.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}var gy,yy;const Ao=class Ao extends DT{get type(){return Ia.Data}constructor(e,t,n){super(e,t,n),this.connectionId=this.options.connectionId||Ao.ID_PREFIX+AT(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new RT(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Te.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{Te.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{Te.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t=!1){if(!this.open){this.emitError(_y.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,t)}async handleMessage(e){const t=e.payload;switch(e.type){case qn.Answer:await this._negotiator.handleSDP(e.type,t.sdp);break;case qn.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:Te.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}};gy=new WeakMap,yy=new WeakMap,_u(Ao,gy,Ao.ID_PREFIX="dc_"),_u(Ao,yy,Ao.MAX_BUFFERED_AMOUNT=8388608);let Of=Ao;class wy extends Of{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>Of.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(t){return Te.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class n0 extends wy{close(e){super.close(e),this._chunkedData={}}constructor(e,t,n){super(e,t,n),this.chunker=new NT,this.serialization=hp.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const t=$E(e),n=t.__peerData;if(n){if(n.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(e){const t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=new Uint8Array(e.data),n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];const a=EC(n.data);this._handleDataMessage({data:a})}}_send(e,t){const n=KE(e);if(n instanceof Promise)return this._send_blob(n);if(!t&&n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}async _send_blob(e){const t=await e;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(e){const t=this.chunker.chunk(e);Te.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const n of t)this.send(n,!0)}}class jC extends wy{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,t){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=hp.None}}class OC extends wy{_handleDataMessage({data:e}){const t=this.parse(this.decoder.decode(e)),n=t.__peerData;if(n&&n.type==="close"){this.close();return}this.emit("data",t)}_send(e,t){const n=this.encoder.encode(this.stringify(e));if(n.byteLength>=pr.chunkedMTU){this.emitError(_y.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(n)}constructor(...e){super(...e),this.serialization=hp.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}var vy;const nh=class nh extends kT{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[t,n]of this._connections)e[t]=n;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,t){super(),this._serializers={raw:jC,json:OC,binary:n0,"binary-utf8":n0,default:n0},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let n;if(e&&e.constructor==Object?t=e:e&&(n=e.toString()),t={debug:0,host:pr.CLOUD_HOST,port:pr.CLOUD_PORT,path:"/",key:nh.DEFAULT_KEY,token:pr.randomToken(),config:pr.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==pr.CLOUD_HOST?this._options.secure=pr.isSecure():this._options.host==pr.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&Te.setLogFunction(this._options.logFunction),Te.logLevel=this._options.debug||0,this._api=new DC(t),this._socket=this._createServerConnection(),!pr.supports.audioVideo&&!pr.supports.data){this._delayedAbort(vn.BrowserIncompatible,"The current browser does not support WebRTC");return}if(n&&!pr.validateId(n)){this._delayedAbort(vn.InvalidID,`ID "${n}" is invalid`);return}n?this._initialize(n):this._api.retrieveId().then(a=>this._initialize(a)).catch(a=>this._abort(vn.ServerError,a))}_createServerConnection(){const e=new RC(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(Sa.Message,t=>{this._handleMessage(t)}),e.on(Sa.Error,t=>{this._abort(vn.SocketError,t)}),e.on(Sa.Disconnected,()=>{this.disconnected||(this.emitError(vn.Network,"Lost connection to server."),this.disconnect())}),e.on(Sa.Close,()=>{this.disconnected||this._abort(vn.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const t=e.type,n=e.payload,a=e.src;switch(t){case qn.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case qn.Error:this._abort(vn.ServerError,n.msg);break;case qn.IdTaken:this._abort(vn.UnavailableID,`ID "${this.id}" is taken`);break;case qn.InvalidKey:this._abort(vn.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case qn.Leave:Te.log(`Received leave message from ${a}`),this._cleanupPeer(a),this._connections.delete(a);break;case qn.Expire:this.emitError(vn.PeerUnavailable,`Could not connect to peer ${a}`);break;case qn.Offer:{const l=n.connectionId;let c=this.getConnection(a,l);if(c&&(c.close(),Te.warn(`Offer received for existing Connection ID:${l}`)),n.type===Ia.Media){const p=new jf(a,this,{connectionId:l,_payload:n,metadata:n.metadata});c=p,this._addConnection(a,c),this.emit("call",p)}else if(n.type===Ia.Data){const p=new this._serializers[n.serialization](a,this,{connectionId:l,_payload:n,metadata:n.metadata,label:n.label,serialization:n.serialization,reliable:n.reliable});c=p,this._addConnection(a,c),this.emit("connection",p)}else{Te.warn(`Received malformed connection type:${n.type}`);return}const d=this._getMessages(l);for(const p of d)c.handleMessage(p);break}default:{if(!n){Te.warn(`You received a malformed message from ${a} of type ${t}`);return}const l=n.connectionId,c=this.getConnection(a,l);c&&c.peerConnection?c.handleMessage(e):l?this._storeMessage(l,e):Te.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(t={serialization:"default",...t},this.disconnected){Te.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(vn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const n=new this._serializers[t.serialization](e,this,t);return this._addConnection(e,n),n}call(e,t,n={}){if(this.disconnected){Te.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(vn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){Te.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const a=new jf(e,this,{...n,_stream:t});return this._addConnection(e,a),a}_addConnection(e,t){Te.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const n=t.indexOf(e);n!==-1&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const n=this._connections.get(e);if(!n)return null;for(const a of n)if(a.connectionId===t)return a;return null}_delayedAbort(e,t){setTimeout(()=>{this._abort(e,t)},0)}_abort(e,t){Te.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(Te.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(const n of t)n.close()}disconnect(){if(this.disconnected)return;const e=this.id;Te.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)Te.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Te.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=t=>{}){this._api.listAllPeers().then(t=>e(t)).catch(t=>this._abort(vn.ServerError,t))}};vy=new WeakMap,_u(nh,vy,nh.DEFAULT_KEY="peerjs");let Pf=nh;const PC=()=>{};var Ow={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT=function(s){const e=[];let t=0;for(let n=0;n<s.length;n++){let a=s.charCodeAt(n);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&n+1<s.length&&(s.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++n)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},MC=function(s){const e=[];let t=0,n=0;for(;t<s.length;){const a=s[t++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const l=s[t++];e[n++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=s[t++],c=s[t++],d=s[t++],p=((a&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[n++]=String.fromCharCode(55296+(p>>10)),e[n++]=String.fromCharCode(56320+(p&1023))}else{const l=s[t++],c=s[t++];e[n++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},OT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<s.length;a+=3){const l=s[a],c=a+1<s.length,d=c?s[a+1]:0,p=a+2<s.length,g=p?s[a+2]:0,v=l>>2,x=(l&3)<<4|d>>4;let E=(d&15)<<2|g>>6,A=g&63;p||(A=64,c||(E=64)),n.push(t[v],t[x],t[E],t[A])}return n.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(jT(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):MC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<s.length;){const l=t[s.charAt(a++)],d=a<s.length?t[s.charAt(a)]:0;++a;const g=a<s.length?t[s.charAt(a)]:64;++a;const x=a<s.length?t[s.charAt(a)]:64;if(++a,l==null||d==null||g==null||x==null)throw new VC;const E=l<<2|d>>4;if(n.push(E),g!==64){const A=d<<4&240|g>>2;if(n.push(A),x!==64){const O=g<<6&192|x;n.push(O)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class VC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LC=function(s){const e=jT(s);return OT.encodeByteArray(e,!0)},PT=function(s){return LC(s).replace(/\./g,"")},MT=function(s){try{return OT.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=()=>VT().__FIREBASE_DEFAULTS__,zC=()=>{if(typeof process>"u"||typeof Ow>"u")return;const s=Ow.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},BC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&MT(s[1]);return e&&JSON.parse(e)},dp=()=>{try{return PC()||UC()||zC()||BC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},FC=s=>{var e,t;return(t=(e=dp())==null?void 0:e.emulatorHosts)==null?void 0:t[s]},LT=()=>{var s;return(s=dp())==null?void 0:s.config},UT=s=>{var e;return(e=dp())==null?void 0:e[`_${s}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wc(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function zT(s){return(await fetch(s,{credentials:"include"})).ok}const Fu={};function qC(){const s={prod:[],emulator:[]};for(const e of Object.keys(Fu))Fu[e]?s.emulator.push(e):s.prod.push(e);return s}function HC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let Pw=!1;function $C(s,e){if(typeof window>"u"||typeof document>"u"||!wc(window.location.host)||Fu[s]===e||Fu[s]||Pw)return;Fu[s]=e;function t(E){return`__firebase__banner__${E}`}const n="__firebase__banner",l=qC().prod.length>0;function c(){const E=document.getElementById(n);E&&E.remove()}function d(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function p(E,A){E.setAttribute("width","24"),E.setAttribute("id",A),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function g(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Pw=!0,c()},E}function v(E,A){E.setAttribute("id",A),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function x(){const E=HC(n),A=t("text"),O=document.getElementById(A)||document.createElement("span"),F=t("learnmore"),J=document.getElementById(F)||document.createElement("a"),se=t("preprendIcon"),ce=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const le=E.element;d(le),v(J,F);const me=g();p(ce,se),le.append(ce,O,J,me),document.body.appendChild(le)}l?(O.innerText="Preview backend disconnected.",ce.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ce.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,O.innerText="Preview backend running in this workspace."),O.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function KC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wn())}function BT(){var e;const s=(e=dp())==null?void 0:e.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function YC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function XC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JC(){const s=wn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function FT(){return!BT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function GT(){return!BT()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function qT(){try{return typeof indexedDB=="object"}catch{return!1}}function WC(){return new Promise((s,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(n),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="FirebaseError";class Ci extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=ZC,Object.setPrototypeOf(this,Ci.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Eh.prototype.create)}}class Eh{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?eR(l,n):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new Ci(a,d,n)}}function eR(s,e){return s.replace(tR,(t,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const tR=/\{\$([^}]+)}/g;function nR(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Oo(s,e){if(s===e)return!0;const t=Object.keys(s),n=Object.keys(e);for(const a of t){if(!n.includes(a))return!1;const l=s[a],c=e[a];if(Mw(l)&&Mw(c)){if(!Oo(l,c))return!1}else if(l!==c)return!1}for(const a of n)if(!t.includes(a))return!1;return!0}function Mw(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(s){const e=[];for(const[t,n]of Object.entries(s))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Pu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,l]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Mu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function rR(s,e){const t=new sR(s,e);return t.subscribe.bind(t)}class sR{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let a;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");iR(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:n},a.next===void 0&&(a.next=r0),a.error===void 0&&(a.error=r0),a.complete===void 0&&(a.complete=r0);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function iR(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function r0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(s){return s&&s._delegate?s._delegate:s}class Po{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new GC;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lR(e))try{this.getOrInitializeService({instanceIdentifier:xo})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});n.resolve(l)}catch{}}}}clearInstance(e=xo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xo){return this.instances.has(e)}getOptions(e=xo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);n===d&&c.resolve(a)}return a}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const l=this.instances.get(n);return l&&e(l,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:oR(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=xo){return this.component?this.component.multipleInstances?e:xo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function oR(s){return s===xo?void 0:s}function lR(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new aR(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(rt||(rt={}));const uR={debug:rt.DEBUG,verbose:rt.VERBOSE,info:rt.INFO,warn:rt.WARN,error:rt.ERROR,silent:rt.SILENT},hR=rt.INFO,dR={[rt.DEBUG]:"log",[rt.VERBOSE]:"log",[rt.INFO]:"info",[rt.WARN]:"warn",[rt.ERROR]:"error"},fR=(s,e,...t)=>{if(e<s.logLevel)return;const n=new Date().toISOString(),a=dR[e];if(a)console[a](`[${n}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ey{constructor(e){this.name=e,this._logLevel=hR,this._logHandler=fR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in rt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?uR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,rt.DEBUG,...e),this._logHandler(this,rt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,rt.VERBOSE,...e),this._logHandler(this,rt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,rt.INFO,...e),this._logHandler(this,rt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,rt.WARN,...e),this._logHandler(this,rt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,rt.ERROR,...e),this._logHandler(this,rt.ERROR,...e)}}const pR=(s,e)=>e.some(t=>s instanceof t);let Vw,Lw;function mR(){return Vw||(Vw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gR(){return Lw||(Lw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HT=new WeakMap,A0=new WeakMap,$T=new WeakMap,s0=new WeakMap,Ty=new WeakMap;function yR(s){const e=new Promise((t,n)=>{const a=()=>{s.removeEventListener("success",l),s.removeEventListener("error",c)},l=()=>{t(Ca(s.result)),a()},c=()=>{n(s.error),a()};s.addEventListener("success",l),s.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&HT.set(t,s)}).catch(()=>{}),Ty.set(e,s),e}function vR(s){if(A0.has(s))return;const e=new Promise((t,n)=>{const a=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",c),s.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{n(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",l),s.addEventListener("error",c),s.addEventListener("abort",c)});A0.set(s,e)}let I0={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return A0.get(s);if(e==="objectStoreNames")return s.objectStoreNames||$T.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ca(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function bR(s){I0=s(I0)}function xR(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=s.call(i0(this),e,...t);return $T.set(n,e.sort?e.sort():[e]),Ca(n)}:gR().includes(s)?function(...e){return s.apply(i0(this),e),Ca(HT.get(this))}:function(...e){return Ca(s.apply(i0(this),e))}}function _R(s){return typeof s=="function"?xR(s):(s instanceof IDBTransaction&&vR(s),pR(s,mR())?new Proxy(s,I0):s)}function Ca(s){if(s instanceof IDBRequest)return yR(s);if(s0.has(s))return s0.get(s);const e=_R(s);return e!==s&&(s0.set(s,e),Ty.set(e,s)),e}const i0=s=>Ty.get(s);function wR(s,e,{blocked:t,upgrade:n,blocking:a,terminated:l}={}){const c=indexedDB.open(s,e),d=Ca(c);return n&&c.addEventListener("upgradeneeded",p=>{n(Ca(c.result),p.oldVersion,p.newVersion,Ca(c.transaction),p)}),t&&c.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),d.then(p=>{l&&p.addEventListener("close",()=>l()),a&&p.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),d}const ER=["get","getKey","getAll","getAllKeys","count"],TR=["put","add","delete","clear"],a0=new Map;function Uw(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(a0.get(e))return a0.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,a=TR.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(a||ER.includes(t)))return;const l=async function(c,...d){const p=this.transaction(c,a?"readwrite":"readonly");let g=p.store;return n&&(g=g.index(d.shift())),(await Promise.all([g[t](...d),a&&p.done]))[0]};return a0.set(e,l),l}bR(s=>({...s,get:(e,t,n)=>Uw(e,t)||s.get(e,t,n),has:(e,t)=>!!Uw(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(NR(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function NR(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const C0="@firebase/app",zw="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti=new Ey("@firebase/app"),AR="@firebase/app-compat",IR="@firebase/analytics-compat",CR="@firebase/analytics",RR="@firebase/app-check-compat",kR="@firebase/app-check",DR="@firebase/auth",jR="@firebase/auth-compat",OR="@firebase/database",PR="@firebase/data-connect",MR="@firebase/database-compat",VR="@firebase/functions",LR="@firebase/functions-compat",UR="@firebase/installations",zR="@firebase/installations-compat",BR="@firebase/messaging",FR="@firebase/messaging-compat",GR="@firebase/performance",qR="@firebase/performance-compat",HR="@firebase/remote-config",$R="@firebase/remote-config-compat",KR="@firebase/storage",QR="@firebase/storage-compat",YR="@firebase/firestore",XR="@firebase/ai",JR="@firebase/firestore-compat",WR="firebase",ZR="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0="[DEFAULT]",ek={[C0]:"fire-core",[AR]:"fire-core-compat",[CR]:"fire-analytics",[IR]:"fire-analytics-compat",[kR]:"fire-app-check",[RR]:"fire-app-check-compat",[DR]:"fire-auth",[jR]:"fire-auth-compat",[OR]:"fire-rtdb",[PR]:"fire-data-connect",[MR]:"fire-rtdb-compat",[VR]:"fire-fn",[LR]:"fire-fn-compat",[UR]:"fire-iid",[zR]:"fire-iid-compat",[BR]:"fire-fcm",[FR]:"fire-fcm-compat",[GR]:"fire-perf",[qR]:"fire-perf-compat",[HR]:"fire-rc",[$R]:"fire-rc-compat",[KR]:"fire-gcs",[QR]:"fire-gcs-compat",[YR]:"fire-fst",[JR]:"fire-fst-compat",[XR]:"fire-vertex","fire-js":"fire-js",[WR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf=new Map,tk=new Map,k0=new Map;function Bw(s,e){try{s.container.addComponent(e)}catch(t){Ti.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function nc(s){const e=s.name;if(k0.has(e))return Ti.debug(`There were multiple attempts to register component ${e}.`),!1;k0.set(e,s);for(const t of Mf.values())Bw(t,s);for(const t of tk.values())Bw(t,s);return!0}function Sy(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function rs(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ra=new Eh("app","Firebase",nk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Po("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ra.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ec=ZR;function KT(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const n={name:R0,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw Ra.create("bad-app-name",{appName:String(a)});if(t||(t=LT()),!t)throw Ra.create("no-options");const l=Mf.get(a);if(l){if(Oo(t,l.options)&&Oo(n,l.config))return l;throw Ra.create("duplicate-app",{appName:a})}const c=new cR(a);for(const p of k0.values())c.addComponent(p);const d=new rk(t,n,c);return Mf.set(a,d),d}function sk(s=R0){const e=Mf.get(s);if(!e&&s===R0&&LT())return KT();if(!e)throw Ra.create("no-app",{appName:s});return e}function ka(s,e,t){let n=ek[s]??s;t&&(n+=`-${t}`);const a=n.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${n}" with version "${e}":`];a&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ti.warn(c.join(" "));return}nc(new Po(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik="firebase-heartbeat-database",ak=1,sh="firebase-heartbeat-store";let o0=null;function QT(){return o0||(o0=wR(ik,ak,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(sh)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ra.create("idb-open",{originalErrorMessage:s.message})})),o0}async function ok(s){try{const t=(await QT()).transaction(sh),n=await t.objectStore(sh).get(YT(s));return await t.done,n}catch(e){if(e instanceof Ci)Ti.warn(e.message);else{const t=Ra.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ti.warn(t.message)}}}async function Fw(s,e){try{const n=(await QT()).transaction(sh,"readwrite");await n.objectStore(sh).put(e,YT(s)),await n.done}catch(t){if(t instanceof Ci)Ti.warn(t.message);else{const n=Ra.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ti.warn(n.message)}}}function YT(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=1024,ck=30;class uk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new dk(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Gw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>ck){const c=fk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ti.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Gw(),{heartbeatsToSend:n,unsentEntries:a}=hk(this._heartbeatsCache.heartbeats),l=PT(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Ti.warn(t),""}}}function Gw(){return new Date().toISOString().substring(0,10)}function hk(s,e=lk){const t=[];let n=s.slice();for(const a of s){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),qw(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),qw(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class dk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return qT()?WC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ok(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Fw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Fw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function qw(s){return PT(JSON.stringify({version:2,heartbeats:s})).length}function fk(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let n=1;n<s.length;n++)s[n].date<t&&(t=s[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(s){nc(new Po("platform-logger",e=>new SR(e),"PRIVATE")),nc(new Po("heartbeat",e=>new uk(e),"PRIVATE")),ka(C0,zw,s),ka(C0,zw,"esm2020"),ka("fire-js","")}pk("");var mk="firebase",gk="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ka(mk,gk,"app");function XT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yk=XT,JT=new Eh("auth","Firebase",XT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vf=new Ey("@firebase/auth");function vk(s,...e){Vf.logLevel<=rt.WARN&&Vf.warn(`Auth (${Ec}): ${s}`,...e)}function gf(s,...e){Vf.logLevel<=rt.ERROR&&Vf.error(`Auth (${Ec}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Es(s,...e){throw Ny(s,...e)}function Fs(s,...e){return Ny(s,...e)}function WT(s,e,t){const n={...yk(),[e]:t};return new Eh("auth","Firebase",n).create(e,{appName:s.name})}function Ei(s){return WT(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ny(s,...e){if(typeof s!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=s.name),s._errorFactory.create(t,...n)}return JT.create(s,...e)}function Oe(s,e,...t){if(!s)throw Ny(e,...t)}function xi(s){const e="INTERNAL ASSERTION FAILED: "+s;throw gf(e),new Error(e)}function Si(s,e){s||xi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D0(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.href)||""}function bk(){return Hw()==="http:"||Hw()==="https:"}function Hw(){var s;return typeof self<"u"&&((s=self.location)==null?void 0:s.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bk()||YC()||"connection"in navigator)?navigator.onLine:!0}function _k(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,t){this.shortDelay=e,this.longDelay=t,Si(t>e,"Short delay should be less than long delay!"),this.isMobile=KC()||XC()}get(){return xk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(s,e){Si(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Tk=new Sh(3e4,6e4);function Ua(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function za(s,e,t,n,a={}){return eS(s,a,async()=>{let l={},c={};n&&(e==="GET"?c=n:l={body:JSON.stringify(n)});const d=Th({key:s.config.apiKey,...c}).slice(1),p=await s._getAdditionalHeaders();p["Content-Type"]="application/json",s.languageCode&&(p["X-Firebase-Locale"]=s.languageCode);const g={method:e,headers:p,...l};return QC()||(g.referrerPolicy="no-referrer"),s.emulatorConfig&&wc(s.emulatorConfig.host)&&(g.credentials="include"),ZT.fetch()(await tS(s,s.config.apiHost,t,d),g)})}async function eS(s,e,t){s._canInitEmulator=!1;const n={...wk,...e};try{const a=new Nk(s),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw tf(s,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[p,g]=d.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw tf(s,"credential-already-in-use",c);if(p==="EMAIL_EXISTS")throw tf(s,"email-already-in-use",c);if(p==="USER_DISABLED")throw tf(s,"user-disabled",c);const v=n[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw WT(s,v,g);Es(s,v)}}catch(a){if(a instanceof Ci)throw a;Es(s,"network-request-failed",{message:String(a)})}}async function Nh(s,e,t,n,a={}){const l=await za(s,e,t,n,a);return"mfaPendingCredential"in l&&Es(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function tS(s,e,t,n){const a=`${e}${t}?${n}`,l=s,c=l.config.emulator?Ay(s.config,a):`${s.config.apiScheme}://${a}`;return Ek.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function Sk(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Nk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Fs(this.auth,"network-request-failed")),Tk.get())})}}function tf(s,e,t){const n={appName:s.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const a=Fs(s,e,n);return a.customData._tokenResponse=t,a}function $w(s){return s!==void 0&&s.enterprise!==void 0}class Ak{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Sk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Ik(s,e){return za(s,"GET","/v2/recaptchaConfig",Ua(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ck(s,e){return za(s,"POST","/v1/accounts:delete",e)}async function Lf(s,e){return za(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Rk(s,e=!1){const t=Rn(s),n=await t.getIdToken(e),a=Iy(n);Oe(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:a,token:n,authTime:Gu(l0(a.auth_time)),issuedAtTime:Gu(l0(a.iat)),expirationTime:Gu(l0(a.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function l0(s){return Number(s)*1e3}function Iy(s){const[e,t,n]=s.split(".");if(e===void 0||t===void 0||n===void 0)return gf("JWT malformed, contained fewer than 3 sections"),null;try{const a=MT(t);return a?JSON.parse(a):(gf("Failed to decode base64 JWT payload"),null)}catch(a){return gf("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Kw(s){const e=Iy(s);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ih(s,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Ci&&kk(n)&&s.auth.currentUser===s&&await s.auth.signOut(),n}}function kk({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gu(this.lastLoginAt),this.creationTime=Gu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uf(s){var x;const e=s.auth,t=await s.getIdToken(),n=await ih(s,Lf(e,{idToken:t}));Oe(n==null?void 0:n.users.length,e,"internal-error");const a=n.users[0];s._notifyReloadListener(a);const l=(x=a.providerUserInfo)!=null&&x.length?nS(a.providerUserInfo):[],c=Ok(s.providerData,l),d=s.isAnonymous,p=!(s.email&&a.passwordHash)&&!(c!=null&&c.length),g=d?p:!1,v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new j0(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(s,v)}async function jk(s){const e=Rn(s);await Uf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ok(s,e){return[...s.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function nS(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pk(s,e){const t=await eS(s,{},async()=>{const n=Th({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=s.config,c=await tS(s,a,"/v1/token",`key=${l}`),d=await s._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:d,body:n};return s.emulatorConfig&&wc(s.emulatorConfig.host)&&(p.credentials="include"),ZT.fetch()(c,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Mk(s,e){return za(s,"POST","/v2/accounts:revokeToken",Ua(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Kw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=Kw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:a,expiresIn:l}=await Pk(e,t);this.updateTokensAndExpiration(n,a,Number(l))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:a,expirationTime:l}=t,c=new Xl;return n&&(Oe(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),a&&(Oe(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Oe(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xl,this.toJSON())}_performRefresh(){return xi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fa(s,e){Oe(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class _s{constructor({uid:e,auth:t,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new Dk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new j0(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await ih(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Rk(this,e)}reload(){return jk(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new _s({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Uf(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(rs(this.auth.app))return Promise.reject(Ei(this.auth));const e=await this.getIdToken();return await ih(this,Ck(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,d=t.tenantId??void 0,p=t._redirectEventId??void 0,g=t.createdAt??void 0,v=t.lastLoginAt??void 0,{uid:x,emailVerified:E,isAnonymous:A,providerData:O,stsTokenManager:F}=t;Oe(x&&F,e,"internal-error");const J=Xl.fromJSON(this.name,F);Oe(typeof x=="string",e,"internal-error"),fa(n,e.name),fa(a,e.name),Oe(typeof E=="boolean",e,"internal-error"),Oe(typeof A=="boolean",e,"internal-error"),fa(l,e.name),fa(c,e.name),fa(d,e.name),fa(p,e.name),fa(g,e.name),fa(v,e.name);const se=new _s({uid:x,auth:e,email:a,emailVerified:E,displayName:n,isAnonymous:A,photoURL:c,phoneNumber:l,tenantId:d,stsTokenManager:J,createdAt:g,lastLoginAt:v});return O&&Array.isArray(O)&&(se.providerData=O.map(ce=>({...ce}))),p&&(se._redirectEventId=p),se}static async _fromIdTokenResponse(e,t,n=!1){const a=new Xl;a.updateFromServerResponse(t);const l=new _s({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Uf(l),l}static async _fromGetAccountInfoResponse(e,t,n){const a=t.users[0];Oe(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?nS(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),d=new Xl;d.updateFromIdToken(n);const p=new _s({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new j0(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(p,g),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw=new Map;function _i(s){Si(s instanceof Function,"Expected a class definition");let e=Qw.get(s);return e?(Si(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,Qw.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}rS.type="NONE";const Yw=rS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(s,e,t){return`firebase:${s}:${e}:${t}`}class Jl{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:a,name:l}=this.auth;this.fullUserKey=yf(this.userKey,a.apiKey,l),this.fullPersistenceKey=yf("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Lf(this.auth,{idToken:e}).catch(()=>{});return t?_s._fromGetAccountInfoResponse(this.auth,t,e):null}return _s._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Jl(_i(Yw),e,n);const a=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=a[0]||_i(Yw);const c=yf(n,e.config.apiKey,e.name);let d=null;for(const g of t)try{const v=await g._get(c);if(v){let x;if(typeof v=="string"){const E=await Lf(e,{idToken:v}).catch(()=>{});if(!E)break;x=await _s._fromGetAccountInfoResponse(e,E,v)}else x=_s._fromJSON(e,v);g!==l&&(d=x),l=g;break}}catch{}const p=a.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new Jl(l,e,n):(l=p[0],d&&await l._set(c,d.toJSON()),await Promise.all(t.map(async g=>{if(g!==l)try{await g._remove(c)}catch{}})),new Jl(l,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(oS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(cS(e))return"Blackberry";if(uS(e))return"Webos";if(iS(e))return"Safari";if((e.includes("chrome/")||aS(e))&&!e.includes("edge/"))return"Chrome";if(lS(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=s.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function sS(s=wn()){return/firefox\//i.test(s)}function iS(s=wn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function aS(s=wn()){return/crios\//i.test(s)}function oS(s=wn()){return/iemobile/i.test(s)}function lS(s=wn()){return/android/i.test(s)}function cS(s=wn()){return/blackberry/i.test(s)}function uS(s=wn()){return/webos/i.test(s)}function Cy(s=wn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function Vk(s=wn()){var e;return Cy(s)&&!!((e=window.navigator)!=null&&e.standalone)}function Lk(){return JC()&&document.documentMode===10}function hS(s=wn()){return Cy(s)||lS(s)||uS(s)||cS(s)||/windows phone/i.test(s)||oS(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(s,e=[]){let t;switch(s){case"Browser":t=Xw(wn());break;case"Worker":t=`${Xw(wn())}-${s}`;break;default:t=s}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ec}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=l=>new Promise((c,d)=>{try{const p=e(l);c(p)}catch(p){d(p)}});n.onAbort=t,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zk(s,e={}){return za(s,"GET","/v2/passwordPolicy",Ua(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk=6;class Fk{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Bk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(e,t,n,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jw(this),this.idTokenSubscription=new Jw(this),this.beforeStateQueue=new Uk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=JT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_i(t)),this._initializationPromise=this.queue(async()=>{var n,a,l;if(!this._deleted&&(this.persistenceManager=await Jl.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Lf(this,{idToken:e}),n=await _s._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(rs(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=n==null?void 0:n._redirectEventId,p=await this.tryRedirectSignIn(e);(!c||c===d)&&(p!=null&&p.user)&&(n=p.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(c){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Uf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_k()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(rs(this.app))return Promise.reject(Ei(this));const t=e?Rn(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return rs(this.app)?Promise.reject(Ei(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return rs(this.app)?Promise.reject(Ei(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_i(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await zk(this),t=new Fk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Eh("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await Mk(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_i(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Jl.create(this,[_i(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,n,a);return()=>{c=!0,p()}}else{const p=e.addObserver(t);return()=>{c=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=dS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(rs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&vk(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Yo(s){return Rn(s)}class Jw{constructor(e){this.auth=e,this.observer=null,this.addObserver=rR(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qk(s){fp=s}function fS(s){return fp.loadJS(s)}function Hk(){return fp.recaptchaEnterpriseScript}function $k(){return fp.gapiScript}function Kk(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class Qk{constructor(){this.enterprise=new Yk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Yk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Xk="recaptcha-enterprise",pS="NO_RECAPTCHA";class Jk{constructor(e){this.type=Xk,this.auth=Yo(e)}async verify(e="verify",t=!1){async function n(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,d)=>{Ik(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const g=new Ak(p);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,c(g.siteKey)}}).catch(p=>{d(p)})})}function a(l,c,d){const p=window.grecaptcha;$w(p)?p.enterprise.ready(()=>{p.enterprise.execute(l,{action:e}).then(g=>{c(g)}).catch(()=>{c(pS)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Qk().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{n(this.auth).then(d=>{if(!t&&$w(window.grecaptcha))a(d,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let p=Hk();p.length!==0&&(p+=d),fS(p).then(()=>{a(d,l,c)}).catch(g=>{c(g)})}}).catch(d=>{c(d)})})}}async function Ww(s,e,t,n=!1,a=!1){const l=new Jk(s);let c;if(a)c=pS;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const p=d.phoneEnrollmentInfo.phoneNumber,g=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const p=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return n?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function O0(s,e,t,n,a){var l;if((l=s._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Ww(s,e,t,t==="getOobCode");return n(s,c)}else return n(s,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Ww(s,e,t,t==="getOobCode");return n(s,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wk(s,e){const t=Sy(s,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Oo(l,e??{}))return a;Es(a,"already-initialized")}return t.initialize({options:e})}function Zk(s,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(_i);e!=null&&e.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function e5(s,e,t){const n=Yo(s);Oe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,l=mS(e),{host:c,port:d}=t5(e),p=d===null?"":`:${d}`,g={url:`${l}//${c}${p}/`},v=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){Oe(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Oe(Oo(g,n.config.emulator)&&Oo(v,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=g,n.emulatorConfig=v,n.settings.appVerificationDisabledForTesting=!0,wc(c)?(zT(`${l}//${c}${p}`),$C("Auth",!0)):n5()}function mS(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function t5(s){const e=mS(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const l=a[1];return{host:l,port:Zw(n.substr(l.length+1))}}else{const[l,c]=n.split(":");return{host:l,port:Zw(c)}}}function Zw(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function n5(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return xi("not implemented")}_getIdTokenResponse(e){return xi("not implemented")}_linkToIdToken(e,t){return xi("not implemented")}_getReauthenticationResolver(e){return xi("not implemented")}}async function r5(s,e){return za(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s5(s,e){return Nh(s,"POST","/v1/accounts:signInWithPassword",Ua(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i5(s,e){return Nh(s,"POST","/v1/accounts:signInWithEmailLink",Ua(s,e))}async function a5(s,e){return Nh(s,"POST","/v1/accounts:signInWithEmailLink",Ua(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah extends Ry{constructor(e,t,n,a=null){super("password",n),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new ah(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new ah(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return O0(e,t,"signInWithPassword",s5);case"emailLink":return i5(e,{email:this._email,oobCode:this._password});default:Es(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return O0(e,n,"signUpPassword",r5);case"emailLink":return a5(e,{idToken:t,email:this._email,oobCode:this._password});default:Es(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wl(s,e){return Nh(s,"POST","/v1/accounts:signInWithIdp",Ua(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o5="http://localhost";class Mo extends Ry{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Mo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Es("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...l}=t;if(!n||!a)return null;const c=new Mo(n,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Wl(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Wl(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Wl(e,t)}buildRequest(){const e={requestUri:o5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Th(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function c5(s){const e=Pu(Mu(s)).link,t=e?Pu(Mu(e)).deep_link_id:null,n=Pu(Mu(s)).deep_link_id;return(n?Pu(Mu(n)).link:null)||n||t||e||s}class ky{constructor(e){const t=Pu(Mu(e)),n=t.apiKey??null,a=t.oobCode??null,l=l5(t.mode??null);Oe(n&&a&&l,"argument-error"),this.apiKey=n,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=c5(e);try{return new ky(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(){this.providerId=Tc.PROVIDER_ID}static credential(e,t){return ah._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ky.parseLink(t);return Oe(n,"argument-error"),ah._fromEmailAndCode(e,n.code,n.tenantId)}}Tc.PROVIDER_ID="password";Tc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Tc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah extends gS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa extends Ah{constructor(){super("facebook.com")}static credential(e){return Mo._fromParams({providerId:xa.PROVIDER_ID,signInMethod:xa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xa.credentialFromTaggedObject(e)}static credentialFromError(e){return xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xa.credential(e.oauthAccessToken)}catch{return null}}}xa.FACEBOOK_SIGN_IN_METHOD="facebook.com";xa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a extends Ah{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Mo._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return _a.credentialFromTaggedObject(e)}static credentialFromError(e){return _a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return _a.credential(t,n)}catch{return null}}}_a.GOOGLE_SIGN_IN_METHOD="google.com";_a.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends Ah{constructor(){super("github.com")}static credential(e){return Mo._fromParams({providerId:wa.PROVIDER_ID,signInMethod:wa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wa.credentialFromTaggedObject(e)}static credentialFromError(e){return wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wa.credential(e.oauthAccessToken)}catch{return null}}}wa.GITHUB_SIGN_IN_METHOD="github.com";wa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea extends Ah{constructor(){super("twitter.com")}static credential(e,t){return Mo._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ea.credential(t,n)}catch{return null}}}Ea.TWITTER_SIGN_IN_METHOD="twitter.com";Ea.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u5(s,e){return Nh(s,"POST","/v1/accounts:signUp",Ua(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,a=!1){const l=await _s._fromIdTokenResponse(e,n,a),c=e1(n);return new Vo({user:l,providerId:c,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const a=e1(n);return new Vo({user:e,providerId:a,_tokenResponse:n,operationType:t})}}function e1(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf extends Ci{constructor(e,t,n,a){super(t.code,t.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,zf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,a){return new zf(e,t,n,a)}}function yS(s,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?zf._fromErrorAndOperation(s,l,e,n):l})}async function h5(s,e,t=!1){const n=await ih(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Vo._forOperation(s,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d5(s,e,t=!1){const{auth:n}=s;if(rs(n.app))return Promise.reject(Ei(n));const a="reauthenticate";try{const l=await ih(s,yS(n,a,e,s),t);Oe(l.idToken,n,"internal-error");const c=Iy(l.idToken);Oe(c,n,"internal-error");const{sub:d}=c;return Oe(s.uid===d,n,"user-mismatch"),Vo._forOperation(s,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Es(n,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vS(s,e,t=!1){if(rs(s.app))return Promise.reject(Ei(s));const n="signIn",a=await yS(s,n,e),l=await Vo._fromIdTokenResponse(s,n,a);return t||await s._updateCurrentUser(l.user),l}async function f5(s,e){return vS(Yo(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bS(s){const e=Yo(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function p5(s,e,t){if(rs(s.app))return Promise.reject(Ei(s));const n=Yo(s),c=await O0(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",u5).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&bS(s),p}),d=await Vo._fromIdTokenResponse(n,"signIn",c);return await n._updateCurrentUser(d.user),d}function m5(s,e,t){return rs(s.app)?Promise.reject(Ei(s)):f5(Rn(s),Tc.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&bS(s),n})}function g5(s,e,t,n){return Rn(s).onIdTokenChanged(e,t,n)}function y5(s,e,t){return Rn(s).beforeAuthStateChanged(e,t)}function v5(s){return Rn(s).signOut()}const Bf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Bf,"1"),this.storage.removeItem(Bf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5=1e3,x5=10;class _S extends xS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),a=this.localCache[t];n!==a&&e(t,a,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,p)=>{this.notifyListeners(c,p)});return}const n=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(n);!t&&this.localCache[n]===c||this.notifyListeners(n,c)},l=this.storage.getItem(n);Lk()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,x5):a()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},b5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_S.type="LOCAL";const _5=_S;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS extends xS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}wS.type="SESSION";const ES=wS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w5(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const n=new pp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const d=Array.from(c).map(async g=>g(t.origin,l)),p=await w5(d);t.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dy(s="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((d,p)=>{const g=Dy("",20);a.port1.start();const v=setTimeout(()=>{p(new Error("unsupported_event"))},n);c={messageChannel:a,onMessage(x){const E=x;if(E.data.eventId===g)switch(E.data.status){case"ack":clearTimeout(v),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(E.data.response);break;default:clearTimeout(v),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(){return window}function T5(s){Gs().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TS(){return typeof Gs().WorkerGlobalScope<"u"&&typeof Gs().importScripts=="function"}async function S5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function N5(){var s;return((s=navigator==null?void 0:navigator.serviceWorker)==null?void 0:s.controller)||null}function A5(){return TS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS="firebaseLocalStorageDb",I5=1,Ff="firebaseLocalStorage",NS="fbase_key";class Ih{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function mp(s,e){return s.transaction([Ff],e?"readwrite":"readonly").objectStore(Ff)}function C5(){const s=indexedDB.deleteDatabase(SS);return new Ih(s).toPromise()}function P0(){const s=indexedDB.open(SS,I5);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const n=s.result;try{n.createObjectStore(Ff,{keyPath:NS})}catch(a){t(a)}}),s.addEventListener("success",async()=>{const n=s.result;n.objectStoreNames.contains(Ff)?e(n):(n.close(),await C5(),e(await P0()))})})}async function t1(s,e,t){const n=mp(s,!0).put({[NS]:e,value:t});return new Ih(n).toPromise()}async function R5(s,e){const t=mp(s,!1).get(e),n=await new Ih(t).toPromise();return n===void 0?null:n.value}function n1(s,e){const t=mp(s,!0).delete(e);return new Ih(t).toPromise()}const k5=800,D5=3;class AS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await P0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>D5)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return TS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pp._getInstance(A5()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await S5(),!this.activeServiceWorker)return;this.sender=new E5(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||N5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await P0();return await t1(e,Bf,"1"),await n1(e,Bf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>t1(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>R5(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>n1(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=mp(a,!1).getAll();return new Ih(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),k5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}AS.type="LOCAL";const j5=AS;new Sh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O5(s,e){return e?_i(e):(Oe(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy extends Ry{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function P5(s){return vS(s.auth,new jy(s),s.bypassAuthState)}function M5(s){const{auth:e,user:t}=s;return Oe(t,e,"internal-error"),d5(t,new jy(s),s.bypassAuthState)}async function V5(s){const{auth:e,user:t}=s;return Oe(t,e,"internal-error"),h5(t,new jy(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(e,t,n,a,l=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:a,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const p={auth:this.auth,requestUri:t,sessionId:n,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return P5;case"linkViaPopup":case"linkViaRedirect":return V5;case"reauthViaPopup":case"reauthViaRedirect":return M5;default:Es(this.auth,"internal-error")}}resolve(e){Si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L5=new Sh(2e3,1e4);class Ql extends IS{constructor(e,t,n,a,l){super(e,t,a,l),this.provider=n,this.authWindow=null,this.pollId=null,Ql.currentPopupAction&&Ql.currentPopupAction.cancel(),Ql.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){Si(this.filter.length===1,"Popup operations only handle one event");const e=Dy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Fs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Fs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ql.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,L5.get())};e()}}Ql.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U5="pendingRedirect",vf=new Map;class z5 extends IS{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=vf.get(this.auth._key());if(!e){try{const n=await B5(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}vf.set(this.auth._key(),e)}return this.bypassAuthState||vf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function B5(s,e){const t=q5(e),n=G5(s);if(!await n._isAvailable())return!1;const a=await n._get(t)==="true";return await n._remove(t),a}function F5(s,e){vf.set(s._key(),e)}function G5(s){return _i(s._redirectPersistence)}function q5(s){return yf(U5,s.config.apiKey,s.name)}async function H5(s,e,t=!1){if(rs(s.app))return Promise.reject(Ei(s));const n=Yo(s),a=O5(n,e),c=await new z5(n,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $5=600*1e3;class K5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Q5(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!CS(e)){const a=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(Fs(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$5&&this.cachedEventUids.clear(),this.cachedEventUids.has(r1(e))}saveEventToCache(e){this.cachedEventUids.add(r1(e)),this.lastProcessedEventTime=Date.now()}}function r1(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function CS({type:s,error:e}){return s==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Q5(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CS(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y5(s,e={}){return za(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,J5=/^https?/;async function W5(s){if(s.config.emulator)return;const{authorizedDomains:e}=await Y5(s);for(const t of e)try{if(Z5(t))return}catch{}Es(s,"unauthorized-domain")}function Z5(s){const e=D0(),{protocol:t,hostname:n}=new URL(e);if(s.startsWith("chrome-extension://")){const c=new URL(s);return c.hostname===""&&n===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===n}if(!J5.test(t))return!1;if(X5.test(s))return n===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=new Sh(3e4,6e4);function s1(){const s=Gs().___jsl;if(s!=null&&s.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function t4(s){return new Promise((e,t)=>{var a,l,c;function n(){s1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{s1(),t(Fs(s,"network-request-failed"))},timeout:e4.get()})}if((l=(a=Gs().gapi)==null?void 0:a.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=Gs().gapi)!=null&&c.load)n();else{const d=Kk("iframefcb");return Gs()[d]=()=>{gapi.load?n():t(Fs(s,"network-request-failed"))},fS(`${$k()}?onload=${d}`).catch(p=>t(p))}}).catch(e=>{throw bf=null,e})}let bf=null;function n4(s){return bf=bf||t4(s),bf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4=new Sh(5e3,15e3),s4="__/auth/iframe",i4="emulator/auth/iframe",a4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},o4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function l4(s){const e=s.config;Oe(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?Ay(e,i4):`https://${s.config.authDomain}/${s4}`,n={apiKey:e.apiKey,appName:s.name,v:Ec},a=o4.get(s.config.apiHost);a&&(n.eid=a);const l=s._getFrameworks();return l.length&&(n.fw=l.join(",")),`${t}?${Th(n).slice(1)}`}async function c4(s){const e=await n4(s),t=Gs().gapi;return Oe(t,s,"internal-error"),e.open({where:document.body,url:l4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:a4,dontclear:!0},n=>new Promise(async(a,l)=>{await n.restyle({setHideOnLeave:!1});const c=Fs(s,"network-request-failed"),d=Gs().setTimeout(()=>{l(c)},r4.get());function p(){Gs().clearTimeout(d),a(n)}n.ping(p).then(p,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},h4=500,d4=600,f4="_blank",p4="http://localhost";class i1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function m4(s,e,t,n=h4,a=d4){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let d="";const p={...u4,width:n.toString(),height:a.toString(),top:l,left:c},g=wn().toLowerCase();t&&(d=aS(g)?f4:t),sS(g)&&(e=e||p4,p.scrollbars="yes");const v=Object.entries(p).reduce((E,[A,O])=>`${E}${A}=${O},`,"");if(Vk(g)&&d!=="_self")return g4(e||"",d),new i1(null);const x=window.open(e||"",d,v);Oe(x,s,"popup-blocked");try{x.focus()}catch{}return new i1(x)}function g4(s,e){const t=document.createElement("a");t.href=s,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4="__/auth/handler",v4="emulator/auth/handler",b4=encodeURIComponent("fac");async function a1(s,e,t,n,a,l){Oe(s.config.authDomain,s,"auth-domain-config-required"),Oe(s.config.apiKey,s,"invalid-api-key");const c={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:n,v:Ec,eventId:a};if(e instanceof gS){e.setDefaultLanguage(s.languageCode),c.providerId=e.providerId||"",nR(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,x]of Object.entries({}))c[v]=x}if(e instanceof Ah){const v=e.getScopes().filter(x=>x!=="");v.length>0&&(c.scopes=v.join(","))}s.tenantId&&(c.tid=s.tenantId);const d=c;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const p=await s._getAppCheckToken(),g=p?`#${b4}=${encodeURIComponent(p)}`:"";return`${x4(s)}?${Th(d).slice(1)}${g}`}function x4({config:s}){return s.emulator?Ay(s,v4):`https://${s.authDomain}/${y4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0="webStorageSupport";class _4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ES,this._completeRedirectFn=H5,this._overrideRedirectResult=F5}async _openPopup(e,t,n,a){var c;Si((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await a1(e,t,n,D0(),a);return m4(e,l,Dy())}async _openRedirect(e,t,n,a){await this._originValidation(e);const l=await a1(e,t,n,D0(),a);return T5(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Si(l,"If manager is not set, promise should be"),l)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await c4(e),n=new K5(e);return t.register("authEvent",a=>(Oe(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(c0,{type:c0},a=>{var c;const l=(c=a==null?void 0:a[0])==null?void 0:c[c0];l!==void 0&&t(!!l),Es(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=W5(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return hS()||iS()||Cy()}}const w4=_4;var o1="@firebase/auth",l1="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function S4(s){nc(new Po("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=n.options;Oe(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const p={apiKey:c,authDomain:d,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:dS(s)},g=new Gk(n,a,l,p);return Zk(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),nc(new Po("auth-internal",e=>{const t=Yo(e.getProvider("auth").getImmediate());return(n=>new E4(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ka(o1,l1,T4(s)),ka(o1,l1,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4=300,A4=UT("authIdTokenMaxAge")||N4;let c1=null;const I4=s=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>A4)return;const a=t==null?void 0:t.token;c1!==a&&(c1=a,await fetch(s,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function C4(s=sk()){const e=Sy(s,"auth");if(e.isInitialized())return e.getImmediate();const t=Wk(s,{popupRedirectResolver:w4,persistence:[j5,_5,ES]}),n=UT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(n,location.origin);if(location.origin===l.origin){const c=I4(l.toString());y5(t,c,()=>c(t.currentUser)),g5(t,d=>c(d))}}const a=FC("auth");return a&&e5(t,`http://${a}`),t}function R4(){var s;return((s=document.getElementsByTagName("head"))==null?void 0:s[0])??document}qk({loadJS(s){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",s),n.onload=e,n.onerror=a=>{const l=Fs("internal-error");l.customData=a,t(l)},n.type="text/javascript",n.charset="UTF-8",R4().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});S4("Browser");var u1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Da,RS;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,C){function R(){}R.prototype=C.prototype,I.F=C.prototype,I.prototype=new R,I.prototype.constructor=I,I.D=function(L,j,P){for(var k=Array(arguments.length-2),at=2;at<arguments.length;at++)k[at-2]=arguments[at];return C.prototype[j].apply(L,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(I,C,R){R||(R=0);const L=Array(16);if(typeof C=="string")for(var j=0;j<16;++j)L[j]=C.charCodeAt(R++)|C.charCodeAt(R++)<<8|C.charCodeAt(R++)<<16|C.charCodeAt(R++)<<24;else for(j=0;j<16;++j)L[j]=C[R++]|C[R++]<<8|C[R++]<<16|C[R++]<<24;C=I.g[0],R=I.g[1],j=I.g[2];let P=I.g[3],k;k=C+(P^R&(j^P))+L[0]+3614090360&4294967295,C=R+(k<<7&4294967295|k>>>25),k=P+(j^C&(R^j))+L[1]+3905402710&4294967295,P=C+(k<<12&4294967295|k>>>20),k=j+(R^P&(C^R))+L[2]+606105819&4294967295,j=P+(k<<17&4294967295|k>>>15),k=R+(C^j&(P^C))+L[3]+3250441966&4294967295,R=j+(k<<22&4294967295|k>>>10),k=C+(P^R&(j^P))+L[4]+4118548399&4294967295,C=R+(k<<7&4294967295|k>>>25),k=P+(j^C&(R^j))+L[5]+1200080426&4294967295,P=C+(k<<12&4294967295|k>>>20),k=j+(R^P&(C^R))+L[6]+2821735955&4294967295,j=P+(k<<17&4294967295|k>>>15),k=R+(C^j&(P^C))+L[7]+4249261313&4294967295,R=j+(k<<22&4294967295|k>>>10),k=C+(P^R&(j^P))+L[8]+1770035416&4294967295,C=R+(k<<7&4294967295|k>>>25),k=P+(j^C&(R^j))+L[9]+2336552879&4294967295,P=C+(k<<12&4294967295|k>>>20),k=j+(R^P&(C^R))+L[10]+4294925233&4294967295,j=P+(k<<17&4294967295|k>>>15),k=R+(C^j&(P^C))+L[11]+2304563134&4294967295,R=j+(k<<22&4294967295|k>>>10),k=C+(P^R&(j^P))+L[12]+1804603682&4294967295,C=R+(k<<7&4294967295|k>>>25),k=P+(j^C&(R^j))+L[13]+4254626195&4294967295,P=C+(k<<12&4294967295|k>>>20),k=j+(R^P&(C^R))+L[14]+2792965006&4294967295,j=P+(k<<17&4294967295|k>>>15),k=R+(C^j&(P^C))+L[15]+1236535329&4294967295,R=j+(k<<22&4294967295|k>>>10),k=C+(j^P&(R^j))+L[1]+4129170786&4294967295,C=R+(k<<5&4294967295|k>>>27),k=P+(R^j&(C^R))+L[6]+3225465664&4294967295,P=C+(k<<9&4294967295|k>>>23),k=j+(C^R&(P^C))+L[11]+643717713&4294967295,j=P+(k<<14&4294967295|k>>>18),k=R+(P^C&(j^P))+L[0]+3921069994&4294967295,R=j+(k<<20&4294967295|k>>>12),k=C+(j^P&(R^j))+L[5]+3593408605&4294967295,C=R+(k<<5&4294967295|k>>>27),k=P+(R^j&(C^R))+L[10]+38016083&4294967295,P=C+(k<<9&4294967295|k>>>23),k=j+(C^R&(P^C))+L[15]+3634488961&4294967295,j=P+(k<<14&4294967295|k>>>18),k=R+(P^C&(j^P))+L[4]+3889429448&4294967295,R=j+(k<<20&4294967295|k>>>12),k=C+(j^P&(R^j))+L[9]+568446438&4294967295,C=R+(k<<5&4294967295|k>>>27),k=P+(R^j&(C^R))+L[14]+3275163606&4294967295,P=C+(k<<9&4294967295|k>>>23),k=j+(C^R&(P^C))+L[3]+4107603335&4294967295,j=P+(k<<14&4294967295|k>>>18),k=R+(P^C&(j^P))+L[8]+1163531501&4294967295,R=j+(k<<20&4294967295|k>>>12),k=C+(j^P&(R^j))+L[13]+2850285829&4294967295,C=R+(k<<5&4294967295|k>>>27),k=P+(R^j&(C^R))+L[2]+4243563512&4294967295,P=C+(k<<9&4294967295|k>>>23),k=j+(C^R&(P^C))+L[7]+1735328473&4294967295,j=P+(k<<14&4294967295|k>>>18),k=R+(P^C&(j^P))+L[12]+2368359562&4294967295,R=j+(k<<20&4294967295|k>>>12),k=C+(R^j^P)+L[5]+4294588738&4294967295,C=R+(k<<4&4294967295|k>>>28),k=P+(C^R^j)+L[8]+2272392833&4294967295,P=C+(k<<11&4294967295|k>>>21),k=j+(P^C^R)+L[11]+1839030562&4294967295,j=P+(k<<16&4294967295|k>>>16),k=R+(j^P^C)+L[14]+4259657740&4294967295,R=j+(k<<23&4294967295|k>>>9),k=C+(R^j^P)+L[1]+2763975236&4294967295,C=R+(k<<4&4294967295|k>>>28),k=P+(C^R^j)+L[4]+1272893353&4294967295,P=C+(k<<11&4294967295|k>>>21),k=j+(P^C^R)+L[7]+4139469664&4294967295,j=P+(k<<16&4294967295|k>>>16),k=R+(j^P^C)+L[10]+3200236656&4294967295,R=j+(k<<23&4294967295|k>>>9),k=C+(R^j^P)+L[13]+681279174&4294967295,C=R+(k<<4&4294967295|k>>>28),k=P+(C^R^j)+L[0]+3936430074&4294967295,P=C+(k<<11&4294967295|k>>>21),k=j+(P^C^R)+L[3]+3572445317&4294967295,j=P+(k<<16&4294967295|k>>>16),k=R+(j^P^C)+L[6]+76029189&4294967295,R=j+(k<<23&4294967295|k>>>9),k=C+(R^j^P)+L[9]+3654602809&4294967295,C=R+(k<<4&4294967295|k>>>28),k=P+(C^R^j)+L[12]+3873151461&4294967295,P=C+(k<<11&4294967295|k>>>21),k=j+(P^C^R)+L[15]+530742520&4294967295,j=P+(k<<16&4294967295|k>>>16),k=R+(j^P^C)+L[2]+3299628645&4294967295,R=j+(k<<23&4294967295|k>>>9),k=C+(j^(R|~P))+L[0]+4096336452&4294967295,C=R+(k<<6&4294967295|k>>>26),k=P+(R^(C|~j))+L[7]+1126891415&4294967295,P=C+(k<<10&4294967295|k>>>22),k=j+(C^(P|~R))+L[14]+2878612391&4294967295,j=P+(k<<15&4294967295|k>>>17),k=R+(P^(j|~C))+L[5]+4237533241&4294967295,R=j+(k<<21&4294967295|k>>>11),k=C+(j^(R|~P))+L[12]+1700485571&4294967295,C=R+(k<<6&4294967295|k>>>26),k=P+(R^(C|~j))+L[3]+2399980690&4294967295,P=C+(k<<10&4294967295|k>>>22),k=j+(C^(P|~R))+L[10]+4293915773&4294967295,j=P+(k<<15&4294967295|k>>>17),k=R+(P^(j|~C))+L[1]+2240044497&4294967295,R=j+(k<<21&4294967295|k>>>11),k=C+(j^(R|~P))+L[8]+1873313359&4294967295,C=R+(k<<6&4294967295|k>>>26),k=P+(R^(C|~j))+L[15]+4264355552&4294967295,P=C+(k<<10&4294967295|k>>>22),k=j+(C^(P|~R))+L[6]+2734768916&4294967295,j=P+(k<<15&4294967295|k>>>17),k=R+(P^(j|~C))+L[13]+1309151649&4294967295,R=j+(k<<21&4294967295|k>>>11),k=C+(j^(R|~P))+L[4]+4149444226&4294967295,C=R+(k<<6&4294967295|k>>>26),k=P+(R^(C|~j))+L[11]+3174756917&4294967295,P=C+(k<<10&4294967295|k>>>22),k=j+(C^(P|~R))+L[2]+718787259&4294967295,j=P+(k<<15&4294967295|k>>>17),k=R+(P^(j|~C))+L[9]+3951481745&4294967295,I.g[0]=I.g[0]+C&4294967295,I.g[1]=I.g[1]+(j+(k<<21&4294967295|k>>>11))&4294967295,I.g[2]=I.g[2]+j&4294967295,I.g[3]=I.g[3]+P&4294967295}n.prototype.v=function(I,C){C===void 0&&(C=I.length);const R=C-this.blockSize,L=this.C;let j=this.h,P=0;for(;P<C;){if(j==0)for(;P<=R;)a(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<C;)if(L[j++]=I.charCodeAt(P++),j==this.blockSize){a(this,L),j=0;break}}else for(;P<C;)if(L[j++]=I[P++],j==this.blockSize){a(this,L),j=0;break}}this.h=j,this.o+=C},n.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var C=1;C<I.length-8;++C)I[C]=0;C=this.o*8;for(var R=I.length-8;R<I.length;++R)I[R]=C&255,C/=256;for(this.v(I),I=Array(16),C=0,R=0;R<4;++R)for(let L=0;L<32;L+=8)I[C++]=this.g[R]>>>L&255;return I};function l(I,C){var R=d;return Object.prototype.hasOwnProperty.call(R,I)?R[I]:R[I]=C(I)}function c(I,C){this.h=C;const R=[];let L=!0;for(let j=I.length-1;j>=0;j--){const P=I[j]|0;L&&P==C||(R[j]=P,L=!1)}this.g=R}var d={};function p(I){return-128<=I&&I<128?l(I,function(C){return new c([C|0],C<0?-1:0)}):new c([I|0],I<0?-1:0)}function g(I){if(isNaN(I)||!isFinite(I))return x;if(I<0)return J(g(-I));const C=[];let R=1;for(let L=0;I>=R;L++)C[L]=I/R|0,R*=4294967296;return new c(C,0)}function v(I,C){if(I.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(I.charAt(0)=="-")return J(v(I.substring(1),C));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=g(Math.pow(C,8));let L=x;for(let P=0;P<I.length;P+=8){var j=Math.min(8,I.length-P);const k=parseInt(I.substring(P,P+j),C);j<8?(j=g(Math.pow(C,j)),L=L.j(j).add(g(k))):(L=L.j(R),L=L.add(g(k)))}return L}var x=p(0),E=p(1),A=p(16777216);s=c.prototype,s.m=function(){if(F(this))return-J(this).m();let I=0,C=1;for(let R=0;R<this.g.length;R++){const L=this.i(R);I+=(L>=0?L:4294967296+L)*C,C*=4294967296}return I},s.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(O(this))return"0";if(F(this))return"-"+J(this).toString(I);const C=g(Math.pow(I,6));var R=this;let L="";for(;;){const j=me(R,C).g;R=se(R,j.j(C));let P=((R.g.length>0?R.g[0]:R.h)>>>0).toString(I);if(R=j,O(R))return P+L;for(;P.length<6;)P="0"+P;L=P+L}},s.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function O(I){if(I.h!=0)return!1;for(let C=0;C<I.g.length;C++)if(I.g[C]!=0)return!1;return!0}function F(I){return I.h==-1}s.l=function(I){return I=se(this,I),F(I)?-1:O(I)?0:1};function J(I){const C=I.g.length,R=[];for(let L=0;L<C;L++)R[L]=~I.g[L];return new c(R,~I.h).add(E)}s.abs=function(){return F(this)?J(this):this},s.add=function(I){const C=Math.max(this.g.length,I.g.length),R=[];let L=0;for(let j=0;j<=C;j++){let P=L+(this.i(j)&65535)+(I.i(j)&65535),k=(P>>>16)+(this.i(j)>>>16)+(I.i(j)>>>16);L=k>>>16,P&=65535,k&=65535,R[j]=k<<16|P}return new c(R,R[R.length-1]&-2147483648?-1:0)};function se(I,C){return I.add(J(C))}s.j=function(I){if(O(this)||O(I))return x;if(F(this))return F(I)?J(this).j(J(I)):J(J(this).j(I));if(F(I))return J(this.j(J(I)));if(this.l(A)<0&&I.l(A)<0)return g(this.m()*I.m());const C=this.g.length+I.g.length,R=[];for(var L=0;L<2*C;L++)R[L]=0;for(L=0;L<this.g.length;L++)for(let j=0;j<I.g.length;j++){const P=this.i(L)>>>16,k=this.i(L)&65535,at=I.i(j)>>>16,_t=I.i(j)&65535;R[2*L+2*j]+=k*_t,ce(R,2*L+2*j),R[2*L+2*j+1]+=P*_t,ce(R,2*L+2*j+1),R[2*L+2*j+1]+=k*at,ce(R,2*L+2*j+1),R[2*L+2*j+2]+=P*at,ce(R,2*L+2*j+2)}for(I=0;I<C;I++)R[I]=R[2*I+1]<<16|R[2*I];for(I=C;I<2*C;I++)R[I]=0;return new c(R,0)};function ce(I,C){for(;(I[C]&65535)!=I[C];)I[C+1]+=I[C]>>>16,I[C]&=65535,C++}function le(I,C){this.g=I,this.h=C}function me(I,C){if(O(C))throw Error("division by zero");if(O(I))return new le(x,x);if(F(I))return C=me(J(I),C),new le(J(C.g),J(C.h));if(F(C))return C=me(I,J(C)),new le(J(C.g),C.h);if(I.g.length>30){if(F(I)||F(C))throw Error("slowDivide_ only works with positive integers.");for(var R=E,L=C;L.l(I)<=0;)R=Ee(R),L=Ee(L);var j=be(R,1),P=be(L,1);for(L=be(L,2),R=be(R,2);!O(L);){var k=P.add(L);k.l(I)<=0&&(j=j.add(R),P=k),L=be(L,1),R=be(R,1)}return C=se(I,j.j(C)),new le(j,C)}for(j=x;I.l(C)>=0;){for(R=Math.max(1,Math.floor(I.m()/C.m())),L=Math.ceil(Math.log(R)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),P=g(R),k=P.j(C);F(k)||k.l(I)>0;)R-=L,P=g(R),k=P.j(C);O(P)&&(P=E),j=j.add(P),I=se(I,k)}return new le(j,I)}s.B=function(I){return me(this,I).h},s.and=function(I){const C=Math.max(this.g.length,I.g.length),R=[];for(let L=0;L<C;L++)R[L]=this.i(L)&I.i(L);return new c(R,this.h&I.h)},s.or=function(I){const C=Math.max(this.g.length,I.g.length),R=[];for(let L=0;L<C;L++)R[L]=this.i(L)|I.i(L);return new c(R,this.h|I.h)},s.xor=function(I){const C=Math.max(this.g.length,I.g.length),R=[];for(let L=0;L<C;L++)R[L]=this.i(L)^I.i(L);return new c(R,this.h^I.h)};function Ee(I){const C=I.g.length+1,R=[];for(let L=0;L<C;L++)R[L]=I.i(L)<<1|I.i(L-1)>>>31;return new c(R,I.h)}function be(I,C){const R=C>>5;C%=32;const L=I.g.length-R,j=[];for(let P=0;P<L;P++)j[P]=C>0?I.i(P+R)>>>C|I.i(P+R+1)<<32-C:I.i(P+R);return new c(j,I.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,RS=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=g,c.fromString=v,Da=c}).apply(typeof u1<"u"?u1:typeof self<"u"?self:typeof window<"u"?window:{});var nf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kS,Vu,DS,xf,M0,jS,OS,PS;(function(){var s,e=Object.defineProperty;function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof nf=="object"&&nf];for(var b=0;b<f.length;++b){var w=f[b];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var n=t(this);function a(f,b){if(b)e:{var w=n;f=f.split(".");for(var N=0;N<f.length-1;N++){var G=f[N];if(!(G in w))break e;w=w[G]}f=f[f.length-1],N=w[f],b=b(N),b!=N&&b!=null&&e(w,f,{configurable:!0,writable:!0,value:b})}}a("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(f){return f||function(b){var w=[],N;for(N in b)Object.prototype.hasOwnProperty.call(b,N)&&w.push([N,b[N]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(f){var b=typeof f;return b=="object"&&f!=null||b=="function"}function p(f,b,w){return f.call.apply(f.bind,arguments)}function g(f,b,w){return g=p,g.apply(null,arguments)}function v(f,b){var w=Array.prototype.slice.call(arguments,1);return function(){var N=w.slice();return N.push.apply(N,arguments),f.apply(this,N)}}function x(f,b){function w(){}w.prototype=b.prototype,f.Z=b.prototype,f.prototype=new w,f.prototype.constructor=f,f.Ob=function(N,G,Q){for(var pe=Array(arguments.length-2),Ge=2;Ge<arguments.length;Ge++)pe[Ge-2]=arguments[Ge];return b.prototype[G].apply(N,pe)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function A(f){const b=f.length;if(b>0){const w=Array(b);for(let N=0;N<b;N++)w[N]=f[N];return w}return[]}function O(f,b){for(let N=1;N<arguments.length;N++){const G=arguments[N];var w=typeof G;if(w=w!="object"?w:G?Array.isArray(G)?"array":w:"null",w=="array"||w=="object"&&typeof G.length=="number"){w=f.length||0;const Q=G.length||0;f.length=w+Q;for(let pe=0;pe<Q;pe++)f[w+pe]=G[pe]}else f.push(G)}}class F{constructor(b,w){this.i=b,this.j=w,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function J(f){c.setTimeout(()=>{throw f},0)}function se(){var f=I;let b=null;return f.g&&(b=f.g,f.g=f.g.next,f.g||(f.h=null),b.next=null),b}class ce{constructor(){this.h=this.g=null}add(b,w){const N=le.get();N.set(b,w),this.h?this.h.next=N:this.g=N,this.h=N}}var le=new F(()=>new me,f=>f.reset());class me{constructor(){this.next=this.g=this.h=null}set(b,w){this.h=b,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let Ee,be=!1,I=new ce,C=()=>{const f=Promise.resolve(void 0);Ee=()=>{f.then(R)}};function R(){for(var f;f=se();){try{f.h.call(f.g)}catch(w){J(w)}var b=le;b.j(f),b.h<100&&(b.h++,f.next=b.g,b.g=f)}be=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(f,b){this.type=f,this.g=this.target=b,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var f=!1,b=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const w=()=>{};c.addEventListener("test",w,b),c.removeEventListener("test",w,b)}catch{}return f})();function k(f){return/^[\s\xa0]*$/.test(f)}function at(f,b){j.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,b)}x(at,j),at.prototype.init=function(f,b){const w=this.type=f.type,N=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=b,b=f.relatedTarget,b||(w=="mouseover"?b=f.fromElement:w=="mouseout"&&(b=f.toElement)),this.relatedTarget=b,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&at.Z.h.call(this)},at.prototype.h=function(){at.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var _t="closure_listenable_"+(Math.random()*1e6|0),X=0;function ue(f,b,w,N,G){this.listener=f,this.proxy=null,this.src=b,this.type=w,this.capture=!!N,this.ha=G,this.key=++X,this.da=this.fa=!1}function Ae(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function He(f,b,w){for(const N in f)b.call(w,f[N],N,f)}function Je(f,b){for(const w in f)b.call(void 0,f[w],w,f)}function M(f){const b={};for(const w in f)b[w]=f[w];return b}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(f,b){let w,N;for(let G=1;G<arguments.length;G++){N=arguments[G];for(w in N)f[w]=N[w];for(let Q=0;Q<ne.length;Q++)w=ne[Q],Object.prototype.hasOwnProperty.call(N,w)&&(f[w]=N[w])}}function ve(f){this.src=f,this.g={},this.h=0}ve.prototype.add=function(f,b,w,N,G){const Q=f.toString();f=this.g[Q],f||(f=this.g[Q]=[],this.h++);const pe=Ve(f,b,N,G);return pe>-1?(b=f[pe],w||(b.fa=!1)):(b=new ue(b,this.src,Q,!!N,G),b.fa=w,f.push(b)),b};function Ce(f,b){const w=b.type;if(w in f.g){var N=f.g[w],G=Array.prototype.indexOf.call(N,b,void 0),Q;(Q=G>=0)&&Array.prototype.splice.call(N,G,1),Q&&(Ae(b),f.g[w].length==0&&(delete f.g[w],f.h--))}}function Ve(f,b,w,N){for(let G=0;G<f.length;++G){const Q=f[G];if(!Q.da&&Q.listener==b&&Q.capture==!!w&&Q.ha==N)return G}return-1}var Be="closure_lm_"+(Math.random()*1e6|0),Ut={};function We(f,b,w,N,G){if(Array.isArray(b)){for(let Q=0;Q<b.length;Q++)We(f,b[Q],w,N,G);return null}return w=Di(w),f&&f[_t]?f.J(b,w,d(N)?!!N.capture:!1,G):is(f,b,w,!1,N,G)}function is(f,b,w,N,G,Q){if(!b)throw Error("Invalid event type");const pe=d(G)?!!G.capture:!!G;let Ge=os(f);if(Ge||(f[Be]=Ge=new ve(f)),w=Ge.add(b,w,N,pe,Q),w.proxy)return w;if(N=Qs(),w.proxy=N,N.src=f,N.listener=w,f.addEventListener)P||(G=pe),G===void 0&&(G=!1),f.addEventListener(b.toString(),N,G);else if(f.attachEvent)f.attachEvent(vr(b.toString()),N);else if(f.addListener&&f.removeListener)f.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Qs(){function f(w){return b.call(f.src,f.listener,w)}const b=zt;return f}function Vr(f,b,w,N,G){if(Array.isArray(b))for(var Q=0;Q<b.length;Q++)Vr(f,b[Q],w,N,G);else N=d(N)?!!N.capture:!!N,w=Di(w),f&&f[_t]?(f=f.i,Q=String(b).toString(),Q in f.g&&(b=f.g[Q],w=Ve(b,w,N,G),w>-1&&(Ae(b[w]),Array.prototype.splice.call(b,w,1),b.length==0&&(delete f.g[Q],f.h--)))):f&&(f=os(f))&&(b=f.g[b.toString()],f=-1,b&&(f=Ve(b,w,N,G)),(w=f>-1?b[f]:null)&&as(w))}function as(f){if(typeof f!="number"&&f&&!f.da){var b=f.src;if(b&&b[_t])Ce(b.i,f);else{var w=f.type,N=f.proxy;b.removeEventListener?b.removeEventListener(w,N,f.capture):b.detachEvent?b.detachEvent(vr(w),N):b.addListener&&b.removeListener&&b.removeListener(N),(w=os(b))?(Ce(w,f),w.h==0&&(w.src=null,b[Be]=null)):Ae(f)}}}function vr(f){return f in Ut?Ut[f]:Ut[f]="on"+f}function zt(f,b){if(f.da)f=!0;else{b=new at(b,this);const w=f.listener,N=f.ha||f.src;f.fa&&as(f),f=w.call(N,b)}return f}function os(f){return f=f[Be],f instanceof ve?f:null}var Ys="__closure_events_fn_"+(Math.random()*1e9>>>0);function Di(f){return typeof f=="function"?f:(f[Ys]||(f[Ys]=function(b){return f.handleEvent(b)}),f[Ys])}function wt(){L.call(this),this.i=new ve(this),this.M=this,this.G=null}x(wt,L),wt.prototype[_t]=!0,wt.prototype.removeEventListener=function(f,b,w,N){Vr(this,f,b,w,N)};function It(f,b){var w,N=f.G;if(N)for(w=[];N;N=N.G)w.push(N);if(f=f.M,N=b.type||b,typeof b=="string")b=new j(b,f);else if(b instanceof j)b.target=b.target||f;else{var G=b;b=new j(N,f),fe(b,G)}G=!0;let Q,pe;if(w)for(pe=w.length-1;pe>=0;pe--)Q=b.g=w[pe],G=kn(Q,N,!0,b)&&G;if(Q=b.g=f,G=kn(Q,N,!0,b)&&G,G=kn(Q,N,!1,b)&&G,w)for(pe=0;pe<w.length;pe++)Q=b.g=w[pe],G=kn(Q,N,!1,b)&&G}wt.prototype.N=function(){if(wt.Z.N.call(this),this.i){var f=this.i;for(const b in f.g){const w=f.g[b];for(let N=0;N<w.length;N++)Ae(w[N]);delete f.g[b],f.h--}}this.G=null},wt.prototype.J=function(f,b,w,N){return this.i.add(String(f),b,!1,w,N)},wt.prototype.K=function(f,b,w,N){return this.i.add(String(f),b,!0,w,N)};function kn(f,b,w,N){if(b=f.i.g[String(b)],!b)return!0;b=b.concat();let G=!0;for(let Q=0;Q<b.length;++Q){const pe=b[Q];if(pe&&!pe.da&&pe.capture==w){const Ge=pe.listener,on=pe.ha||pe.src;pe.fa&&Ce(f.i,pe),G=Ge.call(on,N)!==!1&&G}}return G&&!N.defaultPrevented}function Xs(f,b){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:c.setTimeout(f,b||0)}function sr(f){f.g=Xs(()=>{f.g=null,f.i&&(f.i=!1,sr(f))},f.l);const b=f.h;f.h=null,f.m.apply(null,b)}class dn extends L{constructor(b,w){super(),this.m=b,this.l=w,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:sr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bt(f){L.call(this),this.h=f,this.g={}}x(Bt,L);var Xn=[];function Jn(f){He(f.g,function(b,w){this.g.hasOwnProperty(w)&&as(b)},f),f.g={}}Bt.prototype.N=function(){Bt.Z.N.call(this),Jn(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ir=c.JSON.stringify,Js=c.JSON.parse,Lr=class{stringify(f){return c.JSON.stringify(f,void 0)}parse(f){return c.JSON.parse(f,void 0)}};function ls(){}function K(){}var he={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Fe(){j.call(this,"d")}x(Fe,j);function Xe(){j.call(this,"c")}x(Xe,j);var Ke={},je=null;function Ht(){return je=je||new wt}Ke.Ia="serverreachability";function Ur(f){j.call(this,Ke.Ia,f)}x(Ur,j);function Dt(f){const b=Ht();It(b,new Ur(b))}Ke.STAT_EVENT="statevent";function Sn(f,b){j.call(this,Ke.STAT_EVENT,f),this.stat=b}x(Sn,j);function jt(f){const b=Ht();It(b,new Sn(b,f))}Ke.Ja="timingevent";function an(f,b){j.call(this,Ke.Ja,f),this.size=b}x(an,j);function xn(f,b){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){f()},b)}function br(){this.g=!0}br.prototype.ua=function(){this.g=!1};function ji(f,b,w,N,G,Q){f.info(function(){if(f.g)if(Q){var pe="",Ge=Q.split("&");for(let ht=0;ht<Ge.length;ht++){var on=Ge[ht].split("=");if(on.length>1){const Ft=on[0];on=on[1];const Qr=Ft.split("_");pe=Qr.length>=2&&Qr[1]=="type"?pe+(Ft+"="+on+"&"):pe+(Ft+"=redacted&")}}}else pe=null;else pe=Q;return"XMLHTTP REQ ("+N+") [attempt "+G+"]: "+b+`
`+w+`
`+pe})}function Ha(f,b,w,N,G,Q,pe){f.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+G+"]: "+b+`
`+w+`
`+Q+" "+pe})}function ar(f,b,w,N){f.info(function(){return"XMLHTTP TEXT ("+b+"): "+kc(f,w)+(N?" "+N:"")})}function Ts(f,b){f.info(function(){return"TIMEOUT: "+b})}br.prototype.info=function(){};function kc(f,b){if(!f.g)return b;if(!b)return null;try{const Q=JSON.parse(b);if(Q){for(f=0;f<Q.length;f++)if(Array.isArray(Q[f])){var w=Q[f];if(!(w.length<2)){var N=w[1];if(Array.isArray(N)&&!(N.length<1)){var G=N[0];if(G!="noop"&&G!="stop"&&G!="close")for(let pe=1;pe<N.length;pe++)N[pe]=""}}}}return ir(Q)}catch{return b}}var cs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ws={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Xt;function _e(){}x(_e,ls),_e.prototype.g=function(){return new XMLHttpRequest},Xt=new _e;function zr(f){return encodeURIComponent(String(f))}function Wo(f){var b=1;f=f.split(":");const w=[];for(;b>0&&f.length;)w.push(f.shift()),b--;return f.length&&w.push(f.join(":")),w}function or(f,b,w,N){this.j=f,this.i=b,this.l=w,this.S=N||1,this.V=new Bt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new xr}function xr(){this.i=null,this.g="",this.h=!1}var $t={},Jt={};function lr(f,b,w){f.M=1,f.A=Er(Ct(b)),f.u=w,f.R=!0,Oi(f,null)}function Oi(f,b){f.F=Date.now(),Br(f),f.B=Ct(f.A);var w=f.B,N=f.S;Array.isArray(N)||(N=[String(N)]),Rt(w.i,"t",N),f.C=0,w=f.j.L,f.h=new xr,f.g=Kh(f.j,w?b:null,!f.u),f.P>0&&(f.O=new dn(g(f.Y,f,f.g),f.P)),b=f.V,w=f.g,N=f.ba;var G="readystatechange";Array.isArray(G)||(G&&(Xn[0]=G.toString()),G=Xn);for(let Q=0;Q<G.length;Q++){const pe=We(w,G[Q],N||b.handleEvent,!1,b.h||b);if(!pe)break;b.g[pe.key]=pe}b=f.J?M(f.J):{},f.u?(f.v||(f.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,b)):(f.v="GET",f.g.ea(f.B,f.v,null,b)),Dt(),ji(f.i,f.v,f.B,f.l,f.S,f.u)}or.prototype.ba=function(f){f=f.target;const b=this.O;b&&ps(f)==3?b.j():this.Y(f)},or.prototype.Y=function(f){try{if(f==this.g)e:{const Ge=ps(this.g),on=this.g.ya(),ht=this.g.ca();if(!(Ge<3)&&(Ge!=3||this.g&&(this.h.h||this.g.la()||jn(this.g)))){this.K||Ge!=4||on==7||(on==8||ht<=0?Dt(3):Dt(2)),_r(this);var b=this.g.ca();this.X=b;var w=Dc(this);if(this.o=b==200,Ha(this.i,this.v,this.B,this.l,this.S,Ge,b),this.o){if(this.U&&!this.L){t:{if(this.g){var N,G=this.g;if((N=G.g?G.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(N)){var Q=N;break t}}Q=null}if(f=Q)ar(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,wr(this,f);else{this.o=!1,this.m=3,jt(12),Un(this),Wn(this);break e}}if(this.R){f=!0;let Ft;for(;!this.K&&this.C<w.length;)if(Ft=$a(this,w),Ft==Jt){Ge==4&&(this.m=4,jt(14),f=!1),ar(this.i,this.l,null,"[Incomplete Response]");break}else if(Ft==$t){this.m=4,jt(15),ar(this.i,this.l,w,"[Invalid Chunk]"),f=!1;break}else ar(this.i,this.l,Ft,null),wr(this,Ft);if(Zs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ge!=4||w.length!=0||this.h.h||(this.m=1,jt(16),f=!1),this.o=this.o&&f,!f)ar(this.i,this.l,w,"[Invalid Chunked Response]"),Un(this),Wn(this);else if(w.length>0&&!this.W){this.W=!0;var pe=this.j;pe.g==this&&pe.aa&&!pe.P&&(pe.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Lc(pe),pe.P=!0,jt(11))}}else ar(this.i,this.l,w,null),wr(this,w);Ge==4&&Un(this),this.o&&!this.K&&(Ge==4?Gh(this.j,this):(this.o=!1,Br(this)))}else ni(this.g),b==400&&w.indexOf("Unknown SID")>0?(this.m=3,jt(12)):(this.m=0,jt(13)),Un(this),Wn(this)}}}catch{}finally{}};function Dc(f){if(!Zs(f))return f.g.la();const b=jn(f.g);if(b==="")return"";let w="";const N=b.length,G=ps(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return Un(f),Wn(f),"";f.h.i=new c.TextDecoder}for(let Q=0;Q<N;Q++)f.h.h=!0,w+=f.h.i.decode(b[Q],{stream:!(G&&Q==N-1)});return b.length=0,f.h.g+=w,f.C=0,f.h.g}function Zs(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function $a(f,b){var w=f.C,N=b.indexOf(`
`,w);return N==-1?Jt:(w=Number(b.substring(w,N)),isNaN(w)?$t:(N+=1,N+w>b.length?Jt:(b=b.slice(N,N+w),f.C=N+w,b)))}or.prototype.cancel=function(){this.K=!0,Un(this)};function Br(f){f.T=Date.now()+f.H,ei(f,f.H)}function ei(f,b){if(f.D!=null)throw Error("WatchDog timer not null");f.D=xn(g(f.aa,f),b)}function _r(f){f.D&&(c.clearTimeout(f.D),f.D=null)}or.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(Ts(this.i,this.B),this.M!=2&&(Dt(),jt(17)),Un(this),this.m=2,Wn(this)):ei(this,this.T-f)};function Wn(f){f.j.I==0||f.K||Gh(f.j,f)}function Un(f){_r(f);var b=f.O;b&&typeof b.dispose=="function"&&b.dispose(),f.O=null,Jn(f.V),f.g&&(b=f.g,f.g=null,b.abort(),b.dispose())}function wr(f,b){try{var w=f.j;if(w.I!=0&&(w.g==f||Gr(w.h,f))){if(!f.L&&Gr(w.h,f)&&w.I==3){try{var N=w.Ba.g.parse(b)}catch{N=null}if(Array.isArray(N)&&N.length==3){var G=N;if(G[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<f.F)sl(w),Gi(w);else break e;to(w),jt(18)}}else w.xa=G[1],0<w.xa-w.K&&G[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=xn(g(w.Va,w),6e3));Fr(w.h)<=1&&w.ta&&(w.ta=void 0)}else ks(w,11)}else if((f.L||w.g==f)&&sl(w),!k(b))for(G=w.Ba.g.parse(b),b=0;b<G.length;b++){let ht=G[b];const Ft=ht[0];if(!(Ft<=w.K))if(w.K=Ft,ht=ht[1],w.I==2)if(ht[0]=="c"){w.M=ht[1],w.ba=ht[2];const Qr=ht[3];Qr!=null&&(w.ka=Qr,w.j.info("VER="+w.ka));const Ds=ht[4];Ds!=null&&(w.za=Ds,w.j.info("SVER="+w.za));const ms=ht[5];ms!=null&&typeof ms=="number"&&ms>0&&(N=1.5*ms,w.O=N,w.j.info("backChannelRequestTimeoutMs_="+N)),N=w;const gs=f.g;if(gs){const no=gs.g?gs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(no){var Q=N.h;Q.g||no.indexOf("spdy")==-1&&no.indexOf("quic")==-1&&no.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Qa(Q,Q.h),Q.h=null))}if(N.G){const il=gs.g?gs.g.getResponseHeader("X-HTTP-Session-Id"):null;il&&(N.wa=il,lt(N.J,N.G,il))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-f.F,w.j.info("Handshake RTT: "+w.T+"ms")),N=w;var pe=f;if(N.na=$h(N,N.L?N.ba:null,N.W),pe.L){qr(N.h,pe);var Ge=pe,on=N.O;on&&(Ge.H=on),Ge.D&&(_r(Ge),Br(Ge)),N.g=pe}else Bh(N);w.i.length>0&&Rs(w)}else ht[0]!="stop"&&ht[0]!="close"||ks(w,7);else w.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?ks(w,7):Mc(w):ht[0]!="noop"&&w.l&&w.l.qa(ht),w.A=0)}}Dt(4)}catch{}}var Wt=class{constructor(f,b){this.g=f,this.map=b}};function Ka(f){this.l=f||10,c.PerformanceNavigationTiming?(f=c.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Pi(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Fr(f){return f.h?1:f.g?f.g.size:0}function Gr(f,b){return f.h?f.h==b:f.g?f.g.has(b):!1}function Qa(f,b){f.g?f.g.add(b):f.h=b}function qr(f,b){f.h&&f.h==b?f.h=null:f.g&&f.g.has(b)&&f.g.delete(b)}Ka.prototype.cancel=function(){if(this.i=Ss(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Ss(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let b=f.i;for(const w of f.g.values())b=b.concat(w.G);return b}return A(f.i)}var Ya=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mi(f,b){if(f){f=f.split("&");for(let w=0;w<f.length;w++){const N=f[w].indexOf("=");let G,Q=null;N>=0?(G=f[w].substring(0,N),Q=f[w].substring(N+1)):G=f[w],b(G,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function Zt(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;f instanceof Zt?(this.l=f.l,en(this,f.j),this.o=f.o,this.g=f.g,Hr(this,f.u),this.h=f.h,us(this,Tr(f.i)),this.m=f.m):f&&(b=String(f).match(Ya))?(this.l=!1,en(this,b[1]||"",!0),this.o=Ot(b[2]||""),this.g=Ot(b[3]||"",!0),Hr(this,b[4]),this.h=Ot(b[5]||"",!0),us(this,b[6]||"",!0),this.m=Ot(b[7]||"")):(this.l=!1,this.i=new ee(null,this.l))}Zt.prototype.toString=function(){const f=[];var b=this.j;b&&f.push(Ns(b,Vi,!0),":");var w=this.g;return(w||b=="file")&&(f.push("//"),(b=this.o)&&f.push(Ns(b,Vi,!0),"@"),f.push(zr(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&f.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&f.push("/"),f.push(Ns(w,w.charAt(0)=="/"?Li:Zo,!0))),(w=this.i.toString())&&f.push("?",w),(w=this.m)&&f.push("#",Ns(w,T)),f.join("")},Zt.prototype.resolve=function(f){const b=Ct(this);let w=!!f.j;w?en(b,f.j):w=!!f.o,w?b.o=f.o:w=!!f.g,w?b.g=f.g:w=f.u!=null;var N=f.h;if(w)Hr(b,f.u);else if(w=!!f.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var G=b.h.lastIndexOf("/");G!=-1&&(N=b.h.slice(0,G+1)+N)}if(G=N,G==".."||G==".")N="";else if(G.indexOf("./")!=-1||G.indexOf("/.")!=-1){N=G.lastIndexOf("/",0)==0,G=G.split("/");const Q=[];for(let pe=0;pe<G.length;){const Ge=G[pe++];Ge=="."?N&&pe==G.length&&Q.push(""):Ge==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),N&&pe==G.length&&Q.push("")):(Q.push(Ge),N=!0)}N=Q.join("/")}else N=G}return w?b.h=N:w=f.i.toString()!=="",w?us(b,Tr(f.i)):w=!!f.m,w&&(b.m=f.m),b};function Ct(f){return new Zt(f)}function en(f,b,w){f.j=w?Ot(b,!0):b,f.j&&(f.j=f.j.replace(/:$/,""))}function Hr(f,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);f.u=b}else f.u=null}function us(f,b,w){b instanceof ee?(f.i=b,el(f.i,f.l)):(w||(b=Ns(b,hs)),f.i=new ee(b,f.l))}function lt(f,b,w){f.i.set(b,w)}function Er(f){return lt(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function Ot(f,b){return f?b?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Ns(f,b,w){return typeof f=="string"?(f=encodeURI(f).replace(b,Dn),w&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Dn(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Vi=/[#\/\?@]/g,Zo=/[#\?:]/g,Li=/[#\?]/g,hs=/[#\?@]/g,T=/#/g;function ee(f,b){this.h=this.g=null,this.i=f||null,this.j=!!b}function U(f){f.g||(f.g=new Map,f.h=0,f.i&&Mi(f.i,function(b,w){f.add(decodeURIComponent(b.replace(/\+/g," ")),w)}))}s=ee.prototype,s.add=function(f,b){U(this),this.i=null,f=Ui(this,f);let w=this.g.get(f);return w||this.g.set(f,w=[]),w.push(b),this.h+=1,this};function oe(f,b){U(f),b=Ui(f,b),f.g.has(b)&&(f.i=null,f.h-=f.g.get(b).length,f.g.delete(b))}function ye(f,b){return U(f),b=Ui(f,b),f.g.has(b)}s.forEach=function(f,b){U(this),this.g.forEach(function(w,N){w.forEach(function(G){f.call(b,G,N,this)},this)},this)};function Ue(f,b){U(f);let w=[];if(typeof b=="string")ye(f,b)&&(w=w.concat(f.g.get(Ui(f,b))));else for(f=Array.from(f.g.values()),b=0;b<f.length;b++)w=w.concat(f[b]);return w}s.set=function(f,b){return U(this),this.i=null,f=Ui(this,f),ye(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[b]),this.h+=1,this},s.get=function(f,b){return f?(f=Ue(this,f),f.length>0?String(f[0]):b):b};function Rt(f,b,w){oe(f,b),w.length>0&&(f.i=null,f.g.set(Ui(f,b),A(w)),f.h+=w.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],b=Array.from(this.g.keys());for(let N=0;N<b.length;N++){var w=b[N];const G=zr(w);w=Ue(this,w);for(let Q=0;Q<w.length;Q++){let pe=G;w[Q]!==""&&(pe+="="+zr(w[Q])),f.push(pe)}}return this.i=f.join("&")};function Tr(f){const b=new ee;return b.i=f.i,f.g&&(b.g=new Map(f.g),b.h=f.h),b}function Ui(f,b){return b=String(b),f.j&&(b=b.toLowerCase()),b}function el(f,b){b&&!f.j&&(U(f),f.i=null,f.g.forEach(function(w,N){const G=N.toLowerCase();N!=G&&(oe(this,N),Rt(this,G,w))},f)),f.j=b}function ds(f,b){const w=new br;if(c.Image){const N=new Image;N.onload=v($r,w,"TestLoadImage: loaded",!0,b,N),N.onerror=v($r,w,"TestLoadImage: error",!1,b,N),N.onabort=v($r,w,"TestLoadImage: abort",!1,b,N),N.ontimeout=v($r,w,"TestLoadImage: timeout",!1,b,N),c.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=f}else b(!1)}function jc(f,b){const w=new br,N=new AbortController,G=setTimeout(()=>{N.abort(),$r(w,"TestPingServer: timeout",!1,b)},1e4);fetch(f,{signal:N.signal}).then(Q=>{clearTimeout(G),Q.ok?$r(w,"TestPingServer: ok",!0,b):$r(w,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(G),$r(w,"TestPingServer: error",!1,b)})}function $r(f,b,w,N,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),N(w)}catch{}}function zi(){this.g=new Lr}function As(f){this.i=f.Sb||null,this.h=f.ab||!1}x(As,ls),As.prototype.g=function(){return new Xa(this.i,this.h)};function Xa(f,b){wt.call(this),this.H=f,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(Xa,wt),s=Xa.prototype,s.open=function(f,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=b,this.readyState=1,fs(this)},s.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(b.body=f),(this.H||c).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Bi(this)),this.readyState=0},s.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,fs(this)),this.g&&(this.readyState=3,fs(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;tl(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function tl(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}s.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var b=f.value?f.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!f.done}))&&(this.response=this.responseText+=b)}f.done?Bi(this):fs(this),this.readyState==3&&tl(this)}},s.Oa=function(f){this.g&&(this.response=this.responseText=f,Bi(this))},s.Na=function(f){this.g&&(this.response=f,Bi(this))},s.ga=function(){this.g&&Bi(this)};function Bi(f){f.readyState=4,f.l=null,f.j=null,f.B=null,fs(f)}s.setRequestHeader=function(f,b){this.A.append(f,b)},s.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],b=this.h.entries();for(var w=b.next();!w.done;)w=w.value,f.push(w[0]+": "+w[1]),w=b.next();return f.join(`\r
`)};function fs(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Xa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Kr(f){let b="";return He(f,function(w,N){b+=N,b+=":",b+=w,b+=`\r
`}),b}function Ja(f,b,w){e:{for(N in w){var N=!1;break e}N=!0}N||(w=Kr(w),typeof f=="string"?w!=null&&zr(w):lt(f,b,w))}function Et(f){wt.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(Et,wt);var Is=/^https?$/i,Oc=["POST","PUT"];s=Et.prototype,s.Fa=function(f){this.H=f},s.ea=function(f,b,w,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);b=b?b.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Xt.g(),this.g.onreadystatechange=E(g(this.Ca,this));try{this.B=!0,this.g.open(b,String(f),!0),this.B=!1}catch(Q){Wa(this,Q);return}if(f=w||"",w=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var G in N)w.set(G,N[G]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const Q of N.keys())w.set(Q,N.get(Q));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(w.keys()).find(Q=>Q.toLowerCase()=="content-type"),G=c.FormData&&f instanceof c.FormData,!(Array.prototype.indexOf.call(Oc,b,void 0)>=0)||N||G||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,pe]of w)this.g.setRequestHeader(Q,pe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(Q){Wa(this,Q)}};function Wa(f,b){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=b,f.o=5,Pc(f),ti(f)}function Pc(f){f.A||(f.A=!0,It(f,"complete"),It(f,"error"))}s.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,It(this,"complete"),It(this,"abort"),ti(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ti(this,!0)),Et.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Za(this):this.Xa())},s.Xa=function(){Za(this)};function Za(f){if(f.h&&typeof l<"u"){if(f.v&&ps(f)==4)setTimeout(f.Ca.bind(f),0);else if(It(f,"readystatechange"),ps(f)==4){f.h=!1;try{const Q=f.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var w;if(!(w=b)){var N;if(N=Q===0){let pe=String(f.D).match(Ya)[1]||null;!pe&&c.self&&c.self.location&&(pe=c.self.location.protocol.slice(0,-1)),N=!Is.test(pe?pe.toLowerCase():"")}w=N}if(w)It(f,"complete"),It(f,"success");else{f.o=6;try{var G=ps(f)>2?f.g.statusText:""}catch{G=""}f.l=G+" ["+f.ca()+"]",Pc(f)}}finally{ti(f)}}}}function ti(f,b){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const w=f.g;f.g=null,b||It(f,"ready");try{w.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function ps(f){return f.g?f.g.readyState:0}s.ca=function(){try{return ps(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(f){if(this.g){var b=this.g.responseText;return f&&b.indexOf(f)==0&&(b=b.substring(f.length)),Js(b)}};function jn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function ni(f){const b={};f=(f.g&&ps(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<f.length;N++){if(k(f[N]))continue;var w=Wo(f[N]);const G=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const Q=b[G]||[];b[G]=Q,Q.push(w)}Je(b,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Cs(f,b,w){return w&&w.internalChannelParams&&w.internalChannelParams[f]||b}function Fi(f){this.za=0,this.i=[],this.j=new br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Cs("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Cs("baseRetryDelayMs",5e3,f),this.Za=Cs("retryDelaySeedMs",1e4,f),this.Ta=Cs("forwardChannelMaxRetries",2,f),this.va=Cs("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Ka(f&&f.concurrentRequestLimit),this.Ba=new zi,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Fi.prototype,s.ka=8,s.I=1,s.connect=function(f,b,w,N){jt(0),this.W=f,this.H=b||{},w&&N!==void 0&&(this.H.OSID=w,this.H.OAID=N),this.F=this.X,this.J=$h(this,null,this.W),Rs(this)};function Mc(f){if(nl(f),f.I==3){var b=f.V++,w=Ct(f.J);if(lt(w,"SID",f.M),lt(w,"RID",b),lt(w,"TYPE","terminate"),eo(f,w),b=new or(f,f.j,b),b.M=2,b.A=Er(Ct(w)),w=!1,c.navigator&&c.navigator.sendBeacon)try{w=c.navigator.sendBeacon(b.A.toString(),"")}catch{}!w&&c.Image&&(new Image().src=b.A,w=!0),w||(b.g=Kh(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Br(b)}Hh(f)}function Gi(f){f.g&&(Lc(f),f.g.cancel(),f.g=null)}function nl(f){Gi(f),f.v&&(c.clearTimeout(f.v),f.v=null),sl(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&c.clearTimeout(f.m),f.m=null)}function Rs(f){if(!Pi(f.h)&&!f.m){f.m=!0;var b=f.Ea;Ee||C(),be||(Ee(),be=!0),I.add(b,f),f.D=0}}function rl(f,b){return Fr(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=b.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=xn(g(f.Ea,f,b),qh(f,f.D)),f.D++,!0)}s.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const G=new or(this,this.j,f);let Q=this.o;if(this.U&&(Q?(Q=M(Q),fe(Q,this.U)):Q=this.U),this.u!==null||this.R||(G.J=Q,Q=null),this.S)e:{for(var b=0,w=0;w<this.i.length;w++){t:{var N=this.i[w];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(b+=N,b>4096){b=w;break e}if(b===4096||w===this.i.length-1){b=w+1;break e}}b=1e3}else b=1e3;b=zh(this,G,b),w=Ct(this.J),lt(w,"RID",f),lt(w,"CVER",22),this.G&&lt(w,"X-HTTP-Session-Id",this.G),eo(this,w),Q&&(this.R?b="headers="+zr(Kr(Q))+"&"+b:this.u&&Ja(w,this.u,Q)),Qa(this.h,G),this.Ra&&lt(w,"TYPE","init"),this.S?(lt(w,"$req",b),lt(w,"SID","null"),G.U=!0,lr(G,w,null)):lr(G,w,b),this.I=2}}else this.I==3&&(f?Vc(this,f):this.i.length==0||Pi(this.h)||Vc(this))};function Vc(f,b){var w;b?w=b.l:w=f.V++;const N=Ct(f.J);lt(N,"SID",f.M),lt(N,"RID",w),lt(N,"AID",f.K),eo(f,N),f.u&&f.o&&Ja(N,f.u,f.o),w=new or(f,f.j,w,f.D+1),f.u===null&&(w.J=f.o),b&&(f.i=b.G.concat(f.i)),b=zh(f,w,1e3),w.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),Qa(f.h,w),lr(w,N,b)}function eo(f,b){f.H&&He(f.H,function(w,N){lt(b,N,w)}),f.l&&He({},function(w,N){lt(b,N,w)})}function zh(f,b,w){w=Math.min(f.i.length,w);const N=f.l?g(f.l.Ka,f.l,f):null;e:{var G=f.i;let Ge=-1;for(;;){const on=["count="+w];Ge==-1?w>0?(Ge=G[0].g,on.push("ofs="+Ge)):Ge=0:on.push("ofs="+Ge);let ht=!0;for(let Ft=0;Ft<w;Ft++){var Q=G[Ft].g;const Qr=G[Ft].map;if(Q-=Ge,Q<0)Ge=Math.max(0,G[Ft].g-100),ht=!1;else try{Q="req"+Q+"_"||"";try{var pe=Qr instanceof Map?Qr:Object.entries(Qr);for(const[Ds,ms]of pe){let gs=ms;d(ms)&&(gs=ir(ms)),on.push(Q+Ds+"="+encodeURIComponent(gs))}}catch(Ds){throw on.push(Q+"type="+encodeURIComponent("_badmap")),Ds}}catch{N&&N(Qr)}}if(ht){pe=on.join("&");break e}}pe=void 0}return f=f.i.splice(0,w),b.G=f,pe}function Bh(f){if(!f.g&&!f.v){f.Y=1;var b=f.Da;Ee||C(),be||(Ee(),be=!0),I.add(b,f),f.A=0}}function to(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=xn(g(f.Da,f),qh(f,f.A)),f.A++,!0)}s.Da=function(){if(this.v=null,Fh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=xn(g(this.Wa,this),f)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,jt(10),Gi(this),Fh(this))};function Lc(f){f.B!=null&&(c.clearTimeout(f.B),f.B=null)}function Fh(f){f.g=new or(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var b=Ct(f.na);lt(b,"RID","rpc"),lt(b,"SID",f.M),lt(b,"AID",f.K),lt(b,"CI",f.F?"0":"1"),!f.F&&f.ia&&lt(b,"TO",f.ia),lt(b,"TYPE","xmlhttp"),eo(f,b),f.u&&f.o&&Ja(b,f.u,f.o),f.O&&(f.g.H=f.O);var w=f.g;f=f.ba,w.M=1,w.A=Er(Ct(b)),w.u=null,w.R=!0,Oi(w,f)}s.Va=function(){this.C!=null&&(this.C=null,Gi(this),to(this),jt(19))};function sl(f){f.C!=null&&(c.clearTimeout(f.C),f.C=null)}function Gh(f,b){var w=null;if(f.g==b){sl(f),Lc(f),f.g=null;var N=2}else if(Gr(f.h,b))w=b.G,qr(f.h,b),N=1;else return;if(f.I!=0){if(b.o)if(N==1){w=b.u?b.u.length:0,b=Date.now()-b.F;var G=f.D;N=Ht(),It(N,new an(N,w)),Rs(f)}else Bh(f);else if(G=b.m,G==3||G==0&&b.X>0||!(N==1&&rl(f,b)||N==2&&to(f)))switch(w&&w.length>0&&(b=f.h,b.i=b.i.concat(w)),G){case 1:ks(f,5);break;case 4:ks(f,10);break;case 3:ks(f,6);break;default:ks(f,2)}}}function qh(f,b){let w=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(w*=2),w*b}function ks(f,b){if(f.j.info("Error code "+b),b==2){var w=g(f.bb,f),N=f.Ua;const G=!N;N=new Zt(N||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||en(N,"https"),Er(N),G?ds(N.toString(),w):jc(N.toString(),w)}else jt(2);f.I=0,f.l&&f.l.pa(b),Hh(f),nl(f)}s.bb=function(f){f?(this.j.info("Successfully pinged google.com"),jt(2)):(this.j.info("Failed to ping google.com"),jt(1))};function Hh(f){if(f.I=0,f.ja=[],f.l){const b=Ss(f.h);(b.length!=0||f.i.length!=0)&&(O(f.ja,b),O(f.ja,f.i),f.h.i.length=0,A(f.i),f.i.length=0),f.l.oa()}}function $h(f,b,w){var N=w instanceof Zt?Ct(w):new Zt(w);if(N.g!="")b&&(N.g=b+"."+N.g),Hr(N,N.u);else{var G=c.location;N=G.protocol,b=b?b+"."+G.hostname:G.hostname,G=+G.port;const Q=new Zt(null);N&&en(Q,N),b&&(Q.g=b),G&&Hr(Q,G),w&&(Q.h=w),N=Q}return w=f.G,b=f.wa,w&&b&&lt(N,w,b),lt(N,"VER",f.ka),eo(f,N),N}function Kh(f,b,w){if(b&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=f.Aa&&!f.ma?new Et(new As({ab:w})):new Et(f.ma),b.Fa(f.L),b}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qh(){}s=Qh.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function qi(){}qi.prototype.g=function(f,b){return new Zn(f,b)};function Zn(f,b){wt.call(this),this.g=new Fi(b),this.l=f,this.h=b&&b.messageUrlParams||null,f=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(f?f["X-WebChannel-Content-Type"]=b.messageContentType:f={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(f?f["X-WebChannel-Client-Profile"]=b.sa:f={"X-WebChannel-Client-Profile":b.sa}),this.g.U=f,(f=b&&b.Qb)&&!k(f)&&(this.g.u=f),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!k(b)&&(this.g.G=b,f=this.h,f!==null&&b in f&&(f=this.h,b in f&&delete f[b])),this.j=new ri(this)}x(Zn,wt),Zn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zn.prototype.close=function(){Mc(this.g)},Zn.prototype.o=function(f){var b=this.g;if(typeof f=="string"){var w={};w.__data__=f,f=w}else this.v&&(w={},w.__data__=ir(f),f=w);b.i.push(new Wt(b.Ya++,f)),b.I==3&&Rs(b)},Zn.prototype.N=function(){this.g.l=null,delete this.j,Mc(this.g),delete this.g,Zn.Z.N.call(this)};function Yh(f){Fe.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var b=f.__sm__;if(b){e:{for(const w in b){f=w;break e}f=void 0}(this.i=f)&&(f=this.i,b=b!==null&&f in b?b[f]:void 0),this.data=b}else this.data=f}x(Yh,Fe);function Xh(){Xe.call(this),this.status=1}x(Xh,Xe);function ri(f){this.g=f}x(ri,Qh),ri.prototype.ra=function(){It(this.g,"a")},ri.prototype.qa=function(f){It(this.g,new Yh(f))},ri.prototype.pa=function(f){It(this.g,new Xh)},ri.prototype.oa=function(){It(this.g,"b")},qi.prototype.createWebChannel=qi.prototype.g,Zn.prototype.send=Zn.prototype.o,Zn.prototype.open=Zn.prototype.m,Zn.prototype.close=Zn.prototype.close,PS=function(){return new qi},OS=function(){return Ht()},jS=Ke,M0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},cs.NO_ERROR=0,cs.TIMEOUT=8,cs.HTTP_ERROR=6,xf=cs,Ws.COMPLETE="complete",DS=Ws,K.EventType=he,he.OPEN="a",he.CLOSE="b",he.ERROR="c",he.MESSAGE="d",wt.prototype.listen=wt.prototype.J,Vu=K,Et.prototype.listenOnce=Et.prototype.K,Et.prototype.getLastError=Et.prototype.Ha,Et.prototype.getLastErrorCode=Et.prototype.ya,Et.prototype.getStatus=Et.prototype.ca,Et.prototype.getResponseJson=Et.prototype.La,Et.prototype.getResponseText=Et.prototype.la,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Fa,kS=Et}).apply(typeof nf<"u"?nf:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Fn.UNAUTHENTICATED=new Fn(null),Fn.GOOGLE_CREDENTIALS=new Fn("google-credentials-uid"),Fn.FIRST_PARTY=new Fn("first-party-uid"),Fn.MOCK_USER=new Fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sc="12.9.0";function k4(s){Sc=s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo=new Ey("@firebase/firestore");function Gl(){return Lo.logLevel}function ae(s,...e){if(Lo.logLevel<=rt.DEBUG){const t=e.map(Oy);Lo.debug(`Firestore (${Sc}): ${s}`,...t)}}function un(s,...e){if(Lo.logLevel<=rt.ERROR){const t=e.map(Oy);Lo.error(`Firestore (${Sc}): ${s}`,...t)}}function rc(s,...e){if(Lo.logLevel<=rt.WARN){const t=e.map(Oy);Lo.warn(`Firestore (${Sc}): ${s}`,...t)}}function Oy(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(s,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,MS(s,n,t)}function MS(s,e,t){let n=`FIRESTORE (${Sc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw un(n),new Error(n)}function Ie(s,e,t,n){let a="Unexpected state";typeof t=="string"?a=t:n=t,s||MS(e,a,n)}function Se(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends Ci{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class j4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Fn.UNAUTHENTICATED)))}shutdown(){}}class O4{constructor(e){this.t=e,this.currentUser=Fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ie(this.o===void 0,42304);let n=this.i;const a=p=>this.i!==n?(n=this.i,t(p)):Promise.resolve();let l=new qs;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new qs,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await a(this.currentUser)}))},d=p=>{ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((p=>d(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?d(p):(ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new qs)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ie(typeof n.accessToken=="string",31837,{l:n}),new D4(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ie(e===null||typeof e=="string",2055,{h:e}),new Fn(e)}}class P4{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Fn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class M4{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new P4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class h1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class V4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,rs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ie(this.o===void 0,3512);const n=l=>{l.error!=null&&ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,ae("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>n(l)))};const a=l=>{ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new h1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ie(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new h1(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<s;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=L4(40);for(let l=0;l<a.length;++l)n.length<20&&a[l]<t&&(n+=e.charAt(a[l]%62))}return n}}function Le(s,e){return s<e?-1:s>e?1:0}function V0(s,e){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++){const a=s.charAt(n),l=e.charAt(n);if(a!==l)return u0(a)===u0(l)?Le(a,l):u0(a)?1:-1}return Le(s.length,e.length)}const U4=55296,z4=57343;function u0(s){const e=s.charCodeAt(0);return e>=U4&&e<=z4}function sc(s,e,t){return s.length===e.length&&s.every(((n,a)=>t(n,e[a])))}function VS(s){return s+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1="__name__";class Vs{constructor(e,t,n){t===void 0?t=0:t>e.length&&xe(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&xe(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Vs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Vs?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let a=0;a<n;a++){const l=Vs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return Le(e.length,t.length)}static compareSegments(e,t){const n=Vs.isNumericId(e),a=Vs.isNumericId(t);return n&&!a?-1:!n&&a?1:n&&a?Vs.extractNumericId(e).compare(Vs.extractNumericId(t)):V0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Da.fromString(e.substring(4,e.length-2))}}class pt extends Vs{construct(e,t,n){return new pt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new de(Z.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((a=>a.length>0)))}return new pt(t)}static emptyPath(){return new pt([])}}const B4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qt extends Vs{construct(e,t,n){return new Qt(e,t,n)}static isValidIdentifier(e){return B4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===d1}static keyField(){return new Qt([d1])}static fromServerFormat(e){const t=[];let n="",a=0;const l=()=>{if(n.length===0)throw new de(Z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new de(Z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[a+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new de(Z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=p,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(n+=d,a++):(l(),a++)}if(l(),c)throw new de(Z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qt(t)}static emptyPath(){return new Qt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.path=e}static fromPath(e){return new ge(pt.fromString(e))}static fromName(e){return new ge(pt.fromString(e).popFirst(5))}static empty(){return new ge(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ge(new pt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(s,e,t){if(!t)throw new de(Z.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function F4(s,e,t,n){if(e===!0&&n===!0)throw new de(Z.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function f1(s){if(!ge.isDocumentKey(s))throw new de(Z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function p1(s){if(ge.isDocumentKey(s))throw new de(Z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function US(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function gp(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":xe(12329,{type:typeof s})}function Or(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new de(Z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=gp(s);throw new de(Z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bn(s,e){const t={typeString:s};return e&&(t.value=e),t}function Ch(s,e){if(!US(s))throw new de(Z.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const a=e[n].typeString,l="value"in e[n]?{value:e[n].value}:void 0;if(!(n in s)){t=`JSON missing required field: '${n}'`;break}const c=s[n];if(a&&typeof c!==a){t=`JSON field '${n}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${n}' field to equal '${l.value}'`;break}}if(t)throw new de(Z.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1=-62135596800,g1=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(e){return yt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*g1);return new yt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<m1)throw new de(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/g1}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ch(e,yt._jsonSchema))return new yt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-m1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yt._jsonSchemaVersion="firestore/timestamp/1.0",yt._jsonSchema={type:bn("string",yt._jsonSchemaVersion),seconds:bn("number"),nanoseconds:bn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{static fromTimestamp(e){return new ke(e)}static min(){return new ke(new yt(0,0))}static max(){return new ke(new yt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ic=-1;class Gf{constructor(e,t,n,a){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=a}}function L0(s){return s.fields.find((e=>e.kind===2))}function _o(s){return s.fields.filter((e=>e.kind!==2))}Gf.UNKNOWN_ID=-1;class _f{constructor(e,t){this.fieldPath=e,this.kind=t}}class oh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new oh(0,Mr.min())}}function zS(s,e){const t=s.toTimestamp().seconds,n=s.toTimestamp().nanoseconds+1,a=ke.fromTimestamp(n===1e9?new yt(t+1,0):new yt(t,n));return new Mr(a,ge.empty(),e)}function BS(s){return new Mr(s.readTime,s.key,ic)}class Mr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Mr(ke.min(),ge.empty(),ic)}static max(){return new Mr(ke.max(),ge.empty(),ic)}}function My(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ge.comparator(s.documentKey,e.documentKey),t!==0?t:Le(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class GS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ba(s){if(s.code!==Z.FAILED_PRECONDITION||s.message!==FS)throw s;ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new B(((n,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(n,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(n,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof B?t:B.resolve(t)}catch(t){return B.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):B.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):B.reject(t)}static resolve(e){return new B(((t,n)=>{t(e)}))}static reject(e){return new B(((t,n)=>{n(e)}))}static waitFor(e){return new B(((t,n)=>{let a=0,l=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++l,c&&l===a&&t()}),(p=>n(p)))})),c=!0,l===a&&t()}))}static or(e){let t=B.resolve(!1);for(const n of e)t=t.next((a=>a?B.resolve(a):n()));return t}static forEach(e,t){const n=[];return e.forEach(((a,l)=>{n.push(t.call(this,a,l))})),this.waitFor(n)}static mapArray(e,t){return new B(((n,a)=>{const l=e.length,c=new Array(l);let d=0;for(let p=0;p<l;p++){const g=p;t(e[g]).next((v=>{c[g]=v,++d,d===l&&n(c)}),(v=>a(v)))}}))}static doWhile(e,t){return new B(((n,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):n()};l()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr="SimpleDb";class yp{static open(e,t,n,a){try{return new yp(t,e.transaction(a,n))}catch(l){throw new qu(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new qs,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new qu(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const a=Vy(n.target.error);this.S.reject(new qu(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ae(Dr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new q4(t)}}class ja{static delete(e){return ae(Dr,"Removing database:",e),Eo(VT().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!qT())return!1;if(ja.F())return!0;const e=wn(),t=ja.M(e),n=0<t&&t<10,a=qS(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||l)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,ja.M(wn())===12.2&&un("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ae(Dr,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const c=l.target.result;t(c)},a.onblocked=()=>{n(new qu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const c=l.target.error;c.name==="VersionError"?n(new de(Z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?n(new de(Z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):n(new qu(e,c))},a.onupgradeneeded=l=>{ae(Dr,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const c=l.target.result;this.N.k(c,a.transaction,l.oldVersion,this.version).next((()=>{ae(Dr,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,a){const l=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.L(e);const d=yp.open(this.db,e,l?"readonly":"readwrite",n),p=a(d).next((g=>(d.C(),g))).catch((g=>(d.abort(g),B.reject(g)))).toPromise();return p.catch((()=>{})),await d.D,p}catch(d){const p=d,g=p.name!=="FirebaseError"&&c<3;if(ae(Dr,"Transaction failed with error:",p.message,"Retrying:",g),this.close(),!g)return Promise.reject(p)}}}close(){this.db&&this.db.close(),this.db=void 0}}function qS(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class G4{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Eo(this.U.delete())}}class qu extends de{constructor(e,t){super(Z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Fa(s){return s.name==="IndexedDbTransactionError"}class q4{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(ae(Dr,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(ae(Dr,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Eo(n)}add(e){return ae(Dr,"ADD",this.store.name,e,e),Eo(this.store.add(e))}get(e){return Eo(this.store.get(e)).next((t=>(t===void 0&&(t=null),ae(Dr,"GET",this.store.name,e,t),t)))}delete(e){return ae(Dr,"DELETE",this.store.name,e),Eo(this.store.delete(e))}count(){return ae(Dr,"COUNT",this.store.name),Eo(this.store.count())}H(e,t){const n=this.options(e,t),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(n.range);return new B(((c,d)=>{l.onerror=p=>{d(p.target.error)},l.onsuccess=p=>{c(p.target.result)}}))}{const l=this.cursor(n),c=[];return this.J(l,((d,p)=>{c.push(p)})).next((()=>c))}}Z(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new B(((a,l)=>{n.onerror=c=>{l(c.target.error)},n.onsuccess=c=>{a(c.target.result)}}))}X(e,t){ae(Dr,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const a=this.cursor(n);return this.J(a,((l,c,d)=>d.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const a=this.cursor(n);return this.J(a,t)}te(e){const t=this.cursor({});return new B(((n,a)=>{t.onerror=l=>{const c=Vy(l.target.error);a(c)},t.onsuccess=l=>{const c=l.target.result;c?e(c.primaryKey,c.value).next((d=>{d?c.continue():n()})):n()}}))}J(e,t){const n=[];return new B(((a,l)=>{e.onerror=c=>{l(c.target.error)},e.onsuccess=c=>{const d=c.target.result;if(!d)return void a();const p=new G4(d),g=t(d.primaryKey,d.value,p);if(g instanceof B){const v=g.catch((x=>(p.done(),B.reject(x))));n.push(v)}p.isDone?a():p.G===null?d.continue():d.continue(p.G)}})).next((()=>B.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Eo(s){return new B(((e,t)=>{s.onsuccess=n=>{const a=n.target.result;e(a)},s.onerror=n=>{const a=Vy(n.target.error);t(a)}}))}let y1=!1;function Vy(s){const e=ja.M(wn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const n=new de("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return y1||(y1=!0,setTimeout((()=>{throw n}),0)),n}}return s}const Hu="IndexBackfiller";class H4{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ae(Hu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ae(Hu,`Documents written: ${t}`)}catch(t){Fa(t)?ae(Hu,"Ignoring IndexedDB error during index backfill: ",t):await Ba(t)}await this.re(6e4)}))}}class $4{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let a=t,l=!0;return B.doWhile((()=>l===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!n.has(c))return ae(Hu,`Processing collection: ${c}`),this.oe(e,c,a).next((d=>{a-=d,n.add(c)}));l=!1})))).next((()=>t-a))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,n).next((l=>{const c=l.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this._e(a,l))).next((d=>(ae(Hu,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>c.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((a,l)=>{const c=BS(l);My(c,n)>0&&(n=c)})),new Mr(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}mr.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=-1;function vp(s){return s==null}function lh(s){return s===0&&1/s==-1/0}function HS(s){return typeof s=="number"&&Number.isInteger(s)&&!lh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf="";function Kn(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=v1(e)),e=K4(s.get(t),e);return v1(e)}function K4(s,e){let t=e;const n=s.length;for(let a=0;a<n;a++){const l=s.charAt(a);switch(l){case"\0":t+="";break;case qf:t+="";break;default:t+=l}}return t}function v1(s){return s+qf+""}function zs(s){const e=s.length;if(Ie(e>=2,64408,{path:s}),e===2)return Ie(s.charAt(0)===qf&&s.charAt(1)==="",56145,{path:s}),pt.emptyPath();const t=e-2,n=[];let a="";for(let l=0;l<e;){const c=s.indexOf(qf,l);switch((c<0||c>t)&&xe(50515,{path:s}),s.charAt(c+1)){case"":const d=s.substring(l,c);let p;a.length===0?p=d:(a+=d,p=a,a=""),n.push(p);break;case"":a+=s.substring(l,c),a+="\0";break;case"":a+=s.substring(l,c+1);break;default:xe(61167,{path:s})}l=c+2}return new pt(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo="remoteDocuments",Rh="owner",Ml="owner",ch="mutationQueues",Q4="userId",xs="mutations",b1="batchId",Io="userMutationsIndex",x1=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(s,e){return[s,Kn(e)]}function $S(s,e,t){return[s,Kn(e),t]}const Y4={},ac="documentMutations",Hf="remoteDocumentsV14",X4=["prefixPath","collectionGroup","readTime","documentId"],Ef="documentKeyIndex",J4=["prefixPath","collectionGroup","documentId"],KS="collectionGroupIndex",W4=["collectionGroup","readTime","prefixPath","documentId"],uh="remoteDocumentGlobal",U0="remoteDocumentGlobalKey",oc="targets",QS="queryTargetsIndex",Z4=["canonicalId","targetId"],lc="targetDocuments",eD=["targetId","path"],Ly="documentTargetsIndex",tD=["path","targetId"],$f="targetGlobalKey",Ro="targetGlobal",hh="collectionParents",nD=["collectionId","parent"],cc="clientMetadata",rD="clientId",bp="bundles",sD="bundleId",xp="namedQueries",iD="name",Uy="indexConfiguration",aD="indexId",z0="collectionGroupIndex",oD="collectionGroup",$u="indexState",lD=["indexId","uid"],YS="sequenceNumberIndex",cD=["uid","sequenceNumber"],Ku="indexEntries",uD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],XS="documentKeyIndex",hD=["indexId","uid","orderedDocumentKey"],_p="documentOverlays",dD=["userId","collectionPath","documentId"],B0="collectionPathOverlayIndex",fD=["userId","collectionPath","largestBatchId"],JS="collectionGroupOverlayIndex",pD=["userId","collectionGroup","largestBatchId"],zy="globals",mD="name",WS=[ch,xs,ac,wo,oc,Rh,Ro,lc,cc,uh,hh,bp,xp],gD=[...WS,_p],ZS=[ch,xs,ac,Hf,oc,Rh,Ro,lc,cc,uh,hh,bp,xp,_p],e2=ZS,By=[...e2,Uy,$u,Ku],yD=By,t2=[...By,zy],vD=t2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0 extends GS{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Tn(s,e){const t=Se(s);return ja.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _1(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Ga(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function n2(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,t){this.comparator=e,this.root=t||Ln.EMPTY}insert(e,t){return new Pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ln.BLACK,null,null))}remove(e){return new Pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return t+n.left.size;a<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rf(this.root,e,this.comparator,!1)}getReverseIterator(){return new rf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rf(this.root,e,this.comparator,!0)}}class rf{constructor(e,t,n,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?n(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ln{constructor(e,t,n,a,l){this.key=e,this.value=t,this.color=n??Ln.RED,this.left=a??Ln.EMPTY,this.right=l??Ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,a,l){return new Ln(e??this.key,t??this.value,n??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let a=this;const l=n(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,n),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Ln.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xe(27949);return e+(this.isRed()?0:1)}}Ln.EMPTY=null,Ln.RED=!0,Ln.BLACK=!1;Ln.EMPTY=new class{constructor(){this.size=0}get key(){throw xe(57766)}get value(){throw xe(16141)}get color(){throw xe(16727)}get left(){throw xe(29726)}get right(){throw xe(36894)}copy(e,t,n,a,l){return this}insert(e,t,n){return new Ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.comparator=e,this.data=new Pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new w1(this.data.getIterator())}getIteratorFrom(e){return new w1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof xt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=n.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new xt(this.comparator);return t.data=e,t}}class w1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Vl(s){return s.hasNext()?s.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.fields=e,e.sort(Qt.comparator)}static empty(){return new gr([])}unionWith(e){let t=new xt(Qt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new gr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sc(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new r2("Invalid base64 string: "+l):l}})(e);return new hn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hn.EMPTY_BYTE_STRING=new hn("");const bD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ni(s){if(Ie(!!s,39018),typeof s=="string"){let e=0;const t=bD.exec(s);if(Ie(!!t,46558,{timestamp:s}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(s);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:qt(s.seconds),nanos:qt(s.nanos)}}function qt(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Ai(s){return typeof s=="string"?hn.fromBase64String(s):hn.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2="server_timestamp",i2="__type__",a2="__previous_value__",o2="__local_write_time__";function Fy(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[i2])==null?void 0:n.stringValue)===s2}function wp(s){const e=s.mapValue.fields[a2];return Fy(e)?wp(e):e}function dh(s){const e=Ni(s.mapValue.fields[o2].timestampValue);return new yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e,t,n,a,l,c,d,p,g,v,x){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=v,this.apiKey=x}}const Kf="(default)";class Uo{constructor(e,t){this.projectId=e,this.database=t||Kf}static empty(){return new Uo("","")}get isDefaultDatabase(){return this.database===Kf}isEqual(e){return e instanceof Uo&&e.projectId===this.projectId&&e.database===this.database}}function _D(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new de(Z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Uo(s.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy="__type__",l2="__max__",Na={mapValue:{fields:{__type__:{stringValue:l2}}}},qy="__vector__",uc="value",Tf={nullValue:"NULL_VALUE"};function Pa(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Fy(s)?4:c2(s)?9007199254740991:Ep(s)?10:11:xe(28295,{value:s})}function $s(s,e){if(s===e)return!0;const t=Pa(s);if(t!==Pa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return dh(s).isEqual(dh(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Ni(a.timestampValue),d=Ni(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(a,l){return Ai(a.bytesValue).isEqual(Ai(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(a,l){return qt(a.geoPointValue.latitude)===qt(l.geoPointValue.latitude)&&qt(a.geoPointValue.longitude)===qt(l.geoPointValue.longitude)})(s,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return qt(a.integerValue)===qt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=qt(a.doubleValue),d=qt(l.doubleValue);return c===d?lh(c)===lh(d):isNaN(c)&&isNaN(d)}return!1})(s,e);case 9:return sc(s.arrayValue.values||[],e.arrayValue.values||[],$s);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},d=l.mapValue.fields||{};if(_1(c)!==_1(d))return!1;for(const p in c)if(c.hasOwnProperty(p)&&(d[p]===void 0||!$s(c[p],d[p])))return!1;return!0})(s,e);default:return xe(52216,{left:s})}}function fh(s,e){return(s.values||[]).find((t=>$s(t,e)))!==void 0}function Ma(s,e){if(s===e)return 0;const t=Pa(s),n=Pa(e);if(t!==n)return Le(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Le(s.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=qt(l.integerValue||l.doubleValue),p=qt(c.integerValue||c.doubleValue);return d<p?-1:d>p?1:d===p?0:isNaN(d)?isNaN(p)?0:-1:1})(s,e);case 3:return E1(s.timestampValue,e.timestampValue);case 4:return E1(dh(s),dh(e));case 5:return V0(s.stringValue,e.stringValue);case 6:return(function(l,c){const d=Ai(l),p=Ai(c);return d.compareTo(p)})(s.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),p=c.split("/");for(let g=0;g<d.length&&g<p.length;g++){const v=Le(d[g],p[g]);if(v!==0)return v}return Le(d.length,p.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=Le(qt(l.latitude),qt(c.latitude));return d!==0?d:Le(qt(l.longitude),qt(c.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return T1(s.arrayValue,e.arrayValue);case 10:return(function(l,c){var E,A,O,F;const d=l.fields||{},p=c.fields||{},g=(E=d[uc])==null?void 0:E.arrayValue,v=(A=p[uc])==null?void 0:A.arrayValue,x=Le(((O=g==null?void 0:g.values)==null?void 0:O.length)||0,((F=v==null?void 0:v.values)==null?void 0:F.length)||0);return x!==0?x:T1(g,v)})(s.mapValue,e.mapValue);case 11:return(function(l,c){if(l===Na.mapValue&&c===Na.mapValue)return 0;if(l===Na.mapValue)return 1;if(c===Na.mapValue)return-1;const d=l.fields||{},p=Object.keys(d),g=c.fields||{},v=Object.keys(g);p.sort(),v.sort();for(let x=0;x<p.length&&x<v.length;++x){const E=V0(p[x],v[x]);if(E!==0)return E;const A=Ma(d[p[x]],g[v[x]]);if(A!==0)return A}return Le(p.length,v.length)})(s.mapValue,e.mapValue);default:throw xe(23264,{he:t})}}function E1(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Le(s,e);const t=Ni(s),n=Ni(e),a=Le(t.seconds,n.seconds);return a!==0?a:Le(t.nanos,n.nanos)}function T1(s,e){const t=s.values||[],n=e.values||[];for(let a=0;a<t.length&&a<n.length;++a){const l=Ma(t[a],n[a]);if(l)return l}return Le(t.length,n.length)}function hc(s){return G0(s)}function G0(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const n=Ni(t);return`time(${n.seconds},${n.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Ai(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ge.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let n="[",a=!0;for(const l of t.values||[])a?a=!1:n+=",",n+=G0(l);return n+"]"})(s.arrayValue):"mapValue"in s?(function(t){const n=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of n)l?l=!1:a+=",",a+=`${c}:${G0(t.fields[c])}`;return a+"}"})(s.mapValue):xe(61005,{value:s})}function Sf(s){switch(Pa(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wp(s);return e?16+Sf(e):16;case 5:return 2*s.stringValue.length;case 6:return Ai(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,l)=>a+Sf(l)),0)})(s.arrayValue);case 10:case 11:return(function(n){let a=0;return Ga(n.fields,((l,c)=>{a+=l.length+Sf(c)})),a})(s.mapValue);default:throw xe(13486,{value:s})}}function ph(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function q0(s){return!!s&&"integerValue"in s}function mh(s){return!!s&&"arrayValue"in s}function S1(s){return!!s&&"nullValue"in s}function N1(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Nf(s){return!!s&&"mapValue"in s}function Ep(s){var t,n;return((n=(((t=s==null?void 0:s.mapValue)==null?void 0:t.fields)||{})[Gy])==null?void 0:n.stringValue)===qy}function Qu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Ga(s.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Qu(n))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Qu(s.arrayValue.values[t]);return e}return{...s}}function c2(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===l2}const u2={mapValue:{fields:{[Gy]:{stringValue:qy},[uc]:{arrayValue:{}}}}};function wD(s){return"nullValue"in s?Tf:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?ph(Uo.empty(),ge.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?Ep(s)?u2:{mapValue:{}}:xe(35942,{value:s})}function ED(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?ph(Uo.empty(),ge.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?u2:"mapValue"in s?Ep(s)?{mapValue:{}}:Na:xe(61959,{value:s})}function A1(s,e){const t=Ma(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function I1(s,e){const t=Ma(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.value=e}static empty(){return new Hn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Nf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qu(t)}setAll(e){let t=Qt.emptyPath(),n={},a=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,n,a),n={},a=[],t=d.popLast()}c?n[d.lastSegment()]=Qu(c):a.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,n,a)}delete(e){const t=this.field(e.popLast());Nf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $s(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=t.mapValue.fields[e.get(n)];Nf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,n){Ga(t,((a,l)=>e[a]=l));for(const a of n)delete e[a]}clone(){return new Hn(Qu(this.value))}}function h2(s){const e=[];return Ga(s.fields,((t,n)=>{const a=new Qt([t]);if(Nf(n)){const l=h2(n.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new gr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,t,n,a,l,c,d){this.key=e,this.documentType=t,this.version=n,this.readTime=a,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new rn(e,0,ke.min(),ke.min(),ke.min(),Hn.empty(),0)}static newFoundDocument(e,t,n,a){return new rn(e,1,t,ke.min(),n,a,0)}static newNoDocument(e,t){return new rn(e,2,t,ke.min(),ke.min(),Hn.empty(),0)}static newUnknownDocument(e,t){return new rn(e,3,t,ke.min(),ke.min(),Hn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Hn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Hn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof rn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,t){this.position=e,this.inclusive=t}}function C1(s,e,t){let n=0;for(let a=0;a<s.position.length;a++){const l=e[a],c=s.position[a];if(l.field.isKeyField()?n=ge.comparator(ge.fromName(c.referenceValue),t.key):n=Ma(c,t.data.field(l.field)),l.dir==="desc"&&(n*=-1),n!==0)break}return n}function R1(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!$s(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,t="asc"){this.field=e,this.dir=t}}function TD(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{}class st extends d2{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new SD(e,t,n):t==="array-contains"?new ID(e,n):t==="in"?new v2(e,n):t==="not-in"?new CD(e,n):t==="array-contains-any"?new RD(e,n):new st(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new ND(e,n):new AD(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ma(t,this.value)):t!==null&&Pa(this.value)===Pa(t)&&this.matchesComparison(Ma(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vt extends d2{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new vt(e,t)}matches(e){return fc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function fc(s){return s.op==="and"}function H0(s){return s.op==="or"}function Hy(s){return f2(s)&&fc(s)}function f2(s){for(const e of s.filters)if(e instanceof vt)return!1;return!0}function $0(s){if(s instanceof st)return s.field.canonicalString()+s.op.toString()+hc(s.value);if(Hy(s))return s.filters.map((e=>$0(e))).join(",");{const e=s.filters.map((t=>$0(t))).join(",");return`${s.op}(${e})`}}function p2(s,e){return s instanceof st?(function(n,a){return a instanceof st&&n.op===a.op&&n.field.isEqual(a.field)&&$s(n.value,a.value)})(s,e):s instanceof vt?(function(n,a){return a instanceof vt&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((l,c,d)=>l&&p2(c,a.filters[d])),!0):!1})(s,e):void xe(19439)}function m2(s,e){const t=s.filters.concat(e);return vt.create(t,s.op)}function g2(s){return s instanceof st?(function(t){return`${t.field.canonicalString()} ${t.op} ${hc(t.value)}`})(s):s instanceof vt?(function(t){return t.op.toString()+" {"+t.getFilters().map(g2).join(" ,")+"}"})(s):"Filter"}class SD extends st{constructor(e,t,n){super(e,t,n),this.key=ge.fromName(n.referenceValue)}matches(e){const t=ge.comparator(e.key,this.key);return this.matchesComparison(t)}}class ND extends st{constructor(e,t){super(e,"in",t),this.keys=y2("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class AD extends st{constructor(e,t){super(e,"not-in",t),this.keys=y2("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function y2(s,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>ge.fromName(n.referenceValue)))}class ID extends st{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return mh(t)&&fh(t.arrayValue,this.value)}}class v2 extends st{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&fh(this.value.arrayValue,t)}}class CD extends st{constructor(e,t){super(e,"not-in",t)}matches(e){if(fh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!fh(this.value.arrayValue,t)}}class RD extends st{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!mh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>fh(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e,t=null,n=[],a=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=a,this.limit=l,this.startAt=c,this.endAt=d,this.Te=null}}function K0(s,e=null,t=[],n=[],a=null,l=null,c=null){return new kD(s,e,t,n,a,l,c)}function zo(s){const e=Se(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>$0(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(l){return l.field.canonicalString()+l.dir})(n))).join(","),vp(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>hc(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>hc(n))).join(",")),e.Te=t}return e.Te}function kh(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!TD(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!p2(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!R1(s.startAt,e.startAt)&&R1(s.endAt,e.endAt)}function Yf(s){return ge.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function Xf(s,e){return s.filters.filter((t=>t instanceof st&&t.field.isEqual(e)))}function k1(s,e,t){let n=Tf,a=!0;for(const l of Xf(s,e)){let c=Tf,d=!0;switch(l.op){case"<":case"<=":c=wD(l.value);break;case"==":case"in":case">=":c=l.value;break;case">":c=l.value,d=!1;break;case"!=":case"not-in":c=Tf}A1({value:n,inclusive:a},{value:c,inclusive:d})<0&&(n=c,a=d)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const c=t.position[l];A1({value:n,inclusive:a},{value:c,inclusive:t.inclusive})<0&&(n=c,a=t.inclusive);break}}return{value:n,inclusive:a}}function D1(s,e,t){let n=Na,a=!0;for(const l of Xf(s,e)){let c=Na,d=!0;switch(l.op){case">=":case">":c=ED(l.value),d=!1;break;case"==":case"in":case"<=":c=l.value;break;case"<":c=l.value,d=!1;break;case"!=":case"not-in":c=Na}I1({value:n,inclusive:a},{value:c,inclusive:d})>0&&(n=c,a=d)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const c=t.position[l];I1({value:n,inclusive:a},{value:c,inclusive:t.inclusive})>0&&(n=c,a=t.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,t=null,n=[],a=[],l=null,c="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=a,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=p,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function b2(s,e,t,n,a,l,c,d){return new Dh(s,e,t,n,a,l,c,d)}function jh(s){return new Dh(s)}function j1(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function DD(s){return ge.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function x2(s){return s.collectionGroup!==null}function Yu(s){const e=Se(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new xt(Qt.comparator);return c.filters.forEach((p=>{p.getFlattenedFilters().forEach((g=>{g.isInequality()&&(d=d.add(g.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Qf(l,n))})),t.has(Qt.keyField().canonicalString())||e.Ie.push(new Qf(Qt.keyField(),n))}return e.Ie}function Pr(s){const e=Se(s);return e.Ee||(e.Ee=jD(e,Yu(s))),e.Ee}function jD(s,e){if(s.limitType==="F")return K0(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Qf(a.field,l)}));const t=s.endAt?new dc(s.endAt.position,s.endAt.inclusive):null,n=s.startAt?new dc(s.startAt.position,s.startAt.inclusive):null;return K0(s.path,s.collectionGroup,e,s.filters,s.limit,t,n)}}function Q0(s,e){const t=s.filters.concat([e]);return new Dh(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function Y0(s,e,t){return new Dh(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Tp(s,e){return kh(Pr(s),Pr(e))&&s.limitType===e.limitType}function _2(s){return`${zo(Pr(s))}|lt:${s.limitType}`}function ql(s){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((a=>g2(a))).join(", ")}]`),vp(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((a=>hc(a))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((a=>hc(a))).join(",")),`Target(${n})`})(Pr(s))}; limitType=${s.limitType})`}function Oh(s,e){return e.isFoundDocument()&&(function(n,a){const l=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(l):ge.isDocumentKey(n.path)?n.path.isEqual(l):n.path.isImmediateParentOf(l)})(s,e)&&(function(n,a){for(const l of Yu(n))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(n,a){for(const l of n.filters)if(!l.matches(a))return!1;return!0})(s,e)&&(function(n,a){return!(n.startAt&&!(function(c,d,p){const g=C1(c,d,p);return c.inclusive?g<=0:g<0})(n.startAt,Yu(n),a)||n.endAt&&!(function(c,d,p){const g=C1(c,d,p);return c.inclusive?g>=0:g>0})(n.endAt,Yu(n),a))})(s,e)}function w2(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function E2(s){return(e,t)=>{let n=!1;for(const a of Yu(s)){const l=OD(a,e,t);if(l!==0)return l;n=n||a.field.isKeyField()}return 0}}function OD(s,e,t){const n=s.field.isKeyField()?ge.comparator(e.key,t.key):(function(l,c,d){const p=c.data.field(l),g=d.data.field(l);return p!==null&&g!==null?Ma(p,g):xe(42886)})(s.field,e,t);switch(s.dir){case"asc":return n;case"desc":return-1*n;default:return xe(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[a,l]of n)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[t]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ga(this.inner,((t,n)=>{for(const[a,l]of n)e(a,l)}))}isEmpty(){return n2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=new Pt(ge.comparator);function jr(){return PD}const T2=new Pt(ge.comparator);function Lu(...s){let e=T2;for(const t of s)e=e.insert(t.key,t);return e}function S2(s){let e=T2;return s.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Bs(){return Xu()}function N2(){return Xu()}function Xu(){return new Ri((s=>s.toString()),((s,e)=>s.isEqual(e)))}const MD=new Pt(ge.comparator),VD=new xt(ge.comparator);function Qe(...s){let e=VD;for(const t of s)e=e.add(t);return e}const LD=new xt(Le);function $y(){return LD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:lh(e)?"-0":e}}function A2(s){return{integerValue:""+s}}function UD(s,e){return HS(e)?A2(e):Ky(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(){this._=void 0}}function zD(s,e,t){return s instanceof gh?(function(a,l){const c={fields:{[i2]:{stringValue:s2},[o2]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Fy(l)&&(l=wp(l)),l&&(c.fields[a2]=l),{mapValue:c}})(t,e):s instanceof pc?C2(s,e):s instanceof mc?R2(s,e):(function(a,l){const c=I2(a,l),d=O1(c)+O1(a.Ae);return q0(c)&&q0(a.Ae)?A2(d):Ky(a.serializer,d)})(s,e)}function BD(s,e,t){return s instanceof pc?C2(s,e):s instanceof mc?R2(s,e):t}function I2(s,e){return s instanceof yh?(function(n){return q0(n)||(function(l){return!!l&&"doubleValue"in l})(n)})(e)?e:{integerValue:0}:null}class gh extends Sp{}class pc extends Sp{constructor(e){super(),this.elements=e}}function C2(s,e){const t=k2(e);for(const n of s.elements)t.some((a=>$s(a,n)))||t.push(n);return{arrayValue:{values:t}}}class mc extends Sp{constructor(e){super(),this.elements=e}}function R2(s,e){let t=k2(e);for(const n of s.elements)t=t.filter((a=>!$s(a,n)));return{arrayValue:{values:t}}}class yh extends Sp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function O1(s){return qt(s.integerValue||s.doubleValue)}function k2(s){return mh(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e,t){this.field=e,this.transform=t}}function GD(s,e){return s.field.isEqual(e.field)&&(function(n,a){return n instanceof pc&&a instanceof pc||n instanceof mc&&a instanceof mc?sc(n.elements,a.elements,$s):n instanceof yh&&a instanceof yh?$s(n.Ae,a.Ae):n instanceof gh&&a instanceof gh})(s.transform,e.transform)}class qD{constructor(e,t){this.version=e,this.transformResults=t}}class $n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $n}static exists(e){return new $n(void 0,e)}static updateTime(e){return new $n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Af(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Np{}function D2(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new Ap(s.key,$n.none()):new Nc(s.key,s.data,$n.none());{const t=s.data,n=Hn.empty();let a=new xt(Qt.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?n.delete(l):n.set(l,c),a=a.add(l)}return new ki(s.key,n,new gr(a.toArray()),$n.none())}}function HD(s,e,t){s instanceof Nc?(function(a,l,c){const d=a.value.clone(),p=M1(a.fieldTransforms,l,c.transformResults);d.setAll(p),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(s,e,t):s instanceof ki?(function(a,l,c){if(!Af(a.precondition,l))return void l.convertToUnknownDocument(c.version);const d=M1(a.fieldTransforms,l,c.transformResults),p=l.data;p.setAll(j2(a)),p.setAll(d),l.convertToFoundDocument(c.version,p).setHasCommittedMutations()})(s,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Ju(s,e,t,n){return s instanceof Nc?(function(l,c,d,p){if(!Af(l.precondition,c))return d;const g=l.value.clone(),v=V1(l.fieldTransforms,p,c);return g.setAll(v),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),null})(s,e,t,n):s instanceof ki?(function(l,c,d,p){if(!Af(l.precondition,c))return d;const g=V1(l.fieldTransforms,p,c),v=c.data;return v.setAll(j2(l)),v.setAll(g),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((x=>x.field)))})(s,e,t,n):(function(l,c,d){return Af(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(s,e,t)}function $D(s,e){let t=null;for(const n of s.fieldTransforms){const a=e.data.field(n.field),l=I2(n.transform,a||null);l!=null&&(t===null&&(t=Hn.empty()),t.set(n.field,l))}return t||null}function P1(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&sc(n,a,((l,c)=>GD(l,c)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Nc extends Np{constructor(e,t,n,a=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ki extends Np{constructor(e,t,n,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function j2(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=s.data.field(t);e.set(t,n)}})),e}function M1(s,e,t){const n=new Map;Ie(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let a=0;a<t.length;a++){const l=s[a],c=l.transform,d=e.data.field(l.field);n.set(l.field,BD(c,d,t[a]))}return n}function V1(s,e,t){const n=new Map;for(const a of s){const l=a.transform,c=t.data.field(a.field);n.set(a.field,zD(l,c,e))}return n}class Ap extends Np{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class O2 extends Np{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,t,n,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&HD(l,e,n[a])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ju(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ju(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=N2();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=t.has(a.key)?null:d;const p=D2(c,d);p!==null&&n.set(a.key,p),c.isValidDocument()||c.convertToNoDocument(ke.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Qe())}isEqual(e){return this.batchId===e.batchId&&sc(this.mutations,e.mutations,((t,n)=>P1(t,n)))&&sc(this.baseMutations,e.baseMutations,((t,n)=>P1(t,n)))}}class Yy{constructor(e,t,n,a){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=a}static from(e,t,n){Ie(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return MD})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,n[c].version);return new Yy(e,t,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn,ot;function QD(s){switch(s){case Z.OK:return xe(64938);case Z.CANCELLED:case Z.UNKNOWN:case Z.DEADLINE_EXCEEDED:case Z.RESOURCE_EXHAUSTED:case Z.INTERNAL:case Z.UNAVAILABLE:case Z.UNAUTHENTICATED:return!1;case Z.INVALID_ARGUMENT:case Z.NOT_FOUND:case Z.ALREADY_EXISTS:case Z.PERMISSION_DENIED:case Z.FAILED_PRECONDITION:case Z.ABORTED:case Z.OUT_OF_RANGE:case Z.UNIMPLEMENTED:case Z.DATA_LOSS:return!0;default:return xe(15467,{code:s})}}function P2(s){if(s===void 0)return un("GRPC error has no .code"),Z.UNKNOWN;switch(s){case yn.OK:return Z.OK;case yn.CANCELLED:return Z.CANCELLED;case yn.UNKNOWN:return Z.UNKNOWN;case yn.DEADLINE_EXCEEDED:return Z.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return Z.RESOURCE_EXHAUSTED;case yn.INTERNAL:return Z.INTERNAL;case yn.UNAVAILABLE:return Z.UNAVAILABLE;case yn.UNAUTHENTICATED:return Z.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return Z.INVALID_ARGUMENT;case yn.NOT_FOUND:return Z.NOT_FOUND;case yn.ALREADY_EXISTS:return Z.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return Z.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return Z.FAILED_PRECONDITION;case yn.ABORTED:return Z.ABORTED;case yn.OUT_OF_RANGE:return Z.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return Z.UNIMPLEMENTED;case yn.DATA_LOSS:return Z.DATA_LOSS;default:return xe(39323,{code:s})}}(ot=yn||(yn={}))[ot.OK=0]="OK",ot[ot.CANCELLED=1]="CANCELLED",ot[ot.UNKNOWN=2]="UNKNOWN",ot[ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ot[ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ot[ot.NOT_FOUND=5]="NOT_FOUND",ot[ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",ot[ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",ot[ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",ot[ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ot[ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ot[ot.ABORTED=10]="ABORTED",ot[ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",ot[ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",ot[ot.INTERNAL=13]="INTERNAL",ot[ot.UNAVAILABLE=14]="UNAVAILABLE",ot[ot.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD=new Da([4294967295,4294967295],0);function L1(s){const e=YD().encode(s),t=new RS;return t.update(e),new Uint8Array(t.digest())}function U1(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Da([t,n],0),new Da([a,l],0)]}class Jy{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Uu(`Invalid padding: ${t}`);if(n<0)throw new Uu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Uu(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Uu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Da.fromNumber(this.ge)}ye(e,t,n){let a=e.add(t.multiply(Da.fromNumber(n)));return a.compare(XD)===1&&(a=new Da([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=L1(e),[n,a]=U1(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(n,a,l);if(!this.we(c))return!1}return!0}static create(e,t,n){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new Jy(l,a,t);return n.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const t=L1(e),[n,a]=U1(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(n,a,l);this.be(c)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Uu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,t,n,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const a=new Map;return a.set(e,Mh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Ph(ke.min(),a,new Pt(Le),jr(),Qe())}}class Mh{constructor(e,t,n,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Mh(n,t,Qe(),Qe(),Qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t,n,a){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=a}}class M2{constructor(e,t){this.targetId=e,this.Ce=t}}class V2{constructor(e,t,n=hn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=a}}class z1{constructor(){this.ve=0,this.Fe=B1(),this.Me=hn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Qe(),t=Qe(),n=Qe();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:n=n.add(a);break;default:xe(38017,{changeType:l})}})),new Mh(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=B1()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ie(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class JD{constructor(e){this.Ge=e,this.ze=new Map,this.je=jr(),this.He=sf(),this.Je=sf(),this.Ze=new Pt(Le)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:xe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,n=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(Yf(l))if(n===0){const c=new ge(l.path);this.et(t,c,rn.newNoDocument(c,ke.min()))}else Ie(n===1,20013,{expectedCount:n});else{const c=this._t(t);if(c!==n){const d=this.ut(e),p=d?this.ct(d,e,c):1;if(p!==0){this.it(t);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:l=0}=t;let c,d;try{c=Ai(n).toUint8Array()}catch(p){if(p instanceof r2)return rc("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{d=new Jy(c,a,l)}catch(p){return rc(p instanceof Uu?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return d.ge===0?null:d}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let a=0;return n.forEach((l=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const d=this.ot(c);if(d){if(l.current&&Yf(d.target)){const p=new ge(d.target.path);this.It(p).has(c)||this.Et(c,p)||this.et(c,p,rn.newNoDocument(p,e))}l.Be&&(t.set(c,l.ke()),l.Ke())}}));let n=Qe();this.Je.forEach(((l,c)=>{let d=!0;c.forEachWhile((p=>{const g=this.ot(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(n=n.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new Ph(e,t,this.Ze,this.je,n);return this.je=jr(),this.He=sf(),this.Je=sf(),this.Ze=new Pt(Le),a}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new z1,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new xt(Le),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new xt(Le),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new z1),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function sf(){return new Pt(ge.comparator)}function B1(){return new Pt(ge.comparator)}const WD={asc:"ASCENDING",desc:"DESCENDING"},ZD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ej={and:"AND",or:"OR"};class tj{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function X0(s,e){return s.useProto3Json||vp(e)?e:{value:e}}function gc(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function L2(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function nj(s,e){return gc(s,e.toTimestamp())}function tr(s){return Ie(!!s,49232),ke.fromTimestamp((function(t){const n=Ni(t);return new yt(n.seconds,n.nanos)})(s))}function Wy(s,e){return J0(s,e).canonicalString()}function J0(s,e){const t=(function(a){return new pt(["projects",a.projectId,"databases",a.database])})(s).child("documents");return e===void 0?t:t.child(e)}function U2(s){const e=pt.fromString(s);return Ie(Q2(e),10190,{key:e.toString()}),e}function Jf(s,e){return Wy(s.databaseId,e.path)}function ko(s,e){const t=U2(e);if(t.get(1)!==s.databaseId.projectId)throw new de(Z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new de(Z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ge(F2(t))}function z2(s,e){return Wy(s.databaseId,e)}function B2(s){const e=U2(s);return e.length===4?pt.emptyPath():F2(e)}function W0(s){return new pt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function F2(s){return Ie(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function F1(s,e,t){return{name:Jf(s,e),fields:t.value.mapValue.fields}}function rj(s,e,t){const n=ko(s,e.name),a=tr(e.updateTime),l=e.createTime?tr(e.createTime):ke.min(),c=new Hn({mapValue:{fields:e.fields}}),d=rn.newFoundDocument(n,a,l,c);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function sj(s,e){let t;if("targetChange"in e){e.targetChange;const n=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:xe(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(g,v){return g.useProto3Json?(Ie(v===void 0||typeof v=="string",58123),hn.fromBase64String(v||"")):(Ie(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),hn.fromUint8Array(v||new Uint8Array))})(s,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(g){const v=g.code===void 0?Z.UNKNOWN:P2(g.code);return new de(v,g.message||"")})(c);t=new V2(n,a,l,d||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=ko(s,n.document.name),l=tr(n.document.updateTime),c=n.document.createTime?tr(n.document.createTime):ke.min(),d=new Hn({mapValue:{fields:n.document.fields}}),p=rn.newFoundDocument(a,l,c,d),g=n.targetIds||[],v=n.removedTargetIds||[];t=new If(g,v,p.key,p)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=ko(s,n.document),l=n.readTime?tr(n.readTime):ke.min(),c=rn.newNoDocument(a,l),d=n.removedTargetIds||[];t=new If([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=ko(s,n.document),l=n.removedTargetIds||[];t=new If([],l,a,null)}else{if(!("filter"in e))return xe(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:l}=n,c=new KD(a,l),d=n.targetId;t=new M2(d,c)}}return t}function Wf(s,e){let t;if(e instanceof Nc)t={update:F1(s,e.key,e.value)};else if(e instanceof Ap)t={delete:Jf(s,e.key)};else if(e instanceof ki)t={update:F1(s,e.key,e.data),updateMask:uj(e.fieldMask)};else{if(!(e instanceof O2))return xe(16599,{dt:e.type});t={verify:Jf(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(l,c){const d=c.transform;if(d instanceof gh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof pc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof mc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof yh)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw xe(20930,{transform:c.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:nj(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:xe(27497)})(s,e.precondition)),t}function Z0(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?$n.updateTime(tr(l.updateTime)):l.exists!==void 0?$n.exists(l.exists):$n.none()})(e.currentDocument):$n.none(),n=e.updateTransforms?e.updateTransforms.map((a=>(function(c,d){let p=null;if("setToServerValue"in d)Ie(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),p=new gh;else if("appendMissingElements"in d){const v=d.appendMissingElements.values||[];p=new pc(v)}else if("removeAllFromArray"in d){const v=d.removeAllFromArray.values||[];p=new mc(v)}else"increment"in d?p=new yh(c,d.increment):xe(16584,{proto:d});const g=Qt.fromServerFormat(d.fieldPath);return new FD(g,p)})(s,a))):[];if(e.update){e.update.name;const a=ko(s,e.update.name),l=new Hn({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(p){const g=p.fieldPaths||[];return new gr(g.map((v=>Qt.fromServerFormat(v))))})(e.updateMask);return new ki(a,l,c,t,n)}return new Nc(a,l,t,n)}if(e.delete){const a=ko(s,e.delete);return new Ap(a,t)}if(e.verify){const a=ko(s,e.verify);return new O2(a,t)}return xe(1463,{proto:e})}function ij(s,e){return s&&s.length>0?(Ie(e!==void 0,14353),s.map((t=>(function(a,l){let c=a.updateTime?tr(a.updateTime):tr(l);return c.isEqual(ke.min())&&(c=tr(l)),new qD(c,a.transformResults||[])})(t,e)))):[]}function G2(s,e){return{documents:[z2(s,e.path)]}}function q2(s,e){const t={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=z2(s,a);const l=(function(g){if(g.length!==0)return K2(vt.create(g,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(g){if(g.length!==0)return g.map((v=>(function(E){return{field:Hl(E.field),direction:oj(E.dir)}})(v)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=X0(s,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:a}}function H2(s){let e=B2(s.parent);const t=s.structuredQuery,n=t.from?t.from.length:0;let a=null;if(n>0){Ie(n===1,65062);const v=t.from[0];v.allDescendants?a=v.collectionId:e=e.child(v.collectionId)}let l=[];t.where&&(l=(function(x){const E=$2(x);return E instanceof vt&&Hy(E)?E.getFilters():[E]})(t.where));let c=[];t.orderBy&&(c=(function(x){return x.map((E=>(function(O){return new Qf($l(O.field),(function(J){switch(J){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(O.direction))})(E)))})(t.orderBy));let d=null;t.limit&&(d=(function(x){let E;return E=typeof x=="object"?x.value:x,vp(E)?null:E})(t.limit));let p=null;t.startAt&&(p=(function(x){const E=!!x.before,A=x.values||[];return new dc(A,E)})(t.startAt));let g=null;return t.endAt&&(g=(function(x){const E=!x.before,A=x.values||[];return new dc(A,E)})(t.endAt)),b2(e,a,c,l,d,"F",p,g)}function aj(s,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xe(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function $2(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=$l(t.unaryFilter.field);return st.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=$l(t.unaryFilter.field);return st.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=$l(t.unaryFilter.field);return st.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=$l(t.unaryFilter.field);return st.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xe(61313);default:return xe(60726)}})(s):s.fieldFilter!==void 0?(function(t){return st.create($l(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xe(58110);default:return xe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return vt.create(t.compositeFilter.filters.map((n=>$2(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return xe(1026)}})(t.compositeFilter.op))})(s):xe(30097,{filter:s})}function oj(s){return WD[s]}function lj(s){return ZD[s]}function cj(s){return ej[s]}function Hl(s){return{fieldPath:s.canonicalString()}}function $l(s){return Qt.fromServerFormat(s.fieldPath)}function K2(s){return s instanceof st?(function(t){if(t.op==="=="){if(N1(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NAN"}};if(S1(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(N1(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NOT_NAN"}};if(S1(t.value))return{unaryFilter:{field:Hl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hl(t.field),op:lj(t.op),value:t.value}}})(s):s instanceof vt?(function(t){const n=t.getFilters().map((a=>K2(a)));return n.length===1?n[0]:{compositeFilter:{op:cj(t.op),filters:n}}})(s):xe(54877,{filter:s})}function uj(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Q2(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Y2(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,t,n,a,l=ke.min(),c=ke.min(),d=hn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=p}withSequenceNumber(e){return new wi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new wi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e){this.yt=e}}function hj(s,e){let t;if(e.document)t=rj(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=ge.fromSegments(e.noDocument.path),a=Fo(e.noDocument.readTime);t=rn.newNoDocument(n,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return xe(56709);{const n=ge.fromSegments(e.unknownDocument.path),a=Fo(e.unknownDocument.version);t=rn.newUnknownDocument(n,a)}}return e.readTime&&t.setReadTime((function(a){const l=new yt(a[0],a[1]);return ke.fromTimestamp(l)})(e.readTime)),t}function G1(s,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Zf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(l,c){return{name:Jf(l,c.key),fields:c.data.value.mapValue.fields,updateTime:gc(l,c.version.toTimestamp()),createTime:gc(l,c.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Bo(e.version)};else{if(!e.isUnknownDocument())return xe(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:Bo(e.version)}}return n}function Zf(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function Bo(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Fo(s){const e=new yt(s.seconds,s.nanoseconds);return ke.fromTimestamp(e)}function To(s,e){const t=(e.baseMutations||[]).map((l=>Z0(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const c=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const d=e.mutations[l+1];c.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const n=e.mutations.map((l=>Z0(s.yt,l))),a=yt.fromMillis(e.localWriteTimeMs);return new Qy(e.batchId,a,t,n)}function zu(s){const e=Fo(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?Fo(s.lastLimboFreeSnapshotVersion):ke.min();let n;return n=(function(l){return l.documents!==void 0})(s.query)?(function(l){const c=l.documents.length;return Ie(c===1,1966,{count:c}),Pr(jh(B2(l.documents[0])))})(s.query):(function(l){return Pr(H2(l))})(s.query),new wi(n,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,hn.fromBase64String(s.resumeToken))}function J2(s,e){const t=Bo(e.snapshotVersion),n=Bo(e.lastLimboFreeSnapshotVersion);let a;a=Yf(e.target)?G2(s.yt,e.target):q2(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:zo(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function W2(s){const e=H2({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Y0(e,e.limit,"L"):e}function h0(s,e){return new Xy(e.largestBatchId,Z0(s.yt,e.overlayMutation))}function q1(s,e){const t=e.path.lastSegment();return[s,Kn(e.path.popLast()),t]}function H1(s,e,t,n){return{indexId:s,uid:e,sequenceNumber:t,readTime:Bo(n.readTime),documentKey:Kn(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{getBundleMetadata(e,t){return $1(e).get(t).next((n=>{if(n)return(function(l){return{id:l.bundleId,createTime:Fo(l.createTime),version:l.version}})(n)}))}saveBundleMetadata(e,t){return $1(e).put((function(a){return{bundleId:a.id,createTime:Bo(tr(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return K1(e).get(t).next((n=>{if(n)return(function(l){return{name:l.name,query:W2(l.bundledQuery),readTime:Fo(l.readTime)}})(n)}))}saveNamedQuery(e,t){return K1(e).put((function(a){return{name:a.name,readTime:Bo(tr(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function $1(s){return Tn(s,bp)}function K1(s){return Tn(s,xp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new Ip(e,n)}getOverlay(e,t){return Su(e).get(q1(this.userId,t)).next((n=>n?h0(this.serializer,n):null))}getOverlays(e,t){const n=Bs();return B.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&n.set(a,l)})))).next((()=>n))}saveOverlays(e,t,n){const a=[];return n.forEach(((l,c)=>{const d=new Xy(t,c);a.push(this.bt(e,d))})),B.waitFor(a)}removeOverlaysForBatchId(e,t,n){const a=new Set;t.forEach((c=>a.add(Kn(c.getCollectionPath()))));const l=[];return a.forEach((c=>{const d=IDBKeyRange.bound([this.userId,c,n],[this.userId,c,n+1],!1,!0);l.push(Su(e).X(B0,d))})),B.waitFor(l)}getOverlaysForCollection(e,t,n){const a=Bs(),l=Kn(t),c=IDBKeyRange.bound([this.userId,l,n],[this.userId,l,Number.POSITIVE_INFINITY],!0);return Su(e).H(B0,c).next((d=>{for(const p of d){const g=h0(this.serializer,p);a.set(g.getKey(),g)}return a}))}getOverlaysForCollectionGroup(e,t,n,a){const l=Bs();let c;const d=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Su(e).ee({index:JS,range:d},((p,g,v)=>{const x=h0(this.serializer,g);l.size()<a||x.largestBatchId===c?(l.set(x.getKey(),x),c=x.largestBatchId):v.done()})).next((()=>l))}bt(e,t){return Su(e).put((function(a,l,c){const[d,p,g]=q1(l,c.mutation.key);return{userId:l,collectionPath:p,documentId:g,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:Wf(a.yt,c.mutation)}})(this.serializer,this.userId,t))}}function Su(s){return Tn(s,_p)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{St(e){return Tn(e,zy)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const n=t==null?void 0:t.value;return n?hn.fromUint8Array(n):hn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(qt(e.integerValue));else if("doubleValue"in e){const n=qt(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),lh(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=Ni(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ai(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?c2(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Ep(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):xe(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const n=e.fields||{};this.Ft(t,55);for(const a of Object.keys(n))this.Ot(a,t),this.Ct(n[a],t)}kt(e,t){var c,d;const n=e.fields||{};this.Ft(t,53);const a=uc,l=((d=(c=n[a].arrayValue)==null?void 0:c.values)==null?void 0:d.length)||0;this.Ft(t,15),t.Mt(qt(l)),this.Ot(a,t),this.Ct(n[a],t)}qt(e,t){const n=e.values||[];this.Ft(t,50);for(const a of n)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),ge.fromName(e).path.forEach((n=>{this.Ft(t,60),this.$t(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}So.Wt=new So;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=255;function pj(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function Q1(s){const e=64-(function(n){let a=0;for(let l=0;l<8;++l){const c=pj(255&n[l]);if(a+=c,c!==8)break}return a})(s);return Math.ceil(e/8)}class mj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ht(n.value),n=t.next();this.Jt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Xt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ht(n);else if(n<2048)this.Ht(960|n>>>6),this.Ht(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|n>>>12),this.Ht(128|63&n>>>6),this.Ht(128|63&n);else{const a=t.codePointAt(0);this.Ht(240|a>>>18),this.Ht(128|63&a>>>12),this.Ht(128|63&a>>>6),this.Ht(128|63&a)}}this.Jt()}Yt(e){const t=this.en(e),n=Q1(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),n=Q1(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(Ll),this.sn(255)}_n(){this.an(Ll),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,l,!1),new Uint8Array(c.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let a=1;a<t.length;++a)t[a]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ll?(this.sn(Ll),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ll?(this.an(Ll),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class gj{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class yj{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Nu{constructor(){this.cn=new mj,this.ascending=new gj(this.cn),this.descending=new yj(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e,t,n,a){this.hn=e,this.Pn=t,this.Tn=n,this.In=a}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.In,0),t!==e?n.set([0],this.In.length):++n[n.length-1],new No(this.hn,this.Pn,this.Tn,n)}Rn(e,t,n){return{indexId:this.hn,uid:e,arrayValue:Cf(this.Tn),directionalValue:Cf(this.In),orderedDocumentKey:Cf(t),documentKey:n.path.toArray()}}An(e,t,n){const a=this.Rn(e,t,n);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function pa(s,e){let t=s.hn-e.hn;return t!==0?t:(t=Y1(s.Tn,e.Tn),t!==0?t:(t=Y1(s.In,e.In),t!==0?t:ge.comparator(s.Pn,e.Pn)))}function Y1(s,e){for(let t=0;t<s.length&&t<e.length;++t){const n=s[t]-e[t];if(n!==0)return n}return s.length-e.length}function Cf(s){return GT()?(function(t){let n="";for(let a=0;a<t.length;a++)n+=String.fromCharCode(t[a]);return n})(s):s}function X1(s){return typeof s!="string"?s:(function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n})(s)}class J1{constructor(e){this.Vn=new xt(((t,n)=>Qt.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const n=t;n.isInequality()?this.Vn=this.Vn.add(n):this.mn.push(n)}}get fn(){return this.Vn.size>1}gn(e){if(Ie(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=L0(e);if(t!==void 0&&!this.pn(t))return!1;const n=_o(e);let a=new Set,l=0,c=0;for(;l<n.length&&this.pn(n[l]);++l)a=a.add(n[l].fieldPath.canonicalString());if(l===n.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!a.has(d.field.canonicalString())){const p=n[l];if(!this.yn(d,p)||!this.wn(this.dn[c++],p))return!1}++l}for(;l<n.length;++l){const d=n[l];if(c>=this.dn.length||!this.wn(this.dn[c++],d))return!1}return!0}bn(){if(this.fn)return null;let e=new xt(Qt.comparator);const t=[];for(const n of this.mn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new _f(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new _f(n.field,0))}for(const n of this.dn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new _f(n.field,n.dir==="asc"?0:1)));return new Gf(Gf.UNKNOWN_ID,this.collectionId,t,oh.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(s){var t,n;if(Ie(s instanceof st||s instanceof vt,20012),s instanceof st){if(s instanceof v2){const a=((n=(t=s.value.arrayValue)==null?void 0:t.values)==null?void 0:n.map((l=>st.create(s.field,"==",l))))||[];return vt.create(a,"or")}return s}const e=s.filters.map((a=>Z2(a)));return vt.create(e,s.op)}function vj(s){if(s.getFilters().length===0)return[];const e=ny(Z2(s));return Ie(eN(e),7391),ey(e)||ty(e)?[e]:e.getFilters()}function ey(s){return s instanceof st}function ty(s){return s instanceof vt&&Hy(s)}function eN(s){return ey(s)||ty(s)||(function(t){if(t instanceof vt&&H0(t)){for(const n of t.getFilters())if(!ey(n)&&!ty(n))return!1;return!0}return!1})(s)}function ny(s){if(Ie(s instanceof st||s instanceof vt,34018),s instanceof st)return s;if(s.filters.length===1)return ny(s.filters[0]);const e=s.filters.map((n=>ny(n)));let t=vt.create(e,s.op);return t=ep(t),eN(t)?t:(Ie(t instanceof vt,64498),Ie(fc(t),40251),Ie(t.filters.length>1,57927),t.filters.reduce(((n,a)=>Zy(n,a))))}function Zy(s,e){let t;return Ie(s instanceof st||s instanceof vt,38388),Ie(e instanceof st||e instanceof vt,25473),t=s instanceof st?e instanceof st?(function(a,l){return vt.create([a,l],"and")})(s,e):W1(s,e):e instanceof st?W1(e,s):(function(a,l){if(Ie(a.filters.length>0&&l.filters.length>0,48005),fc(a)&&fc(l))return m2(a,l.getFilters());const c=H0(a)?a:l,d=H0(a)?l:a,p=c.filters.map((g=>Zy(g,d)));return vt.create(p,"or")})(s,e),ep(t)}function W1(s,e){if(fc(e))return m2(e,s.getFilters());{const t=e.filters.map((n=>Zy(s,n)));return vt.create(t,"or")}}function ep(s){if(Ie(s instanceof st||s instanceof vt,11850),s instanceof st)return s;const e=s.getFilters();if(e.length===1)return ep(e[0]);if(f2(s))return s;const t=e.map((a=>ep(a))),n=[];return t.forEach((a=>{a instanceof st?n.push(a):a instanceof vt&&(a.op===s.op?n.push(...a.filters):n.push(a))})),n.length===1?n[0]:vt.create(n,s.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(){this.Sn=new ev}addToCollectionParentIndex(e,t){return this.Sn.add(t),B.resolve()}getCollectionParents(e,t){return B.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return B.resolve()}deleteFieldIndex(e,t){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,t){return B.resolve()}getDocumentsMatchingTarget(e,t){return B.resolve(null)}getIndexType(e,t){return B.resolve(0)}getFieldIndexes(e,t){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,t){return B.resolve(Mr.min())}getMinOffsetFromCollectionGroup(e,t){return B.resolve(Mr.min())}updateCollectionGroup(e,t,n){return B.resolve()}updateIndexEntries(e,t){return B.resolve()}}class ev{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t]||new xt(pt.comparator),l=!a.has(n);return this.index[t]=a.add(n),l}has(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t];return a&&a.has(n)}getEntries(e){return(this.index[e]||new xt(pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="IndexedDbIndexManager",af=new Uint8Array(0);class xj{constructor(e,t){this.databaseId=t,this.Dn=new ev,this.Cn=new Ri((n=>zo(n)),((n,a)=>kh(n,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const n=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const l={collectionId:n,parent:Kn(a)};return eE(e).put(l)}return B.resolve()}getCollectionParents(e,t){const n=[],a=IDBKeyRange.bound([t,""],[VS(t),""],!1,!0);return eE(e).H(a).next((l=>{for(const c of l){if(c.collectionId!==t)break;n.push(zs(c.parent))}return n}))}addFieldIndex(e,t){const n=Au(e),a=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((p=>[p.fieldPath.canonicalString(),p.kind]))}})(t);delete a.indexId;const l=n.add(a);if(t.indexState){const c=zl(e);return l.next((d=>{c.put(H1(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const n=Au(e),a=zl(e),l=Ul(e);return n.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Au(e),n=Ul(e),a=zl(e);return t.X().next((()=>n.X())).next((()=>a.X()))}createTargetIndexes(e,t){return B.forEach(this.vn(t),(n=>this.getIndexType(e,n).next((a=>{if(a===0||a===1){const l=new J1(n).bn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const n=Ul(e);let a=!0;const l=new Map;return B.forEach(this.vn(t),(c=>this.Fn(e,c).next((d=>{a&&(a=!!d),l.set(c,d)})))).next((()=>{if(a){let c=Qe();const d=[];return B.forEach(l,((p,g)=>{ae(Z1,`Using index ${(function(le){return`id=${le.indexId}|cg=${le.collectionGroup}|f=${le.fields.map((me=>`${me.fieldPath}:${me.kind}`)).join(",")}`})(p)} to execute ${zo(t)}`);const v=(function(le,me){const Ee=L0(me);if(Ee===void 0)return null;for(const be of Xf(le,Ee.fieldPath))switch(be.op){case"array-contains-any":return be.value.arrayValue.values||[];case"array-contains":return[be.value]}return null})(g,p),x=(function(le,me){const Ee=new Map;for(const be of _o(me))for(const I of Xf(le,be.fieldPath))switch(I.op){case"==":case"in":Ee.set(be.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return Ee.set(be.fieldPath.canonicalString(),I.value),Array.from(Ee.values())}return null})(g,p),E=(function(le,me){const Ee=[];let be=!0;for(const I of _o(me)){const C=I.kind===0?k1(le,I.fieldPath,le.startAt):D1(le,I.fieldPath,le.startAt);Ee.push(C.value),be&&(be=C.inclusive)}return new dc(Ee,be)})(g,p),A=(function(le,me){const Ee=[];let be=!0;for(const I of _o(me)){const C=I.kind===0?D1(le,I.fieldPath,le.endAt):k1(le,I.fieldPath,le.endAt);Ee.push(C.value),be&&(be=C.inclusive)}return new dc(Ee,be)})(g,p),O=this.Mn(p,g,E),F=this.Mn(p,g,A),J=this.xn(p,g,x),se=this.On(p.indexId,v,O,E.inclusive,F,A.inclusive,J);return B.forEach(se,(ce=>n.Z(ce,t.limit).next((le=>{le.forEach((me=>{const Ee=ge.fromSegments(me.documentKey);c.has(Ee)||(c=c.add(Ee),d.push(Ee))}))}))))})).next((()=>d))}return B.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=vj(vt.create(e.filters,"and")).map((n=>K0(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,n,a,l,c,d){const p=(t!=null?t.length:1)*Math.max(n.length,l.length),g=p/(t!=null?t.length:1),v=[];for(let x=0;x<p;++x){const E=t?this.Nn(t[x/g]):af,A=this.Bn(e,E,n[x%g],a),O=this.Ln(e,E,l[x%g],c),F=d.map((J=>this.Bn(e,E,J,!0)));v.push(...this.createRange(A,O,F))}return v}Bn(e,t,n,a){const l=new No(e,ge.empty(),t,n);return a?l:l.En()}Ln(e,t,n,a){const l=new No(e,ge.empty(),t,n);return a?l.En():l}Fn(e,t){const n=new J1(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((l=>{let c=null;for(const d of l)n.gn(d)&&(!c||d.fields.length>c.fields.length)&&(c=d);return c}))}getIndexType(e,t){let n=2;const a=this.vn(t);return B.forEach(a,(l=>this.Fn(e,l).next((c=>{c?n!==0&&c.fields.length<(function(p){let g=new xt(Qt.comparator),v=!1;for(const x of p.filters)for(const E of x.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?v=!0:g=g.add(E.field));for(const x of p.orderBy)x.field.isKeyField()||(g=g.add(x.field));return g.size+(v?1:0)})(l)&&(n=1):n=0})))).next((()=>(function(c){return c.limit!==null})(t)&&a.length>1&&n===2?1:n))}kn(e,t){const n=new Nu;for(const a of _o(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const c=n.ln(a.kind);So.Wt.Dt(l,c)}return n.un()}Nn(e){const t=new Nu;return So.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const n=new Nu;return So.Wt.Dt(ph(this.databaseId,t),n.ln((function(l){const c=_o(l);return c.length===0?0:c[c.length-1].kind})(e))),n.un()}xn(e,t,n){if(n===null)return[];let a=[];a.push(new Nu);let l=0;for(const c of _o(e)){const d=n[l++];for(const p of a)if(this.qn(t,c.fieldPath)&&mh(d))a=this.Un(a,c,d);else{const g=p.ln(c.kind);So.Wt.Dt(d,g)}}return this.$n(a)}Mn(e,t,n){return this.xn(e,t,n.position)}$n(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Un(e,t,n){const a=[...e],l=[];for(const c of n.arrayValue.values||[])for(const d of a){const p=new Nu;p.seed(d.un()),So.Wt.Dt(c,p.ln(t.kind)),l.push(p)}return l}qn(e,t){return!!e.filters.find((n=>n instanceof st&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=Au(e),a=zl(e);return(t?n.H(z0,IDBKeyRange.bound(t,t)):n.H()).next((l=>{const c=[];return B.forEach(l,(d=>a.get([d.indexId,this.uid]).next((p=>{c.push((function(v,x){const E=x?new oh(x.sequenceNumber,new Mr(Fo(x.readTime),new ge(zs(x.documentKey)),x.largestBatchId)):oh.empty(),A=v.fields.map((([O,F])=>new _f(Qt.fromServerFormat(O),F)));return new Gf(v.indexId,v.collectionGroup,A,E)})(d,p))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,a)=>{const l=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:Le(n.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const a=Au(e),l=zl(e);return this.Wn(e).next((c=>a.H(z0,IDBKeyRange.bound(t,t)).next((d=>B.forEach(d,(p=>l.put(H1(p.indexId,this.uid,c,n))))))))}updateIndexEntries(e,t){const n=new Map;return B.forEach(t,((a,l)=>{const c=n.get(a.collectionGroup);return(c?B.resolve(c):this.getFieldIndexes(e,a.collectionGroup)).next((d=>(n.set(a.collectionGroup,d),B.forEach(d,(p=>this.Qn(e,a,p).next((g=>{const v=this.Gn(l,p);return g.isEqual(v)?B.resolve():this.zn(e,l,p,g,v)})))))))}))}jn(e,t,n,a){return Ul(e).put(a.Rn(this.uid,this.Kn(n,t.key),t.key))}Hn(e,t,n,a){return Ul(e).delete(a.An(this.uid,this.Kn(n,t.key),t.key))}Qn(e,t,n){const a=Ul(e);let l=new xt(pa);return a.ee({index:XS,range:IDBKeyRange.only([n.indexId,this.uid,Cf(this.Kn(n,t))])},((c,d)=>{l=l.add(new No(n.indexId,t,X1(d.arrayValue),X1(d.directionalValue)))})).next((()=>l))}Gn(e,t){let n=new xt(pa);const a=this.kn(t,e);if(a==null)return n;const l=L0(t);if(l!=null){const c=e.data.field(l.fieldPath);if(mh(c))for(const d of c.arrayValue.values||[])n=n.add(new No(t.indexId,e.key,this.Nn(d),a))}else n=n.add(new No(t.indexId,e.key,af,a));return n}zn(e,t,n,a,l){ae(Z1,"Updating index entries for document '%s'",t.key);const c=[];return(function(p,g,v,x,E){const A=p.getIterator(),O=g.getIterator();let F=Vl(A),J=Vl(O);for(;F||J;){let se=!1,ce=!1;if(F&&J){const le=v(F,J);le<0?ce=!0:le>0&&(se=!0)}else F!=null?ce=!0:se=!0;se?(x(J),J=Vl(O)):ce?(E(F),F=Vl(A)):(F=Vl(A),J=Vl(O))}})(a,l,pa,(d=>{c.push(this.jn(e,t,n,d))}),(d=>{c.push(this.Hn(e,t,n,d))})),B.waitFor(c)}Wn(e){let t=1;return zl(e).ee({index:YS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,a,l)=>{l.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((c,d)=>pa(c,d))).filter(((c,d,p)=>!d||pa(c,p[d-1])!==0));const a=[];a.push(e);for(const c of n){const d=pa(c,e),p=pa(c,t);if(d===0)a[0]=e.En();else if(d>0&&p<0)a.push(c),a.push(c.En());else if(p>0)break}a.push(t);const l=[];for(let c=0;c<a.length;c+=2){if(this.Jn(a[c],a[c+1]))return[];const d=a[c].An(this.uid,af,ge.empty()),p=a[c+1].An(this.uid,af,ge.empty());l.push(IDBKeyRange.bound(d,p))}return l}Jn(e,t){return pa(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(tE)}getMinOffset(e,t){return B.mapArray(this.vn(t),(n=>this.Fn(e,n).next((a=>a||xe(44426))))).next(tE)}}function eE(s){return Tn(s,hh)}function Ul(s){return Tn(s,Ku)}function Au(s){return Tn(s,Uy)}function zl(s){return Tn(s,$u)}function tE(s){Ie(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<s.length;n++){const a=s[n].indexState.offset;My(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new Mr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tN=41943040;class Gn{static withCacheSize(e){return new Gn(e,Gn.DEFAULT_COLLECTION_PERCENTILE,Gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nN(s,e,t){const n=s.store(xs),a=s.store(ac),l=[],c=IDBKeyRange.only(t.batchId);let d=0;const p=n.ee({range:c},((v,x,E)=>(d++,E.delete())));l.push(p.next((()=>{Ie(d===1,47070,{batchId:t.batchId})})));const g=[];for(const v of t.mutations){const x=$S(e,v.key.path,t.batchId);l.push(a.delete(x)),g.push(v.key)}return B.waitFor(l).next((()=>g))}function tp(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw xe(14731);e=s.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gn.DEFAULT_COLLECTION_PERCENTILE=10,Gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gn.DEFAULT=new Gn(tN,Gn.DEFAULT_COLLECTION_PERCENTILE,Gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gn.DISABLED=new Gn(-1,0,0);class Cp{constructor(e,t,n,a){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=a,this.Zn={}}static wt(e,t,n,a){Ie(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new Cp(l,t,n,a)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ma(e).ee({index:Io,range:n},((a,l,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,n,a){const l=Kl(e),c=ma(e);return c.add({}).next((d=>{Ie(typeof d=="number",49019);const p=new Qy(d,t,n,a),g=(function(A,O,F){const J=F.baseMutations.map((ce=>Wf(A.yt,ce))),se=F.mutations.map((ce=>Wf(A.yt,ce)));return{userId:O,batchId:F.batchId,localWriteTimeMs:F.localWriteTime.toMillis(),baseMutations:J,mutations:se}})(this.serializer,this.userId,p),v=[];let x=new xt(((E,A)=>Le(E.canonicalString(),A.canonicalString())));for(const E of a){const A=$S(this.userId,E.key.path,d);x=x.add(E.key.path.popLast()),v.push(c.put(g)),v.push(l.put(A,Y4))}return x.forEach((E=>{v.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Zn[d]=p.keys()})),B.waitFor(v).next((()=>p))}))}lookupMutationBatch(e,t){return ma(e).get(t).next((n=>n?(Ie(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),To(this.serializer,n)):null))}Xn(e,t){return this.Zn[t]?B.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const a=n.keys();return this.Zn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=IDBKeyRange.lowerBound([this.userId,n]);let l=null;return ma(e).ee({index:Io,range:a},((c,d,p)=>{d.userId===this.userId&&(Ie(d.batchId>=n,47524,{Yn:n}),l=To(this.serializer,d)),p.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Co;return ma(e).ee({index:Io,range:t,reverse:!0},((a,l,c)=>{n=l.batchId,c.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Co],[this.userId,Number.POSITIVE_INFINITY]);return ma(e).H(Io,t).next((n=>n.map((a=>To(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=wf(this.userId,t.path),a=IDBKeyRange.lowerBound(n),l=[];return Kl(e).ee({range:a},((c,d,p)=>{const[g,v,x]=c,E=zs(v);if(g===this.userId&&t.path.isEqual(E))return ma(e).get(x).next((A=>{if(!A)throw xe(61480,{er:c,batchId:x});Ie(A.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:A.userId,batchId:x}),l.push(To(this.serializer,A))}));p.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new xt(Le);const a=[];return t.forEach((l=>{const c=wf(this.userId,l.path),d=IDBKeyRange.lowerBound(c),p=Kl(e).ee({range:d},((g,v,x)=>{const[E,A,O]=g,F=zs(A);E===this.userId&&l.path.isEqual(F)?n=n.add(O):x.done()}));a.push(p)})),B.waitFor(a).next((()=>this.tr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1,l=wf(this.userId,n),c=IDBKeyRange.lowerBound(l);let d=new xt(Le);return Kl(e).ee({range:c},((p,g,v)=>{const[x,E,A]=p,O=zs(E);x===this.userId&&n.isPrefixOf(O)?O.length===a&&(d=d.add(A)):v.done()})).next((()=>this.tr(e,d)))}tr(e,t){const n=[],a=[];return t.forEach((l=>{a.push(ma(e).get(l).next((c=>{if(c===null)throw xe(35274,{batchId:l});Ie(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:l}),n.push(To(this.serializer,c))})))})),B.waitFor(a).next((()=>n))}removeMutationBatch(e,t){return nN(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),B.forEach(n,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return B.resolve();const n=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),a=[];return Kl(e).ee({range:n},((l,c,d)=>{if(l[0]===this.userId){const p=zs(l[1]);a.push(p)}else d.done()})).next((()=>{Ie(a.length===0,56720,{rr:a.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return rN(e,this.userId,t)}ir(e){return sN(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Co,lastStreamToken:""}))}}function rN(s,e,t){const n=wf(e,t.path),a=n[1],l=IDBKeyRange.lowerBound(n);let c=!1;return Kl(s).ee({range:l,Y:!0},((d,p,g)=>{const[v,x,E]=d;v===e&&x===a&&(c=!0),g.done()})).next((()=>c))}function ma(s){return Tn(s,xs)}function Kl(s){return Tn(s,ac)}function sN(s){return Tn(s,ch)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Go(0)}static ar(){return new Go(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const n=new Go(t.highestTargetId);return t.highestTargetId=n.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>ke.fromTimestamp(new yt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.ur(e).next((a=>(a.highestListenSequenceNumber=t,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.cr(e,a))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((n=>(n.targetCount+=1,this.hr(t,n),this.cr(e,n))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Bl(e).delete(t.targetId))).next((()=>this.ur(e))).next((n=>(Ie(n.targetCount>0,8065),n.targetCount-=1,this.cr(e,n))))}removeTargets(e,t,n){let a=0;const l=[];return Bl(e).ee(((c,d)=>{const p=zu(d);p.sequenceNumber<=t&&n.get(p.targetId)===null&&(a++,l.push(this.removeTargetData(e,p)))})).next((()=>B.waitFor(l))).next((()=>a))}forEachTarget(e,t){return Bl(e).ee(((n,a)=>{const l=zu(a);t(l)}))}ur(e){return rE(e).get($f).next((t=>(Ie(t!==null,2888),t)))}cr(e,t){return rE(e).put($f,t)}lr(e,t){return Bl(e).put(J2(this.serializer,t))}hr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const n=zo(t),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let l=null;return Bl(e).ee({range:a,index:QS},((c,d,p)=>{const g=zu(d);kh(t,g.target)&&(l=g,p.done())})).next((()=>l))}addMatchingKeys(e,t,n){const a=[],l=Ta(e);return t.forEach((c=>{const d=Kn(c.path);a.push(l.put({targetId:n,path:d})),a.push(this.referenceDelegate.addReference(e,n,c))})),B.waitFor(a)}removeMatchingKeys(e,t,n){const a=Ta(e);return B.forEach(t,(l=>{const c=Kn(l.path);return B.waitFor([a.delete([n,c]),this.referenceDelegate.removeReference(e,n,l)])}))}removeMatchingKeysForTargetId(e,t){const n=Ta(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),a=Ta(e);let l=Qe();return a.ee({range:n,Y:!0},((c,d,p)=>{const g=zs(c[1]),v=new ge(g);l=l.add(v)})).next((()=>l))}containsKey(e,t){const n=Kn(t.path),a=IDBKeyRange.bound([n],[VS(n)],!1,!0);let l=0;return Ta(e).ee({index:Ly,Y:!0,range:a},(([c,d],p,g)=>{c!==0&&(l++,g.done())})).next((()=>l>0))}At(e,t){return Bl(e).get(t).next((n=>n?zu(n):null))}}function Bl(s){return Tn(s,oc)}function rE(s){return Tn(s,Ro)}function Ta(s){return Tn(s,lc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE="LruGarbageCollector",iN=1048576;function iE([s,e],[t,n]){const a=Le(s,t);return a===0?Le(e,n):a}class wj{constructor(e){this.Pr=e,this.buffer=new xt(iE),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();iE(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class aN{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ae(sE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Fa(t)?ae(sE,"Ignoring IndexedDB error during garbage collection: ",t):await Ba(t)}await this.Ar(3e5)}))}}class Ej{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return B.resolve(mr.ce);const n=new wj(t);return this.Vr.forEachTarget(e,(a=>n.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>n.Er(a))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ae("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(nE)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nE):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,a,l,c,d,p,g;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,c=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(n=x,d=Date.now(),this.removeTargets(e,n,t)))).next((x=>(l=x,p=Date.now(),this.removeOrphanedDocuments(e,n)))).next((x=>(g=Date.now(),Gl()<=rt.DEBUG&&ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-v}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${l} targets in `+(p-d)+`ms
	Removed ${x} documents in `+(g-p)+`ms
Total Duration: ${g-v}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:x}))))}}function oN(s,e){return new Ej(s,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e,t){this.db=e,this.garbageCollector=oN(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((a=>n+a))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((n,a)=>t(a)))}addReference(e,t,n){return of(e,n)}removeReference(e,t,n){return of(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return of(e,t)}wr(e,t){return(function(a,l){let c=!1;return sN(a).te((d=>rN(a,d,l).next((p=>(p&&(c=!0),B.resolve(!p)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.yr(e,((c,d)=>{if(d<=t){const p=this.wr(e,c).next((g=>{if(!g)return l++,n.getEntry(e,c).next((()=>(n.removeEntry(c,ke.min()),Ta(e).delete((function(x){return[0,Kn(x.path)]})(c)))))}));a.push(p)}})).next((()=>B.waitFor(a))).next((()=>n.apply(e))).next((()=>l))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return of(e,t)}yr(e,t){const n=Ta(e);let a,l=mr.ce;return n.ee({index:Ly},(([c,d],{path:p,sequenceNumber:g})=>{c===0?(l!==mr.ce&&t(new ge(zs(a)),l),l=g,a=p):l=mr.ce})).next((()=>{l!==mr.ce&&t(new ge(zs(a)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function of(s,e){return Ta(s).put((function(n,a){return{targetId:0,path:Kn(n.path),sequenceNumber:a}})(e,s.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(){this.changes=new Ri((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?B.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return bo(e).put(n)}removeEntry(e,t,n){return bo(e).delete((function(l,c){const d=l.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Zf(c),d[d.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.br(e,n))))}getEntry(e,t){let n=rn.newInvalidDocument(t);return bo(e).ee({index:Ef,range:IDBKeyRange.only(Iu(t))},((a,l)=>{n=this.Sr(t,l)})).next((()=>n))}Dr(e,t){let n={size:0,document:rn.newInvalidDocument(t)};return bo(e).ee({index:Ef,range:IDBKeyRange.only(Iu(t))},((a,l)=>{n={document:this.Sr(t,l),size:tp(l)}})).next((()=>n))}getEntries(e,t){let n=jr();return this.Cr(e,t,((a,l)=>{const c=this.Sr(a,l);n=n.insert(a,c)})).next((()=>n))}vr(e,t){let n=jr(),a=new Pt(ge.comparator);return this.Cr(e,t,((l,c)=>{const d=this.Sr(l,c);n=n.insert(l,d),a=a.insert(l,tp(c))})).next((()=>({documents:n,Fr:a})))}Cr(e,t,n){if(t.isEmpty())return B.resolve();let a=new xt(lE);t.forEach((p=>a=a.add(p)));const l=IDBKeyRange.bound(Iu(a.first()),Iu(a.last())),c=a.getIterator();let d=c.getNext();return bo(e).ee({index:Ef,range:l},((p,g,v)=>{const x=ge.fromSegments([...g.prefixPath,g.collectionGroup,g.documentId]);for(;d&&lE(d,x)<0;)n(d,null),d=c.getNext();d&&d.isEqual(x)&&(n(d,g),d=c.hasNext()?c.getNext():null),d?v.j(Iu(d)):v.done()})).next((()=>{for(;d;)n(d,null),d=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,n,a,l){const c=t.path,d=[c.popLast().toArray(),c.lastSegment(),Zf(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],p=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return bo(e).H(IDBKeyRange.bound(d,p,!0)).next((g=>{l==null||l.incrementDocumentReadCount(g.length);let v=jr();for(const x of g){const E=this.Sr(ge.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);E.isFoundDocument()&&(Oh(t,E)||a.has(E.key))&&(v=v.insert(E.key,E))}return v}))}getAllFromCollectionGroup(e,t,n,a){let l=jr();const c=oE(t,n),d=oE(t,Mr.max());return bo(e).ee({index:KS,range:IDBKeyRange.bound(c,d,!0)},((p,g,v)=>{const x=this.Sr(ge.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);l=l.insert(x.key,x),l.size===a&&v.done()})).next((()=>l))}newChangeBuffer(e){return new Nj(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return aE(e).get(U0).next((t=>(Ie(!!t,20021),t)))}br(e,t){return aE(e).put(U0,t)}Sr(e,t){if(t){const n=hj(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(ke.min())))return n}return rn.newInvalidDocument(e)}}function cN(s){return new Sj(s)}class Nj extends lN{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Ri((n=>n.toString()),((n,a)=>n.isEqual(a)))}applyChanges(e){const t=[];let n=0,a=new xt(((l,c)=>Le(l.canonicalString(),c.canonicalString())));return this.changes.forEach(((l,c)=>{const d=this.Or.get(l);if(t.push(this.Mr.removeEntry(e,l,d.readTime)),c.isValidDocument()){const p=G1(this.Mr.serializer,c);a=a.add(l.path.popLast());const g=tp(p);n+=g-d.size,t.push(this.Mr.addEntry(e,l,p))}else if(n-=d.size,this.trackRemovals){const p=G1(this.Mr.serializer,c.convertToNoDocument(ke.min()));t.push(this.Mr.addEntry(e,l,p))}})),a.forEach((l=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Mr.updateMetadata(e,n)),B.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((n=>(this.Or.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:n,Fr:a})=>(a.forEach(((l,c)=>{this.Or.set(l,{size:c,readTime:n.get(l).readTime})})),n)))}}function aE(s){return Tn(s,uh)}function bo(s){return Tn(s,Hf)}function Iu(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function oE(s,e){const t=e.documentKey.path.toArray();return[s,Zf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function lE(s,e){const t=s.path.toArray(),n=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<n.length-2;++l)if(a=Le(t[l],n[l]),a)return a;return a=Le(t.length,n.length),a||(a=Le(t[t.length-2],n[n.length-2]),a||Le(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(e,t,n,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(n!==null&&Ju(n.mutation,a,gr.empty(),yt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,Qe()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=Qe()){const a=Bs();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,n).next((l=>{let c=Lu();return l.forEach(((d,p)=>{c=c.insert(d,p.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const n=Bs();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Qe())))}populateOverlays(e,t,n){const a=[];return n.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,n,a){let l=jr();const c=Xu(),d=(function(){return Xu()})();return t.forEach(((p,g)=>{const v=n.get(g.key);a.has(g.key)&&(v===void 0||v.mutation instanceof ki)?l=l.insert(g.key,g):v!==void 0?(c.set(g.key,v.mutation.getFieldMask()),Ju(v.mutation,g,v.mutation.getFieldMask(),yt.now())):c.set(g.key,gr.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((g,v)=>c.set(g,v))),t.forEach(((g,v)=>d.set(g,new Aj(v,c.get(g)??null)))),d)))}recalculateAndSaveOverlays(e,t){const n=Xu();let a=new Pt(((c,d)=>c-d)),l=Qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((p=>{const g=t.get(p);if(g===null)return;let v=n.get(p)||gr.empty();v=d.applyToLocalView(g,v),n.set(p,v);const x=(a.get(d.batchId)||Qe()).add(p);a=a.insert(d.batchId,x)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),g=p.key,v=p.value,x=N2();v.forEach((E=>{if(!l.has(E)){const A=D2(t.get(E),n.get(E));A!==null&&x.set(E,A),l=l.add(E)}})),c.push(this.documentOverlayCache.saveOverlays(e,g,x))}return B.waitFor(c)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,a){return DD(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):x2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,a):this.getDocumentsMatchingCollectionQuery(e,t,n,a)}getNextDocuments(e,t,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,a-l.size):B.resolve(Bs());let d=ic,p=l;return c.next((g=>B.forEach(g,((v,x)=>(d<x.largestBatchId&&(d=x.largestBatchId),l.get(v)?B.resolve():this.remoteDocumentCache.getEntry(e,v).next((E=>{p=p.insert(v,E)}))))).next((()=>this.populateOverlays(e,g,l))).next((()=>this.computeViews(e,p,g,Qe()))).next((v=>({batchId:d,changes:S2(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ge(t)).next((n=>{let a=Lu();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,a){const l=t.collectionGroup;let c=Lu();return this.indexManager.getCollectionParents(e,l).next((d=>B.forEach(d,(p=>{const g=(function(x,E){return new Dh(E,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,g,n,a).next((v=>{v.forEach(((x,E)=>{c=c.insert(x,E)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,n,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,l,a)))).next((c=>{l.forEach(((p,g)=>{const v=g.getKey();c.get(v)===null&&(c=c.insert(v,rn.newInvalidDocument(v)))}));let d=Lu();return c.forEach(((p,g)=>{const v=l.get(p);v!==void 0&&Ju(v.mutation,g,gr.empty(),yt.now()),Oh(t,g)&&(d=d.insert(p,g))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return B.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:tr(a.createTime)}})(t)),B.resolve()}getNamedQuery(e,t){return B.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:W2(a.bundledQuery),readTime:tr(a.readTime)}})(t)),B.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(){this.overlays=new Pt(ge.comparator),this.Lr=new Map}getOverlay(e,t){return B.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Bs();return B.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&n.set(a,l)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((a,l)=>{this.bt(e,t,l)})),B.resolve()}removeOverlaysForBatchId(e,t,n){const a=this.Lr.get(n);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(n)),B.resolve()}getOverlaysForCollection(e,t,n){const a=Bs(),l=t.length+1,c=new ge(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const p=d.getNext().value,g=p.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===l&&p.largestBatchId>n&&a.set(p.getKey(),p)}return B.resolve(a)}getOverlaysForCollectionGroup(e,t,n,a){let l=new Pt(((g,v)=>g-v));const c=this.overlays.getIterator();for(;c.hasNext();){const g=c.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>n){let v=l.get(g.largestBatchId);v===null&&(v=Bs(),l=l.insert(g.largestBatchId,v)),v.set(g.getKey(),g)}}const d=Bs(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((g,v)=>d.set(g,v))),!(d.size()>=a)););return B.resolve(d)}bt(e,t,n){const a=this.overlays.get(n.key);if(a!==null){const c=this.Lr.get(a.largestBatchId).delete(n.key);this.Lr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new Xy(t,n));let l=this.Lr.get(t);l===void 0&&(l=Qe(),this.Lr.set(t,l)),this.Lr.set(t,l.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(){this.sessionToken=hn.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,B.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(){this.kr=new xt(An.Kr),this.qr=new xt(An.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new An(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new An(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new ge(new pt([])),n=new An(t,e),a=new An(t,e+1),l=[];return this.qr.forEachInRange([n,a],(c=>{this.Wr(c),l.push(c.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ge(new pt([])),n=new An(t,e),a=new An(t,e+1);let l=Qe();return this.qr.forEachInRange([n,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new An(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class An{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ge.comparator(e.key,t.key)||Le(e.Hr,t.Hr)}static Ur(e,t){return Le(e.Hr,t.Hr)||ge.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new xt(An.Kr)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new Qy(l,t,n,a);this.mutationQueue.push(c);for(const d of a)this.Jr=this.Jr.add(new An(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return B.resolve(c)}lookupMutationBatch(e,t){return B.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=this.Xr(n),l=a<0?0:a;return B.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?Co:this.Yn-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new An(t,0),a=new An(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([n,a],(c=>{const d=this.Zr(c.Hr);l.push(d)})),B.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new xt(Le);return t.forEach((a=>{const l=new An(a,0),c=new An(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,c],(d=>{n=n.add(d.Hr)}))})),B.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1;let l=n;ge.isDocumentKey(l)||(l=l.child(""));const c=new An(new ge(l),0);let d=new xt(Le);return this.Jr.forEachWhile((p=>{const g=p.key.path;return!!n.isPrefixOf(g)&&(g.length===a&&(d=d.add(p.Hr)),!0)}),c),B.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((n=>{const a=this.Zr(n);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Ie(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return B.forEach(t.mutations,(a=>{const l=new An(a.key,t.batchId);return n=n.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new An(t,0),a=this.Jr.firstAfterOrEqual(n);return B.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e){this.ti=e,this.docs=(function(){return new Pt(ge.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,a=this.docs.get(n),l=a?a.size:0,c=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return B.resolve(n?n.document.mutableCopy():rn.newInvalidDocument(t))}getEntries(e,t){let n=jr();return t.forEach((a=>{const l=this.docs.get(a);n=n.insert(a,l?l.document.mutableCopy():rn.newInvalidDocument(a))})),B.resolve(n)}getDocumentsMatchingQuery(e,t,n,a){let l=jr();const c=t.path,d=new ge(c.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(d);for(;p.hasNext();){const{key:g,value:{document:v}}=p.getNext();if(!c.isPrefixOf(g.path))break;g.path.length>c.length+1||My(BS(v),n)<=0||(a.has(v.key)||Oh(t,v))&&(l=l.insert(v.key,v.mutableCopy()))}return B.resolve(l)}getAllFromCollectionGroup(e,t,n,a){xe(9500)}ni(e,t){return B.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new jj(this)}getSize(e){return B.resolve(this.size)}}class jj extends lN{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(n)})),B.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e){this.persistence=e,this.ri=new Ri((t=>zo(t)),kh),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this.ii=0,this.si=new tv,this.targetCount=0,this.oi=Go._r()}forEachTarget(e,t){return this.ri.forEach(((n,a)=>t(a))),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),B.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Go(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,B.resolve()}updateTargetData(e,t){return this.lr(t),B.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,t,n){let a=0;const l=[];return this.ri.forEach(((c,d)=>{d.sequenceNumber<=t&&n.get(d.targetId)===null&&(this.ri.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),B.waitFor(l).next((()=>a))}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return B.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),B.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),B.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),B.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return B.resolve(n)}containsKey(e,t){return B.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t){this._i={},this.overlays={},this.ai=new mr(0),this.ui=!1,this.ui=!0,this.ci=new Rj,this.referenceDelegate=e(this),this.li=new Oj(this),this.indexManager=new bj,this.remoteDocumentCache=(function(a){return new Dj(a)})((n=>this.referenceDelegate.hi(n))),this.serializer=new X2(t),this.Pi=new Ij(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Cj,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new kj(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){ae("MemoryPersistence","Starting transaction:",e);const a=new Pj(this.ai.next());return this.referenceDelegate.Ti(),n(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return B.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class Pj extends GS{constructor(e){super(),this.currentSequenceNumber=e}}class Rp{constructor(e){this.persistence=e,this.Ri=new tv,this.Ai=null}static Vi(e){return new Rp(e)}get di(){if(this.Ai)return this.Ai;throw xe(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),B.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),B.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),B.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.di,(n=>{const a=ge.fromPath(n);return this.mi(e,a).next((l=>{l||t.removeEntry(a,ke.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return B.or([()=>B.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class np{constructor(e,t){this.persistence=e,this.fi=new Ri((n=>Kn(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=oN(this,t)}static Vi(e,t){return new np(e,t)}Ti(){}Ii(e){return B.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((a=>n+a))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return B.forEach(this.fi,((n,a)=>this.wr(e,n,a).next((l=>l?B.resolve():t(a)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(c=>this.wr(e,c,t).next((d=>{d||(n++,l.removeEntry(c,ke.min()))})))).next((()=>l.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),B.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),B.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),B.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Sf(e.data.value)),t}wr(e,t,n){return B.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return B.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e){this.serializer=e}k(e,t,n,a){const l=new yp("createOrUpgrade",t);n<1&&a>=1&&((function(p){p.createObjectStore(Rh)})(e),(function(p){p.createObjectStore(ch,{keyPath:Q4}),p.createObjectStore(xs,{keyPath:b1,autoIncrement:!0}).createIndex(Io,x1,{unique:!0}),p.createObjectStore(ac)})(e),cE(e),(function(p){p.createObjectStore(wo)})(e));let c=B.resolve();return n<3&&a>=3&&(n!==0&&((function(p){p.deleteObjectStore(lc),p.deleteObjectStore(oc),p.deleteObjectStore(Ro)})(e),cE(e)),c=c.next((()=>(function(p){const g=p.store(Ro),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ke.min().toTimestamp(),targetCount:0};return g.put($f,v)})(l)))),n<4&&a>=4&&(n!==0&&(c=c.next((()=>(function(p,g){return g.store(xs).H().next((x=>{p.deleteObjectStore(xs),p.createObjectStore(xs,{keyPath:b1,autoIncrement:!0}).createIndex(Io,x1,{unique:!0});const E=g.store(xs),A=x.map((O=>E.put(O)));return B.waitFor(A)}))})(e,l)))),c=c.next((()=>{(function(p){p.createObjectStore(cc,{keyPath:rD})})(e)}))),n<5&&a>=5&&(c=c.next((()=>this.gi(l)))),n<6&&a>=6&&(c=c.next((()=>((function(p){p.createObjectStore(uh)})(e),this.pi(l))))),n<7&&a>=7&&(c=c.next((()=>this.yi(l)))),n<8&&a>=8&&(c=c.next((()=>this.wi(e,l)))),n<9&&a>=9&&(c=c.next((()=>{(function(p){p.objectStoreNames.contains("remoteDocumentChanges")&&p.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&a>=10&&(c=c.next((()=>this.bi(l)))),n<11&&a>=11&&(c=c.next((()=>{(function(p){p.createObjectStore(bp,{keyPath:sD})})(e),(function(p){p.createObjectStore(xp,{keyPath:iD})})(e)}))),n<12&&a>=12&&(c=c.next((()=>{(function(p){const g=p.createObjectStore(_p,{keyPath:dD});g.createIndex(B0,fD,{unique:!1}),g.createIndex(JS,pD,{unique:!1})})(e)}))),n<13&&a>=13&&(c=c.next((()=>(function(p){const g=p.createObjectStore(Hf,{keyPath:X4});g.createIndex(Ef,J4),g.createIndex(KS,W4)})(e))).next((()=>this.Si(e,l))).next((()=>e.deleteObjectStore(wo)))),n<14&&a>=14&&(c=c.next((()=>this.Di(e,l)))),n<15&&a>=15&&(c=c.next((()=>(function(p){p.createObjectStore(Uy,{keyPath:aD,autoIncrement:!0}).createIndex(z0,oD,{unique:!1}),p.createObjectStore($u,{keyPath:lD}).createIndex(YS,cD,{unique:!1}),p.createObjectStore(Ku,{keyPath:uD}).createIndex(XS,hD,{unique:!1})})(e)))),n<16&&a>=16&&(c=c.next((()=>{t.objectStore($u).clear()})).next((()=>{t.objectStore(Ku).clear()}))),n<17&&a>=17&&(c=c.next((()=>{(function(p){p.createObjectStore(zy,{keyPath:mD})})(e)}))),n<18&&a>=18&&GT()&&(c=c.next((()=>{t.objectStore($u).clear()})).next((()=>{t.objectStore(Ku).clear()}))),c}pi(e){let t=0;return e.store(wo).ee(((n,a)=>{t+=tp(a)})).next((()=>{const n={byteSize:t};return e.store(uh).put(U0,n)}))}gi(e){const t=e.store(ch),n=e.store(xs);return t.H().next((a=>B.forEach(a,(l=>{const c=IDBKeyRange.bound([l.userId,Co],[l.userId,l.lastAcknowledgedBatchId]);return n.H(Io,c).next((d=>B.forEach(d,(p=>{Ie(p.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:p.batchId});const g=To(this.serializer,p);return nN(e,l.userId,g).next((()=>{}))}))))}))))}yi(e){const t=e.store(lc),n=e.store(wo);return e.store(Ro).get($f).next((a=>{const l=[];return n.ee(((c,d)=>{const p=new pt(c),g=(function(x){return[0,Kn(x)]})(p);l.push(t.get(g).next((v=>v?B.resolve():(x=>t.put({targetId:0,path:Kn(x),sequenceNumber:a.highestListenSequenceNumber}))(p))))})).next((()=>B.waitFor(l)))}))}wi(e,t){e.createObjectStore(hh,{keyPath:nD});const n=t.store(hh),a=new ev,l=c=>{if(a.add(c)){const d=c.lastSegment(),p=c.popLast();return n.put({collectionId:d,parent:Kn(p)})}};return t.store(wo).ee({Y:!0},((c,d)=>{const p=new pt(c);return l(p.popLast())})).next((()=>t.store(ac).ee({Y:!0},(([c,d,p],g)=>{const v=zs(d);return l(v.popLast())}))))}bi(e){const t=e.store(oc);return t.ee(((n,a)=>{const l=zu(a),c=J2(this.serializer,l);return t.put(c)}))}Si(e,t){const n=t.store(wo),a=[];return n.ee(((l,c)=>{const d=t.store(Hf),p=(function(x){return x.document?new ge(pt.fromString(x.document.name).popFirst(5)):x.noDocument?ge.fromSegments(x.noDocument.path):x.unknownDocument?ge.fromSegments(x.unknownDocument.path):xe(36783)})(c).path.toArray(),g={prefixPath:p.slice(0,p.length-2),collectionGroup:p[p.length-2],documentId:p[p.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};a.push(d.put(g))})).next((()=>B.waitFor(a)))}Di(e,t){const n=t.store(xs),a=cN(this.serializer),l=new nv(Rp.Vi,this.serializer.yt);return n.H().next((c=>{const d=new Map;return c.forEach((p=>{let g=d.get(p.userId)??Qe();To(this.serializer,p).keys().forEach((v=>g=g.add(v))),d.set(p.userId,g)})),B.forEach(d,((p,g)=>{const v=new Fn(g),x=Ip.wt(this.serializer,v),E=l.getIndexManager(v),A=Cp.wt(v,this.serializer,E,l.referenceDelegate);return new uN(a,A,x,E).recalculateAndSaveOverlaysForDocumentKeys(new F0(t,mr.ce),p).next()}))}))}}function cE(s){s.createObjectStore(lc,{keyPath:eD}).createIndex(Ly,tD,{unique:!0}),s.createObjectStore(oc,{keyPath:"targetId"}).createIndex(QS,Z4,{unique:!0}),s.createObjectStore(Ro)}const ga="IndexedDbPersistence",d0=18e5,f0=5e3,p0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Vj="main";class rv{constructor(e,t,n,a,l,c,d,p,g,v,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ci=l,this.window=c,this.document=d,this.Fi=g,this.Mi=v,this.xi=x,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=E=>Promise.resolve(),!rv.v())throw new de(Z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Tj(this,a),this.Ki=t+Vj,this.serializer=new X2(p),this.qi=new ja(this.Ki,this.xi,new Mj(this.serializer)),this.ci=new fj,this.li=new _j(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cN(this.serializer),this.Pi=new dj,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,v===!1&&un(ga,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new de(Z.FAILED_PRECONDITION,p0);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new mr(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>lf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Fa(e))return ae(ga,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ae(ga,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Cu(e).get(Ml).next((t=>B.resolve(this.Xi(t))))}Yi(e){return lf(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,d0)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=Tn(t,cc);return n.H().next((a=>{const l=this.ns(a,d0),c=a.filter((d=>l.indexOf(d)===-1));return B.forEach(c,(d=>n.delete(d.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?B.resolve(!0):Cu(e).get(Ml).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,f0)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new de(Z.FAILED_PRECONDITION,p0);return!1}}return!(!this.networkEnabled||!this.inForeground)||lf(e).H().next((n=>this.ns(n,f0).find((a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(l||c&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ae(ga,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Rh,cc],(e=>{const t=new F0(e,mr.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((n=>this.ts(n.updateTimeMs,t)&&!this.ss(n.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>lf(e).H().next((t=>this.ns(t,d0).map((n=>n.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return Cp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new xj(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Ip.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,n){ae(ga,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=(function(p){return p===18?vD:p===17?t2:p===16?yD:p===15?By:p===14?e2:p===13?ZS:p===12?gD:p===11?WS:void xe(60245)})(this.xi);let c;return this.qi.runTransaction(e,a,l,(d=>(c=new F0(d,this.ai?this.ai.next():mr.ce),t==="readwrite-primary"?this.ji(c).next((p=>!!p||this.Hi(c))).next((p=>{if(!p)throw un(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new de(Z.FAILED_PRECONDITION,FS);return n(c)})).next((p=>this.Zi(c).next((()=>p)))):this.Ps(c).next((()=>n(c)))))).then((d=>(c.raiseOnCommittedEvent(),d)))}Ps(e){return Cu(e).get(Ml).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,f0)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new de(Z.FAILED_PRECONDITION,p0)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Cu(e).put(Ml,t)}static v(){return ja.v()}Ji(e){const t=Cu(e);return t.get(Ml).next((n=>this.Xi(n)?(ae(ga,"Releasing primary lease."),t.delete(Ml)):B.resolve()))}ts(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(un(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;FT()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const n=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return ae(ga,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return un(ga,"Failed to get zombied client id.",n),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){un("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Cu(s){return Tn(s,Rh)}function lf(s){return Tn(s,cc)}function hN(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,t,n,a){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=a}static Es(e,t){let n=Qe(),a=Qe();for(const l of t.docChanges)switch(l.type){case 0:n=n.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new sv(e,t.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return FT()?8:qS(wn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,a){const l={result:null};return this.gs(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ps(e,t,a,n).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new Lj;return this.ys(e,t,c).next((d=>{if(l.result=d,this.As)return this.ws(e,t,c,d.size)}))})).next((()=>l.result))}ws(e,t,n,a){return n.documentReadCount<this.Vs?(Gl()<=rt.DEBUG&&ae("QueryEngine","SDK will not create cache indexes for query:",ql(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),B.resolve()):(Gl()<=rt.DEBUG&&ae("QueryEngine","Query:",ql(t),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.ds*a?(Gl()<=rt.DEBUG&&ae("QueryEngine","The SDK decides to create cache indexes for query:",ql(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pr(t))):B.resolve())}gs(e,t){if(j1(t))return B.resolve(null);let n=Pr(t);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Y0(t,null,"F"),n=Pr(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((l=>{const c=Qe(...l);return this.fs.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,n).next((p=>{const g=this.bs(t,d);return this.Ss(t,g,c,p.readTime)?this.gs(e,Y0(t,null,"F")):this.Ds(e,g,t,p)}))))})))))}ps(e,t,n,a){return j1(t)||a.isEqual(ke.min())?B.resolve(null):this.fs.getDocuments(e,n).next((l=>{const c=this.bs(t,l);return this.Ss(t,c,n,a)?B.resolve(null):(Gl()<=rt.DEBUG&&ae("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ql(t)),this.Ds(e,c,t,zS(a,ic)).next((d=>d)))}))}bs(e,t){let n=new xt(E2(e));return t.forEach(((a,l)=>{Oh(e,l)&&(n=n.add(l))})),n}Ss(e,t,n,a){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,n){return Gl()<=rt.DEBUG&&ae("QueryEngine","Using full collection scan to execute query:",ql(t)),this.fs.getDocumentsMatchingQuery(e,t,Mr.min(),n)}Ds(e,t,n,a){return this.fs.getDocumentsMatchingQuery(e,n,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iv="LocalStore",Uj=3e8;class zj{constructor(e,t,n,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new Pt(Le),this.Fs=new Ri((l=>zo(l)),kh),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uN(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function fN(s,e,t,n){return new zj(s,e,t,n)}async function pN(s,e){const t=Se(s);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return t.mutationQueue.getAllMutationBatches(n).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((l=>{const c=[],d=[];let p=Qe();for(const g of a){c.push(g.batchId);for(const v of g.mutations)p=p.add(v.key)}for(const g of l){d.push(g.batchId);for(const v of g.mutations)p=p.add(v.key)}return t.localDocuments.getDocuments(n,p).next((g=>({Ns:g,removedBatchIds:c,addedBatchIds:d})))}))}))}function Bj(s,e){const t=Se(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,p,g,v){const x=g.batch,E=x.keys();let A=B.resolve();return E.forEach((O=>{A=A.next((()=>v.getEntry(p,O))).next((F=>{const J=g.docVersions.get(O);Ie(J!==null,48541),F.version.compareTo(J)<0&&(x.applyToRemoteDocument(F,g),F.isValidDocument()&&(F.setReadTime(g.commitVersion),v.addEntry(F)))}))})),A.next((()=>d.mutationQueue.removeMutationBatch(p,x)))})(t,n,e,l).next((()=>l.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(d){let p=Qe();for(let g=0;g<d.mutationResults.length;++g)d.mutationResults[g].transformResults.length>0&&(p=p.add(d.batch.mutations[g].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(n,a)))}))}function mN(s){const e=Se(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function Fj(s,e){const t=Se(s),n=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const d=[];e.targetChanges.forEach(((v,x)=>{const E=a.get(x);if(!E)return;d.push(t.li.removeMatchingKeys(l,v.removedDocuments,x).next((()=>t.li.addMatchingKeys(l,v.addedDocuments,x))));let A=E.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(x)!==null?A=A.withResumeToken(hn.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):v.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(v.resumeToken,n)),a=a.insert(x,A),(function(F,J,se){return F.resumeToken.approximateByteSize()===0||J.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=Uj?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(E,A,v)&&d.push(t.li.updateTargetData(l,A))}));let p=jr(),g=Qe();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,v))})),d.push(Gj(l,c,e.documentUpdates).next((v=>{p=v.Bs,g=v.Ls}))),!n.isEqual(ke.min())){const v=t.li.getLastRemoteSnapshotVersion(l).next((x=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,n)));d.push(v)}return B.waitFor(d).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,p,g))).next((()=>p))})).then((l=>(t.vs=a,l)))}function Gj(s,e,t){let n=Qe(),a=Qe();return t.forEach((l=>n=n.add(l))),e.getEntries(s,n).next((l=>{let c=jr();return t.forEach(((d,p)=>{const g=l.get(d);p.isFoundDocument()!==g.isFoundDocument()&&(a=a.add(d)),p.isNoDocument()&&p.version.isEqual(ke.min())?(e.removeEntry(d,p.readTime),c=c.insert(d,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),c=c.insert(d,p)):ae(iv,"Ignoring outdated watch update for ",d,". Current version:",g.version," Watch version:",p.version)})),{Bs:c,Ls:a}}))}function qj(s,e){const t=Se(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Co),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function rp(s,e){const t=Se(s);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return t.li.getTargetData(n,e).next((l=>l?(a=l,B.resolve(a)):t.li.allocateTargetId(n).next((c=>(a=new wi(e,c,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=t.vs.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function yc(s,e,t){const n=Se(s),a=n.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",l,(c=>n.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!Fa(c))throw c;ae(iv,`Failed to update sequence numbers for target ${e}: ${c}`)}n.vs=n.vs.remove(e),n.Fs.delete(a.target)}function ry(s,e,t){const n=Se(s);let a=ke.min(),l=Qe();return n.persistence.runTransaction("Execute query","readwrite",(c=>(function(p,g,v){const x=Se(p),E=x.Fs.get(v);return E!==void 0?B.resolve(x.vs.get(E)):x.li.getTargetData(g,v)})(n,c,Pr(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(c,d.targetId).next((p=>{l=p}))})).next((()=>n.Cs.getDocumentsMatchingQuery(c,e,t?a:ke.min(),t?l:Qe()))).next((d=>(vN(n,w2(e),d),{documents:d,ks:l})))))}function gN(s,e){const t=Se(s),n=Se(t.li),a=t.vs.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(l=>n.At(l,e).next((c=>c?c.target:null))))}function yN(s,e){const t=Se(s),n=t.Ms.get(e)||ke.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.xs.getAllFromCollectionGroup(a,e,zS(n,ic),Number.MAX_SAFE_INTEGER))).then((a=>(vN(t,e,a),a)))}function vN(s,e,t){let n=s.Ms.get(e)||ke.min();t.forEach(((a,l)=>{l.readTime.compareTo(n)>0&&(n=l.readTime)})),s.Ms.set(e,n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN="firestore_clients";function uE(s,e){return`${bN}_${s}_${e}`}const xN="firestore_mutations";function hE(s,e,t){let n=`${xN}_${s}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const _N="firestore_targets";function m0(s,e){return`${_N}_${s}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us="SharedClientState";class sp{constructor(e,t,n,a){this.user=e,this.batchId=t,this.state=n,this.error=a}static $s(e,t,n){const a=JSON.parse(n);let l,c=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return c&&a.error&&(c=typeof a.error.message=="string"&&typeof a.error.code=="string",c&&(l=new de(a.error.code,a.error.message))),c?new sp(e,t,a.state,l):(un(Us,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Wu{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static $s(e,t){const n=JSON.parse(t);let a,l=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return l&&n.error&&(l=typeof n.error.message=="string"&&typeof n.error.code=="string",l&&(a=new de(n.error.code,n.error.message))),l?new Wu(e,n.state,a):(un(Us,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ip{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const n=JSON.parse(t);let a=typeof n=="object"&&n.activeTargetIds instanceof Array,l=$y();for(let c=0;a&&c<n.activeTargetIds.length;++c)a=HS(n.activeTargetIds[c]),l=l.add(n.activeTargetIds[c]);return a?new ip(e,l):(un(Us,`Failed to parse client data for instance '${e}': ${t}`),null)}}class av{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new av(t.clientId,t.onlineState):(un(Us,`Failed to parse online state: ${e}`),null)}}class sy{constructor(){this.activeTargetIds=$y()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class g0{constructor(e,t,n,a,l){this.window=e,this.Ci=t,this.persistenceKey=n,this.zs=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new Pt(Le),this.started=!1,this.Zs=[];const c=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.Xs=uE(this.persistenceKey,this.zs),this.Ys=(function(p){return`firestore_sequence_number_${p}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new sy),this.eo=new RegExp(`^${bN}_${c}_([^_]*)$`),this.no=new RegExp(`^${xN}_${c}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${_N}_${c}_(\\d+)$`),this.io=(function(p){return`firestore_online_state_${p}`})(this.persistenceKey),this.so=(function(p){return`firestore_bundle_loaded_v2_${p}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const n of e){if(n===this.zs)continue;const a=this.getItem(uE(this.persistenceKey,n));if(a){const l=ip.$s(n,a);l&&(this.Js=this.Js.insert(l.clientId,l))}}this.oo();const t=this.storage.getItem(this.io);if(t){const n=this._o(t);n&&this.ao(n)}for(const n of this.Zs)this.Hs(n);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((n,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,n){this.co(e,t,n),this.lo(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(m0(this.persistenceKey,e));if(a){const l=Wu.$s(e,a);l&&(n=l.state)}}return t&&this.ho.Qs(e),this.oo(),n}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(m0(this.persistenceKey,e))}updateQueryState(e,t,n){this.Po(e,t,n)}handleUserChange(e,t,n){t.forEach((a=>{this.lo(a)})),this.currentUser=e,n.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ae(Us,"READ",e,t),t}setItem(e,t){ae(Us,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ae(Us,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(ae(Us,"EVENT",t.key,t.newValue),t.key===this.Xs)return void un("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const n=this.Eo(t.key);return this.Ro(n,null)}{const n=this.Ao(t.key,t.newValue);if(n)return this.Ro(n.clientId,n)}}else if(this.no.test(t.key)){if(t.newValue!==null){const n=this.Vo(t.key,t.newValue);if(n)return this.mo(n)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const n=this.fo(t.key,t.newValue);if(n)return this.po(n)}}else if(t.key===this.io){if(t.newValue!==null){const n=this._o(t.newValue);if(n)return this.ao(n)}}else if(t.key===this.Ys){const n=(function(l){let c=mr.ce;if(l!=null)try{const d=JSON.parse(l);Ie(typeof d=="number",30636,{yo:l}),c=d}catch(d){un(Us,"Failed to read sequence number from WebStorage",d)}return c})(t.newValue);n!==mr.ce&&this.sequenceNumberHandler(n)}else if(t.key===this.so){const n=this.wo(t.newValue);await Promise.all(n.map((a=>this.syncEngine.bo(a))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,n){const a=new sp(this.currentUser,e,t,n),l=hE(this.persistenceKey,this.currentUser,e);this.setItem(l,a.Ws())}lo(e){const t=hE(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,n){const a=m0(this.persistenceKey,e),l=new Wu(e,t,n);this.setItem(a,l.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const n=this.Eo(e);return ip.$s(n,t)}Vo(e,t){const n=this.no.exec(e),a=Number(n[1]),l=n[2]!==void 0?n[2]:null;return sp.$s(new Fn(l),a,t)}fo(e,t){const n=this.ro.exec(e),a=Number(n[1]);return Wu.$s(a,t)}_o(e){return av.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);ae(Us,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const n=t?this.Js.insert(e,t):this.Js.remove(e),a=this.uo(this.Js),l=this.uo(n),c=[],d=[];return l.forEach((p=>{a.has(p)||c.push(p)})),a.forEach((p=>{l.has(p)||d.push(p)})),this.syncEngine.Co(c,d).then((()=>{this.Js=n}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=$y();return e.forEach(((n,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class wN{constructor(){this.vo=new sy,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new sy,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE="ConnectivityMonitor";class fE{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ae(dE,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ae(dE,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cf=null;function iy(){return cf===null?cf=(function(){return 268435456+Math.round(2147483648*Math.random())})():cf++,"0x"+cf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0="RestConnection",$j={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class Kj{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${a}`,this.$o=this.databaseId.database===Kf?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Wo(e,t,n,a,l){const c=iy(),d=this.Qo(e,t.toUriEncodedString());ae(y0,`Sending RPC '${e}' ${c}:`,d,n);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(p,a,l);const{host:g}=new URL(d),v=wc(g);return this.zo(e,d,p,n,v).then((x=>(ae(y0,`Received RPC '${e}' ${c}: `,x),x)),(x=>{throw rc(y0,`RPC '${e}' ${c} failed with error: `,x,"url: ",d,"request:",n),x}))}jo(e,t,n,a,l,c){return this.Wo(e,t,n,a,l)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Sc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),n&&n.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const n=$j[e];let a=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn="WebChannelConnection",Ru=(s,e,t)=>{s.listen(e,(n=>{try{t(n)}catch(a){setTimeout((()=>{throw a}),0)}}))};class Zl extends Kj{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Zl.c_){const e=OS();Ru(e,jS.STAT_EVENT,(t=>{t.stat===M0.PROXY?ae(Bn,"STAT_EVENT: detected buffering proxy"):t.stat===M0.NOPROXY&&ae(Bn,"STAT_EVENT: detected no buffering proxy")})),Zl.c_=!0}}zo(e,t,n,a,l){const c=iy();return new Promise(((d,p)=>{const g=new kS;g.setWithCredentials(!0),g.listenOnce(DS.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case xf.NO_ERROR:const x=g.getResponseJson();ae(Bn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(x)),d(x);break;case xf.TIMEOUT:ae(Bn,`RPC '${e}' ${c} timed out`),p(new de(Z.DEADLINE_EXCEEDED,"Request time out"));break;case xf.HTTP_ERROR:const E=g.getStatus();if(ae(Bn,`RPC '${e}' ${c} failed with status:`,E,"response text:",g.getResponseText()),E>0){let A=g.getResponseJson();Array.isArray(A)&&(A=A[0]);const O=A==null?void 0:A.error;if(O&&O.status&&O.message){const F=(function(se){const ce=se.toLowerCase().replace(/_/g,"-");return Object.values(Z).indexOf(ce)>=0?ce:Z.UNKNOWN})(O.status);p(new de(F,O.message))}else p(new de(Z.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new de(Z.UNAVAILABLE,"Connection failed."));break;default:xe(9055,{l_:e,streamId:c,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{ae(Bn,`RPC '${e}' ${c} completed.`)}}));const v=JSON.stringify(a);ae(Bn,`RPC '${e}' ${c} sending request:`,a),g.send(t,"POST",v,n,15)}))}T_(e,t,n){const a=iy(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const g=l.join("");ae(Bn,`Creating RPC '${e}' stream ${a}: ${g}`,d);const v=c.createWebChannel(g,d);this.I_(v);let x=!1,E=!1;const A=new Qj({Ho:O=>{E?ae(Bn,`Not sending because RPC '${e}' stream ${a} is closed:`,O):(x||(ae(Bn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),x=!0),ae(Bn,`RPC '${e}' stream ${a} sending:`,O),v.send(O))},Jo:()=>v.close()});return Ru(v,Vu.EventType.OPEN,(()=>{E||(ae(Bn,`RPC '${e}' stream ${a} transport opened.`),A.i_())})),Ru(v,Vu.EventType.CLOSE,(()=>{E||(E=!0,ae(Bn,`RPC '${e}' stream ${a} transport closed`),A.o_(),this.E_(v))})),Ru(v,Vu.EventType.ERROR,(O=>{E||(E=!0,rc(Bn,`RPC '${e}' stream ${a} transport errored. Name:`,O.name,"Message:",O.message),A.o_(new de(Z.UNAVAILABLE,"The operation could not be completed")))})),Ru(v,Vu.EventType.MESSAGE,(O=>{var F;if(!E){const J=O.data[0];Ie(!!J,16349);const se=J,ce=(se==null?void 0:se.error)||((F=se[0])==null?void 0:F.error);if(ce){ae(Bn,`RPC '${e}' stream ${a} received error:`,ce);const le=ce.status;let me=(function(I){const C=yn[I];if(C!==void 0)return P2(C)})(le),Ee=ce.message;le==="NOT_FOUND"&&Ee.includes("database")&&Ee.includes("does not exist")&&Ee.includes(this.databaseId.database)&&rc(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),me===void 0&&(me=Z.INTERNAL,Ee="Unknown error status: "+le+" with message "+ce.message),E=!0,A.o_(new de(me,Ee)),v.close()}else ae(Bn,`RPC '${e}' stream ${a} received:`,J),A.__(J)}})),Zl.u_(),setTimeout((()=>{A.s_()}),0),A}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return PS()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(s){return new Zl(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(){return typeof window<"u"?window:null}function Rf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(s){return new tj(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zl.c_=!1;class TN{constructor(e,t,n=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-n);a>0&&ae("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE="PersistentStream";class SN{constructor(e,t,n,a,l,c,d,p){this.Ci=e,this.b_=n,this.S_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new TN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Z.RESOURCE_EXHAUSTED?(un(t.toString()),un("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===t&&this.G_(n,a)}),(n=>{e((()=>{const a=new de(Z.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ae(pE,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ae(pE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Xj extends SN{constructor(e,t,n,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,a,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=sj(this.serializer,e),n=(function(l){if(!("targetChange"in l))return ke.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?ke.min():c.readTime?tr(c.readTime):ke.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=W0(this.serializer),t.addTarget=(function(l,c){let d;const p=c.target;if(d=Yf(p)?{documents:G2(l,p)}:{query:q2(l,p).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=L2(l,c.resumeToken);const g=X0(l,c.expectedCount);g!==null&&(d.expectedCount=g)}else if(c.snapshotVersion.compareTo(ke.min())>0){d.readTime=gc(l,c.snapshotVersion.toTimestamp());const g=X0(l,c.expectedCount);g!==null&&(d.expectedCount=g)}return d})(this.serializer,e);const n=aj(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=W0(this.serializer),t.removeTarget=e,this.K_(t)}}class Jj extends SN{constructor(e,t,n,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,a,c),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ie(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ie(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ie(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=ij(e.writeResults,e.commitTime),n=tr(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=W0(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>Wf(this.serializer,n)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{}class Zj extends Wj{constructor(e,t,n,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new de(Z.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(e,J0(t,n),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new de(Z.UNKNOWN,l.toString())}))}jo(e,t,n,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.jo(e,J0(t,n),a,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new de(Z.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function eO(s,e,t,n){return new Zj(s,e,t,n)}class tO{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(un(t),this.aa=!1):ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo="RemoteStore";class nO{constructor(e,t,n,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((c=>{n.enqueueAndForget((async()=>{Xo(this)&&(ae(qo,"Restarting streams for network reachability change."),await(async function(p){const g=Se(p);g.Ea.add(4),await Vh(g),g.Va.set("Unknown"),g.Ea.delete(4),await Dp(g)})(this))}))})),this.Va=new tO(n,a)}}async function Dp(s){if(Xo(s))for(const e of s.Ra)await e(!0)}async function Vh(s){for(const e of s.Ra)await e(!1)}function jp(s,e){const t=Se(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),cv(t)?lv(t):Ic(t).O_()&&ov(t,e))}function vc(s,e){const t=Se(s),n=Ic(t);t.Ia.delete(e),n.O_()&&NN(t,e),t.Ia.size===0&&(n.O_()?n.L_():Xo(t)&&t.Va.set("Unknown"))}function ov(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ke.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ic(s).Z_(e)}function NN(s,e){s.da.$e(e),Ic(s).X_(e)}function lv(s){s.da=new JD({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Ic(s).start(),s.Va.ua()}function cv(s){return Xo(s)&&!Ic(s).x_()&&s.Ia.size>0}function Xo(s){return Se(s).Ea.size===0}function AN(s){s.da=void 0}async function rO(s){s.Va.set("Online")}async function sO(s){s.Ia.forEach(((e,t)=>{ov(s,e)}))}async function iO(s,e){AN(s),cv(s)?(s.Va.ha(e),lv(s)):s.Va.set("Unknown")}async function aO(s,e,t){if(s.Va.set("Online"),e instanceof V2&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const d of l.targetIds)a.Ia.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Ia.delete(d),a.da.removeTarget(d))})(s,e)}catch(n){ae(qo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ap(s,n)}else if(e instanceof If?s.da.Xe(e):e instanceof M2?s.da.st(e):s.da.tt(e),!t.isEqual(ke.min()))try{const n=await mN(s.localStore);t.compareTo(n)>=0&&await(function(l,c){const d=l.da.Tt(c);return d.targetChanges.forEach(((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const v=l.Ia.get(g);v&&l.Ia.set(g,v.withResumeToken(p.resumeToken,c))}})),d.targetMismatches.forEach(((p,g)=>{const v=l.Ia.get(p);if(!v)return;l.Ia.set(p,v.withResumeToken(hn.EMPTY_BYTE_STRING,v.snapshotVersion)),NN(l,p);const x=new wi(v.target,p,g,v.sequenceNumber);ov(l,x)})),l.remoteSyncer.applyRemoteEvent(d)})(s,t)}catch(n){ae(qo,"Failed to raise snapshot:",n),await ap(s,n)}}async function ap(s,e,t){if(!Fa(e))throw e;s.Ea.add(1),await Vh(s),s.Va.set("Offline"),t||(t=()=>mN(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{ae(qo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Dp(s)}))}function IN(s,e){return e().catch((t=>ap(s,t,e)))}async function Ac(s){const e=Se(s),t=Va(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Co;for(;oO(e);)try{const a=await qj(e.localStore,n);if(a===null){e.Ta.length===0&&t.L_();break}n=a.batchId,lO(e,a)}catch(a){await ap(e,a)}CN(e)&&RN(e)}function oO(s){return Xo(s)&&s.Ta.length<10}function lO(s,e){s.Ta.push(e);const t=Va(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function CN(s){return Xo(s)&&!Va(s).x_()&&s.Ta.length>0}function RN(s){Va(s).start()}async function cO(s){Va(s).ra()}async function uO(s){const e=Va(s);for(const t of s.Ta)e.ea(t.mutations)}async function hO(s,e,t){const n=s.Ta.shift(),a=Yy.from(n,e,t);await IN(s,(()=>s.remoteSyncer.applySuccessfulWrite(a))),await Ac(s)}async function dO(s,e){e&&Va(s).Y_&&await(async function(n,a){if((function(c){return QD(c)&&c!==Z.ABORTED})(a.code)){const l=n.Ta.shift();Va(n).B_(),await IN(n,(()=>n.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Ac(n)}})(s,e),CN(s)&&RN(s)}async function mE(s,e){const t=Se(s);t.asyncQueue.verifyOperationInProgress(),ae(qo,"RemoteStore received new credentials");const n=Xo(t);t.Ea.add(3),await Vh(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Dp(t)}async function ay(s,e){const t=Se(s);e?(t.Ea.delete(2),await Dp(t)):e||(t.Ea.add(2),await Vh(t),t.Va.set("Unknown"))}function Ic(s){return s.ma||(s.ma=(function(t,n,a){const l=Se(t);return l.sa(),new Xj(n,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:rO.bind(null,s),Yo:sO.bind(null,s),t_:iO.bind(null,s),J_:aO.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),cv(s)?lv(s):s.Va.set("Unknown")):(await s.ma.stop(),AN(s))}))),s.ma}function Va(s){return s.fa||(s.fa=(function(t,n,a){const l=Se(t);return l.sa(),new Jj(n,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:cO.bind(null,s),t_:dO.bind(null,s),ta:uO.bind(null,s),na:hO.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Ac(s)):(await s.fa.stop(),s.Ta.length>0&&(ae(qo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e,t,n,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=a,this.removalCallback=l,this.deferred=new qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,a,l){const c=Date.now()+n,d=new uv(e,t,c,a,l);return d.start(n),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(Z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hv(s,e){if(un("AsyncQueue",`${e}: ${s}`),Fa(s))return new de(Z.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{static emptySet(e){return new ec(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ge.comparator(t.key,n.key):(t,n)=>ge.comparator(t.key,n.key),this.keyedMap=Lu(),this.sortedSet=new Pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ec)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=n.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new ec;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(){this.ga=new Pt(ge.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):xe(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class bc{constructor(e,t,n,a,l,c,d,p,g){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,t,n,a,l){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new bc(e,t,ec.emptySet(t),c,n,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==n[a].type||!t[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class pO{constructor(){this.queries=yE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const a=Se(t),l=a.queries;a.queries=yE(),l.forEach(((c,d)=>{for(const p of d.ba)p.onError(n)}))})(this,new de(Z.ABORTED,"Firestore shutting down"))}}function yE(){return new Ri((s=>_2(s)),Tp)}async function dv(s,e){const t=Se(s);let n=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(n=2):(l=new fO,n=e.Da()?0:1);try{switch(n){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const d=hv(c,`Initialization of query '${ql(e.query)}' failed`);return void e.onError(d)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&pv(t)}async function fv(s,e){const t=Se(s),n=e.query;let a=3;const l=t.queries.get(n);if(l){const c=l.ba.indexOf(e);c>=0&&(l.ba.splice(c,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function mO(s,e){const t=Se(s);let n=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const d of c.ba)d.Fa(a)&&(n=!0);c.wa=a}}n&&pv(t)}function gO(s,e,t){const n=Se(s),a=n.queries.get(e);if(a)for(const l of a.ba)l.onError(t);n.queries.delete(e)}function pv(s){s.Ca.forEach((e=>{e.next()}))}var oy,vE;(vE=oy||(oy={})).Ma="default",vE.Cache="cache";class mv{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new bc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=bc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==oy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e){this.key=e}}class DN{constructor(e){this.key=e}}class yO{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Qe(),this.mutatedKeys=Qe(),this.eu=E2(e),this.tu=new ec(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new gE,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,d=!1;const p=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,g=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((v,x)=>{const E=a.get(v),A=Oh(this.query,x)?x:null,O=!!E&&this.mutatedKeys.has(E.key),F=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let J=!1;E&&A?E.data.isEqual(A.data)?O!==F&&(n.track({type:3,doc:A}),J=!0):this.su(E,A)||(n.track({type:2,doc:A}),J=!0,(p&&this.eu(A,p)>0||g&&this.eu(A,g)<0)&&(d=!0)):!E&&A?(n.track({type:0,doc:A}),J=!0):E&&!A&&(n.track({type:1,doc:E}),J=!0,(p||g)&&(d=!0)),J&&(A?(c=c.add(A),l=F?l.add(v):l.delete(v)):(c=c.delete(v),l=l.delete(v)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const v=this.query.limitType==="F"?c.last():c.first();c=c.delete(v.key),l=l.delete(v.key),n.track({type:1,doc:v})}return{tu:c,iu:n,Ss:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((v,x)=>(function(A,O){const F=J=>{switch(J){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xe(20277,{Vt:J})}};return F(A)-F(O)})(v.type,x.type)||this.eu(v.doc,x.doc))),this.ou(n),a=a??!1;const d=t&&!a?this._u():[],p=this.Ya.size===0&&this.current&&!a?1:0,g=p!==this.Xa;return this.Xa=p,c.length!==0||g?{snapshot:new bc(this.query,e.tu,l,c,e.mutatedKeys,p===0,g,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gE,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Qe(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new DN(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new kN(n))})),t}cu(e){this.Za=e.ks,this.Ya=Qe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return bc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Cc="SyncEngine";class vO{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class bO{constructor(e){this.key=e,this.hu=!1}}class xO{constructor(e,t,n,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Ri((d=>_2(d)),Tp),this.Iu=new Map,this.Eu=new Set,this.Ru=new Pt(ge.comparator),this.Au=new Map,this.Vu=new tv,this.du={},this.mu=new Map,this.fu=Go.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function _O(s,e,t=!0){const n=Op(s);let a;const l=n.Tu.get(e);return l?(n.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await jN(n,e,t,!0),a}async function wO(s,e){const t=Op(s);await jN(t,e,!0,!1)}async function jN(s,e,t,n){const a=await rp(s.localStore,Pr(e)),l=a.targetId,c=s.sharedClientState.addLocalQueryTarget(l,t);let d;return n&&(d=await gv(s,e,l,c==="current",a.resumeToken)),s.isPrimaryClient&&t&&jp(s.remoteStore,a),d}async function gv(s,e,t,n,a){s.pu=(x,E,A)=>(async function(F,J,se,ce){let le=J.view.ru(se);le.Ss&&(le=await ry(F.localStore,J.query,!1).then((({documents:I})=>J.view.ru(I,le))));const me=ce&&ce.targetChanges.get(J.targetId),Ee=ce&&ce.targetMismatches.get(J.targetId)!=null,be=J.view.applyChanges(le,F.isPrimaryClient,me,Ee);return ly(F,J.targetId,be.au),be.snapshot})(s,x,E,A);const l=await ry(s.localStore,e,!0),c=new yO(e,l.ks),d=c.ru(l.documents),p=Mh.createSynthesizedTargetChangeForCurrentChange(t,n&&s.onlineState!=="Offline",a),g=c.applyChanges(d,s.isPrimaryClient,p);ly(s,t,g.au);const v=new vO(e,t,c);return s.Tu.set(e,v),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),g.snapshot}async function EO(s,e,t){const n=Se(s),a=n.Tu.get(e),l=n.Iu.get(a.targetId);if(l.length>1)return n.Iu.set(a.targetId,l.filter((c=>!Tp(c,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await yc(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),t&&vc(n.remoteStore,a.targetId),xc(n,a.targetId)})).catch(Ba)):(xc(n,a.targetId),await yc(n.localStore,a.targetId,!0))}async function TO(s,e){const t=Se(s),n=t.Tu.get(e),a=t.Iu.get(n.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),vc(t.remoteStore,n.targetId))}async function SO(s,e,t){const n=xv(s);try{const a=await(function(c,d){const p=Se(c),g=yt.now(),v=d.reduce(((A,O)=>A.add(O.key)),Qe());let x,E;return p.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let O=jr(),F=Qe();return p.xs.getEntries(A,v).next((J=>{O=J,O.forEach(((se,ce)=>{ce.isValidDocument()||(F=F.add(se))}))})).next((()=>p.localDocuments.getOverlayedDocuments(A,O))).next((J=>{x=J;const se=[];for(const ce of d){const le=$D(ce,x.get(ce.key).overlayedDocument);le!=null&&se.push(new ki(ce.key,le,h2(le.value.mapValue),$n.exists(!0)))}return p.mutationQueue.addMutationBatch(A,g,se,d)})).next((J=>{E=J;const se=J.applyToLocalDocumentSet(x,F);return p.documentOverlayCache.saveOverlays(A,J.batchId,se)}))})).then((()=>({batchId:E.batchId,changes:S2(x)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(c,d,p){let g=c.du[c.currentUser.toKey()];g||(g=new Pt(Le)),g=g.insert(d,p),c.du[c.currentUser.toKey()]=g})(n,a.batchId,t),await qa(n,a.changes),await Ac(n.remoteStore)}catch(a){const l=hv(a,"Failed to persist write");t.reject(l)}}async function ON(s,e){const t=Se(s);try{const n=await Fj(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Au.get(l);c&&(Ie(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?Ie(c.hu,14607):a.removedDocuments.size>0&&(Ie(c.hu,42227),c.hu=!1))})),await qa(t,n,e)}catch(n){await Ba(n)}}function bE(s,e,t){const n=Se(s);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const a=[];n.Tu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const p=Se(c);p.onlineState=d;let g=!1;p.queries.forEach(((v,x)=>{for(const E of x.ba)E.va(d)&&(g=!0)})),g&&pv(p)})(n.eventManager,e),a.length&&n.Pu.J_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function NO(s,e,t){const n=Se(s);n.sharedClientState.updateQueryState(e,"rejected",t);const a=n.Au.get(e),l=a&&a.key;if(l){let c=new Pt(ge.comparator);c=c.insert(l,rn.newNoDocument(l,ke.min()));const d=Qe().add(l),p=new Ph(ke.min(),new Map,new Pt(Le),c,d);await ON(n,p),n.Ru=n.Ru.remove(l),n.Au.delete(e),bv(n)}else await yc(n.localStore,e,!1).then((()=>xc(n,e,t))).catch(Ba)}async function AO(s,e){const t=Se(s),n=e.batch.batchId;try{const a=await Bj(t.localStore,e);vv(t,n,null),yv(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await qa(t,a)}catch(a){await Ba(a)}}async function IO(s,e,t){const n=Se(s);try{const a=await(function(c,d){const p=Se(c);return p.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let v;return p.mutationQueue.lookupMutationBatch(g,d).next((x=>(Ie(x!==null,37113),v=x.keys(),p.mutationQueue.removeMutationBatch(g,x)))).next((()=>p.mutationQueue.performConsistencyCheck(g))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(g,v,d))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,v))).next((()=>p.localDocuments.getDocuments(g,v)))}))})(n.localStore,e);vv(n,e,t),yv(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await qa(n,a)}catch(a){await Ba(a)}}function yv(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function vv(s,e,t){const n=Se(s);let a=n.du[n.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),n.du[n.currentUser.toKey()]=a}}function xc(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const n of s.Iu.get(e))s.Tu.delete(n),t&&s.Pu.yu(n,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((n=>{s.Vu.containsKey(n)||PN(s,n)}))}function PN(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(vc(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),bv(s))}function ly(s,e,t){for(const n of t)n instanceof kN?(s.Vu.addReference(n.key,e),CO(s,n)):n instanceof DN?(ae(Cc,"Document no longer in limbo: "+n.key),s.Vu.removeReference(n.key,e),s.Vu.containsKey(n.key)||PN(s,n.key)):xe(19791,{wu:n})}function CO(s,e){const t=e.key,n=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(n)||(ae(Cc,"New document in limbo: "+t),s.Eu.add(n),bv(s))}function bv(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ge(pt.fromString(e)),n=s.fu.next();s.Au.set(n,new bO(t)),s.Ru=s.Ru.insert(t,n),jp(s.remoteStore,new wi(Pr(jh(t.path)),n,"TargetPurposeLimboResolution",mr.ce))}}async function qa(s,e,t){const n=Se(s),a=[],l=[],c=[];n.Tu.isEmpty()||(n.Tu.forEach(((d,p)=>{c.push(n.pu(p,e,t).then((g=>{var v;if((g||t)&&n.isPrimaryClient){const x=g?!g.fromCache:(v=t==null?void 0:t.targetChanges.get(p.targetId))==null?void 0:v.current;n.sharedClientState.updateQueryState(p.targetId,x?"current":"not-current")}if(g){a.push(g);const x=sv.Es(p.targetId,g);l.push(x)}})))})),await Promise.all(c),n.Pu.J_(a),await(async function(p,g){const v=Se(p);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>B.forEach(g,(E=>B.forEach(E.Ts,(A=>v.persistence.referenceDelegate.addReference(x,E.targetId,A))).next((()=>B.forEach(E.Is,(A=>v.persistence.referenceDelegate.removeReference(x,E.targetId,A)))))))))}catch(x){if(!Fa(x))throw x;ae(iv,"Failed to update sequence numbers: "+x)}for(const x of g){const E=x.targetId;if(!x.fromCache){const A=v.vs.get(E),O=A.snapshotVersion,F=A.withLastLimboFreeSnapshotVersion(O);v.vs=v.vs.insert(E,F)}}})(n.localStore,l))}async function RO(s,e){const t=Se(s);if(!t.currentUser.isEqual(e)){ae(Cc,"User change. New user:",e.toKey());const n=await pN(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((d=>{d.forEach((p=>{p.reject(new de(Z.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await qa(t,n.Ns)}}function kO(s,e){const t=Se(s),n=t.Au.get(e);if(n&&n.hu)return Qe().add(n.key);{let a=Qe();const l=t.Iu.get(e);if(!l)return a;for(const c of l){const d=t.Tu.get(c);a=a.unionWith(d.view.nu)}return a}}async function DO(s,e){const t=Se(s),n=await ry(t.localStore,e.query,!0),a=e.view.cu(n);return t.isPrimaryClient&&ly(t,e.targetId,a.au),a}async function jO(s,e){const t=Se(s);return yN(t.localStore,e).then((n=>qa(t,n)))}async function OO(s,e,t,n){const a=Se(s),l=await(function(d,p){const g=Se(d),v=Se(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",(x=>v.Xn(x,p).next((E=>E?g.localDocuments.getDocuments(x,E):B.resolve(null)))))})(a.localStore,e);l!==null?(t==="pending"?await Ac(a.remoteStore):t==="acknowledged"||t==="rejected"?(vv(a,e,n||null),yv(a,e),(function(d,p){Se(Se(d).mutationQueue).nr(p)})(a.localStore,e)):xe(6720,"Unknown batchState",{bu:t}),await qa(a,l)):ae(Cc,"Cannot apply mutation batch with id: "+e)}async function PO(s,e){const t=Se(s);if(Op(t),xv(t),e===!0&&t.gu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),a=await xE(t,n.toArray());t.gu=!0,await ay(t.remoteStore,!0);for(const l of a)jp(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const n=[];let a=Promise.resolve();t.Iu.forEach(((l,c)=>{t.sharedClientState.isLocalQueryTarget(c)?n.push(c):a=a.then((()=>(xc(t,c),yc(t.localStore,c,!0)))),vc(t.remoteStore,c)})),await a,await xE(t,n),(function(c){const d=Se(c);d.Au.forEach(((p,g)=>{vc(d.remoteStore,g)})),d.Vu.zr(),d.Au=new Map,d.Ru=new Pt(ge.comparator)})(t),t.gu=!1,await ay(t.remoteStore,!1)}}async function xE(s,e,t){const n=Se(s),a=[],l=[];for(const c of e){let d;const p=n.Iu.get(c);if(p&&p.length!==0){d=await rp(n.localStore,Pr(p[0]));for(const g of p){const v=n.Tu.get(g),x=await DO(n,v);x.snapshot&&l.push(x.snapshot)}}else{const g=await gN(n.localStore,c);d=await rp(n.localStore,g),await gv(n,MN(g),c,!1,d.resumeToken)}a.push(d)}return n.Pu.J_(l),a}function MN(s){return b2(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function MO(s){return(function(t){return Se(Se(t).persistence).hs()})(Se(s).localStore)}async function VO(s,e,t,n){const a=Se(s);if(a.gu)return void ae(Cc,"Ignoring unexpected query state notification.");const l=a.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const c=await yN(a.localStore,w2(l[0])),d=Ph.createSynthesizedRemoteEventForCurrentChange(e,t==="current",hn.EMPTY_BYTE_STRING);await qa(a,c,d);break}case"rejected":await yc(a.localStore,e,!0),xc(a,e,n);break;default:xe(64155,t)}}async function LO(s,e,t){const n=Op(s);if(n.gu){for(const a of e){if(n.Iu.has(a)&&n.sharedClientState.isActiveQueryTarget(a)){ae(Cc,"Adding an already active target "+a);continue}const l=await gN(n.localStore,a),c=await rp(n.localStore,l);await gv(n,MN(l),c.targetId,!1,c.resumeToken),jp(n.remoteStore,c)}for(const a of t)n.Iu.has(a)&&await yc(n.localStore,a,!1).then((()=>{vc(n.remoteStore,a),xc(n,a)})).catch(Ba)}}function Op(s){const e=Se(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=ON.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=kO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=NO.bind(null,e),e.Pu.J_=mO.bind(null,e.eventManager),e.Pu.yu=gO.bind(null,e.eventManager),e}function xv(s){const e=Se(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=AO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=IO.bind(null,e),e}class vh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=kp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return fN(this.persistence,new dN,e.initialUser,this.serializer)}Cu(e){return new nv(Rp.Vi,this.serializer)}Du(e){return new wN}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vh.provider={build:()=>new vh};class UO extends vh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ie(this.persistence.referenceDelegate instanceof np,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new aN(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Gn.withCacheSize(this.cacheSizeBytes):Gn.DEFAULT;return new nv((n=>np.Vi(n,t)),this.serializer)}}class VN extends vh{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await xv(this.xu.syncEngine),await Ac(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return fN(this.persistence,new dN,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new aN(n,e.asyncQueue,t)}Mu(e,t){const n=new $4(t,this.persistence);return new H4(e.asyncQueue,n)}Cu(e){const t=hN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Gn.withCacheSize(this.cacheSizeBytes):Gn.DEFAULT;return new rv(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,EN(),Rf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new wN}}class zO extends VN{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof g0&&(this.sharedClientState.syncEngine={So:OO.bind(null,t),Do:VO.bind(null,t),Co:LO.bind(null,t),hs:MO.bind(null,t),bo:jO.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async n=>{await PO(this.xu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))}Du(e){const t=EN();if(!g0.v(t))throw new de(Z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=hN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new g0(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class bh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>bE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=RO.bind(null,this.syncEngine),await ay(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new pO})()}createDatastore(e){const t=kp(e.databaseInfo.databaseId),n=Yj(e.databaseInfo);return eO(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,a,l,c,d){return new nO(n,a,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>bE(this.syncEngine,t,0)),(function(){return fE.v()?new fE:new Hj})())}createSyncEngine(e,t){return(function(a,l,c,d,p,g,v){const x=new xO(a,l,c,d,p,g);return v&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Se(a);ae(qo,"RemoteStore shutting down."),l.Ea.add(5),await Vh(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}bh.provider={build:()=>new bh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):un("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La="FirestoreClient";class BO{constructor(e,t,n,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=a,this.user=Fn.UNAUTHENTICATED,this.clientId=Py.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(n,(async c=>{ae(La,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(n,(c=>(ae(La,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=hv(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function v0(s,e){s.asyncQueue.verifyOperationInProgress(),ae(La,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let n=t.initialUser;s.setCredentialChangeListener((async a=>{n.isEqual(a)||(await pN(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function _E(s,e){s.asyncQueue.verifyOperationInProgress();const t=await FO(s);ae(La,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((n=>mE(e.remoteStore,n))),s.setAppCheckTokenChangeListener(((n,a)=>mE(e.remoteStore,a))),s._onlineComponents=e}async function FO(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){ae(La,"Using user provided OfflineComponentProvider");try{await v0(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Z.FAILED_PRECONDITION||a.code===Z.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;rc("Error using user provided cache. Falling back to memory cache: "+t),await v0(s,new vh)}}else ae(La,"Using default OfflineComponentProvider"),await v0(s,new UO(void 0));return s._offlineComponents}async function LN(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(ae(La,"Using user provided OnlineComponentProvider"),await _E(s,s._uninitializedComponentsProvider._online)):(ae(La,"Using default OnlineComponentProvider"),await _E(s,new bh))),s._onlineComponents}function GO(s){return LN(s).then((e=>e.syncEngine))}async function op(s){const e=await LN(s),t=e.eventManager;return t.onListen=_O.bind(null,e.syncEngine),t.onUnlisten=EO.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wO.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=TO.bind(null,e.syncEngine),t}function qO(s,e,t,n){const a=new _v(n),l=new mv(e,a,t);return s.asyncQueue.enqueueAndForget((async()=>dv(await op(s),l))),()=>{a.Nu(),s.asyncQueue.enqueueAndForget((async()=>fv(await op(s),l)))}}function HO(s,e,t={}){const n=new qs;return s.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,p,g){const v=new _v({next:E=>{v.Nu(),c.enqueueAndForget((()=>fv(l,x)));const A=E.docs.has(d);!A&&E.fromCache?g.reject(new de(Z.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&E.fromCache&&p&&p.source==="server"?g.reject(new de(Z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(E)},error:E=>g.reject(E)}),x=new mv(jh(d.path),v,{includeMetadataChanges:!0,Ka:!0});return dv(l,x)})(await op(s),s.asyncQueue,e,t,n))),n.promise}function $O(s,e,t={}){const n=new qs;return s.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,p,g){const v=new _v({next:E=>{v.Nu(),c.enqueueAndForget((()=>fv(l,x))),E.fromCache&&p.source==="server"?g.reject(new de(Z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(E)},error:E=>g.reject(E)}),x=new mv(d,v,{includeMetadataChanges:!0,Ka:!0});return dv(l,x)})(await op(s),s.asyncQueue,e,t,n))),n.promise}function KO(s,e){const t=new qs;return s.asyncQueue.enqueueAndForget((async()=>SO(await GO(s),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QO="ComponentProvider",wE=new Map;function YO(s,e,t,n,a){return new xD(s,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,UN(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO="firestore.googleapis.com",EE=!0;class TE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new de(Z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=XO,this.ssl=EE}else this.host=e.host,this.ssl=e.ssl??EE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<iN)throw new de(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}F4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=UN(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new de(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new de(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new de(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wv{constructor(e,t,n,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new TE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(Z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(Z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new TE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new j4;switch(n.type){case"firstParty":return new M4(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new de(Z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=wE.get(t);n&&(ae(QO,"Removing Datastore"),wE.delete(t),n.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Jo(this.firestore,e,this._query)}}class sn{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Oa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sn(this.firestore,e,this._key)}toJSON(){return{type:sn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Ch(t,sn._jsonSchema))return new sn(e,n||null,new ge(pt.fromString(t.referencePath)))}}sn._jsonSchemaVersion="firestore/documentReference/1.0",sn._jsonSchema={type:bn("string",sn._jsonSchemaVersion),referencePath:bn("string")};class Oa extends Jo{constructor(e,t,n){super(e,t,jh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sn(this.firestore,null,new ge(e))}withConverter(e){return new Oa(this.firestore,e,this._path)}}function Ks(s,e,...t){if(s=Rn(s),LS("collection","path",e),s instanceof wv){const n=pt.fromString(e,...t);return p1(n),new Oa(s,null,n)}{if(!(s instanceof sn||s instanceof Oa))throw new de(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(pt.fromString(e,...t));return p1(n),new Oa(s.firestore,null,n)}}function yr(s,e,...t){if(s=Rn(s),arguments.length===1&&(e=Py.newId()),LS("doc","path",e),s instanceof wv){const n=pt.fromString(e,...t);return f1(n),new sn(s,null,new ge(n))}{if(!(s instanceof sn||s instanceof Oa))throw new de(Z.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=s._path.child(pt.fromString(e,...t));return f1(n),new sn(s.firestore,s instanceof Oa?s.converter:null,new ge(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE="AsyncQueue";class NE{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new TN(this,"async_queue_retry"),this._c=()=>{const n=Rf();n&&ae(SE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Rf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Rf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new qs;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Fa(e))throw e;ae(SE,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,un("INTERNAL UNHANDLED ERROR: ",AE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=uv.createAndSchedule(this,e,t,n,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&xe(47125,{Pc:AE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function AE(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ii extends wv{constructor(e,t,n,a){super(e,t,n,a),this.type="firestore",this._queue=new NE,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new NE(e),this._firestoreClient=void 0,await e}}}function JO(s,e,t){t||(t=Kf);const n=Sy(s,"firestore");if(n.isInitialized(t)){const a=n.getImmediate({identifier:t}),l=n.getOptions(t);if(Oo(l,e))return a;throw new de(Z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new de(Z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<iN)throw new de(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&wc(e.host)&&zT(e.host),n.initialize({options:e,instanceIdentifier:t})}function Pp(s){if(s._terminated)throw new de(Z.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||WO(s),s._firestoreClient}function WO(s){var n,a,l,c;const e=s._freezeSettings(),t=YO(s._databaseId,((n=s._app)==null?void 0:n.options.appId)||"",s._persistenceKey,(a=s._app)==null?void 0:a.options.apiKey,e);s._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((c=e.localCache)!=null&&c._onlineComponentProvider)&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new BO(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(p){const g=p==null?void 0:p._online.build();return{_offline:p==null?void 0:p._offline.build(g),_online:g}})(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ss(hn.fromBase64String(e))}catch(t){throw new de(Z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ss(hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ss._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ch(e,ss._jsonSchema))return ss.fromBase64String(e.bytes)}}ss._jsonSchemaVersion="firestore/bytes/1.0",ss._jsonSchema={type:bn("string",ss._jsonSchemaVersion),bytes:bn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(Z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(Z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(Z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Hs._jsonSchemaVersion}}static fromJSON(e){if(Ch(e,Hs._jsonSchema))return new Hs(e.latitude,e.longitude)}}Hs._jsonSchemaVersion="firestore/geoPoint/1.0",Hs._jsonSchema={type:bn("string",Hs._jsonSchemaVersion),latitude:bn("number"),longitude:bn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let l=0;l<n.length;++l)if(n[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ws._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ch(e,ws._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ws(e.vectorValues);throw new de(Z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ws._jsonSchemaVersion="firestore/vectorValue/1.0",ws._jsonSchema={type:bn("string",ws._jsonSchemaVersion),vectorValues:bn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZO=/^__.*__$/;class eP{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new ki(e,this.data,this.fieldMask,t,this.fieldTransforms):new Nc(e,this.data,t,this.fieldTransforms)}}class zN{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ki(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function BN(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xe(40011,{dataSource:s})}}class Sv{constructor(e,t,n,a,l,c){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var a;const t=(a=this.path)==null?void 0:a.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){var a;const t=(a=this.path)==null?void 0:a.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return lp(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(BN(this.dataSource)&&ZO.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class tP{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||kp(e)}createContext(e,t,n,a=!1){return new Sv({dataSource:e,methodName:t,targetDoc:n,path:Qt.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mp(s){const e=s._freezeSettings(),t=kp(s._databaseId);return new tP(s._databaseId,!!e.ignoreUndefinedProperties,t)}function FN(s,e,t,n,a,l={}){const c=s.createContext(l.merge||l.mergeFields?2:0,e,t,a);Nv("Data must be an object, but it was:",c,n);const d=GN(n,c);let p,g;if(l.merge)p=new gr(c.fieldMask),g=c.fieldTransforms;else if(l.mergeFields){const v=[];for(const x of l.mergeFields){const E=_c(e,x,t);if(!c.contains(E))throw new de(Z.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);$N(v,E)||v.push(E)}p=new gr(v),g=c.fieldTransforms.filter((x=>p.covers(x.field)))}else p=null,g=c.fieldTransforms;return new eP(new Hn(d),p,g)}class Vp extends Tv{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Vp}}function nP(s,e,t,n){const a=s.createContext(1,e,t);Nv("Data must be an object, but it was:",a,n);const l=[],c=Hn.empty();Ga(n,((p,g)=>{const v=HN(e,p,t);g=Rn(g);const x=a.childContextForFieldPath(v);if(g instanceof Vp)l.push(v);else{const E=Lh(g,x);E!=null&&(l.push(v),c.set(v,E))}}));const d=new gr(l);return new zN(c,d,a.fieldTransforms)}function rP(s,e,t,n,a,l){const c=s.createContext(1,e,t),d=[_c(e,n,t)],p=[a];if(l.length%2!=0)throw new de(Z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<l.length;E+=2)d.push(_c(e,l[E])),p.push(l[E+1]);const g=[],v=Hn.empty();for(let E=d.length-1;E>=0;--E)if(!$N(g,d[E])){const A=d[E];let O=p[E];O=Rn(O);const F=c.childContextForFieldPath(A);if(O instanceof Vp)g.push(A);else{const J=Lh(O,F);J!=null&&(g.push(A),v.set(A,J))}}const x=new gr(g);return new zN(v,x,c.fieldTransforms)}function sP(s,e,t,n=!1){return Lh(t,s.createContext(n?4:3,e))}function Lh(s,e){if(qN(s=Rn(s)))return Nv("Unsupported field value:",e,s),GN(s,e);if(s instanceof Tv)return(function(n,a){if(!BN(a.dataSource))throw a.createError(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${n._methodName}() is not currently supported inside arrays`);const l=n._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(n,a){const l=[];let c=0;for(const d of n){let p=Lh(d,a.childContextForArray(c));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),c++}return{arrayValue:{values:l}}})(s,e)}return(function(n,a){if((n=Rn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return UD(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const l=yt.fromDate(n);return{timestampValue:gc(a.serializer,l)}}if(n instanceof yt){const l=new yt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:gc(a.serializer,l)}}if(n instanceof Hs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ss)return{bytesValue:L2(a.serializer,n._byteString)};if(n instanceof sn){const l=a.databaseId,c=n.firestore._databaseId;if(!c.isEqual(l))throw a.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Wy(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof ws)return(function(c,d){const p=c instanceof ws?c.toArray():c;return{mapValue:{fields:{[Gy]:{stringValue:qy},[uc]:{arrayValue:{values:p.map((v=>{if(typeof v!="number")throw d.createError("VectorValues must only contain numeric values.");return Ky(d.serializer,v)}))}}}}}})(n,a);if(Y2(n))return n._toProto(a.serializer);throw a.createError(`Unsupported field value: ${gp(n)}`)})(s,e)}function GN(s,e){const t={};return n2(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ga(s,((n,a)=>{const l=Lh(a,e.childContextForField(n));l!=null&&(t[n]=l)})),{mapValue:{fields:t}}}function qN(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof yt||s instanceof Hs||s instanceof ss||s instanceof sn||s instanceof Tv||s instanceof ws||Y2(s))}function Nv(s,e,t){if(!qN(t)||!US(t)){const n=gp(t);throw n==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+n)}}function _c(s,e,t){if((e=Rn(e))instanceof Ev)return e._internalPath;if(typeof e=="string")return HN(s,e);throw lp("Field path arguments must be of type string or ",s,!1,void 0,t)}const iP=new RegExp("[~\\*/\\[\\]]");function HN(s,e,t){if(e.search(iP)>=0)throw lp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Ev(...e.split("."))._internalPath}catch{throw lp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function lp(s,e,t,n,a){const l=n&&!n.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(l||c)&&(p+=" (found",l&&(p+=` in field ${n}`),c&&(p+=` in document ${a}`),p+=")"),new de(Z.INVALID_ARGUMENT,d+s+p)}function $N(s,e){return s.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{convertValue(e,t="none"){switch(Pa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ai(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Ga(e,((a,l)=>{n[a]=this.convertValue(l,t)})),n}convertVectorValue(e){var n,a,l;const t=(l=(a=(n=e.fields)==null?void 0:n[uc].arrayValue)==null?void 0:a.values)==null?void 0:l.map((c=>qt(c.doubleValue)));return new ws(t)}convertGeoPoint(e){return new Hs(qt(e.latitude),qt(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=wp(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(dh(e));default:return null}}convertTimestamp(e){const t=Ni(e);return new yt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=pt.fromString(e);Ie(Q2(n),9688,{name:e});const a=new Uo(n.get(1),n.get(3)),l=new ge(n.popFirst(5));return a.isEqual(t)||un(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av extends aP{constructor(e){super(),this.firestore=e}convertBytes(e){return new ss(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new sn(this.firestore,null,t)}}const IE="@firebase/firestore",CE="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(s){return(function(t,n){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of n)if(l in a&&typeof a[l]=="function")return!0;return!1})(s,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e,t,n,a,l){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new sn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(_c("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class oP extends KN{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QN(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new de(Z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Iv{}class lP extends Iv{}function Uh(s,e,...t){let n=[];e instanceof Iv&&n.push(e),n=n.concat(t),(function(l){const c=l.filter((p=>p instanceof Cv)).length,d=l.filter((p=>p instanceof Lp)).length;if(c>1||c>0&&d>0)throw new de(Z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const a of n)s=a._apply(s);return s}class Lp extends lP{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Lp(e,t,n)}_apply(e){const t=this._parse(e);return YN(e._query,t),new Jo(e.firestore,e.converter,Q0(e._query,t))}_parse(e){const t=Mp(e.firestore);return(function(l,c,d,p,g,v,x){let E;if(g.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new de(Z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){DE(x,v);const O=[];for(const F of x)O.push(kE(p,l,F));E={arrayValue:{values:O}}}else E=kE(p,l,x)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||DE(x,v),E=sP(d,c,x,v==="in"||v==="not-in");return st.create(g,v,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Up(s,e,t){const n=e,a=_c("where",s);return Lp._create(a,n,t)}class Cv extends Iv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Cv(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:vt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const d=l.getFlattenedFilters();for(const p of d)YN(c,p),c=Q0(c,p)})(e._query,t),new Jo(e.firestore,e.converter,Q0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function kE(s,e,t){if(typeof(t=Rn(t))=="string"){if(t==="")throw new de(Z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!x2(e)&&t.indexOf("/")!==-1)throw new de(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(pt.fromString(t));if(!ge.isDocumentKey(n))throw new de(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ph(s,new ge(n))}if(t instanceof sn)return ph(s,t._key);throw new de(Z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gp(t)}.`)}function DE(s,e){if(!Array.isArray(s)||s.length===0)throw new de(Z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function YN(s,e){const t=(function(a,l){for(const c of a)for(const d of c.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(s.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new de(Z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(Z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function XN(s,e,t){let n;return n=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,n}class cP{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=fP(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function uP(s){return new cP(s)}class hP{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=bh.provider,this._offlineComponentProvider={build:t=>new VN(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class dP{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=bh.provider,this._offlineComponentProvider={build:t=>new zO(t,e==null?void 0:e.cacheSizeBytes)}}}function fP(s){return new hP(s==null?void 0:s.forceOwnership)}function pP(){return new dP}class Bu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Do extends KN{constructor(e,t,n,a,l,c){super(e,t,n,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new kf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(_c("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new de(Z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Do._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Do._jsonSchemaVersion="firestore/documentSnapshot/1.0",Do._jsonSchema={type:bn("string",Do._jsonSchemaVersion),bundleSource:bn("string","DocumentSnapshot"),bundleName:bn("string"),bundle:bn("string")};class kf extends Do{data(e={}){return super.data(e)}}class jo{constructor(e,t,n,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Bu(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new kf(this._firestore,this._userDataWriter,n.key,n,new Bu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(Z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const p=new kf(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Bu(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:p,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const p=new kf(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Bu(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let g=-1,v=-1;return d.type!==0&&(g=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),v=c.indexOf(d.doc.key)),{type:mP(d.type),doc:p,oldIndex:g,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new de(Z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Py.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),n.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function mP(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xe(61501,{type:s})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jo._jsonSchemaVersion="firestore/querySnapshot/1.0",jo._jsonSchema={type:bn("string",jo._jsonSchemaVersion),bundleSource:bn("string","QuerySnapshot"),bundleName:bn("string"),bundle:bn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(s){s=Or(s,sn);const e=Or(s.firestore,Ii),t=Pp(e);return HO(t,s._key).then((n=>JN(e,s,n)))}function Rc(s){s=Or(s,Jo);const e=Or(s.firestore,Ii),t=Pp(e),n=new Av(e);return QN(s._query),$O(t,s._query).then((a=>new jo(e,n,s,a)))}function kv(s,e,t){s=Or(s,sn);const n=Or(s.firestore,Ii),a=XN(s.converter,e,t),l=Mp(n);return Bp(n,[FN(l,"setDoc",s._key,a,s.converter!==null,t).toMutation(s._key,$n.none())])}function Dv(s,e,t,...n){s=Or(s,sn);const a=Or(s.firestore,Ii),l=Mp(a);let c;return c=typeof(e=Rn(e))=="string"||e instanceof Ev?rP(l,"updateDoc",s._key,e,t,n):nP(l,"updateDoc",s._key,e),Bp(a,[c.toMutation(s._key,$n.exists(!0))])}function xh(s){return Bp(Or(s.firestore,Ii),[new Ap(s._key,$n.none())])}function gP(s,e){const t=Or(s.firestore,Ii),n=yr(s),a=XN(s.converter,e),l=Mp(s.firestore);return Bp(t,[FN(l,"addDoc",n._key,a,s.converter!==null,{}).toMutation(n._key,$n.exists(!1))]).then((()=>n))}function zp(s,...e){var g,v,x;s=Rn(s);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||RE(e[n])||(t=e[n++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(RE(e[n])){const E=e[n];e[n]=(g=E.next)==null?void 0:g.bind(E),e[n+1]=(v=E.error)==null?void 0:v.bind(E),e[n+2]=(x=E.complete)==null?void 0:x.bind(E)}let l,c,d;if(s instanceof sn)c=Or(s.firestore,Ii),d=jh(s._key.path),l={next:E=>{e[n]&&e[n](JN(c,s,E))},error:e[n+1],complete:e[n+2]};else{const E=Or(s,Jo);c=Or(E.firestore,Ii),d=E._query;const A=new Av(c);l={next:O=>{e[n]&&e[n](new jo(c,A,E,O))},error:e[n+1],complete:e[n+2]},QN(s._query)}const p=Pp(c);return qO(p,d,a,l)}function Bp(s,e){const t=Pp(s);return KO(t,e)}function JN(s,e,t){const n=t.docs.get(e._key),a=new Av(s);return new Do(s,a,e._key,n,new Bu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){k4(Ec),nc(new Po("firestore",((n,{instanceIdentifier:a,options:l})=>{const c=n.getProvider("app").getImmediate(),d=new Ii(new O4(n.getProvider("auth-internal")),new V4(c,n.getProvider("app-check-internal")),_D(c,a),c);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),ka(IE,CE,e),ka(IE,CE,"esm2020")})();const yP={apiKey:"AIzaSyD2rR0OH2OzSlt4fs2w72TKOUNDngp0zXQ",authDomain:"singmode-7c657.firebaseapp.com",projectId:"singmode-7c657",storageBucket:"singmode-7c657.firebasestorage.app",messagingSenderId:"292866266443",appId:"1:292866266443:web:190d34e55980509c1b04ce"},WN=KT(yP),jv=C4(WN),Yt=JO(WN,{localCache:uP({tabManager:pP()})});class vP{constructor(){this.peer=null,this.lockPeer=null,this.connections=new Map,this.hostId=null,this.isHost=!1,this.heartbeatInterval=null,this.retryCount=0,this.maxRetries=20,this.actionQueue=[],this.initializationParams=null,this.unsubscribeActions=null,this.onStateReceived=null,this.onActionReceived=null,this.onConnectionStatus=null,this.onPeerConnected=null,this.onDeviceConnected=null,this.onDeviceDisconnected=null,this.loadQueue()}loadQueue(){try{const e=localStorage.getItem("singmode_pending_actions");e&&(this.actionQueue=JSON.parse(e),console.log(`[Sync] Loaded ${this.actionQueue.length} pending actions from storage.`))}catch(e){console.warn("[Sync] Failed to load pending actions:",e)}}persistQueue(){try{localStorage.setItem("singmode_pending_actions",JSON.stringify(this.actionQueue)),typeof window<"u"&&window.dispatchEvent(new Event("kstar_sync"))}catch(e){console.warn("[Sync] Failed to persist pending actions:",e)}}async getPublicIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip||"unknown-network"}catch(e){return console.warn("[Sync] Could not fetch public IP for lock, using fallback",e),"local-fallback"}}sanitizeID(e){return e.replace(/[^a-zA-Z0-9-_]/g,"-").toLowerCase()}async initialize(e,t){var n,a,l,c;if(this.peer&&!this.peer.destroyed&&!this.peer.disconnected&&((n=this.initializationParams)==null?void 0:n.role)===e&&((a=this.initializationParams)==null?void 0:a.room)===t)return e==="PARTICIPANT"&&t&&this.connections.size===0?(console.log("[Sync] Redundant initialization detected, but NO active connections. Attempting to reconnect to host..."),this.connectToHost(t),this.peer.id||"reconnecting"):(console.log(`[Sync] Already connected as ${e} to ${t||"host"}. Skipping redundant init.`),this.peer.id||"initializing");if(this.peer&&this.peer.disconnected&&!this.peer.destroyed&&((l=this.initializationParams)==null?void 0:l.role)===e&&((c=this.initializationParams)==null?void 0:c.room)===t)return console.log("[Sync] Peer is disconnected, attempting to reconnect..."),this.peer.reconnect(),this.peer.id||"reconnecting";if(this.peer&&!this.peer.destroyed&&(console.log("[Sync] Parameters changed or peer state invalid, destroying old peer..."),this.destroy()),this.initializationParams={role:e,room:t},this.isHost=e==="DJ",!this.isHost&&t&&(this.hostId=this.sanitizeID(t)),this.isHost&&!t){const d=await this.getPublicIP(),p=this.sanitizeID(`singmode-lock-${btoa(d).replace(/=/g,"").substr(0,12)}`);if(!await new Promise(v=>{const x=setTimeout(()=>v(!0),1e4),E=new Pf(p,{debug:1});E.on("open",()=>{clearTimeout(x),this.lockPeer=E,v(!0)}),E.on("error",A=>{clearTimeout(x),v(A.type!=="unavailable-id"),E.destroy()})}))throw new Error("COLLISION: A SingMode DJ session is already active on this network.")}return new Promise((d,p)=>{const g=this.isHost?t?this.sanitizeID(t):`singmode-${Math.random().toString(36).substr(2,6)}`:void 0,v=setTimeout(()=>{const x=this.isHost?t||"fallback-host":"fallback-peer";this.isHost&&(this.hostId=x),d(x)},2e4);this.peer=new Pf(g,{debug:3,config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"}]}}),this.peer.on("open",x=>{clearTimeout(v),console.log(`[Sync] Peer opened with ID: ${x}`),this.isHost&&(this.hostId=x,this.subscribeToPendingActions(x)),this.retryCount=0,this.startHeartbeat(),!this.isHost&&t&&this.connectToHost(t),this.onConnectionStatus&&(!t||this.connections.size>0)&&this.onConnectionStatus("connected"),d(x)}),this.peer.on("disconnected",()=>{var x;console.warn("[Sync] Peer disconnected. Reconnecting..."),this.onConnectionStatus&&this.onConnectionStatus("connecting"),(x=this.peer)==null||x.reconnect()}),this.peer.on("connection",x=>{this.handleConnection(x)}),this.peer.on("error",x=>{var E;console.error("[Sync] Peer error:",x.type),x.type==="unavailable-id"?t?p(new Error(`Session "${t}" is in use.`)):(this.destroy(),this.initialize(e).then(d).catch(p)):(x.type==="network"||x.type==="server-error"||(E=x.message)!=null&&E.includes("Lost connection"))&&(this.onConnectionStatus&&this.onConnectionStatus("disconnected"),this.handleNetworkError(e,t))})})}handleNetworkError(e,t){if(this.retryCount<this.maxRetries){this.retryCount++;const n=Math.min(1e3*Math.pow(2,this.retryCount),3e4);setTimeout(()=>this.initialize(e,t),n)}}startHeartbeat(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.heartbeatInterval=window.setInterval(()=>{var e,t,n,a,l,c;(e=this.peer)!=null&&e.disconnected&&!((t=this.peer)!=null&&t.destroyed)&&((n=this.peer)==null||n.reconnect()),(a=this.lockPeer)!=null&&a.disconnected&&!((l=this.lockPeer)!=null&&l.destroyed)&&((c=this.lockPeer)==null||c.reconnect())},5e3)}connectToHost(e){if(!this.peer||this.isHost||this.peer.destroyed)return;this.onConnectionStatus&&this.onConnectionStatus("connecting");const t=this.peer.connect(e,{reliable:!0});this.handleConnection(t)}handleConnection(e){e.on("open",()=>{console.log(`[Sync] Connected to: ${e.peer}`),this.connections.set(e.peer,e),!this.isHost&&this.actionQueue.length>0&&this.actionQueue.forEach(t=>e.send(t)),this.isHost&&this.onPeerConnected&&this.onPeerConnected(),this.isHost&&this.onDeviceConnected&&this.onDeviceConnected(e.peer),this.isHost||(console.log(`[Sync] Connection to ${e.peer} opened. Flushing ${this.actionQueue.length} pending actions...`),setTimeout(()=>this.flushQueue(),500))}),e.on("data",t=>{t&&typeof t=="object"&&("type"in t&&this.onActionReceived?this.onActionReceived({...t,senderId:e.peer}):"participants"in t&&this.onStateReceived&&this.applyIncomingState(t))}),e.on("close",()=>{this.connections.delete(e.peer),this.connections.size===0&&this.onConnectionStatus&&!this.isHost&&this.onConnectionStatus("disconnected"),this.isHost&&this.onDeviceDisconnected&&this.onDeviceDisconnected(e.peer)}),e.on("error",t=>{console.error("[Sync] Connection error:",t),this.connections.delete(e.peer)})}broadcastState(e){this.isHost&&this.connections.forEach(t=>{t.open&&t.send(e)})}broadcastAction(e){this.isHost&&this.connections.forEach(t=>{t.open&&t.send(e)})}async sendAction(e){if(this.isHost)return;if(!this.actionQueue.some(n=>n.type===e.type&&JSON.stringify(n.payload)===JSON.stringify(e.payload))){console.log("[Sync] Queuing new action locally:",e.type),this.actionQueue.push(e),this.persistQueue();let n=!1;if(this.connections.forEach(a=>{a.open&&(n=!0)}),this.hostId){const a=gP(Ks(Yt,"sessions",this.hostId,"pending_actions"),{...e,bufferedAt:Date.now()});if(n)a.catch(l=>console.warn("[Sync] Background Firestore buffer delayed:",l.message));else{console.log(`[Sync] No active P2P connection. Awaiting explicit Firestore fallback write for ${e.type}...`);try{await Promise.race([a,new Promise((l,c)=>setTimeout(()=>c(new Error("Firestore write timeout")),5e3))]),console.log(`[Sync] Action ${e.type} confirmed written to Firestore.`)}catch(l){console.warn("[Sync] Firestore write failed or timed out:",l.message)}}}}this.flushQueue()}flushQueue(){if(this.isHost||this.actionQueue.length===0)return;let e=0;this.connections.forEach(t=>{t.open&&this.actionQueue.forEach(n=>{t.send(n),e++})}),e>0?console.log(`[Sync] Flushed ${this.actionQueue.length} actions across open connections.`):console.warn("[Sync] Flush requested but no open connections available.")}requestState(){this.isHost||this.sendAction({type:"REQUEST_STATE",payload:{},senderId:this.getMyPeerId()||"participant"})}getRoomId(){var e;return((e=this.peer)==null?void 0:e.id)||null}getMyPeerId(){var e;return((e=this.peer)==null?void 0:e.id)||null}getHostId(){return this.hostId}getPendingActions(){return this.actionQueue}subscribeToPendingActions(e){this.unsubscribeActions&&this.unsubscribeActions(),console.log(`[Sync] Monitoring Firestore: sessions/${e}/pending_actions`);const t=Uh(Ks(Yt,"sessions",e,"pending_actions"));this.unsubscribeActions=zp(t,n=>{n.docChanges().forEach(a=>{if(a.type==="added"){const l=a.doc.data();this.onActionReceived&&this.onActionReceived(l),xh(yr(Yt,"sessions",e,"pending_actions",a.doc.id)).catch(c=>console.warn("[Sync] Cleanup failed:",c.message))}})})}applyIncomingState(e){if(!this.isHost&&this.actionQueue.length>0){const t=this.actionQueue.length;this.actionQueue=this.actionQueue.filter(n=>{if(n.type==="ADD_REQUEST"){const a=n.payload;return a.clientRequestId&&e.requests.some(l=>l.clientRequestId===a.clientRequestId)?!1:!e.requests.some(l=>l.participantId===a.participantId&&l.songName.toLowerCase().trim()===a.songName.toLowerCase().trim()&&l.artist.toLowerCase().trim()===a.artist.toLowerCase().trim())}return!0}),this.actionQueue.length!==t&&this.persistQueue()}this.onStateReceived&&this.onStateReceived(e)}destroy(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.connections.forEach(e=>e.close()),this.connections.clear(),this.unsubscribeActions&&(this.unsubscribeActions(),this.unsubscribeActions=null),this.peer&&(this.peer.destroy(),this.peer=null),this.lockPeer&&(this.lockPeer.destroy(),this.lockPeer=null)}}const Me=new vP,Zu="kstar_karaoke_session",In="kstar_active_user",Cn="kstar_user_accounts";let bt=!1,jE=Promise.resolve();const rr=async s=>await(jE=jE.then(async()=>{const t=await At(),n=await s(t);return await En(t),n})),cy={id:"current-session",participants:[],requests:[],currentRound:null,history:[],messages:[],tickerMessages:[],verifiedSongbook:[],isPlayingVideo:!1,nextRequestNumber:1,maxRequestsPerUser:5,bannedUsers:[],deviceConnections:[],queueStrategy:Ls.FRESH_MEAT,startedAt:Date.now()},uy=typeof window<"u"&&window.chrome&&window.chrome.storage,Ye={get:async s=>{if(uy)return(await window.chrome.storage.local.get([s]))[s];const e=localStorage.getItem(s);return e?JSON.parse(e):null},set:async(s,e,t=!1)=>{uy?await window.chrome.storage.local.set({[s]:e}):localStorage.setItem(s,JSON.stringify(e)),typeof window<"u"&&!t&&(window.dispatchEvent(new Event("kstar_sync")),window.dispatchEvent(new Event("storage")))}};Me.onStateReceived=s=>{bt&&Ye.set(Zu,s)};Me.onActionReceived=s=>{bP(s)};Me.onPeerConnected=async()=>{if(!bt){const s=await At();Me.broadcastState(s)}};async function bP(s){switch(console.log(`[SessionManager] Processing remote action: ${s.type} from ${s.senderId} `),s.type){case"ADD_REQUEST":await va(s.payload);break;case"JOIN_SESSION":{const{id:n,profile:a}=s.payload;if(a){const l=await Lt(),c=l.findIndex(d=>d.id===n);c===-1?(l.push(a),await Ye.set(Cn,l,!0)):(l[c]={...l[c],...a},await Ye.set(Cn,l,!0))}await bi(n),hy(`${(a==null?void 0:a.name)||n} joined the session`,"info");break}case"TOGGLE_STATUS":await Aa(s.payload.id,s.payload.status);break;case"REQUEST_STATE":if(!bt){const n=await At();Me.broadcastState(n)}break;case"TOGGLE_MIC":await MP(s.payload.id,s.payload.enabled);break;case"DELETE_REQUEST":await ba(s.payload);break;case"UPDATE_REQUEST":await eh(s.payload.id,s.payload.updates);break;case"ADD_CHAT":await BP(s.senderId,s.payload.name,s.payload.text);break;case"SYNC_PROFILE":if(bt){const n=await Qn();n&&n.id===s.payload.id&&await Ye.set(In,s.payload)}const e=await Lt(),t=e.findIndex(n=>n.id===s.payload.id);t>-1?e[t]=s.payload:e.push(s.payload),await Ye.set(Cn,e,!0);break;case"HEARTBEAT":bt||ZN(s.senderId);break;case"TOGGLE_FAVORITE":bt||await nA(s.payload,s.senderId);break;case"REORDER_ROUND":await rA(s.payload);break;case"REORDER_REQUESTS":await sA(s.payload);break;case"REORDER_PENDING":await iA(s.payload);break;case"REORDER_MY_REQUESTS":await fy(s.senderId,s.payload.requestId,s.payload.direction);break}}const tc=async(s,e)=>{const t=s==="DJ",n=typeof window<"u"?localStorage.getItem("kstar_dj_session_id"):null,a=e||(t?n:void 0);bt=s==="PARTICIPANT"&&!!a,console.log(`[SessionManager] Setting up sync. Role: ${s}, Room: ${a||"New Session"} (Saved: ${n})`);const l=await Me.initialize(s,a||void 0);if(t&&l&&localStorage.setItem("kstar_dj_session_id",l),!bt&&l){const c=await Qn(),d=(c==null?void 0:c.name)||"SingMode DJ",p=c==null?void 0:c.id;await GP({id:l,hostName:d,hostUid:p,isActive:!0,startedAt:Date.now()});const g=await At();g.id=l,await En(g);const v=setInterval(()=>{qP(l)},120*1e3);window.addEventListener("beforeunload",()=>{clearInterval(v),aA(l)});const x=Ks(Yt,"users");zp(x,E=>{const A=[];E.forEach(O=>{A.push(O.data())}),console.log("Synced users from Firestore:",A.length),Ye.set(Cn,A)}),Me.onDeviceConnected=E=>{ZN(E),hy(`New device connected: ${E.substr(0,8)}...`,"info")},Me.onDeviceDisconnected=async E=>{const A=await At();if(A.deviceConnections){const O=A.deviceConnections.findIndex(F=>F.peerId===E);if(O>-1){const F=A.deviceConnections[O].id;A.deviceConnections[O].status="disconnected",A.deviceConnections[O].lastSeen=Date.now(),await En(A),hy(`Device disconnected: ${F} `,"warn")}}}}if(bt){const c=Me.getHostId()||e;if(c){console.log("[Sync] Initializing robust Firestore fallback sync for room:",c),EP(c,p=>{console.log("[Sync] Received state update via Firestore fallback. Connection status:",Me.getMyPeerId()?"P2P Pending/Active":"Cloud Only"),Me.applyIncomingState(p),Me.onConnectionStatus&&Me.onConnectionStatus("connected")});const d=setInterval(()=>{bt&&Me.sendAction({type:"HEARTBEAT",payload:{},senderId:Me.getMyPeerId()||"anon"}).catch(p=>console.warn("[Sync] Heartbeat failed:",p.message))},3e4);window.addEventListener("beforeunload",()=>clearInterval(d))}}},ZN=async s=>{await rr(e=>{e.deviceConnections||(e.deviceConnections=[]);const t=e.deviceConnections.findIndex(n=>n.peerId===s);t>-1?(e.deviceConnections[t].status="connected",e.deviceConnections[t].lastSeen=Date.now()):e.deviceConnections.push({id:`D - ${Math.random().toString(36).substr(2,4).toUpperCase()} `,peerId:s,connectedAt:Date.now(),lastSeen:Date.now(),status:"connected",userAgent:"Unknown"})})},xP=async(s,e,t=!1)=>{await rr(n=>{if(!n.deviceConnections)return;const a=n.deviceConnections.findIndex(l=>l.id===s);a>-1&&(n.deviceConnections[a].userId=e,n.deviceConnections[a].isGuest=t)})},_P=async s=>{await rr(e=>{e.deviceConnections&&(e.deviceConnections=e.deviceConnections.filter(t=>t.id!==s))})},At=async s=>{const e=new Promise((t,n)=>setTimeout(()=>n(new Error("Timeout: getSession took too long")),15e3));try{const t=(async()=>{if(s){const a=await wP(s);if(a)return bt&&await Ye.set(Zu,a),a}const n=await Ye.get(Zu)||{...cy};return n.history||(n.history=[]),n.messages||(n.messages=[]),n.tickerMessages||(n.tickerMessages=[]),n.verifiedSongbook||(n.verifiedSongbook=[]),n.isPlayingVideo===void 0&&(n.isPlayingVideo=!1),n.nextRequestNumber||(n.nextRequestNumber=1),n.maxRequestsPerUser===void 0&&(n.maxRequestsPerUser=5),n.bannedUsers||(n.bannedUsers=[]),n.deviceConnections||(n.deviceConnections=[]),n.logs||(n.logs=[]),n.queueStrategy||(n.queueStrategy=Ls.FRESH_MEAT),n})();return await Promise.race([t,e])}catch(t){return console.warn("[Session] getSession fallback to local due to timeout or error:",t),await Ye.get(Zu)||{...cy}}},En=async s=>{if(await Ye.set(Zu,s),Me.broadcastState(s),!bt&&s.id)try{const e=yr(Yt,"sessions",s.id);await kv(e,{fullState:JSON.stringify(s),lastHeartbeat:Date.now(),participantsCount:s.participants.length},{merge:!0})}catch(e){console.error("[SessionManager] Error persisting full state to Firestore:",e)}},wP=async s=>{const e=new Promise((t,n)=>setTimeout(()=>n(new Error(`Timeout: getSessionById for ${s} took too long`)),1e4));try{const t=(async()=>{const n=yr(Yt,"sessions",s),a=await Rv(n);if(a.exists()){const l=a.data();if(l.fullState)return JSON.parse(l.fullState)}return null})();return await Promise.race([t,e])}catch(t){return console.error(`[SessionManager] Error fetching session ${s}: `,t),null}},EP=(s,e)=>{const t=yr(Yt,"sessions",s);return zp(t,n=>{if(n.exists()){const a=n.data();if(a.fullState)try{const l=JSON.parse(a.fullState);e(l)}catch(l){console.error("[SessionManager] Error parsing session state from Firestore:",l)}}})},hy=async(s,e="info")=>{await rr(t=>{t.logs||(t.logs=[]),t.logs.push({timestamp:Date.now(),message:s,type:e}),t.logs.length>100&&(t.logs=t.logs.slice(-100))})},eA=(s,e)=>{if(e.youtubeUrl&&e.youtubeUrl.trim()!==""){const t=s.verifiedSongbook.find(n=>n.songName.toLowerCase()===e.songName.toLowerCase()&&n.artist.toLowerCase()===e.artist.toLowerCase());if(t)t.youtubeUrl!==e.youtubeUrl&&(t.youtubeUrl=e.youtubeUrl);else{const n={id:Math.random().toString(36).substr(2,9),songName:e.songName,artist:e.artist,youtubeUrl:e.youtubeUrl,type:e.type,addedAt:Date.now()};s.verifiedSongbook.push(n)}}},TP=async s=>{const e=await At(),t={...s,id:Math.random().toString(36).substr(2,9),addedAt:Date.now()};e.verifiedSongbook.push(t),await En(e)},SP=async(s,e)=>{const t=await At(),n=t.verifiedSongbook.findIndex(a=>a.id===s);n!==-1&&(t.verifiedSongbook[n]={...t.verifiedSongbook[n],...e},await En(t))},OE=async s=>{const e=await At();e.verifiedSongbook=e.verifiedSongbook.filter(t=>t.id!==s),await En(e)},NP=async()=>{const s=await At(),e={...cy,id:`session - ${Date.now()} `,verifiedSongbook:s.verifiedSongbook,nextRequestNumber:1,startedAt:Date.now()};await En(e)},Lt=async()=>{let s=await Ye.get(Cn);if(!s||s.length===0){try{const t=Ks(Yt,"users"),n=await Rc(t),a=[];if(n.forEach(l=>a.push(l.data())),a.length>0)return await Ye.set(Cn,a),a}catch(t){console.error("Error fetching users from Firebase:",t)}return Array.from({length:5},(t,n)=>({id:`singer - ${n+1} `,name:`Singer${n+1} `,favorites:[],personalHistory:[],createdAt:Date.now()}))}return s},Ho=async(s,e)=>{try{const t=yr(Yt,"users",s);if(e.name&&(await Lt()).find(d=>{var p;return d.id!==s&&d.name.toLowerCase()===((p=e.name)==null?void 0:p.toLowerCase())}))return{success:!1,error:"Username already exists."};await Dv(t,e);const n=await Lt(),a=n.findIndex(l=>l.id===s);if(a>-1){n[a]={...n[a],...e},await Ye.set(Cn,n,!0);const l=await Qn();l&&l.id===s&&await Ye.set(In,n[a]),bt||Me.broadcastAction({type:"SYNC_PROFILE",payload:n[a],senderId:"DJ"})}return{success:!0}}catch(t){return console.error("Error updating account:",t),{success:!1,error:t.message}}},AP=async(s,e)=>{const t=await Lt(),n=t.findIndex(a=>a.id===s);if(n>-1){const a=t[n].favorites.filter(l=>l.id!==e);await Ho(s,{favorites:a})}},IP=async(s,e,t)=>{const n=await Lt(),a=n.findIndex(l=>l.id===s);if(a>-1){const l=[...n[a].favorites],c=l.findIndex(d=>d.id===e);c>-1&&(l[c]={...l[c],...t},await Ho(s,{favorites:l}))}},CP=async(s,e)=>{const t=await Lt(),n=t.findIndex(a=>a.id===s);if(n>-1){const a={...e,id:Math.random().toString(36).substr(2,9)},l=[...t[n].favorites,a];await Ho(s,{favorites:l})}},RP=async(s,e)=>{const t=await Lt(),n=t.findIndex(a=>a.id===s);if(n>-1){const a=t[n].personalHistory.filter(l=>l.id!==e);await Ho(s,{personalHistory:a})}},kP=async(s,e,t)=>{const n=await Lt(),a=n.findIndex(l=>l.id===s);if(a>-1){const l=[...n[a].personalHistory],c=l.findIndex(d=>d.id===e);c>-1&&(l[c]={...l[c],...t},await Ho(s,{personalHistory:l}))}},Df=async s=>{await dy(s);try{await xh(yr(Yt,"users",s));let t=await Lt();t=t.filter(n=>n.id!==s),await Ye.set(Cn,t,!0)}catch(t){console.error("Error deleting account",t)}const e=await Qn();e&&e.id===s&&await Fp()},tA=async()=>{try{const s=await Lt(),e=[],t=new Map;for(const n of s){if(!n.password){e.push(n.id);continue}const a=n.name.toLowerCase().trim();t.has(a)?e.push(n.id):t.set(a,n.id)}if(e.length>0){for(const c of e)await xh(yr(Yt,"users",c));const n=Ks(Yt,"users"),a=await Rc(n),l=[];a.forEach(c=>l.push(c.data())),await Ye.set(Cn,l,!0)}return{success:!0,deletedCount:e.length}}catch(s){return console.error("Cleanup failed:",s),{success:!1,error:String(s)}}},Qn=async()=>{const s=await Ye.get(In);if(s){const t=(await Lt()).find(n=>n.id===s.id);if(t)return t}return s},_h=async(s,e=!1)=>{var t;try{let n=s.id;const a=!!(s.password&&s.email),l=!!(s.password&&!s.email);if(a)try{n=(await p5(jv,s.email,s.password)).user.uid}catch(g){if(g.code==="auth/email-already-in-use")return{success:!1,error:"Email already in use."};throw g}else if(l){if((await Lt()).find(x=>{var E;return x.name.toLowerCase()===((E=s.name)==null?void 0:E.trim().toLowerCase())}))return{success:!1,error:"Username already taken."};n=PE()||`user - ${Date.now()} -${Math.random().toString(36).substr(2,5)} `}else n=s.id||PE()||`guest - ${Math.random().toString(36).substr(2,9)} `;const c={id:n,name:((t=s.name)==null?void 0:t.trim())||"Guest",email:s.email||void 0,password:l?s.password:void 0,isGuest:!a&&!l,favorites:s.favorites||[],personalHistory:s.personalHistory||[],createdAt:Date.now()},d=JSON.parse(JSON.stringify(c));await kv(yr(Yt,"users",n),d);const p=await Lt();return p.some(g=>g.id===n)||(p.push(c),await Ye.set(Cn,p,!0)),e?await Ye.set(In,c,!0):bt||Me.broadcastAction({type:"SYNC_PROFILE",payload:c,senderId:"DJ"}),{success:!0,profile:c}}catch(n){return console.error("Registration error:",n),{success:!1,error:n.message}}},PE=()=>{},DP=async(s,e)=>{if(s.toLowerCase()==="singmaster"&&e==="Organized"){const a={id:"admin-singmaster",name:"SingMaster",password:"Organized",favorites:[],personalHistory:[],createdAt:Date.now()};return await Ye.set(In,a),{success:!0,profile:a}}const t=await Lt();let n=t.find(a=>a.name.toLowerCase()===s.toLowerCase());if(!n)try{const a=Ks(Yt,"users"),l=Uh(a,Up("name","==",s)),c=await Rc(l);c.empty||(n=c.docs[0].data(),t.push(n),await Ye.set(Cn,t))}catch(a){console.warn("Error checking remote user:",a)}if(!n&&!e)return await _h({name:s},!0);if(e)try{const a=`${s.replace(/\s+/g,"").toLowerCase()} @singmode.app`,c=(await m5(jv,a,e)).user.uid,d=await Rv(yr(Yt,"users",c));if(d.exists()){const p=d.data();return await Ye.set(In,p),{success:!0,profile:p}}else return n?{success:!0,profile:n}:{success:!1,error:"Profile data missing."}}catch(a){return console.warn("Firebase login failed, checking legacy local storage:",a),n?n.password&&n.password===e?(await Ye.set(In,n),{success:!0,profile:n}):{success:!1,error:"Incorrect passkey."}:{success:!1,error:a.message||"Login failed."}}return n?(await Ye.set(In,n),{success:!0,profile:n}):{success:!1,error:"User not found"}},jP=async s=>{const e=await Lt();let t=e.find(n=>n.id===s);if(!t)try{const n=yr(Yt,"users",s),a=await Rv(n);a.exists()&&(t=a.data(),e.push(t),await Ye.set(Cn,e))}catch(n){console.error("Error fetching user by ID:",n)}return t?(await Ye.set(In,t),{success:!0,profile:t}):{success:!1,error:"User not found"}},Fp=async()=>{await v5(jv),uy?await window.chrome.storage.local.remove([In]):localStorage.removeItem(In),window.dispatchEvent(new Event("kstar_sync"))},bi=async s=>await rr(async e=>{var l;const t=(l=e.bannedUsers)==null?void 0:l.find(c=>c.id===s);if(t)throw new Error(`ACCESS DENIED: ${t.reason} `);if(bt){const c=await Qn();return Me.sendAction({type:"JOIN_SESSION",payload:{id:s,profile:c,userAgent:typeof navigator<"u"?navigator.userAgent:"Unknown"},senderId:Me.getMyPeerId()||s}),{id:s,name:(c==null?void 0:c.name)||"Joining...",status:Kt.STANDBY,joinedAt:Date.now()}}const a=(await Lt()).find(c=>c.id===s);if(!a){const c=await Qn();if(c&&c.id===s)return await ME(e,c);throw new Error("Profile not found")}return await ME(e,a)}),ME=async(s,e)=>{const t={id:e.id,name:e.name,status:Kt.STANDBY,micEnabled:!1,joinedAt:Date.now()},n=s.participants.findIndex(a=>a.id===e.id);return n>-1?s.participants[n]={...s.participants[n],...t,status:s.participants[n].status}:s.participants.push(t),t},OP=async(s,e)=>{const t=await Lt(),n=t.findIndex(a=>a.id===s);if(n>-1){t[n].vocalRange=e,await Ye.set(Cn,t,!0),bt||Me.broadcastAction({type:"SYNC_PROFILE",payload:t[n],senderId:"DJ"});const a=await Qn();a&&a.id===s&&await Ye.set(In,t[n])}},nA=async(s,e)=>{var l;const t=e||((l=await Qn())==null?void 0:l.id);if(!t)return;if(bt&&!e){Me.sendAction({type:"TOGGLE_FAVORITE",payload:s,senderId:t});const c=await Qn();if(c){const d=c.favorites.findIndex(p=>p.songName===s.songName&&p.artist===s.artist);d>-1?c.favorites.splice(d,1):c.favorites.push({...s,id:Math.random().toString(36).substr(2,9)}),await Ye.set(In,c)}return}const n=await Lt(),a=n.findIndex(c=>c.id===t);if(a>-1){const c=n[a].favorites.findIndex(p=>p.songName===s.songName&&p.artist===s.artist);c>-1?n[a].favorites.splice(c,1):n[a].favorites.push({...s,id:Math.random().toString(36).substr(2,9)}),await Ye.set(Cn,n,!0),bt||Me.broadcastAction({type:"SYNC_PROFILE",payload:n[a],senderId:"DJ"});const d=await Qn();d&&d.id===t&&await Ye.set(In,n[a])}},dy=async s=>{const e=await At(),n=e.requests.filter(a=>a.participantId===s).map(a=>({...a,playedAt:Date.now(),status:Pe.DONE,isInRound:!1}));n.length>0&&(e.history=[...n,...e.history].slice(0,100)),e.participants=e.participants.filter(a=>a.id!==s),e.requests=e.requests.filter(a=>a.participantId!==s),e.currentRound&&(e.currentRound=e.currentRound.filter(a=>a.participantId!==s),e.currentRound.length===0&&(e.currentRound=null)),await En(e)},Aa=async(s,e)=>{if(bt){Me.sendAction({type:"TOGGLE_STATUS",payload:{id:s,status:e},senderId:s});return}await rr(t=>{const n=t.participants.find(a=>a.id===s);n&&(n.status=e)})},PP=async s=>{const e=await At();e.maxRequestsPerUser=s,await En(e)},fy=async(s,e,t)=>{if(bt){Me.sendAction({type:"REORDER_MY_REQUESTS",payload:{requestId:e,direction:t},senderId:s});return}const n=await At(),a=n.requests.filter(v=>v.participantId===s&&v.status!==Pe.DONE),l=a.findIndex(v=>v.id===e);if(l===-1)return;const c=t==="up"?l-1:l+1;if(c<0||c>=a.length)return;const[d]=a.splice(l,1);a.splice(c,0,d);const p=[...n.requests];p.map((v,x)=>v.participantId===s&&v.status!==Pe.DONE?x:-1).filter(v=>v!==-1).forEach((v,x)=>{p[v]=a[x]}),n.requests=p,await En(n)},MP=async(s,e)=>{if(bt){Me.sendAction({type:"TOGGLE_MIC",payload:{id:s,enabled:e},senderId:s});return}await rr(t=>{const n=t.participants.find(a=>a.id===s);n&&(n.micEnabled=e)})},va=async s=>{if(bt){const e=Math.random().toString(36).substr(2,9);return Me.sendAction({type:"ADD_REQUEST",payload:{...s,clientRequestId:e},senderId:s.participantId}),null}return await rr(async e=>{const t=e.nextRequestNumber++,n={...s,id:Math.random().toString(36).substr(2,9),requestNumber:t,createdAt:Date.now(),status:Pe.PENDING,isInRound:!1},a=e.requests.filter(g=>g.participantId===s.participantId&&g.status===Pe.PENDING);if(e.maxRequestsPerUser&&a.length>=e.maxRequestsPerUser)throw new Error(`Request limit reached.Max ${e.maxRequestsPerUser} requests allowed per performer.`);if(a.some(g=>g.songName.toLowerCase().trim()===s.songName.toLowerCase().trim()&&g.artist.toLowerCase().trim()===s.artist.toLowerCase().trim()))return console.log("[SessionManager] Duplicate request detected, skipping:",s.songName),null;e.requests.unshift(n),eA(e,n);const c=await Lt(),d=c.findIndex(g=>g.id===s.participantId);d>-1&&(c[d].personalHistory=[n,...c[d].personalHistory].slice(0,50),await Ye.set(Cn,c,!0),bt||Me.broadcastAction({type:"SYNC_PROFILE",payload:c[d],senderId:"DJ"}));const p=await Qn();if(p&&p.id===s.participantId){const g=c.find(v=>v.id===s.participantId);g&&await Ye.set(In,g,!0)}return n})},eh=async(s,e)=>{if(bt){Me.sendAction({type:"UPDATE_REQUEST",payload:{id:s,updates:e},senderId:"client"});return}await rr(async t=>{const n=t.requests.findIndex(l=>l.id===s);let a="";if(n!==-1&&(t.requests[n]={...t.requests[n],...e},a=t.requests[n].participantId,eA(t,t.requests[n])),t.currentRound){const l=t.currentRound.findIndex(c=>c.id===s);l!==-1&&(t.currentRound[l]={...t.currentRound[l],...e},a=t.currentRound[l].participantId)}if(a){const l=await Lt(),c=l.findIndex(p=>p.id===a);if(c>-1){const p=l[c].personalHistory.findIndex(g=>g.id===s);p!==-1&&(l[c].personalHistory[p]={...l[c].personalHistory[p],...e},await Ye.set(Cn,l),bt||Me.broadcastAction({type:"SYNC_PROFILE",payload:l[c],senderId:"DJ"}))}const d=await Qn();if(d&&d.id===a){const p=l.find(g=>g.id===a);p&&await Ye.set(In,p)}}})},ku=async s=>{await rr(e=>{const t=e.requests.find(n=>n.id===s);t&&(t.status=Pe.APPROVED)})},VP=async s=>{await rr(e=>{const t=e.requests.findIndex(a=>a.id===s);if(t===-1)return;const n=e.requests[t];n.status=Pe.APPROVED,n.isInRound=!0,e.currentRound?e.currentRound.push({...n}):e.currentRound=[{...n}]})},VE=async s=>{bt||await rr(async e=>{const t=e.requests.find(n=>n.id===s);if(t){if(t.status=Pe.DONE,t.completedAt=Date.now(),e.currentRound){const n=e.currentRound.find(a=>a.id===s);n&&(n.status=Pe.DONE,n.completedAt=Date.now())}try{const n=await Lt(),a=n.findIndex(l=>l.id===t.participantId);if(a!==-1){const l={...t,playedAt:Date.now(),isInRound:!1,status:Pe.DONE};n[a].personalHistory=[l,...n[a].personalHistory].slice(0,50),await Ye.set(Cn,n);const c=await Qn();c&&c.id===t.participantId&&await Ye.set(In,n[a]),bt||Me.broadcastAction({type:"SYNC_PROFILE",payload:n[a],senderId:"DJ"})}}catch(n){console.error("[SessionManager] Error updating participant history in markRequestAsDone:",n)}}})},ba=async s=>{if(bt){Me.sendAction({type:"DELETE_REQUEST",payload:s,senderId:"client"});return}await rr(e=>{e.requests=e.requests.filter(t=>t.id!==s),e.currentRound&&(e.currentRound=e.currentRound.filter(t=>t.id!==s),e.currentRound.length===0&&(e.currentRound=null))})},LE=async(s,e)=>{const t=await At(),n=t.requests.findIndex(l=>l.id===s);if(n===-1)return;const a=e==="up"?n-1:n+1;if(a>=0&&a<t.requests.length){const l=t.requests[n];t.requests[n]=t.requests[a],t.requests[a]=l,await En(t)}},LP=async s=>{const e=await At();e.queueStrategy=s,await En(e)},UP=async()=>{const s=await At(),e=s.queueStrategy||Ls.FRESH_MEAT,t=s.requests.filter(a=>a.status===Pe.APPROVED&&a.type===ft.SINGING&&!a.isInRound),n=[];if(e===Ls.FIFO){const a=[...t].sort((l,c)=>l.createdAt-c.createdAt);n.push(...a.slice(0,10))}else{let l=[...s.participants.filter(c=>t.some(d=>d.participantId===c.id))];switch(e){case Ls.FRESH_MEAT:l.sort((p,g)=>(g.joinedAt||0)-(p.joinedAt||0));break;case Ls.OLDEST_MEMBER:l.sort((p,g)=>(p.joinedAt||0)-(g.joinedAt||0));break;case Ls.RANDOM:l.sort(()=>Math.random()-.5);break;case Ls.FAIR_ROTATION:const c=p=>s.requests.filter(g=>g.participantId===p&&g.status===Pe.DONE).length,d=p=>{var v;return((v=t.filter(x=>x.participantId===p).sort((x,E)=>x.createdAt-E.createdAt)[0])==null?void 0:v.createdAt)||Date.now()};l.sort((p,g)=>{const v=c(p.id),x=c(g.id);return v!==x?v-x:d(p.id)-d(g.id)});break}l.forEach(c=>{const p=t.filter(g=>g.participantId===c.id).sort((g,v)=>g.createdAt-v.createdAt)[0];p&&n.push(p)})}if(n.length===0){const a=s.requests.filter(l=>l.status===Pe.APPROVED&&l.type===ft.LISTENING&&!l.isInRound).sort((l,c)=>l.createdAt-c.createdAt);a.length>0&&n.push(...a.slice(0,5))}n.forEach(a=>{const l=s.requests.find(c=>c.id===a.id);if(l&&(l.isInRound=!0),a.type===ft.SINGING){const c=s.participants.find(d=>d.id===a.participantId);c&&(c.status=Kt.READY)}}),n.length>0&&(s.currentRound=n,await En(s))},rA=async s=>{const e=await At();e.currentRound=s,await En(e)},sA=async s=>{const e=await At(),t=e.requests.filter(n=>!(n.status===Pe.APPROVED&&n.type===ft.SINGING&&!n.isInRound));e.requests=[...s,...t],await En(e)},iA=async s=>{const e=await At(),t=e.requests.filter(n=>!(n.status===Pe.PENDING&&!n.isInRound));e.requests=[...s,...t],await En(e)},zP=async()=>{await rr(async s=>{if(!s.currentRound)return;const e=[...s.currentRound].sort((d,p)=>d.completedAt&&p.completedAt?d.completedAt-p.completedAt:d.completedAt?-1:p.completedAt?1:0),t=Date.now(),n=e.map(d=>({...d,playedAt:t,isInRound:!1,status:Pe.DONE,completedAt:d.completedAt||t})),a=s.currentRound.map(d=>d.id);s.history=[...n,...s.history].slice(0,100),s.requests=s.requests.filter(d=>!a.includes(d.id));const l=await Lt();for(const d of n){const p=l.findIndex(g=>g.id===d.participantId);p!==-1&&(l[p].personalHistory=[d,...l[p].personalHistory].slice(0,50))}await Ye.set(Cn,l);const c=await Qn();if(c){const d=l.find(p=>p.id===c.id);d&&await Ye.set(In,d)}s.currentRound=null,s.isPlayingVideo=!1})},b0=async(s,e)=>{const t=await At(),n=t.nextRequestNumber++,a={...s,id:Math.random().toString(36).substr(2,9),requestNumber:n,createdAt:Date.now(),status:Pe.APPROVED,isInRound:!1,playedAt:void 0,aiIntro:void 0};t.requests.push(a),await En(t)},UE=async()=>{const s=await At();s.history=[],await En(s)},BP=async(s,e,t)=>{if(bt){Me.sendAction({type:"ADD_CHAT",payload:{name:e,text:t},senderId:s});return}await rr(n=>{const a={id:Math.random().toString(36).substr(2,9),senderId:s,senderName:e,text:t,timestamp:Date.now()};n.messages||(n.messages=[]),n.messages.push(a)})},FP=async()=>{const s=await Lt(),e=Date.now(),t=1440*60*1e3,n=s.filter(a=>!a.password&&a.createdAt&&e-a.createdAt>t);if(n.length>0){for(const a of n)await Df(a.id);console.log(`Cleaned up ${n.length} expired guest accounts.`)}},GP=async s=>{try{const e={id:s.id,hostName:s.hostName||"SingMode DJ",hostUid:s.hostUid||"anonymous-host",appVersion:"singmode-v2",isActive:s.isActive??!0,startedAt:s.startedAt||Date.now(),lastHeartbeat:Date.now(),participantsCount:0,venueName:s.venueName||"SingMode Venue"};await kv(yr(Yt,"sessions",s.id),e)}catch(e){console.error("Error registering session:",e)}},qP=async s=>{try{const e=yr(Yt,"sessions",s);await Dv(e,{lastHeartbeat:Date.now()})}catch(e){console.error("Error sending heartbeat:",e)}},aA=async s=>{try{const e=yr(Yt,"sessions",s);await Dv(e,{isActive:!1,endedAt:Date.now()})}catch(e){console.error("Error unregistering session:",e)}},HP=async()=>{try{const s=Ks(Yt,"sessions"),e=Uh(s,Up("isActive","==",!1)),t=await Rc(e),n=[];return t.forEach(a=>{n.push(a.data())}),n.sort((a,l)=>(l.endedAt||0)-(a.endedAt||0))}catch(s){return console.error("Error fetching session history:",s),[]}},$P=async()=>{try{const s=Ks(Yt,"sessions"),e=Uh(s,Up("isActive","==",!0)),t=await Rc(e),n=new Map,a=Date.now(),l=300*1e3;return t.forEach(c=>{const d=c.data();if(d.lastHeartbeat&&a-d.lastHeartbeat<l){const g=d.hostUid||`${d.hostName} -${d.venueName} `,v=n.get(g);(!v||d.lastHeartbeat>v.lastHeartbeat)&&n.set(g,d)}}),Array.from(n.values()).sort((c,d)=>d.lastHeartbeat-c.lastHeartbeat)}catch(s){return console.error("Error fetching sessions:",s),[]}},KP=async()=>{try{const s=Ks(Yt,"sessions"),e=await Rc(s),t=Date.now(),n=1800*1e3;let a=0;for(const l of e.docs){const c=l.data();c.lastHeartbeat&&t-c.lastHeartbeat>n?(await xh(l.ref),a++):!c.lastHeartbeat&&t-c.startedAt>n&&(await xh(l.ref),a++)}return{success:!0,deletedCount:a}}catch(s){return console.error("Cleanup failed:",s),{success:!1,error:String(s)}}},oA=s=>{const e=Ks(Yt,"sessions"),t=Uh(e,Up("isActive","==",!0));return zp(t,n=>{const a=new Map,l=Date.now(),c=300*1e3;n.forEach(p=>{const g=p.data(),v=g.lastHeartbeat&&l-g.lastHeartbeat<c,x=g.appVersion==="singmode-v2";if(v&&x){const E=g.hostUid||`${g.hostName} -${g.venueName} `,A=a.get(E);(!A||g.lastHeartbeat>A.lastHeartbeat)&&a.set(E,g)}});const d=Array.from(a.values()).sort((p,g)=>g.lastHeartbeat-p.lastHeartbeat);s(d)})},lA=({onSubmit:s,onCancel:e,title:t="Song Request",showSingerName:n=!1,initialSingerName:a="",initialSongName:l="",initialArtist:c="",initialYoutubeUrl:d="",initialType:p=ft.SINGING,submitLabel:g="SEND REQUEST",participants:v=[],currentUserId:x=""})=>{const[E,A]=ie.useState(a),O=E?`${t}: ${E}`:t,[F,J]=ie.useState(l),[se,ce]=ie.useState(c),[le,me]=ie.useState(d),[Ee,be]=ie.useState(p),[I,C]=ie.useState(""),[R,L]=ie.useState(""),j=P=>{if(P.preventDefault(),(!F||!se)&&!le||n&&!E)return;const k=v.find(at=>at.id===R);s({singerName:E,songName:F,artist:se,youtubeUrl:le,type:Ee,message:I,duetPartnerId:R||void 0,duetPartnerName:k==null?void 0:k.name})};return h.jsxs("form",{onSubmit:j,className:"relative w-full bg-[#050510] border-4 border-white/10 rounded-[3rem] p-10 overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] animate-in fade-in zoom-in-95 duration-300",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsxs("div",{className:"mb-8 text-center",children:[h.jsx("h3",{className:"text-3xl font-bold text-white font-bungee uppercase tracking-tight neon-text-glow-purple mb-2",children:O}),h.jsx("p",{className:"text-[10px] text-[var(--neon-cyan)] font-bold uppercase tracking-widest font-righteous opacity-80",children:"NEW REQUEST"})]}),h.jsxs("div",{className:"space-y-6",children:[n&&h.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2",children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Your Name"}),h.jsx("input",{type:"text",required:!0,value:E,onChange:P=>A(P.target.value),placeholder:"e.g. STAR_VIBE",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-cyan)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Song Title"}),h.jsx("input",{type:"text",value:F,onChange:P=>J(P.target.value),placeholder:"TITLE",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-pink)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Artist"}),h.jsx("input",{type:"text",value:se,onChange:P=>ce(P.target.value),placeholder:"ARTIST",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-pink)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"YouTube URL (Optional)"}),h.jsx("input",{type:"url",value:le,onChange:P=>me(P.target.value),placeholder:"https://youtube.com/watch?v=...",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-cyan)] outline-none transition-all text-xs font-mono shadow-inner tracking-wider"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Note for DJ"}),h.jsx("textarea",{value:I,onChange:P=>C(P.target.value),placeholder:"Key change? Dedication?",rows:2,className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-purple)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest resize-none"})]}),Ee===ft.SINGING&&v.length>1&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Duet Partner (Optional)"}),h.jsxs("select",{value:R,onChange:P=>L(P.target.value),className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-green)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest appearance-none",children:[h.jsx("option",{value:"",children:"-- NO PARTNER --"}),v.filter(P=>P.id!==x).map(P=>h.jsx("option",{value:P.id,children:P.name},P.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Performance Mode"}),h.jsx("div",{className:"flex bg-black/40 p-1.5 rounded-2xl border-2 border-white/5",children:Object.values(ft).map(P=>h.jsx("button",{type:"button",onClick:()=>be(P),className:`flex-1 py-3 rounded-xl font-bold text-[9px] uppercase tracking-widest transition-all font-righteous ${Ee===P?"bg-[var(--neon-cyan)] text-black shadow-[0_0_20px_rgba(0,229,255,0.4)]":"text-slate-600 hover:text-white hover:bg-white/5"}`,children:P},P))})]}),h.jsxs("div",{className:"flex gap-4 pt-6",children:[h.jsx("button",{type:"button",onClick:e,className:"flex-1 py-4 bg-black hover:bg-white/5 text-white rounded-xl font-bold text-[10px] uppercase tracking-widest transition-all border-2 border-white/10 font-righteous",children:"DISCARD"}),h.jsx("button",{type:"submit",className:"flex-[2] py-4 bg-[var(--neon-pink)] hover:bg-white hover:text-black text-white rounded-xl font-bold text-[10px] uppercase tracking-widest shadow-[0_0_30px_rgba(255,0,127,0.4)] transition-all font-righteous hover:scale-105",children:g})]})]})]})};function QP(){if(typeof window>"u")return"/";const s=window.location.pathname.match(/^(\/[^/]+\/)/);return s?s[1]:"/"}function cp(){if(typeof window>"u")return"";const s=window.location.port?`:${window.location.port}`:"",e=QP(),t=localStorage.getItem("kstar_network_ip");if(t){if(t.startsWith("http")){const l=t.replace(/\/$/,"");return l.endsWith(e.replace(/\/$/,""))?l+"/":l+e}return`http://${t.trim()}${s}${e}`}const n=window.location.origin;return!n.includes("localhost")&&!n.includes("127.0.0.1"),n+e}function py(s){localStorage.setItem("kstar_network_ip",s),window.dispatchEvent(new Event("kstar_sync"))}function cA(){return localStorage.getItem("kstar_network_ip")}const YP=[{songName:"Bohemian Rhapsody",artist:"Queen"},{songName:"Toxic",artist:"Britney Spears"},{songName:"Someone Like You",artist:"Adele"},{songName:"Sweet Caroline",artist:"Neil Diamond"},{songName:"Wonderwall",artist:"Oasis"},{songName:"Dancing Queen",artist:"ABBA"},{songName:"I Will Survive",artist:"Gloria Gaynor"},{songName:"Don't Stop Believin'",artist:"Journey"},{songName:"Livin' on a Prayer",artist:"Bon Jovi"},{songName:"My Way",artist:"Frank Sinatra"}],ya=({url:s})=>s?h.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",title:"Open Video Link",className:"p-3 rounded-2xl text-[var(--neon-cyan)] hover:bg-[var(--neon-cyan)]/20 border-2 border-[var(--neon-cyan)]/10 transition-all shadow-xl",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),h.jsx("polyline",{points:"15 3 21 3 21 9"}),h.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})}):null,XP=({url:s})=>{const[e,t]=ie.useState(!1);if(!s)return null;const n=()=>{navigator.clipboard.writeText(s).then(()=>{t(!0),setTimeout(()=>t(!1),2e3)})};return h.jsx("button",{onClick:n,title:"Copy Video URL",className:`p-3 rounded-2xl transition-all border-2 ${e?"bg-[var(--neon-cyan)] text-black border-[var(--neon-cyan)] shadow-[0_0_20px_var(--neon-cyan)]":"text-slate-400 hover:text-[var(--neon-cyan)] hover:bg-[var(--neon-cyan)]/10 border-white/5 shadow-xl"}`,children:e?h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),h.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1-2-2h9a2 2 0 0 1 2 2v1"})]})})},Du=({request:s})=>{const[e,t]=ie.useState(!1),n=s.songName||s.songName,a=()=>{const c=(s.type||s.type||ft.SINGING)===ft.SINGING?" Karaoke":" Lyric",d=`${n} ${s.artist}${c}`;navigator.clipboard.writeText(d).then(()=>{t(!0),setTimeout(()=>t(!1),2e3)})};return h.jsx("button",{onClick:a,title:"Copy Command String",className:`p-3 rounded-2xl transition-all border-2 ${e?"bg-[var(--neon-green)] text-black border-[var(--neon-green)] shadow-[0_0_20px_rgba(0,255,157,0.4)]":"text-slate-400 hover:text-[var(--neon-green)] hover:bg-[var(--neon-green)]/10 border-white/5 shadow-xl"}`,children:e?h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),h.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})},ju=({request:s})=>{const e=s.songName||s.songName,t=()=>{const a=(s.type||s.type||ft.SINGING)===ft.SINGING?" Karaoke":" Lyric",l=encodeURIComponent(`${e} ${s.artist}${a}`);window.open(`https://www.youtube.com/results?search_query=${l}`,"_blank")};return h.jsx("button",{onClick:t,title:"Search on YouTube",className:"p-3 rounded-2xl transition-all border-2 text-rose-500 hover:text-white hover:bg-rose-500 border-white/5 shadow-xl",children:h.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"})})})},JP=({onAdminAccess:s})=>{var Li,hs;const[e,t]=ie.useState(null),[n,a]=ie.useState([]),[l,c]=ie.useState(!1),[d,p]=ie.useState(!1),[g,v]=ie.useState(null),[x,E]=ie.useState(!1),[A,O]=ie.useState(!1),[F,J]=ie.useState(!1),[se,ce]=ie.useState(!1),[le,me]=ie.useState(!1),[Ee,be]=ie.useState([]),[I,C]=ie.useState(null),[R,L]=ie.useState(null),[j,P]=ie.useState(null),[k,at]=ie.useState({}),[_t,X]=ie.useState(!1),[ue,Ae]=ie.useState(!1),[He,Je]=ie.useState([]),[M,ne]=ie.useState("DAY_SHOW"),[fe,ve]=ie.useState(!1),[Ce,Ve]=ie.useState(cA()||""),[Be,Ut]=ie.useState(""),[We,is]=ie.useState(!1),[Qs,Vr]=ie.useState(0),[as,vr]=ie.useState(null),[zt,os]=ie.useState(new Set),[Ys,Di]=ie.useState(""),[wt,It]=ie.useState(null),[kn,Xs]=ie.useState("COMMAND"),[sr,dn]=ie.useState(""),[Bt,Xn]=ie.useState(null),[Jn,ir]=ie.useState(""),[Js,Lr]=ie.useState(localStorage.getItem("singmode_last_session_name")),ls=ie.useRef(null);ie.useRef(null);const K=ie.useRef(null),he=ie.useRef(null),Fe=ie.useRef(0),[Xe,Ke]=ie.useState(null),[je,Ht]=ie.useState(null),[Ur,Dt]=ie.useState(!1),[Sn,jt]=ie.useState({name:"",password:""}),[an,xn]=ie.useState(""),[br,ji]=ie.useState(!1),[Ha,ar]=ie.useState(""),[Ts,kc]=ie.useState([]),[cs,Ws]=ie.useState({isOpen:!1,message:"",onConfirm:()=>{}}),Xt=(T,ee)=>{Ws({isOpen:!0,message:T,onConfirm:ee})};ie.useEffect(()=>{const T=oA(ee=>{kc(ee)});return()=>T()},[]);const _e=ie.useCallback(async()=>{const T=++Fe.current,ee=await At();if(T!==Fe.current)return;t(ee);const U=await Lt();T===Fe.current&&a(U)},[]);ie.useEffect(()=>{if(je&&n.length>0){const T=n.find(ee=>ee.id===je.id);T&&JSON.stringify(T)!==JSON.stringify(je)&&Ht(T)}},[n,je]),ie.useEffect(()=>(_e(),window.addEventListener("kstar_sync",_e),window.addEventListener("storage",_e),()=>{window.removeEventListener("kstar_sync",_e),window.removeEventListener("storage",_e),Wo()}),[_e]),ie.useEffect(()=>{ue&&HP().then(Je).catch(console.error)},[ue]);const zr=async T=>{ve(!0);const ee=T||M;try{await tc("DJ",ee),localStorage.setItem("singmode_last_session_name",ee),Lr(ee),_e()}catch(U){alert(U.message)}finally{ve(!1)}};ie.useEffect(()=>{(!(e!=null&&e.currentRound)||e.currentRound.length===0)&&os(new Set)},[e==null?void 0:e.currentRound]);const Wo=()=>{he.current&&cancelAnimationFrame(he.current),K.current&&(K.current.getTracks().forEach(T=>T.stop()),K.current=null),ls.current&&(ls.current.close(),ls.current=null),is(!1),Vr(0)},or=async(T,ee,U)=>{const oe=`Taking the stage now, it's ${T} with "${ee}"!`;await eh(U,{aiIntro:oe}),at(ye=>({...ye,[U]:oe})),await _e()},xr=async T=>{if(R&&je)R.type==="favorite"?await IP(je.id,R.itemId,{songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type}):await kP(je.id,R.itemId,{songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type,message:T.message}),L(null);else if(I)await eh(I.id,{participantName:T.singerName||I.participantName,songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type,message:T.message}),C(null);else if(g)await SP(g.id,{songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type}),v(null);else if(d)await TP({songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type}),p(!1);else{let ee=(j==null?void 0:j.id)||"DJ-MANUAL",U=T.singerName||(j==null?void 0:j.name)||"Guest";if(!j&&T.singerName){const oe=await _h({name:T.singerName});oe.success&&oe.profile&&(ee=oe.profile.id,U=oe.profile.name,await bi(ee))}await va({participantId:ee,participantName:U,songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type,message:T.message}),c(!1),P(null)}await _e()},$t=async T=>{await bi(T.id);const ee=[...YP];for(let U=0;U<3&&ee.length!==0;U++){const oe=Math.floor(Math.random()*ee.length),ye=ee.splice(oe,1)[0],Ue=await va({participantId:T.id,participantName:T.name,songName:ye.songName,artist:ye.artist,type:ft.SINGING});Ue&&await ku(Ue.id)}await Aa(T.id,Kt.READY),await _e()},Jt=(T,ee,U)=>{const oe=U===ft.SINGING?`${T} ${ee} karaoke`:`${T} ${ee} Lyrics Letra`,ye=`https://www.youtube.com/results?search_query=${encodeURIComponent(oe)}`;window.open(ye,"_blank")},lr=async T=>{var oe;await VP(T),await _e();const U=(oe=(await At()).currentRound)==null?void 0:oe.find(ye=>ye.id===T);U&&or(U.participantName,U.songName,U.id)},Oi=T=>{T.youtubeUrl?window.open(T.youtubeUrl,"_blank"):Jt(T.songName,T.artist,T.type)},Dc=async T=>{T.preventDefault(),xn("");const ee={name:Sn.name,password:Sn.password||void 0};let U;Xe?U=await Ho(Xe.id,ee):U=await _h(ee),U.success?(Ke(null),Dt(!1),jt({name:"",password:""}),xn(""),await _e()):xn(U.error||"Action failed.")},[Zs,$a]=ie.useState(null),[Br,ei]=ie.useState(null),_r=(T,ee,U)=>{$a(ee),ei(U),T.dataTransfer.effectAllowed="move"},Wn=T=>{T.preventDefault(),T.dataTransfer.dropEffect="move"},Un=async(T,ee,U)=>{if(T.preventDefault(),!(Zs===null||Br!==U)){if(U==="ROUND"&&(e!=null&&e.currentRound)){const oe=Array.from(e.currentRound),[ye]=oe.splice(Zs,1);oe.splice(ee,0,ye),await rA(oe)}else if(U==="QUEUE"){const ye=Array.from(Ct),[Ue]=ye.splice(Zs,1);ye.splice(ee,0,Ue),await sA(ye)}else if(U==="PENDING"){const ye=Array.from(Ss),[Ue]=ye.splice(Zs,1);ye.splice(ee,0,Ue),await iA(ye)}$a(null),ei(null),await _e()}},wr=T=>{Ke(T),Dt(!0),jt({name:T.name,password:T.password||""})},Wt=T=>{Ke(T),ar(""),ji(!0),xn(""),Ht(null)},Ka=async T=>{if(T.preventDefault(),!Xe)return;const ee=await Ho(Xe.id,{password:Ha});ee.success?(Ht(Xe),Ke(null),ji(!1),ar(""),xn(""),await _e()):xn(ee.error||"Update failed.")},Pi=()=>{c(!1),C(null),L(null),P(null),E(!1),O(!1),J(!1),ce(!1),me(!1),Dt(!1),ji(!1),Ke(null),Ht(null),X(!1),p(!1),v(null),It(null),Xn(null)},Fr=()=>{py(Ce),X(!1),_e()},Gr=async()=>{await UP(),O(!1),await _e();const T=await At();T.currentRound&&T.currentRound.forEach(ee=>{ee.aiIntro||or(ee.participantName,ee.songName,ee.id)})},Qa=async()=>{await NP(),me(!1),await _e()},qr=T=>{const ee=n.find(U=>U.id===T);ee&&(Ht(ee),J(!0))};if(!e)return h.jsx("div",{className:"flex items-center justify-center p-20 min-h-screen",children:h.jsx("div",{className:"w-12 h-12 border-4 border-teal-400 border-t-transparent rounded-full animate-spin"})});const Ss=e.requests.filter(T=>T.status===Pe.PENDING&&!T.isInRound),Ya=e.requests.filter(T=>T.status===Pe.APPROVED&&T.type===ft.SINGING&&!T.isInRound),Mi=e.participants.filter(T=>Ya.some(ee=>ee.participantId===T.id)).sort((T,ee)=>(ee.joinedAt||0)-(T.joinedAt||0)),Zt={};Ya.forEach(T=>{Zt[T.participantId]||(Zt[T.participantId]=[]),Zt[T.participantId].push(T)}),Object.keys(Zt).forEach(T=>{Zt[T].sort((ee,U)=>ee.createdAt-U.createdAt)});const Ct=[];let en=0,Hr=!0;for(;Hr;)Hr=!1,Mi.forEach(T=>{Zt[T.id]&&Zt[T.id][en]&&(Ct.push(Zt[T.id][en]),Hr=!0)}),en++;const us=e.requests.filter(T=>T.status===Pe.APPROVED&&T.type===ft.LISTENING&&!T.isInRound),lt=e.participants.filter(T=>T.status===Kt.READY).length,Er=e.verifiedSongbook||[],Ot=Me.getRoomId();cp()+(Ot?`?room=${Ot}`:"");const Ns=({name:T,isActive:ee})=>{const U=T.split(" ").map(Ue=>Ue[0]).join("").toUpperCase().slice(0,2),oe=["from-teal-400 to-indigo-500","from-rose-400 to-orange-500","from-amber-400 to-rose-500","from-indigo-400 to-purple-500","from-emerald-400 to-teal-500"],ye=T.length%oe.length;return h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:`w-12 h-12 rounded-2xl bg-gradient-to-br ${oe[ye]} p-[2px] shadow-lg shadow-black/20`,children:h.jsx("div",{className:"w-full h-full bg-slate-950 rounded-[14px] flex items-center justify-center",children:h.jsx("span",{className:"text-xl font-black text-white tracking-widest",children:U})})}),ee&&h.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-[var(--neon-green)] rounded-full border-4 border-slate-950 animate-pulse"})]})},Dn=Er.filter(T=>T.songName.toLowerCase().includes(sr.toLowerCase())||T.artist.toLowerCase().includes(sr.toLowerCase())),Vi=async T=>{if(wt){const ee=await va({participantId:wt.id,participantName:wt.name,songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl||"",type:T.type});ee&&await ku(ee.id),It(null),dn(""),await _e()}},Zo=T=>{v(T)};return h.jsxs("div",{className:"max-w-[1600px] mx-auto p-4 lg:p-8 space-y-12 relative font-inter text-slate-300",children:[h.jsxs("header",{className:"relative rounded-[4rem] p-1 overflow-hidden shadow-3xl mb-12 group",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-blue)] opacity-80 group-hover:opacity-100 transition-all duration-1000 animate-gradient-x"}),h.jsxs("div",{className:"relative glass-panel rounded-[3.9rem] p-10 flex flex-col md:flex-row justify-between items-center gap-12 border border-white/20 backdrop-blur-3xl",children:[h.jsxs("div",{className:"flex items-center gap-10",children:[h.jsxs("div",{className:"relative group/logo",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-[var(--neon-yellow)] to-[var(--neon-pink)] rounded-full blur-xl opacity-60 group-hover/logo:opacity-100 transition-opacity duration-500"}),h.jsx("div",{className:"relative p-1.5 rounded-full border-4 border-white/10 shadow-2xl bg-black/40",children:h.jsx("img",{src:"IGK.jpeg",alt:"Island Groove",className:"w-32 h-32 rounded-full transition-transform duration-700 group-hover/logo:rotate-[360deg]"})})]}),h.jsxs("div",{children:[h.jsxs("h1",{className:"text-8xl font-bold font-bungee text-white flex items-center gap-6 uppercase tracking-tight neon-glow-pink leading-none",children:["Singmode v.2 ",h.jsx("span",{className:"text-[var(--neon-blue)] neon-glow-cyan text-5xl font-righteous translate-y-2",children:"beta"})]}),h.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[h.jsx("span",{className:"px-4 py-1.5 rounded-full bg-[var(--neon-pink)]/10 border border-[var(--neon-pink)]/30 text-[var(--neon-pink)] text-lg font-bold uppercase tracking-widest font-righteous",children:"DJ CONSOLE"}),h.jsx("span",{className:"text-[var(--neon-blue)]/30",children:"||"}),h.jsxs("span",{className:"text-[var(--neon-blue)] text-lg font-bold uppercase tracking-widest font-righteous neon-glow-cyan",children:["SINGERS: ",e.participants.length]})]})]})]}),h.jsx("div",{className:"flex gap-4",children:h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-base text-[var(--neon-yellow)] font-bold uppercase tracking-widest font-righteous mb-1",children:"STATUS"}),h.jsxs("div",{className:"text-4xl text-white font-bold uppercase tracking-widest font-bungee flex items-center justify-end gap-3",children:["ONLINE ",h.jsx("div",{className:"w-3 h-3 bg-[var(--neon-green)] rounded-full animate-pulse shadow-[0_0_10px_var(--neon-green)]"})]})]})})]})]}),h.jsxs("div",{className:"bg-[#0a0a10]/90 backdrop-blur-2xl rounded-[2.5rem] p-6 border border-white/5 shadow-xl relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-[var(--neon-purple)]/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/4 pointer-events-none"}),h.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-6 relative z-10",children:[h.jsxs("div",{className:"flex items-center gap-5",children:[h.jsx("span",{className:"text-4xl",children:""}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold font-bungee text-white uppercase neon-glow-purple",children:"DAY_SHOW SESSION"}),h.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[h.jsx("span",{className:`text-xs font-black uppercase tracking-widest font-righteous ${Ot?"text-[var(--neon-green)]":"text-slate-500"}`,children:Ot?" ACTIVE":" OFFLINE"}),Ot&&h.jsxs("span",{className:"text-slate-400 font-mono text-xs",children:["ROOM: ",h.jsx("span",{className:"text-white font-bold",children:Ot})]})]})]})]}),h.jsxs("div",{className:"flex gap-3",children:[!Ot&&h.jsx("button",{onClick:()=>Xs("SESSION"),className:"px-6 py-3 bg-[var(--neon-purple)] text-white rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-fuchsia-500 transition-all font-righteous shadow-[0_0_20px_rgba(180,0,255,0.3)]",children:" OPEN BROADCAST"}),h.jsx("button",{onClick:()=>Ae(!ue),className:"px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl font-black text-xs uppercase tracking-widest font-righteous text-slate-400 hover:text-white transition-all",children:ue?" HIDE HISTORY":" SESSION HISTORY"})]})]}),ue&&h.jsx("div",{className:"mt-6 pt-6 border-t border-white/5",children:He.length===0?h.jsx("p",{className:"text-slate-600 font-black uppercase tracking-widest text-xs font-righteous py-4 text-center",children:"NO PREVIOUS SESSIONS RECORDED"}):h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:He.slice().reverse().map(T=>h.jsxs("div",{className:"p-4 bg-white/5 border border-white/5 rounded-2xl hover:border-white/10 transition-all",children:[h.jsx("div",{className:"text-white font-bold font-bungee text-sm truncate",children:T.hostName||"DAY_SHOW"}),h.jsx("div",{className:"text-[var(--neon-cyan)] font-mono text-[10px] mt-1",children:new Date(T.startedAt).toLocaleString()}),T.endedAt&&h.jsxs("div",{className:"text-slate-500 text-[10px] font-righteous mt-0.5",children:["DURATION: ",Math.round((T.endedAt-T.startedAt)/6e4),"m"]})]},T.id))})})]}),h.jsx("div",{className:"sticky top-4 z-50",children:h.jsxs("div",{className:"glass-panel p-4 rounded-[2.5rem] border border-white/20 shadow-[0_20px_50px_rgba(0,0,0,0.5)] flex flex-col gap-3 backdrop-blur-3xl",children:[h.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[h.jsxs("div",{className:"flex gap-3 p-2 bg-black/40 rounded-[2rem] border border-white/5",children:[h.jsxs("button",{onClick:()=>c(!0),className:"px-8 py-4 bg-[var(--neon-pink)] text-black font-black hover:bg-white transition-all active:scale-95 rounded-[1.5rem] shadow-[0_0_25px_rgba(255,42,109,0.4)] text-lg uppercase tracking-[0.2em] font-righteous flex items-center gap-3 group",children:[h.jsx("span",{className:"text-3xl group-hover:rotate-90 transition-transform",children:""})," ADD SONG"]}),h.jsxs("button",{onClick:()=>{O(!0),_e()},className:"px-8 py-4 bg-[var(--neon-blue)] text-black font-black hover:bg-white transition-all uppercase tracking-[0.2em] text-lg active:scale-95 rounded-[1.5rem] shadow-[0_0_25px_rgba(5,217,232,0.4)] font-righteous flex items-center gap-3 group",children:[h.jsx("span",{className:"text-3xl group-hover:animate-spin",children:""})," NEXT ROUND"]})]}),h.jsx("div",{className:"w-[1px] h-12 bg-white/10 mx-2"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>E(!0),className:"w-14 h-14 flex items-center justify-center text-[var(--neon-yellow)] border border-[var(--neon-yellow)]/30 bg-[var(--neon-yellow)]/5 hover:bg-[var(--neon-yellow)] hover:text-black transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(255,200,87,0.1)] group",children:h.jsx("span",{className:"text-4xl group-hover:scale-110 transition-transform",children:""})}),h.jsx("button",{onClick:()=>J(!0),className:"w-14 h-14 flex items-center justify-center text-[var(--neon-blue)] border border-[var(--neon-blue)]/30 bg-[var(--neon-blue)]/5 hover:bg-[var(--neon-blue)] hover:text-black transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(5,217,232,0.1)] group",children:h.jsx("span",{className:"text-4xl group-hover:scale-110 transition-transform",children:""})}),h.jsx("button",{onClick:()=>me(!0),className:"w-14 h-14 flex items-center justify-center text-rose-500 border border-rose-500/30 bg-rose-500/5 hover:bg-rose-500 hover:text-white transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(244,63,94,0.1)] group",children:h.jsx("span",{className:"text-4xl group-hover:rotate-12 transition-transform",children:""})}),s&&h.jsxs("button",{onClick:s,title:"ADMIN PORTAL",className:"w-14 h-14 flex items-center justify-center text-[var(--neon-purple)] border border-[var(--neon-purple)]/30 bg-[var(--neon-purple)]/5 hover:bg-[var(--neon-purple)] hover:text-black transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(147,51,234,0.1)] group ml-4 relative",children:[h.jsx("span",{className:"text-4xl group-hover:scale-110 transition-transform",children:""}),h.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-[var(--neon-pink)] rounded-full animate-pulse border-2 border-black"})]}),h.jsxs("button",{onClick:()=>{Xt("Are you sure you want to sign out?",async()=>{await Fp(),window.location.reload()})},title:"SIGN OUT",className:"px-6 h-14 flex items-center justify-center gap-3 text-rose-500 border border-rose-500/30 bg-rose-500/5 hover:bg-rose-500 hover:text-white transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(244,63,94,0.1)] group ml-2",children:[h.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),h.jsx("polyline",{points:"16 17 21 12 16 7"}),h.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest font-righteous",children:"SIGN_OUT"})]})]})]}),h.jsx("div",{className:"flex gap-1.5 overflow-x-auto no-scrollbar border-t border-white/5 pt-3",children:["COMMAND","ROTATION","PERFORMERS","LIBRARY","SESSION"].map(T=>h.jsx("button",{onClick:()=>Xs(T),className:`px-6 py-2.5 rounded-full font-bungee text-sm tracking-widest transition-all whitespace-nowrap border-2 ${kn===T?"bg-white text-black border-white shadow-[0_0_20px_rgba(255,255,255,0.3)]":"bg-transparent text-slate-400 border-white/20 hover:border-white/40 hover:text-white"}`,children:T==="COMMAND"?"DECK":T==="ROTATION"?"ROTATION":T==="PERFORMERS"?"PERFORMERS":T==="LIBRARY"?"LIBRARY":"SESSION"},T))})]})}),h.jsxs("main",{className:"min-h-[600px] animate-in fade-in duration-500",children:[kn==="COMMAND"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 animate-in slide-in-from-bottom-2",children:[h.jsxs("div",{className:"lg:col-span-8 space-y-10",children:[e.currentRound&&h.jsxs("section",{className:"relative rounded-[3rem] p-1 overflow-hidden shadow-[0_0_100px_rgba(255,42,109,0.3)] zoom-in-95 duration-500",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-orange)] opacity-20 animate-pulse"}),h.jsxs("div",{className:"relative bg-[#150030]/90 p-10 rounded-[2.8rem] backdrop-blur-xl border-2 border-[var(--neon-green)]/50",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8",children:[h.jsxs("h2",{className:"text-4xl font-bold font-bungee text-white uppercase flex items-center gap-4 neon-glow-green",children:[h.jsx("span",{className:"text-6xl animate-pulse",children:""})," NOW PLAYING"]}),h.jsx("button",{onClick:async()=>{await zP(),await _e()},className:"px-8 py-3 bg-[var(--neon-pink)] text-black text-base font-bold uppercase hover:bg-white transition-all rounded-[1rem] tracking-widest font-righteous shadow-[0_0_20px_var(--neon-pink)] active:scale-95",children:"END ROUND"})]}),h.jsx("div",{className:"flex flex-col gap-3",children:(e.currentRound||[]).map((T,ee)=>{const U=e.participants.find(Rt=>Rt.id===T.participantId),oe=(U==null?void 0:U.status)===Kt.READY,ye=e.currentRound.findIndex(Rt=>Rt.status!==Pe.DONE),Ue=ee===(ye===-1?0:ye);return h.jsxs("div",{className:`p-3 pl-6 pr-4 rounded-xl border-l-8 transition-all duration-300 flex items-center justify-between gap-4 w-full shadow-lg relative overflow-hidden group ${Ue?"bg-[#001005] border-l-[var(--neon-green)] border-y border-r border-[#1a3320] z-10 scale-[1.01]":"bg-[#0a0a10] border-l-slate-700 border-y border-r border-white/10 opacity-70 hover:opacity-100"}`,children:[h.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_49%,rgba(255,255,255,0.03)_50%,transparent_51%)] bg-[length:50px_100%] pointer-events-none"}),h.jsxs("div",{className:"flex items-center gap-6 min-w-0 flex-1 z-10",children:[h.jsxs("div",{className:"relative",children:[Ue&&h.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 px-2 py-0.5 bg-[var(--neon-green)] text-black text-[8px] font-black uppercase tracking-[0.2em] rounded animate-pulse shadow-[0_0_10px_var(--neon-green)] z-20",children:"LIVE"}),h.jsx("button",{onClick:()=>{const Rt=T.type===ft.SINGING?" Karaoke":" Lyric",Tr=`${T.songName} ${T.artist}${Rt}`;navigator.clipboard.writeText(Tr)},title:"Copy Command String",className:`w-16 h-16 flex flex-col justify-center items-center border-2 rounded-2xl transition-all shrink-0 active:scale-95 ${Ue?"border-[var(--neon-green)] bg-[var(--neon-green)]/10 text-[var(--neon-green)] shadow-[0_0_15px_rgba(0,255,157,0.2)]":"border-white/10 text-slate-400 hover:border-white/30 hover:bg-white/5"}`,children:h.jsx("span",{className:"text-2xl font-bold font-mono tracking-tighter",children:T.requestNumber})})]}),h.jsxs("div",{className:"flex items-baseline gap-6 min-w-0 flex-1",children:[h.jsx("h3",{className:`text-2xl font-black uppercase font-righteous tracking-tight leading-tight ${Ue?"text-white":"text-slate-300"}`,children:T.songName}),h.jsxs("div",{className:"flex items-center gap-3 opacity-80 shrink-0",children:[h.jsx("span",{className:"text-xl font-bold font-righteous text-[var(--neon-cyan)] uppercase tracking-wider",children:T.artist}),h.jsx("span",{className:"text-slate-600 font-mono text-lg",children:"/"}),h.jsxs("button",{onClick:()=>qr(T.participantId),className:"flex items-center gap-2 group/singer hover:underline",children:[h.jsx("div",{className:`w-2 h-2 rounded-full ${oe?"bg-[var(--neon-green)] shadow-[0_0_5px_var(--neon-green)]":"bg-slate-700"}`}),h.jsxs("span",{className:"text-xl font-bold font-righteous text-[var(--neon-pink)] uppercase tracking-wider",children:["@",T.participantName]})]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-3 z-10 pl-4 border-l border-white/10 bg-gradient-to-l from-black/80 to-transparent",children:[h.jsx("button",{onClick:async()=>{T.status===Pe.DONE?await eh(T.id,{status:Pe.APPROVED}):await VE(T.id),await _e()},title:T.status===Pe.DONE?"Undo Done":"Mark as Done",className:`p-2 rounded-xl transition-all border-2 ${T.status===Pe.DONE?"text-yellow-500 border-yellow-500/30 bg-yellow-500/10 shadow-[0_0_15px_rgba(234,179,8,0.2)]":"text-slate-600 border-white/5 hover:border-white/20 hover:text-white"}`,children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})})}),h.jsx("button",{onClick:()=>{Xt("Remove from active round?",async()=>{await ba(T.id),await _e()})},className:"w-8 h-8 flex items-center justify-center rounded bg-rose-500/10 hover:bg-rose-500 text-rose-500 hover:text-white transition-all border border-rose-500/20",title:"REMOVE",children:""})]})]},T.id)})})]})]}),h.jsxs("section",{className:"bg-[#10002B]/80 border-2 border-[var(--neon-blue)]/30 rounded-[3rem] p-10 shadow-[0_0_60px_rgba(5,217,232,0.1)] relative overflow-hidden backdrop-blur-md",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 px-2",children:[h.jsxs("h2",{className:"text-4xl font-bold font-bungee text-white uppercase flex items-center gap-4 neon-glow-cyan",children:[h.jsx("span",{className:"text-[var(--neon-blue)]",children:""})," REQUESTS"]}),h.jsxs("span",{className:"px-6 py-2 bg-[var(--neon-blue)]/10 border border-[var(--neon-blue)]/30 rounded-full text-base text-[var(--neon-blue)] font-bold tracking-widest font-righteous",children:[Ss.length," PENDING"]})]}),h.jsxs("div",{className:"flex flex-col gap-4",children:[Ss.map((T,ee)=>h.jsxs("div",{draggable:!0,onDragStart:U=>_r(U,ee,"PENDING"),onDragOver:Wn,onDrop:U=>Un(U,ee,"PENDING"),className:"bg-black/40 border border-white/5 p-4 rounded-3xl flex items-center gap-6 hover:border-[var(--neon-blue)] transition-all group cursor-move shadow-xl",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-1",children:[h.jsx("div",{className:"text-xs font-black font-righteous text-[var(--neon-pink)] uppercase tracking-[0.2em] bg-[var(--neon-pink)]/10 px-2 py-0.5 rounded-full border border-[var(--neon-pink)]/20 shrink-0",children:"NEW_SIGNAL"}),h.jsx("div",{className:"text-3xl font-black text-white uppercase truncate tracking-tighter font-bungee group-hover:text-[var(--neon-blue)] transition-colors",children:T.songName}),h.jsxs("div",{className:"text-slate-500 text-base font-black uppercase tracking-[0.2em] font-righteous truncate",children:["/ ",T.artist]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>qr(T.participantId),className:"text-base font-bold text-[var(--neon-pink)] uppercase truncate hover:text-white transition-colors font-righteous tracking-[0.2em]",children:["@",T.participantName]}),T.message&&h.jsx("div",{className:"flex-1 max-w-md px-3 py-1 bg-black/40 border-l-2 border-[var(--neon-pink)] rounded-r-lg",children:h.jsxs("p",{className:"text-base text-white/60 font-medium italic truncate",children:['"',T.message,'"']})})]})]}),h.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[h.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx(Du,{request:T}),h.jsx(ju,{request:T}),h.jsx(ya,{url:T.youtubeUrl}),h.jsx("button",{onClick:()=>C(T),className:"p-3 bg-white/5 hover:bg-white/10 rounded-xl text-sm font-black uppercase tracking-widest transition-all font-righteous text-white/50 hover:text-white border border-white/5",children:"EDIT"})]}),h.jsxs("div",{className:"flex gap-2 bg-black/40 p-1 rounded-2xl border border-white/5",children:[h.jsx("button",{onClick:async()=>{await ku(T.id),await _e()},className:"px-6 py-3 bg-[var(--neon-blue)] text-black text-sm font-black uppercase hover:bg-white transition-all rounded-xl tracking-[0.1em] shadow-[0_0_20px_rgba(5,217,232,0.3)]",children:"ACCEPT"}),h.jsx("button",{onClick:()=>{Xt("Delete pending request?",async()=>{await ba(T.id),await _e()})},className:"w-11 h-11 flex items-center justify-center text-rose-500 hover:bg-rose-500/10 rounded-xl transition-all",children:""})]})]})]},T.id)),Ss.length===0&&h.jsx("div",{className:"col-span-full py-24 text-center border-4 border-dashed border-white/5 rounded-[2.5rem] opacity-30",children:h.jsx("p",{className:"text-4xl font-black font-righteous uppercase tracking-[0.4em] italic text-slate-500",children:"NO SIGNAL DETECTED"})})]})]}),h.jsxs("div",{className:"flex flex-col gap-10",children:[h.jsxs("section",{className:"bg-[#10002B]/60 border-2 border-[var(--neon-yellow)]/20 rounded-[3rem] p-10 shadow-2xl relative overflow-hidden backdrop-blur-sm",children:[h.jsxs("h3",{className:"text-5xl font-bold font-bungee text-white uppercase mb-8 px-2 neon-glow-yellow flex items-center gap-4",children:[h.jsx("span",{className:"text-[var(--neon-yellow)] animate-pulse",children:""})," QUEUE"]}),h.jsxs("div",{className:"flex flex-col gap-3",children:[Ct.map((T,ee)=>h.jsxs("div",{draggable:!0,onDragStart:U=>_r(U,ee,"QUEUE"),onDragOver:Wn,onDrop:U=>Un(U,ee,"QUEUE"),className:"bg-black/40 border border-white/5 p-4 rounded-[2rem] flex items-center gap-6 group hover:border-[var(--neon-yellow)] transition-all cursor-move shadow-lg relative",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-black/40 rounded-2xl border border-white/5 text-[var(--neon-yellow)] font-bungee text-3xl shrink-0 group-hover:scale-110 transition-transform",children:ee+1}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-0.5",children:[h.jsx("div",{className:"text-2xl font-bold text-white truncate uppercase tracking-tight font-bungee group-hover:text-[var(--neon-yellow)] transition-colors",children:T.songName}),h.jsxs("div",{className:"text-sm text-slate-500 uppercase tracking-widest font-righteous",children:["/ ",T.artist]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:U=>{U.stopPropagation(),qr(T.participantId)},className:"text-sm font-black text-[var(--neon-yellow)] uppercase tracking-[0.2em] font-righteous hover:text-white transition-colors",children:["@",T.participantName]}),T.message&&h.jsxs("div",{className:"flex-1 max-w-sm px-2 py-0.5 bg-[var(--neon-yellow)]/5 border-l border-[var(--neon-yellow)]/30 rounded-r text-xs text-[var(--neon-yellow)]/70 italic truncate",children:['"',T.message,'"']})]})]}),h.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[h.jsxs("div",{className:"flex flex-col gap-0.5 px-2",children:[h.jsx("button",{onClick:async()=>{await LE(T.id,"up"),await _e()},className:"text-slate-700 hover:text-white transition-colors p-1 text-base",children:""}),h.jsx("button",{onClick:async()=>{await LE(T.id,"down"),await _e()},className:"text-slate-700 hover:text-white transition-colors p-1 text-base",children:""})]}),h.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx(Du,{request:T}),h.jsx(ju,{request:T}),h.jsx(ya,{url:T.youtubeUrl}),h.jsx("button",{onClick:()=>C(T),className:"p-2 text-slate-600 hover:text-white text-xs font-black uppercase tracking-widest font-righteous transition-colors border border-white/5 rounded-lg",children:"EDIT"})]}),h.jsxs("div",{className:"flex gap-2 bg-black/40 p-1 rounded-xl border border-white/5",children:[h.jsx("button",{onClick:()=>lr(T.id),className:"px-4 py-2 bg-[var(--neon-yellow)] text-black text-sm font-black uppercase rounded-lg hover:bg-white transition-all shadow-[0_0_15px_rgba(255,200,87,0.3)] tracking-wider",children:"STAGE"}),h.jsx("button",{onClick:()=>{Xt("Remove from queue?",async()=>{await ba(T.id),await _e()})},className:"w-9 h-9 flex items-center justify-center text-rose-500/20 hover:text-rose-500 hover:bg-rose-500/10 rounded-lg transition-all",children:""})]})]})]},T.id)),Ct.length===0&&h.jsx("div",{className:"flex-1 py-12 flex items-center justify-center border-2 border-dashed border-white/5 rounded-[2rem] opacity-30 w-full",children:h.jsx("p",{className:"text-xl font-black font-righteous uppercase tracking-[0.3em] text-slate-500",children:"QUEUE EMPTY"})})]})]}),h.jsxs("section",{className:"bg-[#10002B]/60 border-2 border-[var(--neon-blue)]/20 rounded-[3rem] p-10 shadow-2xl relative overflow-hidden backdrop-blur-sm",children:[h.jsxs("h3",{className:"text-3xl font-bold font-bungee text-white uppercase mb-8 px-2 neon-glow-blue flex items-center gap-4",children:[h.jsx("span",{className:"text-[var(--neon-blue)] animate-pulse",children:""})," TO HEAR (",us.length,")"]}),h.jsxs("div",{className:"flex flex-col gap-3",children:[us.map((T,ee)=>h.jsxs("div",{className:"bg-black/40 border border-white/5 p-4 rounded-[2rem] flex items-center gap-6 group hover:border-[var(--neon-blue)] transition-all relative",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-black/40 rounded-2xl border border-white/5 text-[var(--neon-blue)] font-bungee text-xl shrink-0",children:ee+1}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-0.5",children:[h.jsx("div",{className:"text-xl font-bold text-white truncate uppercase tracking-tight font-bungee group-hover:text-[var(--neon-blue)] transition-colors",children:T.songName}),h.jsxs("div",{className:"text-sm text-slate-500 uppercase tracking-widest font-righteous",children:["/ ",T.artist]})]}),h.jsxs("div",{className:"text-xs font-black text-[var(--neon-pink)] uppercase tracking-[0.2em] font-righteous",children:["@",T.participantName]})]}),h.jsx("div",{className:"flex gap-2 bg-black/40 p-1 rounded-xl border border-white/5 opacity-0 group-hover:opacity-100 transition-opacity",children:h.jsx("button",{onClick:async()=>{await ba(T.id),await _e()},className:"px-4 py-2 text-rose-500 hover:bg-rose-500 hover:text-white rounded-lg transition-all font-black text-xs uppercase tracking-widest font-righteous",children:"REMOVE"})})]},T.id)),us.length===0&&h.jsx("div",{className:"flex-1 py-8 flex items-center justify-center border-2 border-dashed border-white/5 rounded-[2rem] opacity-30 w-full",children:h.jsx("p",{className:"text-base font-black font-righteous uppercase tracking-[0.3em] text-slate-500",children:"NO LISTENING TRACKS"})})]})]}),h.jsxs("section",{className:"bg-[#10002B]/60 border-2 border-[var(--neon-green)]/20 rounded-[3rem] p-10 shadow-2xl relative overflow-hidden backdrop-blur-sm",children:[h.jsxs("h3",{className:"text-3xl md:text-4xl font-bold font-bungee text-white uppercase mb-8 px-2 neon-glow-green flex items-center gap-4 flex-wrap",children:[h.jsx("span",{className:"text-[var(--neon-green)] animate-pulse",children:""})," ATMOSPHERE"]}),h.jsxs("div",{className:"space-y-10",children:[h.jsxs("div",{className:"p-6 bg-black/40 rounded-3xl border border-white/5 space-y-6",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[h.jsx("label",{className:"text-sm md:text-base font-black text-[var(--neon-cyan)] uppercase tracking-[0.2em] font-righteous opacity-80 break-words",children:"REQUEST LIMIT"}),h.jsx("span",{className:"text-4xl font-black text-white font-bungee neon-glow-cyan",children:e.maxRequestsPerUser||5})]}),h.jsx("input",{type:"range",min:"1",max:"20",value:e.maxRequestsPerUser||5,onChange:async T=>{await PP(parseInt(T.target.value)),await _e()},className:"w-full accent-[var(--neon-cyan)] bg-white/5 rounded-lg appearance-none h-2 cursor-pointer transition-all"}),h.jsxs("div",{className:"flex justify-between text-xs font-black text-slate-600 font-righteous uppercase tracking-widest",children:[h.jsx("span",{children:"STRICT (1)"}),h.jsx("span",{children:"UNLIMITED (20)"})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-base font-black text-[var(--neon-pink)] uppercase tracking-[0.4em] mb-4 flex items-center gap-4 font-righteous opacity-80",children:"BACKGROUND THREADS"}),h.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar custom-scrollbar-h",children:[[...us].reverse().map(T=>h.jsxs("div",{className:"bg-black/60 p-5 rounded-[2rem] border border-white/10 flex flex-col justify-between group hover:border-[var(--neon-pink)] transition-all shadow-lg min-w-[280px] max-w-[280px]",children:[h.jsxs("div",{className:"min-w-0 mb-4 cursor-pointer",onClick:()=>Jt(T.songName,T.artist,T.type),children:[h.jsx("div",{className:"text-2xl font-black text-white truncate uppercase tracking-tight font-bungee group-hover:text-[var(--neon-pink)] transition-all",children:T.songName}),h.jsx("div",{className:"text-base text-slate-500 uppercase tracking-widest mt-1 font-righteous opacity-60 truncate",children:T.artist})]}),h.jsxs("div",{className:"flex items-center justify-between border-t border-white/5 pt-4",children:[h.jsx(ya,{url:T.youtubeUrl}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>lr(T.id),className:"px-4 py-2 bg-[var(--neon-purple)] text-white text-sm font-black uppercase rounded-lg hover:bg-white hover:text-black transition-all shadow-[0_0_10px_var(--neon-purple)] tracking-[0.1em]",children:"BOOST"}),h.jsx("button",{onClick:()=>{Xt("Remove from atmosphere?",async()=>{await ba(T.id),await _e()})},className:"text-rose-500/20 hover:text-rose-500 p-2 font-black",children:""})]})]})]},T.id)),us.length===0&&h.jsx("p",{className:"text-base text-slate-700 italic px-4 font-righteous uppercase tracking-widest opacity-50",children:"NO BACKGROUND TRACKS"})]})]}),h.jsxs("div",{className:"pt-6 border-t border-white/5",children:[h.jsxs("h4",{className:"text-base font-black text-[var(--neon-cyan)] uppercase tracking-[0.4em] mb-6 flex justify-between items-center font-righteous opacity-80",children:[h.jsx("span",{children:"VERIFIED_LINKS"}),h.jsx("button",{onClick:()=>p(!0),className:"text-[var(--neon-cyan)] hover:text-white transition-colors underline decoration-dotted",children:"+ ADD NEW"})]}),h.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar custom-scrollbar-h",children:[[...Er].reverse().map(T=>h.jsxs("div",{className:"bg-black/80 p-5 rounded-[2rem] border border-white/5 flex flex-col justify-between group hover:border-[var(--neon-cyan)] transition-all shadow-lg min-w-[280px] max-w-[280px]",children:[h.jsxs("div",{className:"min-w-0 mb-4",children:[h.jsx("div",{className:"text-2xl font-bold text-white uppercase truncate tracking-tight group-hover:text-[var(--neon-cyan)] transition-colors font-bungee mb-1",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-600 uppercase truncate tracking-widest font-righteous font-bold",children:T.artist})]}),h.jsxs("div",{className:"flex items-center justify-between border-t border-white/5 pt-4",children:[h.jsxs("div",{className:"flex gap-1",children:[h.jsx(XP,{url:T.youtubeUrl}),h.jsx("button",{onClick:()=>v(T),className:"text-slate-600 hover:text-white p-2",children:""})]}),h.jsxs("div",{className:"flex gap-2 shrink-0",children:[h.jsx("button",{onClick:()=>Jt(T.songName,T.artist,T.type),className:"px-3 py-1 bg-black border border-[var(--neon-cyan)] text-[var(--neon-cyan)] text-sm font-black uppercase rounded-md hover:bg-[var(--neon-cyan)] hover:text-black transition-all tracking-widest",children:"RUN"}),h.jsx("button",{onClick:()=>{c(!0)},className:"px-3 py-1 bg-[var(--neon-pink)] text-black text-sm font-black uppercase rounded-md hover:bg-white transition-all shadow-lg tracking-widest",children:"PUSH"}),h.jsx("button",{onClick:()=>{Xt("Delete verified song?",async()=>{await OE(T.id),await _e()})},className:"text-rose-500/20 hover:text-rose-500 px-1 font-black",children:""})]})]})]},T.id)),Er.length===0&&h.jsx("p",{className:"text-xl text-slate-800 italic px-4 font-righteous uppercase tracking-widest opacity-30",children:"NO VERIFIED SONGS"})]})]})]})]})]})]}),h.jsxs("div",{className:"lg:col-span-4 space-y-8",children:[h.jsxs("section",{className:"bg-[#0a0a0a] border-4 border-white/5 rounded-[3rem] p-8 shadow-[0_0_40px_rgba(0,0,0,0.5)] relative overflow-hidden flex flex-col h-[600px]",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6 px-2",children:[h.jsx("h2",{className:"text-4xl font-bold font-bungee text-white uppercase tracking-tight opacity-90",children:"PERFORMERS"}),h.jsxs("div",{className:"flex items-center gap-2 bg-white/5 px-3 py-1 rounded-full border border-white/5",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--neon-cyan)] animate-pulse"}),h.jsxs("span",{className:"text-sm text-[var(--neon-cyan)] font-bold uppercase tracking-widest",children:[lt," ONLINE"]})]})]}),h.jsxs("div",{className:"space-y-3 overflow-y-auto custom-scrollbar pr-2 flex-1",children:[e.participants.map(T=>{const ee=T.status===Kt.READY,oe=e.requests.filter(ye=>ye.participantId===T.id).filter(ye=>ye.status===Pe.APPROVED&&ye.type===ft.SINGING).length;return h.jsxs("div",{className:`flex items-center justify-between p-4 rounded-[1.5rem] transition-all border ${ee?"bg-[#002a1a]/30 border-[var(--neon-green)] shadow-[0_0_15px_rgba(0,255,157,0.2)]":"bg-black/40 border-white/5 hover:bg-white/5"}`,children:[h.jsxs("div",{className:"min-w-0 flex items-center gap-4",children:[h.jsx("button",{onClick:async()=>{await Aa(T.id,ee?Kt.STANDBY:Kt.READY),await _e()},className:`w-3 h-3 rounded-full shrink-0 transition-all ${ee?"bg-[var(--neon-green)] shadow-[0_0_10px_var(--neon-green)]":"bg-slate-800"}`}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("button",{onClick:()=>qr(T.id),className:`text-xl font-black uppercase truncate text-left transition-colors font-righteous ${ee?"text-white":"text-slate-500 hover:text-[var(--neon-green)]"}`,children:T.name}),oe>0&&h.jsxs("span",{className:"block text-xs text-[var(--neon-cyan)] font-black mt-0.5 tracking-[0.2em]",children:[oe," REQUESTS"]})]})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:()=>P(T),className:"p-2 hover:text-[var(--neon-cyan)] transition-colors text-slate-600",children:"+"}),h.jsx("button",{onClick:()=>{Xt(`Remove ${T.name}?`,async()=>{await dy(T.id),await _e()})},className:"p-2 text-rose-500/20 hover:text-rose-500 transition-colors",children:""})]})]},T.id)}),e.participants.length===0&&h.jsx("div",{className:"text-center py-20 opacity-20",children:h.jsx("p",{className:"text-lg font-righteous uppercase tracking-widest",children:"NO DATA"})})]})]}),h.jsxs("section",{className:"bg-[#0a0a0a] border-4 border-white/5 rounded-[3rem] p-8 shadow-[0_0_40px_rgba(0,0,0,0.5)] relative overflow-hidden flex flex-col h-[400px]",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6 px-2",children:[h.jsx("h2",{className:"text-4xl font-bold font-bungee text-white uppercase tracking-tight opacity-90",children:"LOG"}),e.history.length>0&&h.jsx("button",{onClick:async()=>{await UE(),await _e()},className:"text-sm font-bold text-rose-500/40 hover:text-rose-500 uppercase tracking-widest transition-all",children:"CLEAR"})]}),h.jsxs("div",{className:"space-y-3 overflow-y-auto custom-scrollbar pr-2 flex-1",children:[e.history.map((T,ee)=>h.jsxs("div",{className:"bg-black/40 p-4 rounded-2xl border border-white/5 flex flex-col group hover:border-[var(--neon-purple)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsxs("div",{className:"min-w-0 pr-2",children:[h.jsx("div",{className:"text-xl font-bold text-white uppercase truncate tracking-tight group-hover:text-[var(--neon-purple)] transition-colors font-bungee",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-600 uppercase truncate tracking-widest font-righteous",children:T.artist})]}),h.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-all",children:[h.jsx(Du,{request:T}),h.jsx(ju,{request:T}),h.jsx(ya,{url:T.youtubeUrl})]})]}),h.jsxs("div",{className:"flex items-center justify-between mt-2 border-t border-white/5 pt-2",children:[h.jsxs("span",{className:"text-base font-black text-[var(--neon-pink)] uppercase truncate",children:["@",T.participantName]}),h.jsx("button",{onClick:async()=>{await b0(T),await _e()},className:"opacity-0 group-hover:opacity-100 text-xs font-black text-[var(--neon-pink)] hover:underline transition-all uppercase tracking-widest",children:"RE-QUEUE"})]})]},ee)),e.history.length===0&&h.jsx("div",{className:"text-center py-16 opacity-20",children:h.jsx("p",{className:"text-lg italic font-righteous uppercase tracking-widest text-slate-800",children:"EMPTY"})})]})]})]})]}),kn==="ROTATION"&&h.jsxs("div",{className:"space-y-16 animate-in slide-in-from-bottom-2 pb-32",children:[e.currentRound&&e.currentRound.length>0&&h.jsxs("section",{className:"glass-panel border-4 rounded-[4rem] p-12 shadow-[0_0_100px_rgba(0,255,157,0.3)] relative overflow-hidden neon-sign-border-green",children:[h.jsxs("div",{className:"flex items-center gap-8 mb-12",children:[h.jsx("div",{className:"w-8 h-8 bg-[var(--neon-green)] rounded-full animate-ping shadow-[0_0_25px_var(--neon-green)]"}),h.jsx("h3",{className:"text-6xl font-black text-white uppercase tracking-tighter font-righteous neon-glow-green",children:"NOW PLAYING"})]}),h.jsx("div",{className:"flex flex-col gap-4",children:e.currentRound.map((T,ee)=>{const U=e.currentRound.findIndex(ye=>ye.status!==Pe.DONE),oe=ee===(U===-1?0:U);return h.jsxs("div",{className:`p-3 pl-6 pr-4 rounded-xl border-l-8 transition-all duration-300 flex items-center justify-between gap-4 w-full shadow-lg relative overflow-hidden group ${oe?"bg-[#001005] border-l-[var(--neon-green)] border-y border-r border-[#1a3320] z-10 scale-[1.01]":"bg-[#0a0a10] border-l-slate-700 border-y border-r border-white/10 opacity-70 hover:opacity-100"}`,children:[h.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_49%,rgba(255,255,255,0.03)_50%,transparent_51%)] bg-[length:50px_100%] pointer-events-none"}),h.jsxs("div",{className:"flex items-center gap-6 min-w-0 flex-1 z-10",children:[h.jsx("div",{className:"w-16 h-full flex flex-col justify-center items-center border-r border-white/10 pr-4 shrink-0",children:h.jsx("span",{className:`text-xl font-bold font-mono tracking-tighter ${oe?"text-[var(--neon-green)]":"text-slate-400"}`,children:T.requestNumber})}),h.jsxs("div",{className:"flex items-baseline gap-6 min-w-0 flex-1",children:[h.jsx("h3",{className:`text-3xl font-black uppercase truncate font-righteous tracking-tight ${oe?"text-white":"text-slate-300"}`,children:T.songName}),h.jsxs("div",{className:"flex items-center gap-3 opacity-80 shrink-0",children:[h.jsx("span",{className:"text-xl font-bold font-righteous text-[var(--neon-cyan)] uppercase tracking-wider",children:T.artist}),h.jsx("span",{className:"text-slate-600 font-mono text-lg",children:"/"}),h.jsxs("span",{className:"text-xl font-bold font-righteous text-[var(--neon-pink)] uppercase tracking-wider",children:["@",T.participantName]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-3 z-10 pl-6 border-l border-white/10 bg-gradient-to-l from-black/80 to-transparent",children:[oe&&h.jsx("div",{className:"px-3 py-1 bg-[var(--neon-green)] text-black text-[10px] font-black uppercase tracking-[0.2em] rounded animate-pulse shadow-[0_0_10px_var(--neon-green)] mr-2 shrink-0",children:"LIVE"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(Du,{request:T}),h.jsx(ju,{request:T}),h.jsx(ya,{url:T.youtubeUrl}),h.jsx("button",{onClick:()=>C(T),className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white/5 hover:bg-white hover:text-black border border-white/10 transition-all text-slate-400 group",title:"EDIT",children:h.jsx("span",{className:"text-sm font-black font-righteous",children:"EDIT"})}),h.jsx("button",{onClick:()=>Oi(T),className:"w-10 h-10 flex items-center justify-center rounded-lg bg-black border border-white/20 hover:bg-white hover:text-black hover:border-white transition-all group",title:"RESET TRACK",children:h.jsx("span",{className:"text-lg",children:""})}),h.jsxs("button",{disabled:T.status===Pe.DONE,onClick:async()=>{await VE(T.id),await _e()},className:`h-10 px-6 rounded-lg text-sm font-black uppercase tracking-widest font-righteous transition-all flex items-center gap-2 ${T.status===Pe.DONE?"bg-white/10 text-white/40 cursor-not-allowed border border-white/5":"bg-[var(--neon-cyan)]/10 hover:bg-[var(--neon-cyan)] text-[var(--neon-cyan)] hover:text-black border border-[var(--neon-cyan)]/50"}`,children:[h.jsx("span",{children:T.status===Pe.DONE?"COMPLETED":"DONE"}),T.status!==Pe.DONE&&h.jsx("span",{className:"text-lg leading-none",children:""})]})]})]})]},T.id)})})]}),h.jsxs("section",{className:"bg-[#050510] border-4 border-[var(--neon-cyan)]/30 rounded-[3rem] p-10 shadow-[0_0_80px_rgba(0,229,255,0.15)] relative overflow-hidden backdrop-blur-md",children:[h.jsxs("div",{className:"flex items-center gap-6 mb-10",children:[h.jsx("div",{className:"w-4 h-4 bg-[var(--neon-cyan)] shadow-[0_0_20px_var(--neon-cyan)] rounded-full animate-pulse"}),h.jsx("h3",{className:"text-4xl font-bold text-white uppercase tracking-tight font-bungee neon-glow-cyan",children:"UPCOMING"})]}),h.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-2 gap-6",children:[Ct.map(T=>h.jsxs("div",{className:"relative group perspective-1000",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--neon-purple)] to-[var(--neon-blue)] rounded-[2.5rem] blur-xl opacity-20 group-hover:opacity-40 transition-opacity"}),h.jsxs("div",{className:"relative bg-[#101015] p-8 rounded-[2.5rem] border border-white/10 flex justify-between items-center group-hover:border-[var(--neon-cyan)] transition-all shadow-2xl h-full",children:[h.jsxs("div",{className:"min-w-0 pr-6 flex-1",children:[h.jsx("div",{className:"text-white font-black uppercase truncate text-4xl font-bungee tracking-tight mb-2 group-hover:text-[var(--neon-cyan)] transition-colors",children:T.songName}),h.jsxs("div",{className:"text-lg text-slate-500 uppercase flex items-center gap-3 font-righteous tracking-[0.2em] opacity-80",children:[h.jsxs("span",{className:"text-[var(--neon-green)] font-black",children:["@",T.participantName]}),h.jsx("span",{className:"opacity-20",children:"|"}),h.jsx("span",{className:"truncate",children:T.artist})]})]}),h.jsxs("div",{className:"flex gap-3 shrink-0 flex-col",children:[h.jsx("button",{onClick:()=>lr(T.id),className:"px-6 py-3 bg-[var(--neon-green)] text-black text-base font-black rounded-xl uppercase tracking-[0.2em] font-righteous shadow-[0_0_20px_var(--neon-green)] transition-all hover:bg-white hover:scale-105",children:"STAGE"}),h.jsx("button",{onClick:async()=>{await ba(T.id),await _e()},className:"px-6 py-3 border border-white/10 text-white/40 hover:text-rose-500 hover:border-rose-500/50 rounded-xl transition-all text-lg font-black uppercase tracking-[0.2em]",children:"REMOVE"})]})]})]},T.id)),Ct.length===0&&h.jsx("div",{className:"col-span-full py-32 text-center border-4 border-dashed border-white/5 rounded-[4rem] opacity-30",children:h.jsx("p",{className:"text-5xl font-black uppercase tracking-[0.5em] italic font-righteous text-slate-700",children:"NO DATA STREAM"})})]})]})]}),kn==="PERFORMERS"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 animate-in slide-in-from-bottom-2 pb-32",children:[h.jsxs("section",{className:"lg:col-span-8 bg-[#0a0a0a] border-4 border-[var(--neon-cyan)]/20 rounded-[3rem] p-10 shadow-[0_0_60px_rgba(0,229,255,0.1)] relative overflow-hidden backdrop-blur-md",children:[h.jsxs("div",{className:"flex justify-between items-center mb-10 px-2",children:[h.jsx("h2",{className:"text-4xl font-bold text-white uppercase tracking-tight font-bungee neon-glow-cyan",children:"SINGERS"}),h.jsxs("div",{className:"flex items-center gap-4 px-6 py-2 bg-black/40 border border-[var(--neon-cyan)]/30 rounded-full shadow-lg",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--neon-cyan)] animate-pulse"}),h.jsxs("span",{className:"text-lg font-bold text-[var(--neon-cyan)] uppercase tracking-widest font-righteous",children:[lt," ACTIVE"]})]})]}),h.jsxs("div",{className:"grid gap-6",children:[e.participants.map(T=>{const ee=T.status===Kt.READY,oe=e.requests.filter(ye=>ye.participantId===T.id).filter(ye=>ye.status===Pe.APPROVED&&ye.type===ft.SINGING).length;return h.jsxs("div",{className:`flex items-center justify-between p-6 rounded-[2rem] transition-all border-2 ${ee?"bg-[#002a1a]/30 border-[var(--neon-green)] shadow-[0_0_30px_rgba(0,255,157,0.15)]":"bg-black/40 border-white/5 hover:border-white/20"}`,children:[h.jsxs("div",{className:"min-w-0 flex items-center gap-6 text-left",children:[h.jsx("button",{onClick:async()=>{await Aa(T.id,ee?Kt.STANDBY:Kt.READY),await _e()},className:`w-12 h-12 rounded-full shrink-0 border-2 transition-all flex items-center justify-center ${ee?"bg-[var(--neon-green)] border-[var(--neon-green)] shadow-[0_0_20px_var(--neon-green)]":"bg-slate-900 border-white/10 hover:border-white/50"}`,children:ee&&h.jsx("div",{className:"w-4 h-4 bg-white rounded-full animate-pulse"})}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("button",{onClick:()=>qr(T.id),className:`font-bold text-4xl uppercase truncate font-bungee tracking-tight transition-colors ${ee?"text-white":"text-slate-600 hover:text-[var(--neon-green)]"}`,children:T.name}),oe>0&&h.jsxs("div",{className:"text-base font-bold text-[var(--neon-cyan)] uppercase mt-1 tracking-widest font-righteous opacity-90",children:[oe," TRACKS READY"]})]})]}),h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("button",{onClick:()=>P(T),className:"px-6 py-3 bg-[var(--neon-cyan)]/10 text-[var(--neon-cyan)] rounded-xl border border-[var(--neon-cyan)]/50 transition-all font-righteous text-base font-black uppercase tracking-[0.2em] hover:bg-[var(--neon-cyan)] hover:text-black hover:shadow-[0_0_20px_var(--neon-cyan)]",children:"ADD TRACK"}),h.jsx("button",{onClick:()=>{Xt(`Remove ${T.name}?`,async()=>{await dy(T.id),await _e()})},className:"text-rose-500/30 hover:text-rose-500 p-3 transition-colors text-3xl font-black",children:""})]})]},T.id)}),e.participants.length===0&&h.jsx("div",{className:"py-32 text-center border-4 border-dashed border-white/5 rounded-[3rem] opacity-30",children:h.jsx("p",{className:"text-5xl font-black uppercase tracking-[0.6em] italic font-righteous text-slate-800",children:"NO SIGNALS"})})]})]}),h.jsxs("section",{className:"lg:col-span-4 lg:sticky lg:top-36 h-fit bg-[#050510] border-4 border border-white/5 rounded-[3.5rem] p-8 shadow-[0_0_60px_rgba(157,0,255,0.15)] relative overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-10 px-2",children:[h.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter font-bungee neon-glow-purple",children:"SESSION LOG"}),e.history.length>0&&h.jsx("button",{onClick:async()=>{await UE(),await _e()},className:"text-sm font-black text-rose-500/40 hover:text-rose-500 uppercase tracking-[0.3em] font-righteous transition-all",children:"CLEAR ALL"})]}),h.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:[e.history.filter(T=>(T.playedAt||0)>=(e.startedAt||0)).map((T,ee)=>h.jsxs("div",{className:"bg-black/40 p-5 rounded-[1.5rem] border border-white/5 group hover:border-[var(--neon-purple)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-3",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-2xl font-black text-white uppercase truncate font-bungee tracking-tight group-hover:text-[var(--neon-purple)] transition-colors",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-600 font-bold uppercase truncate font-righteous tracking-widest mt-1",children:T.artist})]}),h.jsx(ya,{url:T.youtubeUrl})]}),h.jsxs("div",{className:"flex items-center justify-between border-t border-white/5 pt-3 mt-1",children:[h.jsxs("button",{onClick:()=>qr(T.participantId),className:"text-sm font-black text-[var(--neon-pink)] uppercase truncate hover:text-white font-righteous tracking-widest transition-colors mb-0",children:["@",T.participantName]}),h.jsx("button",{onClick:async()=>{await b0(T),await _e()},className:"opacity-0 group-hover:opacity-100 text-xs font-black text-[var(--neon-cyan)] hover:text-white transition-all font-righteous tracking-widest uppercase ml-auto",children:"RELOAD"})]})]},ee)),e.history.length===0&&h.jsx("div",{className:"text-center py-20 opacity-20",children:h.jsx("p",{className:"text-lg italic font-righteous uppercase tracking-widest text-slate-700",children:"EMPTY"})})]})]}),h.jsxs("section",{className:"lg:col-span-12 bg-black/40 border-4 border-white/5 rounded-[3rem] p-10 mt-10 relative overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-center mb-10 px-2",children:[h.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter font-bungee neon-glow-cyan",children:"COMPLETED ROUNDS"}),h.jsx("div",{className:"text-[var(--neon-cyan)]/40 text-sm font-black uppercase tracking-[0.4em] font-righteous",children:"HISTORY"})]}),h.jsx("div",{className:"grid gap-12",children:(()=>{const T={};e.history.filter(U=>(U.playedAt||0)>=(e.startedAt||0)).forEach(U=>{const oe=U.playedAt||0;T[oe]||(T[oe]=[]),T[oe].push(U)});const ee=Object.keys(T).map(Number).sort((U,oe)=>oe-U);return ee.length===0?h.jsx("div",{className:"text-center py-24 border-4 border-dashed border-white/5 rounded-[2.5rem] opacity-20",children:h.jsx("p",{className:"text-2xl font-black uppercase tracking-[0.4em] font-righteous text-slate-500",children:"HISTORY_NULL"})}):ee.map(U=>h.jsxs("div",{className:"bg-[#050510] border-2 border-white/5 rounded-[2.5rem] p-8 relative group hover:border-[var(--neon-cyan)]/30 transition-all",children:[h.jsxs("div",{className:"absolute top-0 left-10 py-1 px-4 bg-[var(--neon-cyan)] text-black text-[10px] font-black uppercase tracking-widest rounded-b-lg font-righteous shadow-[0_0_15px_rgba(0,229,255,0.4)]",children:["ROUND_",new Date(U).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4",children:T[U].map((oe,ye)=>h.jsxs("div",{className:"flex flex-col p-4 bg-black/40 rounded-2xl border border-white/5 group/song hover:bg-white/5 transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsx("div",{className:"text-lg font-black text-white uppercase truncate font-bungee tracking-tight group-hover/song:text-[var(--neon-cyan)] transition-colors",children:oe.songName}),h.jsx(ya,{url:oe.youtubeUrl})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-xs font-black text-[var(--neon-pink)] uppercase tracking-widest font-righteous",children:["@",oe.participantName]}),h.jsxs("span",{className:"text-[10px] font-bold text-slate-700 uppercase tracking-tighter",children:["POS_",ye+1]})]})]},oe.id))})]},U))})()})]})]}),kn==="LIBRARY"&&h.jsxs("section",{className:"animate-in fade-in slide-in-from-bottom-2 space-y-10 pb-32",children:[h.jsx("div",{className:"sticky top-0 z-40 pt-4 -mt-4",children:h.jsxs("div",{className:"relative group p-1 rounded-[2.5rem] bg-[#050510]/90 shadow-2xl backdrop-blur-xl border border-white/10",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--neon-pink)]/20 via-[var(--neon-purple)]/20 to-[var(--neon-cyan)]/20 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity duration-500"}),h.jsx("input",{type:"text",placeholder:"SEARCH SONGBOOK...",value:Jn,onChange:T=>ir(T.target.value),className:"w-full bg-black/50 border-2 border-white/10 rounded-[2.3rem] py-6 pl-16 pr-32 text-2xl font-bold tracking-widest text-white placeholder:text-slate-600 focus:outline-none focus:border-[var(--neon-pink)] transition-all font-righteous uppercase"}),h.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-slate-600 group-focus-within:text-[var(--neon-pink)] transition-colors pointer-events-none",children:h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[h.jsx("circle",{cx:"11",cy:"11",r:"8"}),h.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),h.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex gap-2",children:h.jsx("button",{onClick:()=>p(!0),className:"px-6 py-3 bg-[var(--neon-cyan)] text-black rounded-[2rem] font-black text-base uppercase tracking-widest shadow-[0_0_15px_rgba(0,229,255,0.4)] active:scale-95 transition-all font-righteous hover:bg-white hover:scale-105",children:"+ ADD NEW"})})]})}),h.jsx("div",{className:"flex flex-col gap-3",children:(()=>{const ee=((e==null?void 0:e.verifiedSongbook)||[]).map(U=>({...U,isVerified:!0,title:U.songName,source:"VERIFIED"})).filter(U=>{if(!Jn)return!0;const oe=Jn.toLowerCase();return U.title.toLowerCase().includes(oe)||U.artist.toLowerCase().includes(oe)});return ee.length===0?h.jsxs("div",{className:"col-span-full text-center py-40 opacity-30 border-4 border-dashed border-white/5 rounded-[4rem]",children:[h.jsx("div",{className:"text-8xl mb-6 opacity-50 grayscale animate-pulse",children:Jn?"":""}),h.jsx("p",{className:"text-5xl font-black uppercase tracking-[0.5em] font-righteous text-slate-600",children:Jn?"NO MATCH FOUND":"SONGBOOK EMPTY"})]}):ee.map((U,oe)=>h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 p-4 rounded-[2rem] flex items-center justify-between group hover:border-[var(--neon-cyan)] transition-all relative hover:z-50 shadow-lg",children:[h.jsxs("div",{className:"flex items-center gap-6 flex-1 min-w-0",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-black rounded-lg border border-white/10 text-[var(--neon-cyan)] text-2xl",children:""}),h.jsx("div",{className:"min-w-0 pr-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[U.isVerified&&h.jsx("div",{className:"px-2 py-0.5 bg-[var(--neon-pink)] text-black rounded-full text-[10px] font-black uppercase tracking-widest font-righteous shrink-0",children:"VERIFIED"}),h.jsx("h4",{className:"text-3xl font-black text-white uppercase truncate tracking-tighter font-bungee group-hover:text-[var(--neon-cyan)] transition-colors",children:U.title}),h.jsxs("span",{className:"text-base text-slate-600 font-bold uppercase font-righteous tracking-widest truncate",children:["/ ",U.artist]})]})})]}),h.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[h.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx(Du,{request:U}),h.jsx(ju,{request:U}),h.jsx(ya,{url:U.youtubeUrl}),h.jsx("button",{onClick:async()=>{await OE(U.id).then(_e)},className:"p-2 text-rose-500/20 hover:text-rose-500 transition-all text-xl",children:""})]}),h.jsxs("div",{className:"flex gap-2 bg-black/40 p-1 rounded-xl border border-white/5 ml-4",children:[h.jsxs("div",{className:"relative group/assign",children:[h.jsx("button",{className:"px-6 py-2.5 bg-white text-black text-sm font-black uppercase rounded-lg hover:bg-[var(--neon-cyan)] transition-all font-righteous tracking-wider",children:"ASSIGN"}),h.jsxs("div",{className:"absolute bottom-full right-0 mb-4 bg-[#0a0a0a] border-2 border-[var(--neon-cyan)]/30 rounded-[1.5rem] shadow-2xl opacity-0 invisible group-hover/assign:opacity-100 group-hover/assign:visible transition-all p-4 z-50 backdrop-blur-xl w-[200px]",children:[h.jsx("p",{className:"text-base text-[var(--neon-cyan)] font-black uppercase mb-3 border-b border-white/10 pb-2 font-righteous tracking-widest",children:"TRANSMIT TO:"}),h.jsxs("div",{className:"space-y-1 max-h-48 overflow-y-auto custom-scrollbar pr-2",children:[e.participants.map(ye=>h.jsx("button",{onClick:async()=>{const Ue=await va({participantId:ye.id,participantName:ye.name,songName:U.title,artist:U.artist,youtubeUrl:U.youtubeUrl,type:ft.SINGING});Ue&&await ku(Ue.id),await _e()},className:"w-full text-left p-2 rounded-lg hover:bg-white/10 hover:text-[var(--neon-cyan)] text-lg font-black text-slate-400 uppercase truncate font-righteous transition-all",children:ye.name},ye.id)),h.jsx("div",{className:"h-[1px] bg-white/10 my-2"}),h.jsx("button",{onClick:async()=>{const ye=await va({participantId:"DJ-MANUAL",participantName:"GUEST",songName:U.title,artist:U.artist,youtubeUrl:U.youtubeUrl,type:ft.SINGING});ye&&await ku(ye.id),await _e()},className:"w-full text-left p-2 rounded-lg bg-[var(--neon-cyan)]/20 text-[var(--neon-cyan)] hover:bg-[var(--neon-cyan)] hover:text-black text-sm font-black uppercase font-righteous transition-all",children:"+ GUEST"})]})]})]}),h.jsxs("div",{className:"relative group/star",children:[h.jsx("button",{className:"px-4 py-2.5 bg-black border border-white/10 text-[var(--neon-pink)] rounded-lg font-black text-sm uppercase tracking-widest hover:border-[var(--neon-pink)] transition-all font-righteous",children:""}),h.jsxs("div",{className:"absolute bottom-full right-0 mb-4 bg-[#0a0a0a] border-2 border-[var(--neon-pink)]/30 rounded-[1.5rem] shadow-2xl opacity-0 invisible group-hover/star:opacity-100 group-hover/star:visible transition-all p-4 z-50 backdrop-blur-xl w-[180px]",children:[h.jsx("p",{className:"text-base text-[var(--neon-pink)] font-black uppercase mb-3 border-b border-white/10 pb-2 font-righteous tracking-widest",children:"ADD FAVORITE:"}),h.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto custom-scrollbar pr-2",children:e.participants.map(ye=>h.jsx("button",{onClick:async()=>{await CP(ye.id,{songName:U.title,artist:U.artist,youtubeUrl:U.youtubeUrl,type:U.type}),await _e()},className:"w-full text-left p-2 rounded-lg hover:bg-white/10 hover:text-[var(--neon-pink)] text-lg font-black text-slate-400 uppercase truncate font-righteous transition-all",children:ye.name},ye.id))})]})]})]})]})]},oe))})()})]})]}),A&&h.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-6 z-[100] backdrop-blur-xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-2xl bg-[#0a0a0a] border-4 border-[var(--neon-pink)]/30 rounded-[3rem] p-10 shadow-[0_0_100px_rgba(255,42,109,0.2)] animate-in zoom-in-95 duration-500 relative overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-start mb-8",children:[h.jsx("h2",{className:"text-5xl font-bold text-white uppercase tracking-tight leading-none font-bungee neon-glow-pink",children:"REVIEW LINEUP"}),h.jsx("button",{onClick:()=>O(!1),className:"text-slate-600 hover:text-white font-bold text-5xl px-2 transition-all transform hover:scale-110",children:""})]}),h.jsx("div",{className:"mb-8 text-lg text-[var(--neon-cyan)] font-bold uppercase tracking-widest font-righteous opacity-80 decoration-dotted underline underline-offset-4",children:"OPERATIONAL READY CHECK"}),h.jsx("div",{className:"space-y-4 mb-10 max-h-[400px] overflow-y-auto pr-4 custom-scrollbar",children:(()=>{var ee;const T=e.participants.filter(U=>{var oe;return(oe=e.requests)==null?void 0:oe.some(ye=>ye.participantId===U.id&&ye.status===Pe.APPROVED&&ye.type===ft.SINGING&&!ye.isInRound)}).sort((U,oe)=>(oe.joinedAt||0)-(U.joinedAt||0));if(T.length>0)return T.map(U=>{var Ue;const oe=U.status===Kt.READY,ye=(Ue=e.requests)==null?void 0:Ue.find(Rt=>Rt.participantId===U.id&&Rt.status===Pe.APPROVED&&Rt.type===ft.SINGING&&!Rt.isInRound);return h.jsxs("div",{className:`flex items-center justify-between p-4 rounded-[1.5rem] border-2 transition-all duration-300 ${oe?"bg-[#150030] border-[var(--neon-green)] shadow-[0_0_20px_rgba(57,255,20,0.15)]":"bg-black/40 border-white/5 opacity-50"}`,children:[h.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[h.jsx("button",{onClick:async()=>{await Aa(U.id,oe?Kt.STANDBY:Kt.READY),await _e()},className:`w-6 h-6 rounded-full shrink-0 flex items-center justify-center transition-all border-2 ${oe?"bg-[var(--neon-green)] border-[var(--neon-green)] shadow-[0_0_10px_var(--neon-green)]":"bg-slate-900 border-white/10 hover:border-slate-600"}`,children:oe&&h.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-ping"})}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("div",{className:`font-bold uppercase text-2xl truncate tracking-tight font-bungee ${oe?"text-white":"text-slate-600"}`,children:U.name}),oe?ye?h.jsx("div",{className:"text-[var(--neon-cyan)] text-base font-black uppercase tracking-[0.2em] font-righteous mt-0.5 opacity-90",children:ye.songName}):h.jsx("div",{className:"text-rose-500 text-sm font-black uppercase tracking-[0.1em] font-righteous mt-0.5",children:" NO SIGNAL"}):h.jsx("div",{className:"text-slate-700 text-sm font-black uppercase tracking-[0.2em] font-righteous mt-0.5",children:"STANDBY"})]})]}),oe&&ye&&h.jsx("div",{className:"shrink-0 text-sm bg-[var(--neon-cyan)] text-black px-4 py-1.5 rounded-full font-black uppercase tracking-widest font-righteous shadow-[0_0_10px_var(--neon-cyan)] animate-in fade-in zoom-in",children:"READY"})]},U.id)});{const U=((ee=e.requests)==null?void 0:ee.filter(oe=>oe.status===Pe.APPROVED&&oe.type===ft.LISTENING&&!oe.isInRound).sort((oe,ye)=>oe.createdAt-ye.createdAt).slice(0,5))||[];return U.length>0?h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"p-4 bg-white/5 rounded-xl border border-dashed border-white/10 text-center",children:h.jsx("p",{className:"text-[var(--neon-blue)] font-black uppercase tracking-widest font-righteous",children:"FALLBACK: LISTENING MODE"})}),U.map(oe=>h.jsxs("div",{className:"flex items-center justify-between p-4 rounded-[1.5rem] border-2 bg-[#0a0a20] border-[var(--neon-blue)]/30",children:[h.jsxs("div",{className:"min-w-0",children:[h.jsx("div",{className:"text-[var(--neon-blue)] text-xl font-black uppercase tracking-tight font-bungee",children:oe.songName}),h.jsx("div",{className:"text-slate-500 text-sm font-bold uppercase tracking-widest font-righteous",children:oe.artist})]}),h.jsxs("div",{className:"text-xs font-black uppercase tracking-widest text-[var(--neon-pink)] font-righteous",children:["@",oe.participantName]})]},oe.id))]}):h.jsx("div",{className:"text-center py-24 bg-black/20 rounded-[2.5rem] border-4 border-dashed border-white/5 animate-in fade-in duration-700",children:h.jsx("p",{className:"text-slate-700 text-2xl font-black uppercase tracking-[0.4em] font-righteous",children:"NO DATA"})})}})()}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>O(!1),className:"flex-1 py-4 bg-black hover:bg-white hover:text-black text-white border border-white/10 rounded-xl font-black uppercase text-base tracking-widest transition-all font-righteous",children:"CANCEL"}),(()=>{var ye;const T=e.participants.filter(Ue=>{var Rt;return(Rt=e.requests)==null?void 0:Rt.some(Tr=>Tr.participantId===Ue.id&&Tr.status===Pe.APPROVED&&Tr.type===ft.SINGING&&!Tr.isInRound)}).length,ee=((ye=e.requests)==null?void 0:ye.filter(Ue=>Ue.status===Pe.APPROVED&&Ue.type===ft.LISTENING&&!Ue.isInRound).length)||0,U=T>0?T:ee,oe=T>0?"ACTIVATE ROUND":"ACTIVATE LISTENING";return h.jsx("button",{onClick:Gr,disabled:U===0,className:`flex-[2] py-4 rounded-xl font-black uppercase text-base tracking-widest transition-all flex items-center justify-center gap-3 shadow-lg font-righteous ${U>0?"bg-[var(--neon-green)] hover:bg-white hover:text-black text-black hover:scale-105":"bg-slate-900 text-slate-800 cursor-not-allowed border border-white/5"}`,children:U>0?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-1.5 h-1.5 bg-current rounded-full animate-ping"}),oe," (",U,")"]}):"IDLE"})})()]}),h.jsxs("div",{className:"bg-[#151520] p-6 rounded-[2rem] border border-white/5 mt-8",children:[h.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-widest font-righteous mb-4 flex items-center gap-3",children:[h.jsx("span",{className:"text-[var(--neon-purple)]",children:""})," Priority Protocol"]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.values(Ls).map(T=>h.jsxs("button",{onClick:()=>{LP(T)},className:`p-4 rounded-xl border-2 text-left transition-all relative overflow-hidden group ${e.queueStrategy===T?"bg-[var(--neon-purple)]/20 border-[var(--neon-purple)] text-white shadow-[0_0_15px_var(--neon-purple)]":"bg-black/40 border-white/5 text-slate-500 hover:border-white/20 hover:text-slate-300"}`,children:[h.jsx("div",{className:"font-bold font-righteous uppercase tracking-wider relative z-10",children:T.replace("_"," ")}),h.jsxs("div",{className:"text-[10px] uppercase font-mono mt-1 opacity-60 relative z-10",children:[T==="FRESH_MEAT"&&"New Singers First",T==="FAIR_ROTATION"&&"Fewest Songs + Oldest Wait",T==="FIFO"&&"Strict First In First Out",T==="OLDEST_MEMBER"&&"Oldest Singers First",T==="RANDOM"&&"Chaotic Shuffle"]}),e.queueStrategy===T&&h.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 rounded-full bg-[var(--neon-green)] animate-pulse"})]},T))})]})]})}),le&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[200] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-md bg-[#050510] border-4 border-rose-500/30 rounded-[3rem] p-10 text-center shadow-[0_0_100px_rgba(244,63,94,0.3)] animate-in zoom-in-95 duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-rose-500 shadow-[0_0_20px_rgba(244,63,94,0.8)]"}),h.jsx("div",{className:"w-20 h-20 bg-rose-500/10 text-rose-500 rounded-[2rem] border-2 border-rose-500/20 flex items-center justify-center mx-auto mb-6 text-4xl font-black shadow-[0_0_30px_rgba(244,63,94,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-text-glow-rose",children:"SYSTEM RESET"}),h.jsxs("p",{className:"text-slate-400 text-lg mb-8 leading-relaxed font-black font-righteous uppercase tracking-widest",children:["This will ",h.jsx("span",{className:"text-rose-500 underline decoration-2 underline-offset-4 decoration-rose-500",children:"TERMINATE ALL SESSIONS"}),", clear requests, and wipe history logs."]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>me(!1),className:"flex-1 py-4 bg-black border-2 border-white/10 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous transition-all hover:bg-white/5",children:"ABORT"}),h.jsx("button",{onClick:Qa,className:"flex-[2] py-4 bg-rose-500 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous shadow-[0_0_30px_rgba(244,63,94,0.4)] transition-all hover:bg-rose-400 hover:scale-105",children:"EXECUTE WIPE"})]})]})}),(F||je)&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[70] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-6xl bg-[#0a0a0a] border-4 border-white/10 rounded-[4rem] overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] flex flex-col max-h-[90vh] relative",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsxs("div",{className:"p-8 border-b-2 border-white/5 flex justify-between items-center bg-black/40 backdrop-blur-xl",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-5xl font-black text-white font-bungee uppercase tracking-tight neon-glow-purple",children:"User Directory"}),h.jsx("p",{className:"text-base text-[var(--neon-cyan)] uppercase font-black tracking-[0.3em] font-righteous opacity-80 mt-1",children:"Authenticated Identities & Signal History"})]}),h.jsxs("div",{className:"flex gap-3",children:[je&&h.jsx("button",{onClick:()=>Ht(null),className:"px-6 py-3 bg-black border border-white/10 text-white rounded-xl text-sm font-black uppercase tracking-widest font-righteous hover:bg-white/10 transition-all",children:" ALL ACCOUNTS"}),h.jsx("button",{onClick:()=>{Xt("DANGER: This will permanently delete ALL GUEST ACCOUNTS and DUPLICATE ENTRIES from the Firestore database. Proceed?",async()=>{const T=await tA();T.success?(alert(`DATABASE CLEANUP SUCCESS: Removed ${T.deletedCount} orphan records.`),await _e()):alert(`CLEANUP FAILED: ${T.error}`)})},className:"px-6 py-3 bg-rose-500/10 border border-rose-500/50 text-rose-500 rounded-xl text-sm font-black uppercase tracking-widest font-righteous hover:bg-rose-500 hover:text-white transition-all hover:scale-105",children:"PURGE GUESTS"}),h.jsx("button",{onClick:()=>Dt(!0),className:"px-6 py-3 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-black uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white transition-all hover:scale-105",children:"+ NEW ACCOUNT"}),h.jsx("button",{onClick:Pi,className:"text-slate-600 hover:text-white p-2 ml-2 font-black text-4xl transition-colors transform hover:scale-110",children:""})]})]}),h.jsx("div",{className:"p-6 border-b-2 border-white/5 bg-black/20",children:h.jsxs("div",{className:"relative group max-w-2xl mx-auto",children:[h.jsx("input",{type:"text",placeholder:"SCANNING DIRECTORY RECORDS...",value:Be,onChange:T=>Ut(T.target.value),className:"w-full bg-[#050510] border-2 border-white/10 rounded-2xl px-10 py-4 text-white font-black uppercase font-righteous tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all shadow-inner placeholder:text-slate-700 text-xl"}),h.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-700 group-focus-within:text-[var(--neon-pink)] transition-colors",children:h.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[h.jsx("circle",{cx:"11",cy:"11",r:"8"}),h.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]})}),h.jsx("div",{className:"flex-1 overflow-y-auto p-10 space-y-12 custom-scrollbar bg-black/20",children:je?h.jsxs("div",{className:"animate-in slide-in-from-right-4 duration-500 grid lg:grid-cols-12 gap-8",children:[h.jsx("div",{className:"lg:col-span-4 space-y-6",children:h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[3rem] p-8 shadow-2xl relative overflow-hidden group hover:border-[var(--neon-purple)] transition-all",children:[h.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-[var(--neon-purple)]/10 blur-[60px] rounded-full -mr-24 -mt-24 group-hover:bg-[var(--neon-purple)]/20 transition-all"}),h.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[h.jsx("div",{className:"scale-125 mb-4",children:h.jsx(Ns,{name:je.name,isActive:e.participants.some(T=>T.id===je.id)})}),h.jsxs("div",{className:"mt-4",children:[h.jsx("div",{className:"text-sm font-bold text-[var(--neon-cyan)] uppercase tracking-widest mb-2 font-righteous",children:"SINGER PROFILE"}),h.jsx("h3",{className:"text-5xl font-bold text-white uppercase tracking-tight leading-none font-bungee break-words",children:je.name})]}),h.jsxs("div",{className:"w-full mt-8 space-y-3 pt-6 border-t border-white/5",children:[h.jsxs("div",{className:"flex justify-between items-center text-sm uppercase font-black font-righteous tracking-widest",children:[h.jsx("span",{className:"text-slate-600",children:"SINGER ID"}),h.jsxs("span",{className:"text-[var(--neon-pink)] font-mono opacity-80",children:[je.id.slice(0,8),"..."]})]}),h.jsxs("div",{className:"flex justify-between items-center text-sm uppercase font-black font-righteous tracking-widest",children:[h.jsx("span",{className:"text-slate-600",children:"SECURITY"}),h.jsx("span",{className:`px-2 py-0.5 rounded-full ${je.password?"bg-[var(--neon-pink)]/10 text-[var(--neon-pink)]":"bg-slate-900 text-slate-600"}`,children:je.password?"SECURE PIN":"OPEN LINK"})]})]}),h.jsxs("div",{className:"w-full mt-10 space-y-3",children:[h.jsx("button",{onClick:()=>Wt(je),className:"w-full py-3 bg-black border border-white/10 hover:border-[var(--neon-pink)] text-white rounded-xl text-sm font-black uppercase tracking-widest transition-all font-righteous",children:"CHANGE PASSWORD"}),h.jsx("button",{onClick:async()=>{Xn(je),E(!0),await bi(je.id),await _e()},className:"w-full py-3 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-black uppercase tracking-widest transition-all shadow-[0_0_15px_rgba(0,229,255,0.3)] font-righteous hover:bg-white",children:"SYNC QR CODE"}),h.jsx("div",{className:"pt-2 border-t border-white/5 mt-2 space-y-2"}),h.jsx("button",{onClick:()=>{Xt("Permanently delete this account?",async()=>{await Df(je.id),Ht(null),await _e()})},className:"w-full py-3 bg-rose-500/5 hover:bg-rose-500 text-rose-500/40 hover:text-white rounded-xl text-sm font-black uppercase tracking-widest transition-all border border-transparent hover:border-rose-500/30 font-righteous mt-2",children:"TERMINATE ACCOUNT"})]})]})]})}),h.jsx("div",{className:"lg:col-span-8 space-y-6",children:h.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[2.5rem] p-8 relative overflow-hidden",children:[h.jsxs("h4",{className:"text-sm font-black text-[var(--neon-pink)] uppercase tracking-[0.3em] mb-6 font-righteous",children:["LIBRARY STARS (",je.favorites.length,")"]}),h.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[je.favorites.map(T=>h.jsxs("div",{className:"bg-black/40 border border-white/5 p-4 rounded-xl flex justify-between items-center group hover:border-[var(--neon-pink)] transition-all",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-xl font-black text-white truncate uppercase tracking-tight font-righteous group-hover:text-[var(--neon-pink)] transition-colors",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-500 font-bold uppercase tracking-widest mt-0.5 font-righteous opacity-60",children:T.artist})]}),h.jsxs("div",{className:"flex gap-2 shrink-0",children:[h.jsx("button",{onClick:async()=>{await va({participantId:je.id,participantName:je.name,songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type}),await _e()},className:"px-3 py-1.5 bg-[var(--neon-cyan)]/10 border border-[var(--neon-cyan)]/30 text-[var(--neon-cyan)] rounded-lg text-xs font-black uppercase font-righteous hover:bg-[var(--neon-cyan)] hover:text-black transition-all",children:"ADD"}),h.jsx("button",{onClick:()=>L({type:"favorite",itemId:T.id}),className:"p-1.5 text-slate-700 hover:text-white transition-colors",children:""}),h.jsx("button",{onClick:()=>{Xt("Remove from stars?",async()=>{await AP(je.id,T.id),await _e()})},className:"p-1.5 text-rose-500/30 hover:text-rose-500 transition-colors",children:""})]})]},T.id)),je.favorites.length===0&&h.jsxs("div",{className:"flex flex-col items-center py-20 opacity-20",children:[h.jsx("span",{className:"text-4xl mb-3 grayscale",children:""}),h.jsx("p",{className:"text-sm font-black uppercase tracking-[0.3em] font-righteous text-slate-600",children:"Catalog is empty"})]})]})]}),h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[2.5rem] p-8 relative overflow-hidden",children:[h.jsxs("h4",{className:"text-sm font-black text-[var(--neon-cyan)] uppercase tracking-[0.3em] mb-6 font-righteous",children:["PERFORMANCE LOG (",je.personalHistory.length,")"]}),h.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[je.personalHistory.map((T,ee)=>h.jsxs("div",{className:"bg-black/40 border border-white/5 p-4 rounded-xl group hover:border-[var(--neon-cyan)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-xl font-bold text-white truncate uppercase tracking-tight font-righteous group-hover:text-[var(--neon-cyan)] transition-colors",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-500 font-bold uppercase tracking-widest mt-0.5 font-righteous opacity-60",children:T.artist})]}),h.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-all transform translate-x-2 group-hover:translate-x-0",children:[h.jsx("button",{onClick:()=>L({type:"history",itemId:T.id}),className:"p-1.5 text-slate-700 hover:text-white transition-colors",children:""}),h.jsx("button",{onClick:()=>{Xt("Erase from history?",async()=>{await RP(je.id,T.id),await _e()})},className:"p-1.5 text-rose-500/30 hover:text-rose-500 transition-colors",children:""})]})]}),h.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-white/5",children:[h.jsx("span",{className:"text-xs text-slate-700 font-black uppercase font-righteous tracking-widest",children:new Date(T.createdAt).toLocaleDateString()}),h.jsx("button",{onClick:async()=>{await b0(T),await _e()},className:"px-3 py-1.5 bg-[var(--neon-pink)]/10 border border-[var(--neon-pink)]/30 text-[var(--neon-pink)] rounded-lg text-xs font-black uppercase font-righteous hover:bg-[var(--neon-pink)] hover:text-black transition-all",children:"RE-QUEUE"})]})]},ee)),je.personalHistory.length===0&&h.jsxs("div",{className:"flex flex-col items-center py-20 opacity-20",children:[h.jsx("span",{className:"text-4xl mb-3 grayscale",children:""}),h.jsx("p",{className:"text-sm font-black uppercase tracking-[0.3em] font-righteous text-slate-600",children:"No transmissions recorded"})]})]})]})]})})]}):br?h.jsxs("form",{onSubmit:Ka,className:"max-w-xl mx-auto bg-[#101015] border-2 border-white/10 p-10 rounded-[3rem] space-y-6 shadow-[0_0_60px_rgba(255,0,127,0.1)] animate-in fade-in zoom-in-95 duration-500",children:[h.jsx("h3",{className:"text-5xl font-bold text-white uppercase tracking-tight font-bungee neon-glow-pink mb-2 text-center",children:"SECURITY UPDATE"}),h.jsxs("p",{className:"text-center text-slate-400 font-righteous uppercase tracking-widest mb-8",children:["UPDATING KEY FOR: ",h.jsx("span",{className:"text-[var(--neon-cyan)]",children:Xe==null?void 0:Xe.name})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-500 uppercase mb-2 ml-4 tracking-widest font-righteous",children:"NEW ENCRYPTION PIN"}),h.jsx("input",{required:!0,type:"password",value:Ha,onChange:T=>{ar(T.target.value),xn("")},className:"w-full bg-black border border-white/10 rounded-2xl px-6 py-4 text-white font-bold uppercase font-righteous tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all",placeholder:"ENTER NEW PIN"})]}),an&&h.jsx("div",{className:"mb-4 animate-pulse",children:h.jsxs("p",{className:"text-[var(--neon-pink)] font-bold uppercase text-sm tracking-widest flex items-center gap-2",children:[h.jsx("span",{className:"text-lg",children:""})," ",an]})})]}),h.jsxs("div",{className:"flex gap-4 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>{ji(!1),Ht(Xe),Ke(null)},className:"flex-1 py-4 bg-black border border-white/10 text-white rounded-xl text-sm font-bold uppercase tracking-widest font-righteous hover:bg-white/5",children:"ABORT"}),h.jsx("button",{type:"submit",className:"flex-[2] py-4 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-bold uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white",children:"UPDATE KEY"})]})]}):Ur?h.jsxs("form",{onSubmit:Dc,className:"max-w-xl mx-auto bg-[#101015] border-2 border-white/10 p-10 rounded-[3rem] space-y-6 shadow-[0_0_60px_rgba(255,0,127,0.1)] animate-in fade-in zoom-in-95 duration-500",children:[h.jsx("h3",{className:"text-5xl font-bold text-white uppercase tracking-tight font-bungee neon-glow-pink mb-2 text-center",children:Xe?"Modify Profile":"New User Account"}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-500 uppercase mb-2 ml-4 tracking-widest font-righteous",children:"IDENTITY HANDLE"}),h.jsx("input",{required:!0,type:"text",value:Sn.name,onChange:T=>{jt({...Sn,name:T.target.value}),xn("")},className:"w-full bg-black border border-white/10 rounded-2xl px-6 py-4 text-white font-bold uppercase font-righteous tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all"})]}),an&&h.jsx("div",{className:"mb-4 animate-pulse",children:h.jsxs("p",{className:"text-[var(--neon-pink)] font-bold uppercase text-sm tracking-widest flex items-center gap-2",children:[h.jsx("span",{className:"text-lg",children:""})," ",an]})}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-500 uppercase mb-2 ml-4 tracking-widest font-righteous",children:"ENCRYPTION PIN (OPTIONAL)"}),h.jsx("input",{type:"password",value:Sn.password,onChange:T=>jt({...Sn,password:T.target.value}),className:"w-full bg-black border border-white/10 rounded-2xl px-6 py-4 text-white font-bold uppercase font-righteous tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all"})]})]}),h.jsxs("div",{className:"flex gap-4 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>{Dt(!1),Ke(null)},className:"flex-1 py-4 bg-black border border-white/10 text-white rounded-xl text-sm font-bold uppercase tracking-widest font-righteous hover:bg-white/5",children:"ABORT"}),h.jsx("button",{type:"submit",className:"flex-[2] py-4 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-bold uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white",children:"AUTHORIZE ACCOUNT"})]})]}):h.jsx("div",{className:"space-y-16",children:(()=>{const T=n.filter(U=>!U.password&&e.participants.some(oe=>oe.id===U.id)&&(U.name.toLowerCase().includes(Be.toLowerCase())||U.id.toLowerCase().includes(Be.toLowerCase()))),ee=n.filter(U=>(U.password||!e.participants.some(oe=>oe.id===U.id))&&(U.name.toLowerCase().includes(Be.toLowerCase())||U.id.toLowerCase().includes(Be.toLowerCase())));return h.jsxs(h.Fragment,{children:[T.length>0&&h.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-500",children:[h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsx("h3",{className:"text-base font-black text-[var(--neon-green)] uppercase tracking-[0.5em] font-righteous whitespace-nowrap",children:"ACTIVE SIGNALS"}),h.jsx("div",{className:"h-[2px] w-full bg-gradient-to-r from-[var(--neon-green)]/30 to-transparent"})]}),h.jsx("div",{className:"flex flex-col gap-4",children:T.map(U=>h.jsxs("div",{className:"bg-[#151520] border-2 border-white/5 rounded-[2rem] p-4 flex items-center justify-between hover:border-[var(--neon-green)] transition-all shadow-lg group relative overflow-hidden",children:[h.jsxs("div",{className:"flex items-center gap-6 min-w-0 pr-4",children:[h.jsx(Ns,{name:U.name,isActive:!0}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("button",{onClick:()=>Ht(U),className:"text-white font-bold text-3xl uppercase truncate tracking-tight text-left block hover:text-[var(--neon-green)] transition-colors font-bungee",children:U.name}),h.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[h.jsx("span",{className:"text-[10px] bg-[var(--neon-green)] text-black px-2 py-0.5 rounded-full font-black uppercase tracking-widest font-righteous shrink-0",children:"LIVE"}),h.jsxs("span",{className:"text-sm text-slate-600 uppercase font-black font-righteous tracking-widest truncate",children:[U.favorites.length,"   ",U.personalHistory.length," TX"]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-4 py-2 px-4 bg-black/40 rounded-2xl border border-white/5",children:[h.jsx("button",{onClick:()=>Ht(U),className:"py-2.5 px-4 bg-white/5 hover:bg-white/10 text-white rounded-lg text-xs font-black uppercase tracking-widest transition-all font-righteous",children:"LOG"}),h.jsx("button",{onClick:()=>wr(U),className:"py-2.5 px-4 bg-white/5 hover:bg-white/10 text-white rounded-lg text-xs font-black uppercase transition-all font-righteous",children:"EDIT"}),h.jsx("button",{onClick:()=>$t(U),className:"py-2.5 px-6 bg-[var(--neon-cyan)]/20 text-[var(--neon-cyan)] hover:text-black rounded-lg text-xs font-black uppercase tracking-widest transition-all font-righteous hover:bg-[var(--neon-cyan)]",children:"AUTO_SET"}),h.jsx("button",{onClick:()=>It(U),className:"py-2.5 px-6 bg-[var(--neon-pink)]/20 text-[var(--neon-pink)] hover:text-white rounded-lg text-xs font-black uppercase tracking-widest transition-all font-righteous hover:bg-[var(--neon-pink)]",children:"MANUAL"})]}),h.jsx("button",{onClick:()=>{Xt("Terminate temporary link?",async()=>{await Df(U.id),await _e()})},className:"w-10 h-10 flex items-center justify-center text-rose-500/20 hover:text-rose-500 hover:bg-rose-500/10 rounded-xl transition-all font-black",children:""})]})]},U.id))})]}),h.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-700",children:[h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsx("h3",{className:"text-base font-black text-slate-600 uppercase tracking-[0.5em] font-righteous whitespace-nowrap",children:"ARCHIVE DIRECTORY"}),h.jsx("div",{className:"h-[1px] w-full bg-white/5"})]}),h.jsx("div",{className:"flex flex-col gap-4",children:ee.map(U=>{const oe=e.participants.some(ye=>ye.id===U.id);return h.jsxs("div",{className:`bg-[#101015] border-2 ${oe?"border-[var(--neon-cyan)] shadow-[0_0_20px_rgba(0,229,255,0.1)]":"border-white/5"} rounded-[2.5rem] p-6 flex flex-col justify-between hover:border-[var(--neon-purple)] transition-all group`,children:[h.jsxs("div",{className:"flex justify-between items-start gap-4 mb-3",children:[h.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-2xl font-black border-2 ${U.password?"bg-indigo-900/50 border-[var(--neon-purple)] text-white shadow-[0_0_15px_rgba(167,139,250,0.3)]":"bg-slate-800 border-white/10 text-slate-500"}`,children:U.name.charAt(0).toUpperCase()}),U.isAdmin&&h.jsx("div",{className:"absolute -top-2 -right-2 bg-[var(--neon-pink)] text-black text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg border border-white/20",children:"ADMIN"})]}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("div",{className:"flex justify-between items-start gap-2",children:h.jsx("button",{onClick:()=>Ht(U),className:"text-white font-bold text-2xl uppercase truncate tracking-tight text-left block hover:text-[var(--neon-purple)] transition-colors font-bungee",children:U.name})}),h.jsxs("p",{className:"text-xs text-slate-500 uppercase font-black tracking-[0.2em] mt-1 font-righteous",children:[U.password?" AUTHENTICATED":"GUEST ID","  ",U.favorites.length," "]})]})]}),h.jsx("button",{onClick:()=>Xn(U),className:"p-3 bg-white/5 border border-white/10 rounded-xl hover:bg-[var(--neon-cyan)]/20 hover:border-[var(--neon-cyan)] hover:text-[var(--neon-cyan)] transition-all group/qr",title:"Generate SINC QR",children:h.jsxs("div",{className:"w-6 h-6 flex flex-col justify-between items-center p-0.5",children:[h.jsx("div",{className:"w-full h-[2px] bg-current"}),h.jsxs("div",{className:"w-full flex justify-between",children:[h.jsx("div",{className:"w-[2px] h-[2px] bg-current"}),h.jsx("div",{className:"w-[2px] h-[2px] bg-current"})]}),h.jsx("div",{className:"w-full h-[2px] bg-current"}),h.jsxs("div",{className:"w-full flex justify-between",children:[h.jsx("div",{className:"w-[2px] h-[2px] bg-current"}),h.jsx("div",{className:"w-[2px] h-[2px] bg-current"})]}),h.jsx("div",{className:"w-full h-[2px] bg-current"})]})})]}),h.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>Ht(U),className:"flex-1 py-2.5 bg-black border border-white/10 hover:border-[var(--neon-purple)] text-white rounded-lg text-xs font-black uppercase transition-all font-righteous",children:"LOG"}),h.jsx("button",{onClick:()=>wr(U),className:"flex-1 py-2.5 bg-black border border-white/10 hover:border-[var(--neon-purple)] text-white rounded-lg text-xs font-black uppercase transition-all font-righteous",children:"EDIT"}),h.jsx("button",{onClick:()=>$t(U),className:"flex-[2] py-2.5 bg-[var(--neon-cyan)]/20 text-[var(--neon-cyan)] hover:text-black rounded-lg text-xs font-black uppercase transition-all font-righteous hover:bg-[var(--neon-cyan)]",children:"AUTO-SET"})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>It(U),className:"flex-[4] py-2.5 bg-slate-900 border border-white/5 hover:border-[var(--neon-pink)] text-slate-500 hover:text-white rounded-lg flex items-center justify-center gap-2 transition-all text-xs font-black uppercase font-righteous",children:"MANUAL SELECT"}),h.jsx("button",{onClick:()=>{Xt("Erase this record permanently?",async()=>{await Df(U.id),await _e()})},className:"flex-1 py-2.5 bg-rose-500/5 text-rose-500/20 hover:text-rose-500 border border-transparent hover:border-rose-500/30 rounded-lg transition-all flex items-center justify-center",children:""})]})]})]},U.id)})}),ee.length===0&&T.length===0&&h.jsx("div",{className:"text-center py-24 bg-black/20 rounded-[3rem] border-2 border-dashed border-white/5",children:h.jsx("p",{className:"text-slate-800 text-base font-black uppercase tracking-[0.5em] font-righteous",children:"EMPTY DIRECTORY - NO SIGNALS DETECTED"})})]})]})})()})})]})}),(l||I||R||j||d||g)&&h.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-[100] backdrop-blur-xl",children:h.jsx("div",{className:"w-full max-w-md",children:(()=>{let T={singerName:"",songName:"",artist:"",youtubeUrl:"",type:ft.SINGING},ee="Global Track Input";if(R&&je)if(R.type==="favorite"){const U=je.favorites.find(oe=>oe.id===R.itemId);U&&(T={singerName:je.name,songName:U.songName,artist:U.artist,youtubeUrl:U.youtubeUrl||"",type:U.type},ee=`Edit Permanent Favorite for ${je.name}`)}else{const U=je.personalHistory.find(oe=>oe.id===R.itemId);U&&(T={singerName:je.name,songName:U.songName,artist:U.artist,youtubeUrl:U.youtubeUrl||"",type:U.type},ee=`Edit History Entry for ${je.name}`)}else I?(T={singerName:I.participantName,songName:I.songName,artist:I.artist,youtubeUrl:I.youtubeUrl||"",type:I.type},ee="Modify Track"):g?(T={singerName:"",songName:g.songName,artist:g.artist,youtubeUrl:g.youtubeUrl||"",type:g.type},ee="Edit Verified Song"):d?(T={singerName:"",songName:"",artist:"",youtubeUrl:"",type:ft.SINGING},ee="Add to Verified Songbook"):j&&(T.singerName=j.name,ee=`Song for ${j.name}`);return h.jsx(lA,{title:ee,showSingerName:!R&&!g&&!d,initialSingerName:T.singerName,initialSongName:T.songName,initialArtist:T.artist,initialYoutubeUrl:T.youtubeUrl,initialType:T.type,submitLabel:I||R||g?"Save Update":d?"Add to Library":"Queue Track",onSubmit:xr,onCancel:Pi,participants:e.participants},(I==null?void 0:I.id)||(R==null?void 0:R.itemId)||(j==null?void 0:j.id)||(g==null?void 0:g.id)||(d?"new-verified":"new-request"))})()})}),(x||Bt)&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[200] backdrop-blur-3xl animate-in fade-in duration-500",children:h.jsxs("div",{className:"w-full max-w-2xl bg-[#0a0a0a] border-4 border-white/10 rounded-[3rem] p-8 relative overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] animate-in zoom-in-95 duration-500",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-cyan)] via-[var(--neon-purple)] to-[var(--neon-pink)] animate-gradient-x"}),h.jsxs("div",{className:"flex justify-between items-start mb-6",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tight font-bungee neon-glow-white",children:Bt?"USER SINC":"JOIN ROOM"}),Bt&&h.jsxs("p",{className:"text-[var(--neon-cyan)] text-xs font-black uppercase tracking-widest font-righteous mt-1",children:["TARGET: ",Bt.name]})]}),h.jsx("button",{onClick:()=>{E(!1),Xn(null)},className:"text-slate-600 hover:text-white p-2 font-black text-3xl transition-colors",children:""})]}),h.jsx("div",{className:"flex flex-col items-center gap-4",children:(()=>{const T=cp(),ee=T.includes("localhost")||T.includes("127.0.0.1"),U=Ue=>{const Rt=Ue.replace(/\/$/,"")+"/";return Bt?`${Rt}?userId=${Bt.id}&room=${Ot||""}`:`${Rt}?room=${Ot||""}`};if(!ee){const Ue=U(T);return h.jsxs(h.Fragment,{children:[h.jsx("p",{className:"text-[var(--neon-green)] font-black uppercase tracking-[0.2em] text-[10px] font-righteous self-start",children:" LIVE URL  SCAN TO JOIN"}),h.jsx("div",{className:"bg-white p-4 rounded-2xl w-full max-w-sm mx-auto shadow-[0_0_40px_rgba(255,255,255,0.1)] hover:scale-105 transition-transform",children:h.jsx(Tw,{value:Ue,size:300,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}),h.jsx("div",{className:"w-full p-3 bg-[var(--neon-green)]/10 border border-[var(--neon-green)]/30 rounded-xl",children:h.jsx("p",{className:"text-[10px] font-mono text-[var(--neon-green)] break-all text-center",children:Ue})})]})}const oe=Ce.trim()?Ce.trim().startsWith("http")?Ce.trim():`http://${Ce.trim()}:5173/SingMode-v.2/`:null,ye=oe?U(oe):"http://enter-your-ip-below";return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"w-full p-3 bg-rose-500/20 border border-rose-500/40 rounded-xl",children:[h.jsx("p",{className:"text-rose-400 text-[10px] font-black uppercase tracking-widest text-center",children:" LOCALHOST  phones can't connect via this URL"}),h.jsx("p",{className:"text-slate-500 text-[10px] text-center mt-1 font-mono",children:"Deploy to GitHub Pages for automatic public URLs, or enter your LAN IP below"})]}),h.jsx("p",{className:"text-[var(--neon-yellow)] font-black uppercase tracking-[0.2em] text-[10px] font-righteous self-start",children:"MANUAL NETWORK IP"}),h.jsx("div",{className:"bg-white p-4 rounded-2xl w-full max-w-sm mx-auto shadow-[0_0_40px_rgba(255,255,255,0.1)] hover:scale-105 transition-transform",children:h.jsx(Tw,{value:ye,size:300,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}),h.jsx("div",{className:"w-full p-3 bg-black/60 border border-white/10 rounded-xl",children:h.jsx("p",{className:"text-[10px] font-mono text-[var(--neon-cyan)] break-all text-center",children:oe?ye:"Enter IP below to generate URL"})}),h.jsx("input",{type:"text",value:Ce,onChange:Ue=>Ve(Ue.target.value),placeholder:"e.g. 192.168.0.160",className:"w-full bg-black border-2 border-[var(--neon-yellow)]/40 focus:border-[var(--neon-yellow)] rounded-xl px-4 py-3 text-white font-mono text-sm outline-none transition-all placeholder:text-slate-600"}),h.jsx("button",{onClick:()=>{py(Ce.trim())},className:"w-full py-3 bg-[var(--neon-yellow)] text-black rounded-xl font-black text-xs uppercase tracking-widest hover:bg-white transition-all font-righteous",children:"SAVE & USE THIS IP"})]})})()}),h.jsx("div",{className:"mt-6 p-3 bg-white/5 rounded-2xl border border-white/5 text-center",children:h.jsx("p",{className:"text-[var(--neon-cyan)] font-black uppercase tracking-widest text-sm font-righteous",children:Bt?"AUTO-LOGIN ENABLED":`ROOM ID: ${Ot}`})})]})}),_t&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[200] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-xl bg-[#050510] border-4 border-white/10 p-12 rounded-[3.5rem] shadow-[0_0_100px_rgba(0,0,0,0.8)] relative overflow-hidden animate-in zoom-in-95 duration-300",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsx("h3",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-glow-purple",children:"Signal Origin"}),h.jsx("p",{className:"text-base text-[var(--neon-cyan)] font-black uppercase tracking-[0.4em] mb-12 font-righteous opacity-80",children:"Set the endpoint for guest terminal connections"}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"bg-black/40 p-8 rounded-[2rem] border-2 border-white/5 border-dashed",children:[h.jsx("p",{className:"text-sm text-slate-500 uppercase font-black mb-3 tracking-[0.3em] font-righteous",children:"LOCAL ENVIRONMENT DETECTION"}),h.jsxs("div",{className:"text-xl text-[var(--neon-cyan)] font-mono font-black tracking-widest",children:[window.location.hostname," ",h.jsx("span",{className:"text-sm text-slate-700 opacity-60",children:"(CURRENT HOST)"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-black text-slate-500 uppercase mb-4 ml-4 tracking-[0.3em] font-righteous",children:"TERMINAL ADDRESS / PUBLIC TUNNEL URL"}),h.jsx("input",{type:"text",value:Ce,onChange:T=>Ve(T.target.value),placeholder:"E.G. 192.168.1.15 OR HTTPS://SIGNAL.NGROK.APP",className:"w-full bg-black border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-black uppercase font-mono tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all placeholder:text-slate-800 text-lg"})]}),h.jsx("div",{className:"bg-[var(--neon-pink)]/5 border border-[var(--neon-pink)]/10 p-6 rounded-2xl",children:h.jsx("p",{className:"text-sm text-[var(--neon-pink)]/60 font-black leading-relaxed uppercase tracking-widest font-righteous italic",children:"Note: Cross-network connectivity requires tunneling (ngrok) for public-private bridge."})}),h.jsxs("div",{className:"flex gap-4 pt-6",children:[h.jsx("button",{onClick:()=>X(!1),className:"flex-1 py-4 bg-black border border-white/10 text-white rounded-xl text-sm font-black uppercase tracking-widest font-righteous hover:bg-white/5",children:"ABORT"}),h.jsx("button",{onClick:Fr,className:"flex-[2] py-4 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-black uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white transition-all hover:scale-105",children:"AUTHORIZE CONFIG"})]})]})]})}),wt&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[200] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-4xl bg-[#0a0a0a] border-4 border-white/10 rounded-[4rem] overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] flex flex-col max-h-[90vh] relative animate-in zoom-in-95 duration-300",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsxs("div",{className:"p-8 border-b-2 border-white/5 flex justify-between items-center bg-black/40 backdrop-blur-xl",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-5xl font-black text-white font-bungee uppercase tracking-tight neon-glow-pink",children:"Signal Selection"}),h.jsxs("p",{className:"text-base text-[var(--neon-cyan)] font-black uppercase tracking-[0.4em] mt-1 font-righteous opacity-80",children:["Verified Catalog  Target: ",h.jsx("span",{className:"text-[var(--neon-pink)]",children:wt.name})]})]}),h.jsx("button",{onClick:()=>It(null),className:"text-slate-600 hover:text-white p-3 font-black text-4xl transition-colors transform hover:scale-110",children:""})]}),h.jsx("div",{className:"p-6 bg-black/20 border-b-2 border-white/5",children:h.jsxs("div",{className:"relative group",children:[h.jsx("input",{type:"text",placeholder:"FILTER VERIFIED TRANSMISSIONS...",value:sr,onChange:T=>dn(T.target.value),className:"w-full bg-[#050510] border-2 border-white/10 rounded-2xl px-12 py-4 text-white font-black uppercase tracking-widest font-righteous outline-none focus:border-[var(--neon-pink)] transition-all shadow-inner placeholder:text-slate-700 text-xl"}),h.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-700 group-focus-within:text-[var(--neon-pink)] transition-colors",children:h.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[h.jsx("circle",{cx:"11",cy:"11",r:"8"}),h.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]})}),h.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6",children:[sr&&Dn.length===0&&h.jsx("div",{className:"text-center py-20 opacity-50",children:h.jsx("p",{className:"text-xl font-black uppercase tracking-widest text-slate-600 font-righteous",children:"NO MATCHING TRANSMISSIONS"})}),!sr&&Er.length===0&&h.jsx("div",{className:"text-center py-20 opacity-50",children:h.jsx("p",{className:"text-xl font-black uppercase tracking-widest text-slate-600 font-righteous",children:"NO VERIFIED SONGS IN LIBRARY"})}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(sr?Dn:Er).map(T=>h.jsxs("div",{className:"bg-black/40 border-2 border-white/5 rounded-2xl p-4 relative overflow-hidden group hover:border-[var(--neon-pink)] transition-all",children:[h.jsx("h3",{className:"text-lg font-black text-white uppercase truncate font-righteous",children:T.songName}),h.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-wider mb-4 font-righteous",children:T.artist}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>Vi(T),className:"flex-1 py-2 bg-[var(--neon-pink)]/20 text-[var(--neon-pink)] hover:text-black rounded-lg text-xs font-black uppercase transition-all font-righteous hover:bg-[var(--neon-pink)]",children:"SELECT"}),h.jsx("button",{onClick:()=>Zo(T),className:"flex-1 py-2 bg-black border border-white/10 hover:border-[var(--neon-pink)] text-white rounded-lg text-xs font-black uppercase transition-all font-righteous",children:"EDIT"})]})]},T.id))})]}),h.jsx("div",{className:"p-6 border-t-2 border-white/5 flex justify-end bg-black/40 backdrop-blur-xl",children:h.jsx("button",{onClick:()=>p(!0),className:"py-3 px-6 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-black uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white transition-all hover:scale-105",children:"ADD NEW VERIFIED SONG"})})]})}),h.jsx("style",{children:`
        @keyframes gradient-x {
          0%, 100% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
        }
        .animate-gradient-x {
          background-size: 200% 200%;
          animation: gradient-x 3s ease infinite;
        }
        .neon-glow-pink {
          text-shadow: 0 0 10px rgba(255, 0, 255, 0.5), 0 0 20px rgba(255, 0, 255, 0.3);
        }
        .neon-glow-cyan {
          text-shadow: 0 0 10px rgba(0, 229, 255, 0.5), 0 0 20px rgba(0, 229, 255, 0.3);
        }
        .neon-glow-purple {
          text-shadow: 0 0 10px rgba(167, 139, 250, 0.5), 0 0 20px rgba(167, 139, 250, 0.3);
        }
        .neon-glow-green {
           text-shadow: 0 0 10px rgba(0, 255, 157, 0.5), 0 0 20px rgba(0, 255, 157, 0.3);
        }
        .neon-glow-white {
           text-shadow: 0 0 10px rgba(255, 255, 255, 0.5), 0 0 20px rgba(255, 255, 255, 0.3);
        }
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: rgba(255, 255, 255, 0.02);
          border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: rgba(255, 255, 255, 0.1);
          border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 255, 255, 0.2);
        }
      `}),kn==="ADMIN"&&h.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:h.jsxs("div",{className:"bg-[#0a0a10]/90 backdrop-blur-2xl rounded-[3rem] p-10 border border-white/5 shadow-2xl relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-[var(--neon-green)]/10 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/4 pointer-events-none"}),h.jsx("div",{className:"flex justify-between items-center mb-10 relative z-10",children:h.jsxs("div",{children:[h.jsxs("h2",{className:"text-4xl font-bold font-bungee text-white uppercase flex items-center gap-4 neon-glow-green",children:[h.jsx("span",{className:"text-5xl",children:""})," SESSION CONTROL"]}),h.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest mt-2 font-righteous",children:"MANAGE ACTIVE INSTANCES"})]})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[Ts.map(T=>h.jsxs("div",{className:"bg-black/40 border-2 border-white/5 rounded-[2rem] p-6 relative overflow-hidden group hover:border-[var(--neon-green)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsx("div",{className:"w-12 h-12 bg-black rounded-xl border border-white/10 flex items-center justify-center text-2xl",children:T.id===(e==null?void 0:e.id)?"":""}),h.jsx("div",{className:`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest border ${T.id===(e==null?void 0:e.id)?"bg-[var(--neon-cyan)]/20 text-[var(--neon-cyan)] border-[var(--neon-cyan)]":"bg-slate-800 text-slate-400 border-white/10"}`,children:T.id===(e==null?void 0:e.id)?"CURRENT":"REMOTE"})]}),h.jsx("h3",{className:"text-xl font-black text-white uppercase truncate font-bungee mb-1",children:T.venueName||"Unknown Venue"}),h.jsxs("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-wider mb-6 font-righteous",children:["HOST: ",T.hostName,"  ID: ",T.id]}),h.jsx("button",{onClick:()=>{Xt(`Force close session "${T.venueName}"? This cannot be undone.`,async()=>{await aA(T.id)})},className:"w-full py-3 bg-rose-500/10 text-rose-500 hover:bg-rose-500 hover:text-white border border-rose-500/30 rounded-xl font-black uppercase tracking-widest text-xs transition-all font-righteous",children:"FORCE CLOSE"})]},T.id)),Ts.length===0&&h.jsx("div",{className:"col-span-full text-center py-20 opacity-50",children:h.jsx("p",{className:"text-xl font-black uppercase tracking-widest text-slate-600 font-righteous",children:"NO ACTIVE SESSIONS FOUND"})})]})]})}),kn==="SESSION"&&h.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:h.jsxs("div",{className:"bg-[#0a0a10]/90 backdrop-blur-2xl rounded-[3rem] p-10 border border-white/5 shadow-2xl relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-[var(--neon-purple)]/10 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/4 pointer-events-none"}),h.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[h.jsxs("div",{children:[h.jsxs("h2",{className:"text-4xl font-bold font-bungee text-white uppercase flex items-center gap-4 neon-glow-purple",children:[h.jsx("span",{className:"text-5xl",children:""})," DAY_SHOW SESSION"]}),h.jsx("p",{className:"text-slate-400 mt-2 font-mono",children:"Monitor all connected devices and manage active synchronization."})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("div",{className:"px-6 py-3 bg-white/5 rounded-2xl border border-white/10 flex items-center gap-3",children:[h.jsx("span",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest font-righteous",children:"STATUS"}),h.jsx("span",{className:`text-xl font-black ${Ot?"text-[var(--neon-green)]":"text-rose-500"} uppercase font-bungee`,children:Ot?"ACTIVE":"OFFLINE"})]}),h.jsxs("div",{className:"px-6 py-3 bg-white/5 rounded-2xl border border-white/10 flex items-center gap-3",children:[h.jsx("span",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest font-righteous",children:"ROOM"}),h.jsx("span",{className:"text-2xl font-black text-white font-mono",children:Ot||"----"})]})]})]}),Ot?h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[(Li=e.deviceConnections)==null?void 0:Li.map(T=>{var ye;const ee=T.status==="connected",U=T.userId?n.find(Ue=>Ue.id===T.userId)||((ye=e.participants)==null?void 0:ye.find(Ue=>Ue.id===T.userId)):null,oe=T.isGuest||(U&&"isGuest"in U?U.isGuest:!1);return h.jsxs("div",{className:`p-6 rounded-[2rem] border transition-all relative overflow-hidden group ${ee?"bg-[#151520] border-[var(--neon-purple)]/30 hover:border-[var(--neon-purple)]":"bg-[#05050A] border-white/5 opacity-60"}`,children:[h.jsx("div",{className:`absolute top-6 right-6 w-3 h-3 rounded-full ${ee?"bg-[var(--neon-green)] shadow-[0_0_10px_var(--neon-green)]":"bg-rose-500"}`}),h.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[h.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl shadow-lg ${U?oe?"bg-[var(--neon-orange)]/20 text-[var(--neon-orange)]":"bg-[var(--neon-blue)]/20 text-[var(--neon-blue)]":"bg-white/5 text-slate-500"}`,children:U?oe?"":"":""}),h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xl font-bold text-white font-righteous tracking-wide flex items-center gap-3",children:[T.id,oe&&h.jsx("span",{className:"px-2 py-0.5 rounded bg-rose-500 text-[8px] font-black text-white",children:"GUEST"})]}),h.jsxs("div",{className:"text-xs font-mono text-slate-500 mt-1 flex flex-col gap-1",children:[h.jsx("div",{className:"truncate max-w-[150px]",title:T.peerId,children:T.peerId}),T.userAgent&&h.jsx("div",{className:"text-[10px] text-[var(--neon-cyan)]/60 font-black uppercase flex items-center gap-1",children:T.userAgent.toLowerCase().includes("mobile")?" MOBILE":" DESKTOP"})]}),h.jsx("div",{className:`mt-2 text-xs font-bold uppercase tracking-widest px-2 py-0.5 rounded inline-block ${ee?"bg-[var(--neon-green)]/10 text-[var(--neon-green)]":"bg-rose-500/10 text-rose-500"}`,children:T.status})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"p-4 bg-black/40 rounded-xl border border-white/5",children:[h.jsx("div",{className:"text-[10px] uppercase text-slate-500 font-bold tracking-widest mb-1",children:"Assigned Session"}),h.jsx("div",{className:"text-white font-medium truncate",children:U?U.name:h.jsx("span",{className:"text-slate-600 italic",children:"Unassigned"})})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>{const Ue=prompt("Enter User Name to link (must exist in Directory):");if(Ue){const Rt=n.find(Tr=>Tr.name.toLowerCase()===Ue.toLowerCase());Rt?(xP(T.id,Rt.id,Rt.isGuest),_e()):alert("User not found!")}},className:"flex-1 py-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-white/20 text-sm font-bold text-white transition-all",children:U?"CHANGE":"LINK USER"}),h.jsx("button",{onClick:()=>{Xt("Forget this device?",async()=>{await _P(T.id),_e()})},className:"px-4 py-3 rounded-xl bg-rose-500/10 hover:bg-rose-500/20 border border-rose-500/20 text-rose-500 transition-all",children:"Forget"})]})]})]},T.id)}),(!e.deviceConnections||e.deviceConnections.length===0)&&h.jsx("div",{className:"col-span-full py-20 text-center text-slate-500 font-mono",children:"No devices detected yet. Scan the QR code to connect."})]}):h.jsx("div",{className:"flex items-center justify-center py-20",children:h.jsxs("div",{className:"max-w-xl w-full bg-[#0a0a0a] border-4 border-dashed border-white/5 rounded-[4rem] p-16 text-center",children:[h.jsx("div",{className:"w-24 h-24 bg-[var(--neon-purple)]/10 text-[var(--neon-purple)] rounded-[2.5rem] flex items-center justify-center text-5xl mx-auto mb-10 shadow-[0_0_50px_rgba(180,0,255,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-4xl font-black text-white uppercase mb-4 font-bungee tracking-tight",children:"OPEN BROADCAST"}),h.jsxs("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs mb-10 font-righteous leading-relaxed",children:["ACTIVATE THE WORLDWIDE SYNC PROTOCOL. ",h.jsx("br",{}),"ALLOW SINGER CONNECTIONS AND REMOTE COMMANDS."]}),h.jsx("button",{onClick:()=>Ae(!0),className:"mb-10 px-6 py-3 bg-white/5 hover:bg-white/10 rounded-2xl border border-white/10 flex items-center justify-center gap-3 text-xs font-black text-slate-400 hover:text-white transition-all uppercase tracking-[0.2em] font-righteous mx-auto shadow-inner",children:" VIEW SESSION HISTORY"}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] font-black text-[var(--neon-purple)] uppercase tracking-[0.3em] mb-3 font-righteous",children:"SESSION NAME / ROOM ID"}),h.jsx("input",{type:"text",value:M,onChange:T=>ne(T.target.value.toUpperCase().replace(/\s+/g,"_")),className:"w-full bg-black border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-mono text-center text-2xl tracking-widest focus:border-[var(--neon-purple)] outline-none transition-all"})]}),h.jsx("button",{onClick:()=>zr(),disabled:fe||!M,className:"w-full py-6 bg-[var(--neon-purple)] text-white rounded-[1.5rem] font-black uppercase tracking-[0.2em] text-xl shadow-[0_0_40px_rgba(180,0,255,0.4)] hover:scale-105 hover:bg-fuchsia-500 transition-all disabled:opacity-50 disabled:scale-100 font-righteous",children:fe?"INITIALIZING...":"OPEN DAY_SHOW SESSION"}),Js&&Js!==M&&h.jsxs("button",{onClick:()=>zr(Js),disabled:fe,className:"w-full py-4 bg-black border-2 border-[var(--neon-cyan)] text-[var(--neon-cyan)] rounded-[1.5rem] font-black uppercase tracking-[0.2em] text-sm shadow-[0_0_20px_rgba(0,229,255,0.2)] hover:bg-[var(--neon-cyan)]/10 transition-all font-righteous mt-4",children:["RECONNECT TO PREVIOUS: ",Js]})]})]})}),Ot&&h.jsxs("div",{className:"mt-10 p-8 bg-black/40 rounded-[2.5rem] border border-white/5 relative overflow-hidden animate-in slide-in-from-bottom-4 duration-700",children:[h.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[var(--neon-cyan)]/5 blur-[80px] rounded-full -mr-32 -mt-32 pointer-events-none"}),h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight font-bungee neon-text-glow-cyan",children:"Live Session Log"}),h.jsx("span",{className:"px-3 py-1 rounded-full bg-[var(--neon-cyan)]/10 border border-[var(--neon-cyan)]/30 text-[9px] font-black text-[var(--neon-cyan)] uppercase tracking-widest animate-pulse",children:" REALTIME_FEED"})]}),h.jsxs("div",{className:"space-y-3 max-h-64 overflow-y-auto pr-4 no-scrollbar custom-scrollbar",children:[(hs=e.logs)==null?void 0:hs.slice().reverse().map((T,ee)=>h.jsxs("div",{className:"flex gap-4 items-start animate-in slide-in-from-left-2 duration-300 group",children:[h.jsxs("span",{className:"text-[10px] font-mono text-slate-600 shrink-0 mt-0.5 group-hover:text-slate-400 transition-colors",children:["[",new Date(T.timestamp).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),"]"]}),h.jsx("span",{className:`text-xs font-righteous uppercase tracking-wide px-2 py-0.5 rounded ${T.type==="error"?"text-rose-500 bg-rose-500/5":T.type==="warn"?"text-[var(--neon-yellow)] bg-[var(--neon-yellow)]/5":"text-slate-300 group-hover:text-white transition-colors"}`,children:T.message})]},ee)),(!e.logs||e.logs.length===0)&&h.jsx("div",{className:"text-center py-10 text-slate-700 font-black uppercase tracking-widest text-[10px] italic",children:"AWAITING_INITIAL_SYNC_EVENTS..."})]})]})]})}),ue&&h.jsx("div",{className:"fixed inset-0 bg-black/98 flex items-center justify-center p-6 z-[400] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-4xl bg-[#050510] border-4 border-[var(--neon-purple)]/30 rounded-[4rem] p-12 shadow-[0_0_100px_rgba(180,0,255,0.2)] flex flex-col max-h-[85vh] relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-[var(--neon-purple)]/5 blur-[100px] rounded-full -mr-48 -mt-48 pointer-events-none"}),h.jsxs("div",{className:"flex justify-between items-center mb-12",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-5xl font-black text-white uppercase tracking-tight font-bungee neon-text-glow-purple",children:"SESSION_HISTORY"}),h.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-[0.2em] text-xs mt-2 font-righteous",children:"ARCHIVE OF PREVIOUS SINGMODE V.2 BROADCASTS"})]}),h.jsx("button",{onClick:()=>Ae(!1),className:"w-16 h-16 rounded-full bg-white/5 hover:bg-white/10 border border-white/10 flex items-center justify-center text-2xl transition-all",children:""})]}),h.jsx("div",{className:"flex-1 overflow-y-auto pr-4 space-y-4 no-scrollbar",children:He.length===0?h.jsx("div",{className:"py-32 text-center text-slate-600 font-black uppercase tracking-widest font-righteous italic",children:"NO PREVIOUS SESSIONS RECORDED"}):h.jsx("div",{className:"grid gap-4",children:He.map(T=>h.jsxs("div",{className:"p-8 bg-white/5 rounded-[2.5rem] border border-white/5 hover:border-white/10 transition-all group flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-8",children:[h.jsx("div",{className:"w-20 h-20 rounded-2xl bg-[var(--neon-purple)]/10 border border-[var(--neon-purple)]/20 flex flex-col items-center justify-center",children:h.jsx("span",{className:"text-2xl",children:""})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-2xl font-black text-white uppercase tracking-tight font-righteous",children:T.venueName||"Main Lounge"}),h.jsxs("div",{className:"flex items-center gap-4 mt-1 text-slate-500 font-mono text-sm",children:[h.jsxs("span",{children:["ID: ",T.id]}),h.jsx("span",{children:""}),h.jsx("span",{children:new Date(T.startedAt).toLocaleDateString()})]})]})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 mb-1 font-righteous",children:"Duration"}),h.jsx("div",{className:"text-white font-mono text-xl",children:T.endedAt?Math.floor((T.endedAt-T.startedAt)/(60*1e3))+" MINS":"---"})]})]},T.id))})})]})}),cs.isOpen&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[300] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-md bg-[#050510] border-4 border-[var(--neon-pink)]/30 rounded-[3rem] p-10 text-center shadow-[0_0_100px_rgba(255,42,109,0.3)] animate-in zoom-in-95 duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-[var(--neon-pink)] shadow-[0_0_20px_rgba(255,42,109,0.8)]"}),h.jsx("div",{className:"w-20 h-20 bg-[var(--neon-pink)]/10 text-[var(--neon-pink)] rounded-[2rem] border-2 border-[var(--neon-pink)]/20 flex items-center justify-center mx-auto mb-6 text-4xl font-black shadow-[0_0_30px_rgba(255,42,109,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-text-glow-pink",children:"CONFIRM"}),h.jsx("p",{className:"text-slate-400 text-lg mb-8 leading-relaxed font-black font-righteous uppercase tracking-widest",children:cs.message}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>Ws(T=>({...T,isOpen:!1})),className:"flex-1 py-4 bg-black border-2 border-white/10 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous transition-all hover:bg-white/5",children:"CANCEL"}),h.jsx("button",{onClick:async()=>{Ws(T=>({...T,isOpen:!1})),await cs.onConfirm()},className:"flex-[2] py-4 bg-[var(--neon-pink)] text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous shadow-[0_0_30px_rgba(255,42,109,0.4)] transition-all hover:bg-rose-400 hover:scale-105",children:"PROCEED"})]})]})})]})},WP=({onJoin:s,filterHostName:e})=>{const[t,n]=ie.useState([]),[a,l]=ie.useState(!0);ie.useEffect(()=>{const d=oA(p=>{n(p),l(!1)});return()=>d()},[]);const c=e?t.filter(d=>{var p;return((p=d.hostName)==null?void 0:p.toLowerCase())===e.toLowerCase()}):t;return a?h.jsx("div",{className:"text-center py-20 animate-pulse",children:h.jsx("div",{className:"text-[var(--neon-cyan)] text-xl font-black uppercase tracking-widest font-righteous",children:"SEARCHING FOR STAGES..."})}):c.length===0?h.jsxs("div",{className:"text-center py-20 px-6 bg-black/20 rounded-[3rem] border-2 border-dashed border-white/5 mx-auto max-w-2xl",children:[h.jsx("p",{className:"text-[var(--neon-pink)] text-2xl font-black uppercase tracking-widest font-bungee mb-4",children:"NO STAGES FOUND"}),h.jsx("p",{className:"text-slate-500 font-righteous uppercase tracking-wider text-sm",children:"There are no active sessions nearby."})]}):h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 space-y-6 animate-in fade-in slide-in-from-bottom-8 duration-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"w-3 h-3 bg-[var(--neon-green)] rounded-full animate-ping"}),h.jsx("h2",{className:"text-[var(--neon-green)] font-black uppercase tracking-[0.3em] font-righteous text-lg",children:"LIVE STAGES"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:c.map(d=>h.jsxs("div",{className:"group relative bg-[#101015] border-2 border-white/5 hover:border-[var(--neon-cyan)] p-8 rounded-[2.5rem] transition-all hover:-translate-y-2 hover:shadow-[0_0_50px_rgba(0,229,255,0.15)] overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--neon-cyan)]/0 via-transparent to-[var(--neon-purple)]/0 group-hover:from-[var(--neon-cyan)]/5 group-hover:to-[var(--neon-purple)]/5 transition-all duration-500"}),h.jsxs("div",{className:"relative z-10",children:[h.jsxs("div",{className:"flex justify-between items-start mb-6",children:[h.jsx("div",{className:"w-16 h-16 bg-black border border-white/10 rounded-2xl flex items-center justify-center text-3xl shadow-xl group-hover:scale-110 transition-transform duration-500 group-hover:border-[var(--neon-cyan)]",children:""}),h.jsx("div",{className:"px-3 py-1 bg-[var(--neon-green)]/10 text-[var(--neon-green)] border border-[var(--neon-green)]/20 rounded-lg text-[10px] font-black uppercase tracking-widest font-righteous",children:"ONLINE"})]}),h.jsx("h3",{className:"text-3xl font-bold text-white mb-2 font-bungee uppercase tracking-tight group-hover:text-[var(--neon-cyan)] transition-colors truncate",children:d.venueName||"OPEN MIC"}),h.jsxs("div",{className:"flex items-center gap-2 mb-8 text-slate-400 font-righteous uppercase tracking-wider text-xs",children:[h.jsx("span",{className:"text-[var(--neon-pink)]",children:"HOST:"})," ",d.hostName]}),h.jsx("button",{onClick:()=>s(d.id),className:"w-full py-4 bg-white text-black font-black uppercase tracking-[0.2em] rounded-xl hover:bg-[var(--neon-cyan)] transition-all font-righteous hover:scale-[1.02] active:scale-95 shadow-lg",children:"JOIN STAGE"})]})]},d.id))})]})},ZP=({size:s="md",className:e=""})=>{const t={sm:"w-10 h-10 text-[10px]",md:"w-14 h-14 text-sm",lg:"w-28 h-28 text-2xl"};return h.jsxs("div",{className:`flex items-center gap-4 ${e} group cursor-pointer`,children:[h.jsx("div",{className:`${t[s]} bg-black border-2 border-cyan-400 rounded-2xl flex items-center justify-center font-black text-cyan-400 shadow-[0_0_20px_rgba(34,211,238,0.2)] transition-all group-hover:neon-border-pink group-hover:text-pink-500 group-hover:scale-110 font-bungee`,children:"SM"}),h.jsxs("div",{className:"font-bungee tracking-tighter flex flex-col leading-none",children:[h.jsx("span",{className:"text-pink-500 text-[0.5em] tracking-[0.5em] mb-1 font-righteous uppercase",children:"Terminal"}),h.jsx("span",{className:"text-white uppercase group-hover:neon-glow-pink transition-all",children:"Singmode v.2"})]})]})},zE=({url:s})=>s?h.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",title:"Open Video Link",className:"p-2 rounded-lg text-[var(--neon-cyan)] hover:bg-[var(--neon-cyan)]/20 border border-[var(--neon-cyan)]/30 transition-all shadow-[0_0_10px_rgba(0,229,255,0.2)]",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),h.jsx("polyline",{points:"15 3 21 3 21 9"}),h.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})}):null,e3=()=>{const[s,e]=ie.useState(null),[t,n]=ie.useState(null),[a,l]=ie.useState(!0),[c,d]=ie.useState(""),[p,g]=ie.useState(""),[v,x]=ie.useState(""),[E,A]=ie.useState(""),[O,F]=ie.useState(""),[J,se]=ie.useState(null),[ce,le]=ie.useState(!1),[me,Ee]=ie.useState(null),[be,I]=ie.useState(null),[C,R]=ie.useState("ROTATION"),[L,j]=ie.useState(!1),[P,k]=ie.useState(""),[at,_t]=ie.useState(!1),[X,ue]=ie.useState(0),[Ae,He]=ie.useState(!1),[Je,M]=ie.useState("connecting"),[ne,fe]=ie.useState(void 0),[ve,Ce]=ie.useState([]),[Ve,Be]=ie.useState(!1),Ut=ie.useRef(!1);Me.getMyPeerId();const We=Me.getHostId(),is=cp()+(We?`?room=${We}`:""),Qs=!!(new URLSearchParams(window.location.search).get("room")||new URLSearchParams(window.location.search).get("userId"));ie.useEffect(()=>{We&&$P().then(K=>{const he=K.find(Fe=>Fe.id===We);he&&fe(he.hostName)})},[We]);const[Vr,as]=ie.useState({isOpen:!1,message:"",onConfirm:()=>{}}),vr=(K,he)=>{as({isOpen:!0,message:K,onConfirm:he})};ie.useEffect(()=>{(async()=>{const Xe=new URLSearchParams(window.location.search).get("room"),Ke=We||Xe;Ke&&!Ut.current&&(console.log(`[Participant] Initializing sync for room: ${Ke}`),await tc("PARTICIPANT",Ke),Ut.current=!0);const Ht=new URLSearchParams(window.location.search).get("userId");if(Ht){console.log(`[Participant] SINC Login detected for userId: ${Ht}`);const Dt=await jP(Ht);Dt.success&&Dt.profile&&(n(Dt.profile),l(!1),window.history.replaceState({},"",window.location.pathname+(We?`?room=${We}`:"")))}const Ur=await Qn();if(Ur){n(Ur);const Dt=await At(Ke||void 0);se(Dt);const Sn=Dt.participants.find(an=>an.id===Ur.id);if(Ke&&(!Sn||Dt.id==="current-session")){console.log(`[Participant] Auto-joining session ${Ke} for profile ${Ur.id}`);try{const an=await bi(Ur.id);e(an)}catch(an){console.error("Auto-join failed:",an)}}else Sn&&e(Sn)}else{const Dt=await At(Ke||void 0);se(Dt)}await zt()})();const he=setTimeout(()=>{(!J||!s)&&(console.log("[Participant] Connection timeout, showing reconnect options."),Be(!0))},8e3),Fe=setInterval(()=>{(!J||!s)&&(console.log("[Participant] Proactively requesting state..."),Me.requestState())},4e3);return Me.onConnectionStatus=Xe=>{M(Xe)},Me.onStateReceived=Xe=>{if(console.log("[Participant] State updated via SyncService"),se(Xe),t){const Ke=Xe.participants.find(je=>je.id===t.id);Ke?e(Ke):Xe.id&&Xe.id!=="current-session"&&(console.log("[Sync] Participant not found in live session, auto-joining..."),bi(t.id).then(je=>{e(je)}).catch(je=>{console.error("[Sync] Auto-join failed:",je)}))}Ce(Me.getPendingActions())},Me.onActionReceived=Xe=>{console.log("[Participant] Action received via SyncService:",Xe.type),zt()},()=>{clearTimeout(he),clearInterval(Fe),Me.onConnectionStatus=null,Me.onStateReceived=null,Me.onActionReceived=null}},[t==null?void 0:t.id,We]);const zt=async()=>{const K=await At();se(K);const he=await Qn();if(n(he),he){const Fe=K.participants.find(Xe=>Xe.id===he.id);Fe&&e(Fe)}else e(null);Ce(Me.getPendingActions())};ie.useEffect(()=>(window.addEventListener("kstar_sync",zt),window.addEventListener("storage",zt),()=>{window.removeEventListener("kstar_sync",zt),window.removeEventListener("storage",zt)}),[]);const os=async K=>{K.preventDefault(),d("");try{if(a){const he=await DP(p,E);if(he.success&&he.profile){const Fe=await bi(he.profile.id);e(Fe),n(he.profile)}else d(he.error||"Authorization failed.")}else{if(E!==O){d("PASSWORDS_DO_NOT_MATCH");return}const he=await _h({name:p,email:v||void 0,password:E||void 0},!0);if(he.success&&he.profile){const Fe=await bi(he.profile.id);e(Fe),n(he.profile)}else d(he.error||"Initialization failed.")}}catch(he){d(he.message||"An unexpected error occurred.")}},Ys=async K=>{s&&(await Aa(s.id,K),await zt())},Di=async K=>{s&&(me?(await eh(me.id,{songName:K.songName,artist:K.artist,youtubeUrl:K.youtubeUrl,type:K.type,message:K.message}),Ee(null),await zt()):(await va({participantId:s.id,participantName:s.name,songName:K.songName,artist:K.artist,youtubeUrl:K.youtubeUrl,type:K.type,message:K.message}),le(!1),await zt(),s.status!==Kt.READY&&await Aa(s.id,Kt.READY)),I(null),await zt())},wt=()=>{le(!1),Ee(null),I(null)},It=async()=>{d("");try{const K=`Guest - ${Math.floor(Math.random()*1e4)}`,he=await _h({name:K},!0);if(he.success&&he.profile){const Fe=await bi(he.profile.id);e(Fe),n(he.profile),I(null),le(!0),await Aa(he.profile.id,Kt.READY)}else d(he.error||"Guest initialization failed.")}catch(K){d(K.message||"An unexpected error occurred.")}};if(!s&&!t&&!Qs)return h.jsxs("div",{className:"max-w-2xl mx-auto p-8 flex flex-col items-center justify-center min-h-[90vh] text-center animate-in fade-in duration-1000 relative",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black via-[#10002B] to-black -z-10"}),h.jsxs("div",{className:"w-48 h-48 flex items-center justify-center mb-12 relative group",children:[h.jsx("div",{className:"absolute inset-0 bg-[var(--neon-pink)] blur-[60px] opacity-40 group-hover:opacity-60 transition-opacity"}),h.jsx("div",{className:"p-3 rounded-full border-4 border-white/10 relative z-10 bg-black shadow-2xl",children:h.jsx("div",{className:"rounded-full overflow-hidden border-4 border-[var(--neon-pink)] shadow-[0_0_40px_rgba(255,0,127,0.5)] w-full h-full",children:h.jsx("img",{src:"IGK.jpeg",alt:"Island Groove",className:"w-full h-full object-cover opacity-90 group-hover:opacity-100 transition-opacity"})})})]}),h.jsx("h1",{className:"text-6xl md:text-8xl font-bold font-bungee text-white mb-6 uppercase tracking-tight neon-text-glow-purple leading-none",children:"Singmode v.2"}),h.jsx("p",{className:"text-[var(--neon-cyan)] font-righteous mb-16 uppercase tracking-[0.6em] text-lg font-black neon-glow-cyan",children:"SINGER LOGIN"}),h.jsxs("div",{className:"w-full max-w-lg mb-12 relative z-20",children:[h.jsx("button",{onClick:It,className:"w-full py-8 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-blue)] text-white rounded-[2.5rem] font-black text-4xl shadow-[0_0_60px_rgba(255,0,127,0.4)] uppercase tracking-[0.1em] active:scale-95 transition-all font-bungee hover:brightness-110 border-4 border-white/10 animate-pulse",children:"SING!"}),h.jsx("p",{className:"text-slate-500 font-righteous uppercase tracking-widest text-xs mt-4",children:"GUEST PASS"})]}),h.jsxs("div",{className:"relative w-full max-w-lg",children:[h.jsx("div",{className:"absolute inset-0 flex items-center mb-8",children:h.jsx("div",{className:"w-full border-t border-white/10"})}),h.jsx("div",{className:"relative flex justify-center mb-8",children:h.jsx("span",{className:"bg-black px-4 text-slate-500 font-righteous uppercase tracking-widest text-sm",children:"MEMBER LOGIN"})})]}),h.jsxs("form",{onSubmit:os,className:"w-full space-y-8 bg-[#050510] p-10 md:p-14 rounded-[4rem] border-4 border-white/5 shadow-[0_0_100px_rgba(0,0,0,0.8)] relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)]"}),c&&h.jsx("div",{className:"bg-rose-500/10 border border-rose-500/30 text-rose-500 text-base py-4 px-6 rounded-2xl font-black uppercase tracking-widest animate-pulse font-righteous",children:c}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-base font-black text-slate-500 uppercase tracking-[0.3em] mb-3 text-left font-righteous ml-4",children:"STAGE NAME"}),h.jsx("input",{type:"text",required:!0,value:p,onChange:K=>g(K.target.value),placeholder:"Stage Name",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-bold focus:border-[var(--neon-cyan)] outline-none transition-all shadow-inner text-2xl uppercase tracking-wider placeholder:text-slate-600 font-righteous"})]}),!a&&h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-base font-black text-slate-500 uppercase tracking-[0.3em] mb-3 text-left font-righteous ml-4",children:"EMAIL (OPTIONAL)"}),h.jsx("input",{type:"email",value:v,onChange:K=>x(K.target.value),placeholder:"myname@emailserver.com",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-bold focus:border-[var(--neon-purple)] outline-none transition-all shadow-inner text-xl tracking-wider placeholder:text-slate-600 font-righteous"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-base font-black text-slate-500 uppercase tracking-[0.3em] mb-3 text-left font-righteous ml-4",children:"PASSWORD"}),h.jsx("input",{type:"password",required:!a,value:E,onChange:K=>A(K.target.value),placeholder:"",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-bold focus:border-[var(--neon-pink)] outline-none transition-all shadow-inner text-3xl tracking-wider placeholder:text-slate-600 font-righteous"})]}),!a&&h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-base font-black text-slate-500 uppercase tracking-[0.3em] mb-3 text-left font-righteous ml-4",children:"CONFIRM PASSWORD"}),h.jsx("input",{type:"password",required:!0,value:O,onChange:K=>F(K.target.value),placeholder:"",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-bold focus:border-[var(--neon-pink)] outline-none transition-all shadow-inner text-3xl tracking-wider placeholder:text-slate-600 font-righteous"})]}),h.jsx("button",{type:"submit",className:"w-full py-6 mt-6 bg-[var(--neon-pink)] hover:bg-white hover:text-black text-white rounded-2xl font-black text-3xl shadow-[0_0_40px_rgba(255,0,127,0.3)] transition-all uppercase tracking-[0.2em] font-bungee hover:scale-[1.02] active:scale-95",children:a?"SIGN IN":"CREATE PROFILE"}),h.jsx("button",{type:"button",onClick:()=>{l(!a),d("")},className:"text-slate-600 hover:text-[var(--neon-cyan)] text-sm font-black uppercase tracking-[0.3em] pt-6 block mx-auto transition-colors font-righteous border-b-2 border-transparent hover:border-[var(--neon-cyan)] pb-1",children:a?"CREATE ACCOUNT":"BACK TO START"})]})]});if(!J||!s)return h.jsxs("div",{className:"min-h-screen bg-[#050510] flex flex-col items-center justify-center p-8 space-y-12",children:[h.jsx("div",{className:"scale-125 mb-8",children:h.jsx(ZP,{})}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute -inset-4 bg-[var(--neon-cyan)]/10 rounded-full blur-xl animate-pulse"}),h.jsxs("div",{className:"relative w-32 h-32",children:[h.jsx("div",{className:"absolute inset-0 border-4 border-[var(--neon-cyan)]/10 border-t-[var(--neon-cyan)] rounded-full animate-spin shadow-[0_0_20px_rgba(0,229,255,0.4)]"}),h.jsx("div",{className:"absolute inset-4 border-4 border-[var(--neon-pink)]/10 border-b-[var(--neon-pink)] rounded-full animate-spin shadow-[0_0_20px_rgba(255,42,109,0.4)]",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),h.jsx("div",{className:"absolute inset-8 border-4 border-white/5 border-l-white/40 rounded-full animate-spin",style:{animationDuration:"3s"}})]})]}),h.jsxs("div",{className:"text-center space-y-4 max-w-xs transition-all",children:[h.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-[0.4em] font-bungee animate-pulse drop-shadow-[0_0_10px_rgba(255,255,255,0.3)]",children:"Connecting"}),h.jsx("div",{className:"h-1 w-24 bg-gradient-to-r from-transparent via-[var(--neon-cyan)] to-transparent mx-auto opacity-50"}),h.jsx("p",{className:"text-slate-400 font-righteous tracking-[0.2em] text-xs uppercase leading-relaxed",children:We?h.jsxs(h.Fragment,{children:["Syncing with Room",h.jsx("br",{}),h.jsx("span",{className:"text-[var(--neon-cyan)] font-bold",children:We})]}):"Waiting for session data..."})]}),Ve&&h.jsxs("div",{className:"flex flex-col gap-3 w-full max-w-xs animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-300",children:[h.jsxs("button",{onClick:async()=>{Be(!1);const K=new URLSearchParams(window.location.search).get("room");K?(console.log("[Participant] Manual RECONNECT triggered"),await tc("PARTICIPANT",K),await zt()):window.location.search=""},className:"w-full py-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl text-[var(--neon-cyan)] font-black uppercase tracking-widest text-xs transition-all flex items-center justify-center gap-2",children:[h.jsx("span",{children:"RECONNECT"}),h.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[var(--neon-cyan)] animate-pulse"})]}),h.jsx("button",{onClick:()=>window.location.search="",className:"w-full py-4 bg-transparent hover:bg-white/5 border border-white/10 rounded-2xl text-slate-500 hover:text-white font-black uppercase tracking-widest text-[10px] transition-all",children:"CHANGE ROOM"})]}),h.jsx("div",{className:"fixed bottom-12 left-0 right-0 flex justify-center",children:h.jsxs("div",{className:"px-4 py-2 bg-black/40 backdrop-blur-md border border-white/5 rounded-full flex items-center space-x-3",children:[h.jsx("div",{className:`w - 2 h - 2 rounded - full animate - ping ${Je==="connected"?"bg-green-500":"bg-amber-500"} `}),h.jsxs("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:["Network: ",Je]})]})})]});const Xs=J.requests.filter(K=>K.participantId===s.id&&K.status!==Pe.DONE),sr=J.requests.filter(K=>K.status===Pe.APPROVED&&K.type===ft.SINGING&&!K.isInRound),dn=J.participants.filter(K=>sr.some(he=>he.participantId===K.id)).sort((K,he)=>(he.joinedAt||0)-(K.joinedAt||0)),Bt={};sr.forEach(K=>{Bt[K.participantId]||(Bt[K.participantId]=[]),Bt[K.participantId].push(K)}),Object.keys(Bt).forEach(K=>{Bt[K].sort((he,Fe)=>he.createdAt-Fe.createdAt)});const Xn=[];let Jn=0,ir=!0;for(;ir;)ir=!1,dn.forEach(K=>{Bt[K.id]&&Bt[K.id][Jn]&&(Xn.push(Bt[K.id][Jn]),ir=!0)}),Jn++;const Lr=Xn.findIndex(K=>K.participantId===s.id)+1,ls=(J.currentRound||[]).some(K=>K.participantId===s.id&&K.status!==Pe.DONE);return h.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-10 relative",children:[h.jsxs("header",{className:"relative rounded-[3rem] p-1 overflow-hidden shadow-2xl group",children:[h.jsx("div",{className:"absolute inset-0 bg-[#0a0a0a] rounded-[2.9rem]"}),h.jsx("div",{className:"absolute top-0 inset-x-0 h-32 bg-[var(--neon-purple)]/10 blur-[50px]"}),h.jsxs("div",{className:"relative p-8 flex flex-col items-center text-center",children:[h.jsx("div",{className:"absolute top-6 right-6 z-20"}),h.jsxs("div",{className:"w-24 h-24 p-1 rounded-full border-2 border-white/10 mb-6 relative",children:[h.jsx("div",{className:"absolute inset-0 rounded-full bg-[var(--neon-pink)]/20 blur-xl"}),h.jsx("img",{src:"IGK.jpeg",alt:"Logo",className:"w-full h-full rounded-full object-cover relative z-10"}),h.jsx("div",{className:"absolute bottom-0 right-0 w-6 h-6 bg-black rounded-full flex items-center justify-center border-2 border-black z-20",children:h.jsx("div",{className:`w - 3 h - 3 rounded - full animate - pulse shadow - [0_0_10px_currentColor] ${Je==="connected"?"bg-[var(--neon-green)] text-[var(--neon-green)]":Je==="connecting"?"bg-[var(--neon-yellow)] text-[var(--neon-yellow)]":"bg-rose-500 text-rose-500"} `})}),h.jsx("div",{className:"absolute -bottom-2 -left-2 bg-[#101015] border border-white/10 rounded-lg px-2 py-0.5 text-[8px] font-black tracking-widest text-[var(--neon-cyan)] shadow-xl z-30 uppercase font-righteous",children:Je==="connected"?"P2P+CLOUD":"CLOUD-ONLY"})]}),h.jsx("h2",{className:"text-4xl font-bold text-white tracking-tight uppercase leading-none font-bungee mb-2",children:s.name}),Lr>0&&!ls&&h.jsxs("div",{className:"mb-4 px-6 py-2 bg-[var(--neon-cyan)]/10 border border-[var(--neon-cyan)]/30 rounded-full inline-flex items-center gap-3",children:[h.jsx("span",{className:"w-2 h-2 bg-[var(--neon-cyan)] rounded-full animate-pulse"}),h.jsx("span",{className:"text-[var(--neon-cyan)] font-black text-xs uppercase tracking-[0.2em] font-righteous",children:Lr===1?"NEXT UP IN ROTATION":`${Lr}${Lr===2?"ND":Lr===3?"RD":"TH"} IN LINE`})]}),ls&&h.jsxs("div",{className:"mb-4 px-6 py-2 bg-[var(--neon-green)]/10 border border-[var(--neon-green)]/30 rounded-full inline-flex items-center gap-3 shadow-[0_0_20px_rgba(0,255,157,0.2)]",children:[h.jsx("span",{className:"w-2 h-2 bg-[var(--neon-green)] rounded-full animate-blink"}),h.jsx("span",{className:"text-[var(--neon-green)] font-black text-xs uppercase tracking-[0.2em] font-righteous",children:"LIVE ON STAGE"})]}),h.jsx("div",{className:"flex items-center gap-3",children:h.jsxs("button",{onClick:()=>{vr("Are you sure you want to sign out?",async()=>{await Fp(),window.location.reload()})},className:"flex items-center gap-2 px-4 py-2 bg-rose-500/10 hover:bg-rose-500 text-rose-500 hover:text-white rounded-xl transition-all font-black uppercase text-[10px] tracking-widest font-righteous border border-rose-500/20 hover:border-transparent",children:[h.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),h.jsx("polyline",{points:"16 17 21 12 16 7"}),h.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"SIGN OUT"]})})]})]}),J.currentRound&&J.currentRound.some(K=>K.status!==Pe.DONE)&&h.jsxs("section",{className:"animate-in fade-in slide-in-from-top-4",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4 px-4",children:[h.jsx("div",{className:"w-2 h-2 bg-[var(--neon-green)] rounded-full animate-blink"}),h.jsx("h3",{className:"text-[var(--neon-green)] font-black uppercase tracking-[0.3em] text-base font-righteous",children:"ON STAGE"})]}),h.jsx("div",{className:"flex flex-col gap-3",children:(J.currentRound||[]).filter(K=>K.status!==Pe.DONE).map((K,he)=>h.jsxs("div",{className:`p - 3 pl - 6 pr - 4 rounded - xl border - l - 8 transition - all duration - 300 flex items - center justify - between gap - 4 w - full shadow - lg relative overflow - hidden group ${he===0?"bg-[#001005] border-l-[var(--neon-green)] border-y border-r border-[#1a3320] z-10 scale-[1.01]":"bg-[#0a0a10] border-l-slate-700 border-y border-r border-white/10 opacity-70 hover:opacity-100"} `,children:[h.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_49%,rgba(255,255,255,0.03)_50%,transparent_51%)] bg-[length:50px_100%] pointer-events-none"}),h.jsxs("div",{className:"flex items-center gap-6 min-w-0 flex-1 z-10",children:[h.jsxs("div",{className:"relative",children:[he===0&&h.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 px-2 py-0.5 bg-[var(--neon-green)] text-black text-[8px] font-black uppercase tracking-[0.2em] rounded animate-pulse shadow-[0_0_10px_var(--neon-green)] z-20",children:"LIVE"}),h.jsx("div",{className:`w - 14 h - 14 flex flex - col justify - center items - center border - 2 rounded - xl transition - all shrink - 0 ${he===0?"border-[var(--neon-green)] bg-[var(--neon-green)]/10 text-[var(--neon-green)]":"border-white/10 text-slate-400"} `,children:h.jsx("span",{className:"text-xl font-bold font-mono tracking-tighter",children:K.requestNumber})})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-baseline gap-1 sm:gap-6 min-w-0 flex-1",children:[h.jsx("h3",{className:`text - xl sm: text - 2xl font - black uppercase font - righteous tracking - tight leading - tight ${he===0?"text-white":"text-slate-300"} `,children:K.songName}),h.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 opacity-80 shrink-0",children:[h.jsx("span",{className:"text-sm sm:text-lg font-bold font-righteous text-[var(--neon-cyan)] uppercase tracking-wider",children:K.artist}),h.jsx("span",{className:"text-slate-600 font-mono text-lg hidden sm:inline",children:"/"}),h.jsxs("span",{className:"text-sm sm:text-lg font-bold font-righteous text-[var(--neon-pink)] uppercase tracking-wider",children:["@",K.participantName]})]})]})]}),h.jsx("div",{className:"flex items-center gap-3 z-10 pl-4 border-l border-white/10 bg-gradient-to-l from-black/80 to-transparent",children:he===0&&h.jsx(zE,{url:K.youtubeUrl})})]},K.id))})]}),h.jsx("div",{className:"grid grid-cols-5 gap-2 bg-[#0a0a0a] p-2 rounded-2xl border border-white/5 shadow-inner",children:["ROTATION","REQUESTS","FAVORITES","HISTORY","VOCALS"].map(K=>h.jsxs("button",{onClick:()=>R(K),className:`py - 3 rounded - xl text - [10px] font - black uppercase tracking - widest transition - all font - righteous flex flex - col items - center justify - center gap - 1.5 ${C===K?"bg-[#151520] text-white shadow-[0_0_20px_rgba(255,255,255,0.05)] border border-white/10":"text-slate-600 hover:text-white hover:bg-white/5"} `,children:[h.jsx("span",{className:`text - 2xl mb - 0.5 ${C===K?"text-[var(--neon-pink)]":"grayscale opacity-50"} `,children:K==="ROTATION"?"":K==="REQUESTS"?"":K==="FAVORITES"?"":K==="HISTORY"?"":""}),K==="ROTATION"?"STAGE":K==="REQUESTS"?"MY SONGS":K==="FAVORITES"?"SONGBOOK":K==="HISTORY"?"LOG":"MIC SETUP"]},K))}),h.jsx("button",{onClick:()=>{I(null),le(!0)},className:"w-full py-8 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-blue)] text-white rounded-[2.5rem] font-black text-4xl shadow-[0_0_60px_rgba(255,0,127,0.4)] uppercase tracking-[0.1em] active:scale-95 transition-all font-bungee hover:brightness-110 border-4 border-white/10 animate-pulse",children:"SING!"}),h.jsxs("div",{className:"flex gap-4 pt-2",children:[h.jsx("button",{onClick:()=>Ys(Kt.READY),className:`flex - 1 py - 4 rounded - [1.5rem] font - bold text - xl uppercase tracking - wider transition - all border - 2 flex items - center justify - center gap - 2 group relative overflow - hidden font - bungee ${s.status===Kt.READY?"bg-[#051005] border-[var(--neon-green)] shadow-[0_0_30px_rgba(0,255,157,0.2)] text-[var(--neon-green)]":"bg-[#101015] border-white/5 text-slate-700 hover:border-white/10"} `,children:h.jsx("span",{className:"relative z-10",children:"READY"})}),h.jsx("button",{onClick:()=>Ys(Kt.STANDBY),className:`flex - 1 py - 4 rounded - [1.5rem] font - bold text - xl uppercase tracking - wider transition - all border - 2 flex items - center justify - center gap - 2 group relative overflow - hidden font - bungee ${s.status===Kt.STANDBY?"bg-[#150505] border-rose-500 shadow-[0_0_30px_rgba(244,63,94,0.2)] text-rose-500":"bg-[#101015] border-white/5 text-slate-700 hover:border-white/10"} `,children:h.jsx("span",{className:"relative z-10",children:"NOT YET"})})]}),(ce||me)&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-50 overflow-y-auto backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsx("div",{className:"w-full max-w-lg space-y-6",children:h.jsx(lA,{title:me?"Remix Request":"New Transmission",submitLabel:me?"Save Remix":"Transmit",initialSongName:(me==null?void 0:me.songName)||(be==null?void 0:be.songName)||"",initialArtist:(me==null?void 0:me.artist)||(be==null?void 0:be.artist)||"",initialYoutubeUrl:(me==null?void 0:me.youtubeUrl)||(be==null?void 0:be.youtubeUrl)||"",initialType:(me==null?void 0:me.type)||(be==null?void 0:be.type)||ft.SINGING,onSubmit:Di,onCancel:wt,participants:J.participants,currentUserId:s.id},(me==null?void 0:me.id)||"new-request")})}),h.jsxs("main",{className:"min-h-[300px] pb-32",children:[C==="ROTATION"&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-6",children:[h.jsx("h3",{className:"text-[var(--neon-green)] font-black uppercase tracking-[0.3em] text-sm px-4 font-righteous opacity-80",children:"COMING UP"}),h.jsx("div",{className:"space-y-4",children:Xn.length===0?h.jsx("div",{className:"text-center py-16 opacity-30 border-2 border-dashed border-white/5 rounded-[2.5rem] bg-black/20",children:h.jsx("p",{className:"text-sm font-black uppercase tracking-[0.4em] font-righteous text-slate-600",children:"QUEUE EMPTY"})}):Xn.map((K,he)=>h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 p-6 rounded-[2rem] flex justify-between items-center group hover:border-[var(--neon-blue)] transition-all",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-white font-bold uppercase truncate text-2xl font-bungee tracking-tight mb-1 group-hover:text-[var(--neon-blue)] transition-colors",children:K.songName}),h.jsxs("div",{className:"text-base text-[var(--neon-cyan)] uppercase tracking-[0.2em] flex items-center gap-2 font-righteous",children:[K.artist," ",h.jsx("span",{className:"text-white/20",children:"|"})," ",h.jsx("span",{className:"text-slate-400",children:K.participantName})]})]}),h.jsx("div",{className:"shrink-0 w-12 h-12 rounded-full border border-[var(--neon-blue)]/50 bg-[var(--neon-blue)]/10 flex items-center justify-center text-[var(--neon-blue)] text-xl font-black font-bungee shadow-[0_0_15px_rgba(5,217,232,0.2)]",children:he+1})]},K.id))})]}),C==="REQUESTS"&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-4",children:[ve.filter(K=>K.type==="ADD_REQUEST"&&K.payload.participantId===(s==null?void 0:s.id)).map((K,he)=>h.jsx("div",{className:"relative group opacity-60",children:h.jsxs("div",{className:"bg-[#151520] border-2 border-dashed border-[var(--neon-cyan)]/30 p-6 rounded-[2rem]",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"flex items-center gap-3 mb-2",children:h.jsx("div",{className:"font-bold text-white tracking-tight uppercase truncate font-bungee text-3xl italic",children:K.payload.songName})}),h.jsx("div",{className:"text-base text-slate-400 font-bold uppercase tracking-[0.2em] truncate font-righteous",children:K.payload.artist})]}),h.jsx("div",{className:"shrink-0 px-3 py-1 rounded-lg border border-[var(--neon-cyan)]/30 text-[var(--neon-cyan)] text-xs font-black uppercase tracking-widest animate-pulse",children:"SENDING..."})]}),h.jsx("div",{className:"mt-4 text-[10px] text-[var(--neon-cyan)] font-bold tracking-widest uppercase opacity-60 font-mono",children:"CLOUD BUFFERED // AUTO-RETRYING"})]})},`pending - ${he} `)),Xs.map(K=>h.jsx("div",{className:"relative group",children:h.jsxs("div",{className:"bg-[#151520] border-2 border-white/5 p-6 rounded-[2rem] hover:border-[var(--neon-pink)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsxs("div",{className:"font-bold text-white tracking-tight uppercase truncate font-bungee text-3xl group-hover:text-[var(--neon-pink)] transition-colors",children:[h.jsxs("span",{className:"text-slate-500 mr-2 text-[11px] font-mono tracking-widest",children:["#",K.requestNumber]}),K.songName]}),h.jsx(zE,{url:K.youtubeUrl})]}),h.jsx("div",{className:"text-base text-slate-400 font-bold uppercase tracking-[0.2em] truncate font-righteous",children:K.artist})]}),h.jsx("div",{className:`shrink - 0 px - 3 py - 1 rounded - lg border text - xs font - black uppercase tracking - widest ${K.status===Pe.APPROVED?K.isInRound?"bg-[var(--neon-green)] border-[var(--neon-green)] text-black animate-pulse shadow-[0_0_15px_var(--neon-green)]":"bg-[var(--neon-cyan)]/10 border-[var(--neon-cyan)] text-[var(--neon-cyan)]":"border-white/10 text-slate-600"} `,children:K.status===Pe.APPROVED?K.isInRound?"LIVE":"QUEUED":"PENDING"})]}),(K.status===Pe.PENDING||K.status===Pe.APPROVED)&&h.jsxs("div",{className:"flex gap-3 pt-4 border-t border-white/5",children:[h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:async()=>{await fy(s.id,K.id,"up"),await zt()},className:"w-10 h-10 bg-white/5 hover:bg-white/10 rounded-xl flex items-center justify-center text-white transition-all text-xl",title:"Move Up",children:""}),h.jsx("button",{onClick:async()=>{await fy(s.id,K.id,"down"),await zt()},className:"w-10 h-10 bg-white/5 hover:bg-white/10 rounded-xl flex items-center justify-center text-white transition-all text-xl",title:"Move Down",children:""})]}),h.jsx("button",{onClick:()=>Ee(K),className:"flex-1 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-sm font-black uppercase tracking-widest transition-all font-righteous text-white",children:"EDIT"}),h.jsx("button",{onClick:async()=>{await ba(K.id),await zt()},className:"flex-1 py-3 bg-rose-500/10 hover:bg-rose-500/20 rounded-xl text-sm font-black uppercase tracking-widest transition-all font-righteous text-rose-500",children:"CANCEL"})]})]})},K.id)),Xs.length===0&&ve.length===0&&h.jsx("div",{className:"text-center py-20 bg-black/20 rounded-[3rem] border-2 border-dashed border-white/5",children:h.jsx("p",{className:"text-base font-black uppercase tracking-[0.5em] font-righteous text-slate-700",children:"NO REQUESTS"})}),ve.length>0&&h.jsx("div",{className:"flex justify-center pt-4",children:h.jsxs("button",{onClick:()=>{Me.flushQueue(),fe("Syncing..."),setTimeout(()=>zt(),1e3)},className:"px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl text-[var(--neon-cyan)] font-black uppercase tracking-widest text-[10px] transition-all flex items-center gap-2",children:[h.jsxs("span",{children:["SYNC QUEUE (",ve.length,")"]}),h.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[var(--neon-cyan)] animate-ping"})]})})]}),C==="FAVORITES"&&t&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-6",children:[h.jsxs("div",{className:"relative group",children:[h.jsx("input",{type:"text",placeholder:"SEARCH SONGBOOK...",value:P,onChange:K=>k(K.target.value),className:"w-full bg-[#101015] border-2 border-white/10 rounded-[2rem] py-5 px-6 pl-14 text-xl font-bold uppercase tracking-wider text-white focus:outline-none focus:border-[var(--neon-pink)] transition-all font-righteous placeholder:text-slate-600 shadow-inner"}),h.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-2xl text-slate-600 group-focus-within:text-[var(--neon-pink)] transition-colors",children:""})]}),h.jsx("div",{className:"grid gap-3",children:(()=>{const K=[...t.favorites.map(he=>({...he,isFavorite:!0})),...((J==null?void 0:J.verifiedSongbook)||[]).filter(he=>!t.favorites.some(Fe=>Fe.songName===he.songName&&Fe.artist===he.artist)).map(he=>({...he,isFavorite:!1}))].filter(he=>!P||he.songName.toLowerCase().includes(P.toLowerCase())||he.artist.toLowerCase().includes(P.toLowerCase()));return K.length===0?h.jsx("div",{className:"text-center py-20 opacity-30 font-righteous text-sm uppercase tracking-widest text-slate-500",children:"NO_MATCHES"}):K.map(he=>h.jsxs("div",{className:"bg-[#101015] p-5 rounded-[2rem] flex justify-between items-center group border-2 border-white/5 hover:border-[var(--neon-yellow)] transition-all",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("div",{className:"text-white font-bold uppercase truncate text-2xl font-bungee tracking-tight group-hover:text-[var(--neon-yellow)] transition-colors",children:he.songName}),he.isFavorite&&h.jsx("span",{className:"text-lg text-[var(--neon-yellow)] animate-pulse",children:""})]}),h.jsx("div",{className:"text-sm text-slate-400 font-bold uppercase tracking-[0.2em] font-righteous",children:he.artist})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>{I({...he}),le(!0)},className:"bg-[var(--neon-pink)] text-black px-4 py-2 rounded-xl font-black text-xs uppercase tracking-widest hover:bg-white transition-all font-righteous shadow-[0_0_15px_rgba(255,0,127,0.3)] hover:scale-105 active:scale-95",children:"ADD"}),h.jsx("button",{onClick:async()=>{await nA(he),await zt()},className:`px - 2 transition - colors ${he.isFavorite?"text-rose-500":"text-slate-700 hover:text-[var(--neon-yellow)]"} `,children:he.isFavorite?"":""})]})]},he.id))})()})]}),C==="HISTORY"&&t&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-4",children:[t.personalHistory.map((K,he)=>h.jsxs("div",{className:"bg-[#101015] p-6 rounded-[2rem] flex justify-between items-center border-2 border-white/5 hover:border-[var(--neon-purple)] group transition-all",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-white font-bold uppercase truncate text-2xl font-bungee tracking-tight mb-1 group-hover:text-[var(--neon-purple)] transition-colors",children:K.songName}),h.jsx("div",{className:"text-base text-[var(--neon-cyan)]/70 font-bold uppercase tracking-[0.2em] font-righteous",children:K.artist})]}),h.jsx("button",{onClick:()=>{I({...K,type:ft.SINGING}),le(!0)},className:"text-slate-600 hover:text-white border border-white/5 hover:border-white px-4 py-2 rounded-xl font-black text-xs uppercase tracking-widest transition-all font-righteous",children:"AGAIN"})]},he)),t.personalHistory.length===0&&h.jsx("div",{className:"text-center py-20 opacity-30 border-2 border-dashed border-white/5 rounded-[2.5rem] bg-black/20",children:h.jsx("p",{className:"text-sm font-black uppercase tracking-[0.4em] font-righteous text-slate-600",children:"NO HISTORY FOUND"})})]}),C==="VOCALS"&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-6",children:[h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[2.5rem] p-8 relative overflow-hidden group hover:border-[var(--neon-cyan)] transition-all",children:[h.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20 group-hover:opacity-100 transition-opacity",children:h.jsx("span",{className:"text-5xl",children:""})}),h.jsx("h3",{className:"text-[var(--neon-cyan)] font-black uppercase tracking-[0.3em] font-righteous mb-6",children:"VOCAL SETUP"}),h.jsxs("div",{className:"flex flex-col items-center gap-6",children:[h.jsxs("div",{className:"w-full bg-black/40 border border-white/10 rounded-2xl p-6 flex flex-col items-center",children:[h.jsx("span",{className:"text-sm font-black text-slate-500 uppercase tracking-widest font-righteous mb-2",children:"SINGER RANGE"}),h.jsx("span",{className:"text-4xl font-bold text-white uppercase font-bungee tracking-tight neon-text-glow-cyan",children:(t==null?void 0:t.vocalRange)||"UNKNOWN"})]}),at?h.jsxs("div",{className:"w-full space-y-3 py-2",children:[h.jsx("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-[var(--neon-cyan)] animate-pulse shadow-[0_0_10px_var(--neon-cyan)]",style:{width:`${X}% `}})}),h.jsx("div",{className:"text-xs text-[var(--neon-cyan)] font-black animate-pulse font-righteous text-center tracking-[0.2em]",children:"CALIBRATING VOICE..."})]}):h.jsx("button",{onClick:async()=>{_t(!0);let K=0;const he=setInterval(()=>{K+=5,ue(K),K>=100&&(clearInterval(he),setTimeout(async()=>{const Fe=["Soprano","Alto","Tenor","Baritone","Bass"],Xe=Fe[Math.floor(Math.random()*Fe.length)];t&&await OP(t.id,Xe),_t(!1),ue(0),await zt()},500))},100)},className:"px-8 py-4 bg-[var(--neon-cyan)]/10 hover:bg-[var(--neon-cyan)] text-[var(--neon-cyan)] hover:text-black rounded-xl font-black uppercase tracking-[0.2em] transition-all font-righteous border border-[var(--neon-cyan)]/30 hover:shadow-[0_0_20px_var(--neon-cyan)]",children:"START_CALIBRATION_SEQUENCE"})]})]}),h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[2.5rem] p-8 opacity-50 relative overflow-hidden border-dashed",children:[h.jsx("h3",{className:"text-slate-500 font-black uppercase tracking-[0.3em] font-righteous mb-2",children:"MICROPHONE_TOOLS"}),h.jsx("p",{className:"text-slate-600 font-mono text-xs uppercase tracking-wider",children:"HARDWARE_LINK_OFFLINE // COMING_SOON"})]})]})]}),h.jsxs("footer",{className:"fixed bottom-6 left-6 right-6 z-40 flex gap-4",children:[h.jsxs("button",{onClick:()=>He(!0),className:"flex-1 bg-[#101015] border-2 border-[var(--neon-green)]/30 p-4 rounded-[2rem] flex items-center justify-between px-8 shadow-2xl hover:bg-[var(--neon-green)] hover:text-black hover:border-[var(--neon-green)] transition-all group",children:[h.jsx("span",{className:"text-sm font-black uppercase tracking-[0.3em] font-righteous group-hover:text-black text-[var(--neon-green)]",children:"RECONNECT"}),h.jsx("span",{className:"text-2xl group-hover:scale-125 transition-transform",children:""})]}),h.jsxs("button",{onClick:()=>j(!0),className:"flex-1 bg-[#101015] border-2 border-white/10 p-4 rounded-[2rem] flex items-center justify-between px-8 shadow-2xl hover:border-[var(--neon-pink)] transition-all group",children:[h.jsx("span",{className:"text-sm text-[var(--neon-pink)] font-black uppercase tracking-[0.3em] font-righteous",children:"SYSTEM_LINK"}),h.jsx("div",{className:"flex items-center gap-3",children:h.jsx("span",{className:"text-2xl group-hover:scale-125 transition-transform",children:""})})]})]}),Ae&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-8 z-[200] animate-in zoom-in-95 duration-300",children:h.jsxs("div",{className:"w-full max-w-4xl text-center relative bg-[#050510] border-4 border-white/10 rounded-[3rem] p-4 md:p-10 overflow-hidden max-h-[90vh] overflow-y-auto",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-green)] via-[var(--neon-cyan)] to-[var(--neon-blue)] animate-gradient-x"}),h.jsx("button",{onClick:()=>He(!1),className:"absolute top-6 right-6 text-slate-700 hover:text-white text-3xl transition-colors z-50",children:""}),h.jsx("h3",{className:"text-4xl md:text-5xl font-black text-white uppercase tracking-tight mb-8 font-bungee neon-glow-green mt-8",children:"RECONNECT"}),h.jsx(WP,{onJoin:K=>{window.location.search=`? room = ${K} `},filterHostName:"SingMode DJ"})]})}),L&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-8 z-[200] animate-in zoom-in-95 duration-300",children:h.jsxs("div",{className:"w-full max-w-sm text-center relative bg-[#050510] border-4 border-white/10 rounded-[3rem] p-10 overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsx("button",{onClick:()=>j(!1),className:"absolute top-6 right-6 text-slate-700 hover:text-white text-3xl transition-colors",children:""}),h.jsx("div",{className:"bg-white p-4 rounded-[2rem] inline-block mb-8 shadow-[0_0_40px_rgba(255,255,255,0.1)]",children:h.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(is)}&bgcolor=ffffff`,alt:"Room QR",className:"w-48 h-48"})}),h.jsx("h3",{className:"text-5xl font-black text-white uppercase tracking-tight mb-2 font-bungee neon-glow-white",children:"SYNC_NODE"}),h.jsx("p",{className:"text-[var(--neon-cyan)] text-sm font-black uppercase tracking-[0.4em] font-righteous opacity-80",children:"SCAN TO INITIALIZE CONNECTION"})]})}),Vr.isOpen&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[300] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-md bg-[#050510] border-4 border-[var(--neon-pink)]/30 rounded-[3rem] p-10 text-center shadow-[0_0_100px_rgba(255,42,109,0.3)] animate-in zoom-in-95 duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-[var(--neon-pink)] shadow-[0_0_20px_rgba(255,42,109,0.8)]"}),h.jsx("div",{className:"w-20 h-20 bg-[var(--neon-pink)]/10 text-[var(--neon-pink)] rounded-[2rem] border-2 border-[var(--neon-pink)]/20 flex items-center justify-center mx-auto mb-6 text-4xl font-black shadow-[0_0_30px_rgba(255,42,109,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-text-glow-pink",children:"CONFIRM"}),h.jsx("p",{className:"text-slate-400 text-lg mb-8 leading-relaxed font-black font-righteous uppercase tracking-widest",children:Vr.message}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>as(K=>({...K,isOpen:!1})),className:"flex-1 py-4 bg-black border-2 border-white/10 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous transition-all hover:bg-white/5",children:"CANCEL"}),h.jsx("button",{onClick:async()=>{as(K=>({...K,isOpen:!1})),await Vr.onConfirm()},className:"flex-[2] py-4 bg-[var(--neon-pink)] text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous shadow-[0_0_30px_rgba(255,42,109,0.4)] transition-all hover:bg-rose-400 hover:scale-105",children:"PROCEED"})]})]})})]})},Fl=({title:s,icon:e,description:t,items:n})=>h.jsxs("div",{className:"bg-[#101015] border border-white/5 p-10 rounded-[3.5rem] hover:border-[var(--neon-pink)] transition-all backdrop-blur-xl group relative overflow-hidden shadow-2xl",children:[h.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[var(--neon-pink)]/5 blur-3xl rounded-full -mr-16 -mt-16 group-hover:bg-[var(--neon-pink)]/10 transition-colors"}),h.jsx("div",{className:"w-20 h-20 bg-black border border-white/10 rounded-2xl flex items-center justify-center text-4xl mb-8 group-hover:scale-110 group-hover:border-[var(--neon-pink)] group-hover:text-white transition-all shadow-2xl relative z-10",children:e}),h.jsx("h3",{className:"text-3xl font-bold text-white font-bungee uppercase mb-4 tracking-tight group-hover:text-[var(--neon-pink)] transition-colors relative z-10 leading-none",children:s}),h.jsx("p",{className:"text-[var(--neon-cyan)]/70 mb-8 font-bold uppercase text-[10px] tracking-[0.2em] font-righteous leading-relaxed relative z-10 transition-opacity",children:t}),h.jsx("ul",{className:"space-y-4 relative z-10",children:n.map((a,l)=>h.jsxs("li",{className:"flex items-start gap-3 text-[11px] text-slate-500 font-bold uppercase tracking-widest font-righteous group-hover:text-[var(--neon-cyan)] transition-colors",children:[h.jsx("span",{className:"text-[var(--neon-cyan)] font-bold",children:""}),a]},l))})]}),t3=({onBack:s,onAdminLogin:e})=>{const t=()=>{prompt("Enter Admin Password:")==="Organized"?e():alert("Access Denied: Incorrect Password")};return h.jsxs("div",{className:"min-h-screen bg-[#050510] text-slate-200 p-6 md:p-16 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] z-50 animate-gradient-x"}),h.jsx("div",{className:"absolute -top-[500px] -right-[500px] w-[1000px] h-[1000px] bg-[var(--neon-pink)]/5 blur-[200px] rounded-full"}),h.jsx("div",{className:"absolute -bottom-[500px] -left-[500px] w-[1000px] h-[1000px] bg-[var(--neon-cyan)]/5 blur-[200px] rounded-full"}),h.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('/grid.svg')] opacity-5 pointer-events-none"}),h.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[h.jsxs("div",{className:"flex justify-between items-center mb-24 animate-in fade-in slide-in-from-top-4 duration-700",children:[h.jsx("div",{onClick:s,className:"cursor-pointer hover:scale-105 transition-transform",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("img",{src:"IGK.jpeg",alt:"Logo",className:"w-10 h-10 rounded-full border border-[var(--neon-pink)]"}),h.jsx("span",{className:"font-bungee text-xl text-white tracking-widest",children:"Singmode v.2"})]})}),h.jsx("button",{onClick:s,className:"px-8 py-4 bg-black border border-white/10 hover:border-[var(--neon-pink)] text-slate-400 hover:text-white rounded-2xl font-bold text-[9px] uppercase tracking-widest font-righteous transition-all",children:"RETURN TO HUB"})]}),h.jsxs("div",{className:"text-center max-w-4xl mx-auto mb-32 animate-in fade-in zoom-in duration-700 delay-100",children:[h.jsxs("h1",{className:"text-6xl md:text-8xl font-bold font-bungee text-white mb-8 tracking-tight uppercase leading-none neon-text-glow-purple",children:["The ultimate ",h.jsx("span",{className:"text-[var(--neon-cyan)]",children:"karaoke"})," os"]}),h.jsx("p",{className:"text-[10px] md:text-xs text-[var(--neon-cyan)]/80 font-bold uppercase tracking-[0.4em] font-righteous leading-relaxed max-w-2xl mx-auto border-y border-[var(--neon-cyan)]/20 py-4",children:"Singmode v.2 transforms any arena into a high-fidelity visual theater. Connect instantly, dominate the queue, and emit your signal."})]}),h.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-32 animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-200",children:[h.jsx(Fl,{title:"DJ Console",icon:"",description:"The command center for your sessions. Maintain signal flow.",items:["Real-time Queue Logic","Drag & Drop Sequencer","Instant Signal Auth","Master Output Control"]}),h.jsx(Fl,{title:"Singer Web",icon:"",description:"A personal terminal for every guest. Eliminate analog friction.",items:["Identity Transmission","Smart Vector Search","High-Speed Requests","Live Sync Lyrics"]}),h.jsx(Fl,{title:"Theater Box",icon:"",description:"A stunning visual matrix for the main screen. Pure aesthetics.",items:["Ultra-HD Playback","Generative Backgrounds","Active HUD Overlays","QR Signal Entrance"]}),h.jsx(Fl,{title:"Hybrid AI",icon:"",description:"Gemini integration enhances the arena with predictive logic.",items:["Vibe-Matched Vectors","Dynamic Visual Synthesis","Automated Interstitials","Identity Verification"]}),h.jsx(Fl,{title:"Sync Matrix",icon:"",description:"Real-time P2P technology keeps the cluster in perfect sync.",items:["Zero-Latency State","Decentralized Design","Instant Node Creation","Omni-Device Support"]}),h.jsx(Fl,{title:"Prime Suite",icon:"",description:"Unlock premium protocols for venues and power units.",items:["Broadcast Protocols","Branding Overlays","Logic Routing","Priority Channel"]}),h.jsxs("div",{className:"md:col-span-2 lg:col-span-1 border-2 border-dashed border-white/10 rounded-[3.5rem] flex flex-col items-center justify-center p-10 group hover:border-[var(--neon-cyan)] transition-all",children:[h.jsx("p",{className:"text-[10px] text-slate-700 font-black uppercase tracking-[0.4em] mb-6 font-righteous group-hover:text-[var(--neon-cyan)]",children:"ADMIN LOGIN"}),h.jsx("button",{onClick:t,className:"p-6 bg-black border border-white/5 rounded-2xl text-[10px] font-black uppercase tracking-widest font-righteous text-white/40 hover:text-white hover:border-white transition-all shadow-xl",children:" ENTER ADMIN MODE"})]})]}),h.jsx("div",{className:"text-center animate-in fade-in duration-700 delay-500 pb-32",children:h.jsx("button",{onClick:s,className:"px-16 py-8 bg-[var(--neon-cyan)] hover:bg-white text-black rounded-[3rem] font-bold text-2xl uppercase tracking-widest font-righteous shadow-[0_0_50px_rgba(34,211,238,0.4)] hover:scale-105 transition-all",children:"START SINGING"})})]})]})},n3=({onBack:s})=>{const[e,t]=ie.useState(null),[n,a]=ie.useState(""),[l,c]=ie.useState(!1),[d,p]=ie.useState({primary:"#ff007f",secondary:"#05d9e8",accent:"#feff3f"}),[g,v]=ie.useState({isOpen:!1,message:"",onConfirm:()=>{}}),x=(A,O)=>{v({isOpen:!0,message:A,onConfirm:O})};ie.useEffect(()=>{(async()=>{const O=await At();t(O),O.brandIdentity&&(a(O.brandIdentity.venueName),c(O.brandIdentity.isBusinessAccount)),O.customTheme&&p({primary:O.customTheme.primaryNeon,secondary:O.customTheme.secondaryNeon,accent:O.customTheme.accentNeon})})()},[]);const E=async()=>{var O;if(!e)return;const A={...e};A.brandIdentity={venueName:n,isBusinessAccount:l,logoUrl:(O=A.brandIdentity)==null?void 0:O.logoUrl},A.customTheme={primaryNeon:d.primary,secondaryNeon:d.secondary,accentNeon:d.accent},await En(A),document.documentElement.style.setProperty("--neon-pink",d.primary),document.documentElement.style.setProperty("--neon-cyan",d.secondary),document.documentElement.style.setProperty("--neon-yellow",d.accent),alert("Configurations locked in.")};return e?h.jsxs("div",{className:"min-h-screen bg-[#050510] text-white p-6 md:p-16 relative overflow-hidden font-righteous",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] z-50 animate-gradient-x"}),h.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[h.jsxs("header",{className:"flex justify-between items-center mb-20 animate-in fade-in slide-in-from-top-4 duration-700",children:[h.jsxs("div",{onClick:s,className:"cursor-pointer group flex items-center gap-4",children:[h.jsx("img",{src:"IGK.jpeg",alt:"Logo",className:"w-12 h-12 rounded-full border-2 border-[var(--neon-pink)] group-hover:scale-110 transition-all"}),h.jsx("h1",{className:"text-3xl font-bungee tracking-tight",children:"ADMIN SETTINGS"})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:s,className:"px-6 py-3 bg-black border border-white/10 hover:border-white text-slate-500 hover:text-white rounded-xl text-[10px] uppercase tracking-widest transition-all",children:"CLOSE MENU"}),h.jsxs("button",{onClick:()=>{x("Are you sure you want to sign out?",async()=>{await Fp(),window.location.reload()})},className:"px-6 py-3 bg-rose-500/10 border border-rose-500/30 hover:bg-rose-500 text-rose-500 hover:text-white rounded-xl text-[10px] uppercase tracking-widest transition-all flex items-center gap-2",children:[h.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),h.jsx("polyline",{points:"16 17 21 12 16 7"}),h.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"LOG OUT"]})]})]}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-10",children:[h.jsxs("section",{className:"bg-black/40 border-2 border-white/5 rounded-[3rem] p-10 space-y-8 shadow-2xl",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bungee text-[var(--neon-cyan)] mb-2 uppercase",children:"Venue Settings"}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-widest font-black opacity-60",children:"VENUE DISPLAY"})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] text-slate-500 uppercase tracking-widest mb-2 ml-4",children:"Venue Display Name"}),h.jsx("input",{type:"text",value:n,onChange:A=>a(A.target.value),placeholder:"Enter Venue Name",className:"w-full bg-black/60 border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold outline-none focus:border-[var(--neon-cyan)] transition-all uppercase"})]}),h.jsxs("div",{className:"flex items-center justify-between p-6 bg-white/5 rounded-2xl border border-white/5",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-xs font-black uppercase tracking-widest mb-1",children:"Business Account"}),h.jsx("p",{className:"text-[9px] text-slate-500 uppercase font-bold",children:"Unlocks Revenue Stream Matrix"})]}),h.jsx("button",{onClick:()=>c(!l),className:`w-14 h-8 rounded-full transition-all relative ${l?"bg-[var(--neon-cyan)]":"bg-slate-800"}`,children:h.jsx("div",{className:`absolute top-1 w-6 h-6 rounded-full bg-white transition-all ${l?"right-1":"left-1"}`})})]})]})]}),h.jsxs("section",{className:"bg-black/40 border-2 border-white/5 rounded-[3rem] p-10 space-y-8 shadow-2xl",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bungee text-[var(--neon-pink)] mb-2 uppercase",children:"Theme Matrix"}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-widest font-black opacity-60",children:"THEME COLORS"})]}),h.jsx("div",{className:"space-y-6",children:h.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[h.jsxs("div",{className:"flex items-center justify-between bg-white/5 p-4 rounded-xl border border-white/5",children:[h.jsx("label",{className:"text-[10px] uppercase font-black tracking-widest",children:"Primary Neon"}),h.jsx("input",{type:"color",value:d.primary,onChange:A=>p({...d,primary:A.target.value}),className:"bg-transparent border-none w-10 h-10 cursor-pointer"})]}),h.jsxs("div",{className:"flex items-center justify-between bg-white/5 p-4 rounded-xl border border-white/5",children:[h.jsx("label",{className:"text-[10px] uppercase font-black tracking-widest",children:"Secondary Neon"}),h.jsx("input",{type:"color",value:d.secondary,onChange:A=>p({...d,secondary:A.target.value}),className:"bg-transparent border-none w-10 h-10 cursor-pointer"})]}),h.jsxs("div",{className:"flex items-center justify-between bg-white/5 p-4 rounded-xl border border-white/5",children:[h.jsx("label",{className:"text-[10px] uppercase font-black tracking-widest",children:"Accent Neon"}),h.jsx("input",{type:"color",value:d.accent,onChange:A=>p({...d,accent:A.target.value}),className:"bg-transparent border-none w-10 h-10 cursor-pointer"})]})]})})]}),h.jsxs("section",{className:"bg-black/40 border-2 border-white/5 rounded-[3rem] p-10 space-y-8 shadow-2xl col-span-full",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bungee text-rose-500 mb-2 uppercase",children:"System Maintenance"}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-widest font-black opacity-60",children:"DATABASE PURGE OPERATIONS"})]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[h.jsxs("div",{className:"flex-1 p-6 bg-white/5 rounded-2xl border border-white/5",children:[h.jsx("h4",{className:"text-xs font-black uppercase tracking-widest mb-1 text-white",children:"Account Optimization"}),h.jsx("p",{className:"text-[9px] text-slate-500 uppercase font-bold mb-4",children:"Deletes all guests and duplicate entries"}),h.jsx("button",{onClick:()=>{x("DANGER: This will permanently delete all guest accounts and duplicate stage names. Proceed?",async()=>{const A=await tA();A.success?alert(`Cleanup complete. Deleted ${A.deletedCount} items.`):alert(`Cleanup failed: ${A.error}`)})},className:"px-6 py-3 bg-rose-500/10 border border-rose-500 hover:bg-rose-500 text-rose-500 hover:text-white rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:"PURGE GUESTS & DUPLICATES"})]}),h.jsxs("div",{className:"flex-1 p-6 bg-white/5 rounded-2xl border border-white/5",children:[h.jsx("h4",{className:"text-xs font-black uppercase tracking-widest mb-1 text-white",children:"Signal Maintenance"}),h.jsx("p",{className:"text-[9px] text-slate-500 uppercase font-bold mb-4",children:"Cleans up dead or abandoned stage signals"}),h.jsx("button",{onClick:()=>{x("This will remove all inactive or stale stage sessions from the public list. Proceed?",async()=>{const A=await KP();A.success?alert(`Signal cleanup complete. Removed ${A.deletedCount} stale sessions.`):alert(`Cleanup failed: ${A.error}`)})},className:"px-6 py-3 bg-[var(--neon-purple)]/10 border border-[var(--neon-purple)] hover:bg-[var(--neon-purple)] text-[var(--neon-purple)] hover:text-white rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:"PURGE STALE SIGNALS"})]})]})]})]}),h.jsx("div",{className:"mt-12 flex justify-center",children:h.jsx("button",{onClick:E,className:"px-16 py-6 bg-white text-black rounded-[2rem] font-bold text-xl uppercase tracking-widest font-bungee hover:bg-[var(--neon-cyan)] transition-all shadow-2xl hover:scale-105 active:scale-95",children:"SAVE CHANGES"})})]}),g.isOpen&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[300] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-md bg-[#050510] border-4 border-[var(--neon-pink)]/30 rounded-[3rem] p-10 text-center shadow-[0_0_100px_rgba(255,42,109,0.3)] animate-in zoom-in-95 duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-[var(--neon-pink)] shadow-[0_0_20px_rgba(255,42,109,0.8)]"}),h.jsx("div",{className:"w-20 h-20 bg-[var(--neon-pink)]/10 text-[var(--neon-pink)] rounded-[2rem] border-2 border-[var(--neon-pink)]/20 flex items-center justify-center mx-auto mb-6 text-4xl font-black shadow-[0_0_30px_rgba(255,42,109,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-text-glow-pink",children:"CONFIRM"}),h.jsx("p",{className:"text-slate-400 text-lg mb-8 leading-relaxed font-black font-righteous uppercase tracking-widest",children:g.message}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>v(A=>({...A,isOpen:!1})),className:"flex-1 py-4 bg-black border-2 border-white/10 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous transition-all hover:bg-white/5",children:"CANCEL"}),h.jsx("button",{onClick:async()=>{v(A=>({...A,isOpen:!1})),await g.onConfirm()},className:"flex-[2] py-4 bg-[var(--neon-pink)] text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous shadow-[0_0_30px_rgba(255,42,109,0.4)] transition-all hover:bg-rose-400 hover:scale-105",children:"PROCEED"})]})]})})]}):null},r3=()=>{const[s,e]=ie.useState("SELECT"),[t,n]=ie.useState(!0),[a,l]=ie.useState(null),[c,d]=ie.useState(!1),[p,g]=ie.useState(!1),[v,x]=ie.useState("");ie.useEffect(()=>{(async()=>{var be;const ce=new URLSearchParams(window.location.search),le=(be=ce.get("view"))==null?void 0:be.toUpperCase(),me=ce.get("userId"),Ee=ce.get("room");(Ee||me)&&d(!0);try{Ee||me?(e("PARTICIPANT"),await tc("PARTICIPANT",Ee||void 0)):le==="DJ"?e("DJ"):le==="PARTICIPANT"||le==="STAGE"?(e("PARTICIPANT"),await tc("PARTICIPANT",void 0)):e("SELECT");const I=await At();I&&I.customTheme&&(document.documentElement.style.setProperty("--neon-pink",I.customTheme.primaryNeon),document.documentElement.style.setProperty("--neon-cyan",I.customTheme.secondaryNeon),document.documentElement.style.setProperty("--neon-yellow",I.customTheme.accentNeon)),await FP()}catch(I){console.error("[App] Init Error:",I),l(I.message),e("SELECT")}finally{n(!1)}})()},[]);const E=async se=>{n(!0),l(null);try{e(se),se==="PARTICIPANT"&&await tc(se)}catch(ce){l(ce.message),e("SELECT")}finally{n(!1)}},A=()=>{v.trim()&&(py(v.trim()),g(!1),x(""))},O=cp(),F=Me.getRoomId(),J=`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(O+(F?`?room=${F}`:""))}&bgcolor=ffffff`;if(t)return h.jsxs("div",{className:"min-h-screen bg-[#050510] flex flex-col items-center justify-center space-y-8 relative overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-[#10002B] to-black"}),h.jsxs("div",{className:"w-24 h-24 relative",children:[h.jsx("div",{className:"absolute inset-0 border-4 border-[var(--neon-pink)]/30 rounded-full animate-ping"}),h.jsx("div",{className:"absolute inset-0 border-4 border-[var(--neon-cyan)]/30 rounded-full animate-ping delay-75"}),h.jsx("div",{className:"relative z-10 w-full h-full border-4 border-t-[var(--neon-pink)] border-r-[var(--neon-purple)] border-b-[var(--neon-cyan)] border-l-[var(--neon-yellow)] rounded-full animate-spin"})]}),h.jsx("h2",{className:"text-2xl font-black font-bungee text-white uppercase tracking-widest animate-pulse z-10",children:"INITIALIZING"})]});if(s==="FEATURES")return h.jsx(t3,{onBack:()=>e("SELECT"),onAdminLogin:()=>e("ADMIN")});if(s==="ADMIN")return h.jsx(n3,{onBack:()=>e("SELECT")});if(s==="SELECT"){const se=cA(),ce=O.includes("localhost")||O.includes("127.0.0.1");return h.jsxs("div",{className:"min-h-screen flex items-center justify-center p-6 bg-[#050510] relative overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-[#10002B] to-black -z-10"}),h.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('/grid.svg')] opacity-10"}),h.jsxs("div",{className:"max-w-7xl w-full z-10",children:[h.jsxs("div",{className:"text-center mb-20 animate-in fade-in slide-in-from-top-4 duration-1000",children:[h.jsxs("div",{className:"flex justify-center mb-10 relative",children:[h.jsx("div",{className:"absolute inset-0 bg-[var(--neon-pink)]/20 blur-[100px] rounded-full"}),h.jsx("div",{className:"p-3 rounded-full border-4 border-white/10 bg-black shadow-2xl relative z-10",children:h.jsx("div",{className:"rounded-full overflow-hidden border-4 border-[var(--neon-pink)] shadow-[0_0_50px_rgba(255,0,127,0.5)] w-48 h-48",children:h.jsx("img",{src:"IGK.jpeg",alt:"Island Groove",className:"w-full h-full object-cover"})})})]}),h.jsx("h1",{className:"text-6xl md:text-9xl font-bold font-bungee text-white mb-6 uppercase tracking-tight neon-text-glow-purple leading-none drop-shadow-2xl",children:"Singmode v.2"}),h.jsx("p",{className:"text-[var(--neon-yellow)] text-xl md:text-2xl font-bold tracking-widest uppercase neon-glow-yellow font-righteous",children:"KARAOKE_LOUNGE_SYSTEM"})]}),a&&h.jsxs("div",{className:"mb-12 p-10 bg-[#150005] border-4 border-rose-500 rounded-[3rem] text-center animate-in zoom-in duration-500 max-w-3xl mx-auto shadow-[0_0_60px_rgba(244,63,94,0.4)] relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-rose-500 animate-pulse"}),h.jsx("div",{className:"text-6xl mb-6",children:""}),h.jsx("h3",{className:"text-rose-500 font-bold uppercase tracking-widest text-3xl mb-4 font-bungee",children:"SYSTEM_CONFLICT"}),h.jsx("p",{className:"text-white text-xl font-bold leading-relaxed font-righteous",children:a}),h.jsx("p",{className:"text-rose-500/50 text-xs mt-8 uppercase font-bold tracking-widest font-righteous",children:"SINGLE_DJ_PROTOCOL_ACTIVE"})]}),h.jsxs("div",{className:`grid gap-8 ${c?"grid-cols-1 max-w-2xl mx-auto":"md:grid-cols-2"}`,children:[!c&&h.jsxs("button",{onClick:()=>E("DJ"),className:"group relative p-12 bg-[#101015] border-4 border-white/5 rounded-[4rem] text-left transition-all hover:border-[var(--neon-pink)] hover:-translate-y-2 hover:shadow-[0_0_80px_rgba(255,0,127,0.2)] overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--neon-pink)]/0 to-[var(--neon-pink)]/5 group-hover:to-[var(--neon-pink)]/10 transition-all"}),h.jsxs("div",{className:"relative z-10",children:[h.jsx("div",{className:"w-24 h-24 bg-black border-2 border-white/10 rounded-3xl flex items-center justify-center text-5xl mb-8 group-hover:scale-110 transition-all group-hover:border-[var(--neon-pink)] shadow-2xl",children:""}),h.jsx("h2",{className:"text-5xl font-bold mb-4 font-bungee uppercase tracking-tight text-white group-hover:text-[var(--neon-pink)] transition-colors",children:"DJ_CONSOLE"}),h.jsx("p",{className:"text-sm font-medium font-righteous uppercase tracking-widest text-[var(--neon-cyan)] opacity-90 leading-relaxed",children:"COORDINATE ROTATION. APPROVE REQUESTS. COMMAND ATMOSPHERE."})]})]}),h.jsxs("button",{onClick:()=>E("PARTICIPANT"),className:"group relative p-12 bg-[#101015] border-4 border-white/5 rounded-[4rem] text-left transition-all hover:border-[var(--neon-cyan)] hover:-translate-y-2 hover:shadow-[0_0_80px_rgba(0,229,255,0.2)] overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--neon-cyan)]/0 to-[var(--neon-cyan)]/5 group-hover:to-[var(--neon-cyan)]/10 transition-all"}),h.jsxs("div",{className:"relative z-10",children:[h.jsx("div",{className:"w-24 h-24 bg-black border-2 border-white/10 rounded-3xl flex items-center justify-center text-5xl mb-8 group-hover:scale-110 transition-all group-hover:border-[var(--neon-cyan)] shadow-2xl",children:""}),h.jsx("h2",{className:"text-5xl font-bold mb-4 font-bungee uppercase tracking-tight text-white group-hover:text-[var(--neon-cyan)] transition-colors",children:"SINGER_UI"}),h.jsx("p",{className:"text-sm font-medium font-righteous uppercase tracking-widest text-[var(--neon-yellow)] opacity-90 leading-relaxed",children:"REQUEST SONGS. FAVORITE VIBES. ACCESS SONGBOOK."})]})]})]}),h.jsxs("div",{className:"mt-16 p-10 bg-[#080808] border-2 border-white/5 rounded-[3rem] flex flex-col md:flex-row items-center gap-10 relative overflow-hidden group hover:border-[var(--neon-green)] transition-all",children:[h.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[var(--neon-green)]/5 blur-[80px] rounded-full -mr-32 -mt-32 pointer-events-none"}),h.jsx("div",{className:"bg-white p-4 rounded-3xl shrink-0 shadow-[0_0_40px_rgba(0,255,157,0.2)] border-4 border-white/10 group-hover:scale-105 transition-transform",children:h.jsx("img",{src:J,alt:"Join QR Code",width:"140",height:"140",className:"block"})}),h.jsxs("div",{className:"text-center md:text-left flex-1 relative z-10",children:[h.jsx("strong",{className:"text-[var(--neon-green)] block mb-3 uppercase tracking-[0.3em] text-xs font-black font-righteous",children:"SCAN TO JOIN"}),h.jsx("div",{className:"text-white text-xl font-mono break-all mb-4 bg-black/50 px-4 py-2 rounded-lg inline-block border border-white/5",children:O}),ce&&h.jsxs("div",{className:"p-4 bg-amber-500/5 border border-amber-500/10 rounded-2xl",children:[h.jsx("p",{className:"text-amber-500 text-[10px] font-black uppercase tracking-widest mb-2 font-righteous",children:" LOCALHOST DETECTED"}),h.jsx("button",{onClick:()=>{g(!0),x(se||"")},className:"text-[10px] font-black text-white hover:text-[var(--neon-cyan)] uppercase tracking-[0.2em] underline decoration-white/30 hover:decoration-[var(--neon-cyan)] transition-all font-righteous",children:"CONFIGURE NETWORK IP"})]})]})]})]}),p&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-6 z-50 backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-lg bg-[#0a0a0a] border-2 border-white/10 rounded-[3rem] p-10 space-y-8 shadow-[0_0_60px_rgba(0,0,0,0.8)] relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-cyan)] to-[var(--neon-blue)]"}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-3xl font-bold text-white mb-2 font-bungee uppercase tracking-tight",children:"Network Config"}),h.jsx("p",{className:"text-slate-500 text-[10px] uppercase tracking-widest font-righteous",children:"ESTABLISH REMOTE CONNECTION PROTOCOLS"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-[11px] font-bold text-[var(--neon-cyan)] uppercase tracking-[0.2em] ml-4 font-righteous",children:"Network IP Address"}),h.jsx("input",{type:"text",value:v,onChange:le=>x(le.target.value),placeholder:"e.g. 192.168.0.x OR https://....ngrok.io",className:"w-full bg-[#151520] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-mono focus:border-[var(--neon-cyan)] outline-none transition-all shadow-inner text-sm"}),h.jsxs("p",{className:"text-slate-500 text-[9px] uppercase tracking-widest font-righteous ml-4 opacity-60",children:[h.jsx("span",{className:"text-[var(--neon-yellow)]",children:"PRO TIP:"})," Use ",h.jsx("span",{className:"text-white",children:"ngrok"})," for secure external tunneling."]})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>g(!1),className:"flex-1 py-4 bg-black border border-white/10 hover:bg-white/5 text-slate-400 hover:text-white rounded-xl font-bold text-[10px] uppercase tracking-widest transition-all font-righteous",children:"Cancel"}),h.jsx("button",{onClick:A,className:"flex-1 py-4 bg-[var(--neon-cyan)] text-black rounded-xl font-bold text-[10px] uppercase tracking-widest shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white transition-all font-righteous hover:scale-105",children:"Save Configuration"})]})]})})]})}return h.jsxs("div",{className:"min-h-screen bg-[#050510] text-white selection:bg-[var(--neon-pink)] selection:text-white",children:[h.jsx("nav",{className:"fixed top-0 inset-x-0 z-[100] backdrop-blur-xl bg-black/80 border-b border-white/5 transition-all duration-300",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-6 h-20 flex items-center justify-between",children:[h.jsxs("div",{onClick:()=>e("SELECT"),className:"cursor-pointer group flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-[var(--neon-pink)] p-0.5 group-hover:shadow-[0_0_20px_rgba(255,0,127,0.4)] transition-all",children:h.jsx("img",{src:"IGK.jpeg",alt:"Logo",className:"w-full h-full rounded-full"})}),h.jsx("span",{className:"font-bungee text-xl text-white tracking-widest group-hover:text-[var(--neon-cyan)] transition-colors",children:"Singmode v.2"})]}),h.jsx("div",{className:"flex items-center gap-6",children:h.jsxs("button",{onClick:()=>{e("SELECT"),l(null)},className:"text-[9px] font-bold uppercase tracking-widest px-5 py-2.5 rounded-xl transition-all font-righteous bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white border border-white/5 hover:border-white/20",children:["EXIT ",s]})})]})}),h.jsx("main",{className:"pb-20",children:s==="DJ"?h.jsx(JP,{onAdminAccess:()=>e("ADMIN")}):h.jsx(e3,{})})]})},uA=document.getElementById("root");if(!uA)throw new Error("Could not find root element to mount to");const s3=eC.createRoot(uA);s3.render(h.jsx($I.StrictMode,{children:h.jsx(r3,{})}));
