var qR=r=>{throw TypeError(r)};var Uu=(r,e,t)=>e.has(r)?qR("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);function HR(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in r)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(r,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function Qp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var A0={exports:{}},zu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function $R(){if(i1)return zu;i1=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var d in i)d!=="key"&&(o[d]=i[d])}else o=i;return i=o.ref,{$$typeof:r,type:n,key:c,ref:i!==void 0?i:null,props:o}}return zu.Fragment=e,zu.jsx=t,zu.jsxs=t,zu}var a1;function KR(){return a1||(a1=1,A0.exports=$R()),A0.exports}var h=KR(),C0={exports:{}},He={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o1;function QR(){if(o1)return He;o1=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),_=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=_&&V[_]||V["@@iterator"],typeof V=="function"?V:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L=Object.assign,B={};function X(V,te,pe){this.props=V,this.context=te,this.refs=B,this.updater=pe||k}X.prototype.isReactComponent={},X.prototype.setState=function(V,te){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,te,"setState")},X.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function re(){}re.prototype=X.prototype;function ee(V,te,pe){this.props=V,this.context=te,this.refs=B,this.updater=pe||k}var le=ee.prototype=new re;le.constructor=ee,L(le,X.prototype),le.isPureReactComponent=!0;var fe=Array.isArray;function ce(){}var C={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function R(V,te,pe){var ye=pe.ref;return{$$typeof:r,type:V,key:te,ref:ye!==void 0?ye:null,props:pe}}function U(V,te){return R(V.type,te,V.props)}function D(V){return typeof V=="object"&&V!==null&&V.$$typeof===r}function M(V){var te={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(pe){return te[pe]})}var O=/\/+/g;function qe(V,te){return typeof V=="object"&&V!==null&&V.key!=null?M(""+V.key):te.toString(36)}function gt(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(ce,ce):(V.status="pending",V.then(function(te){V.status==="pending"&&(V.status="fulfilled",V.value=te)},function(te){V.status==="pending"&&(V.status="rejected",V.reason=te)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function Z(V,te,pe,ye,Ne){var Re=typeof V;(Re==="undefined"||Re==="boolean")&&(V=null);var Be=!1;if(V===null)Be=!0;else switch(Re){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(V.$$typeof){case r:case e:Be=!0;break;case v:return Be=V._init,Z(Be(V._payload),te,pe,ye,Ne)}}if(Be)return Ne=Ne(V),Be=ye===""?"."+qe(V,0):ye,fe(Ne)?(pe="",Be!=null&&(pe=Be.replace(O,"$&/")+"/"),Z(Ne,te,pe,"",function($e){return $e})):Ne!=null&&(D(Ne)&&(Ne=U(Ne,pe+(Ne.key==null||V&&V.key===Ne.key?"":(""+Ne.key).replace(O,"$&/")+"/")+Be)),te.push(Ne)),1;Be=0;var Je=ye===""?".":ye+":";if(fe(V))for(var rt=0;rt<V.length;rt++)ye=V[rt],Re=Je+qe(ye,rt),Be+=Z(ye,te,pe,Re,Ne);else if(rt=S(V),typeof rt=="function")for(V=rt.call(V),rt=0;!(ye=V.next()).done;)ye=ye.value,Re=Je+qe(ye,rt++),Be+=Z(ye,te,pe,Re,Ne);else if(Re==="object"){if(typeof V.then=="function")return Z(gt(V),te,pe,ye,Ne);throw te=String(V),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Be}function he(V,te,pe){if(V==null)return V;var ye=[],Ne=0;return Z(V,ye,"","",function(Re){return te.call(pe,Re,Ne++)}),ye}function Te(V){if(V._status===-1){var te=V._result;te=te(),te.then(function(pe){(V._status===0||V._status===-1)&&(V._status=1,V._result=pe)},function(pe){(V._status===0||V._status===-1)&&(V._status=2,V._result=pe)}),V._status===-1&&(V._status=0,V._result=te)}if(V._status===1)return V._result.default;throw V._result}var Me=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},Ve={map:he,forEach:function(V,te,pe){he(V,function(){te.apply(this,arguments)},pe)},count:function(V){var te=0;return he(V,function(){te++}),te},toArray:function(V){return he(V,function(te){return te})||[]},only:function(V){if(!D(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return He.Activity=b,He.Children=Ve,He.Component=X,He.Fragment=t,He.Profiler=i,He.PureComponent=ee,He.StrictMode=n,He.Suspense=f,He.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,He.__COMPILER_RUNTIME={__proto__:null,c:function(V){return C.H.useMemoCache(V)}},He.cache=function(V){return function(){return V.apply(null,arguments)}},He.cacheSignal=function(){return null},He.cloneElement=function(V,te,pe){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ye=L({},V.props),Ne=V.key;if(te!=null)for(Re in te.key!==void 0&&(Ne=""+te.key),te)!I.call(te,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&te.ref===void 0||(ye[Re]=te[Re]);var Re=arguments.length-2;if(Re===1)ye.children=pe;else if(1<Re){for(var Be=Array(Re),Je=0;Je<Re;Je++)Be[Je]=arguments[Je+2];ye.children=Be}return R(V.type,Ne,ye)},He.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:o,_context:V},V},He.createElement=function(V,te,pe){var ye,Ne={},Re=null;if(te!=null)for(ye in te.key!==void 0&&(Re=""+te.key),te)I.call(te,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(Ne[ye]=te[ye]);var Be=arguments.length-2;if(Be===1)Ne.children=pe;else if(1<Be){for(var Je=Array(Be),rt=0;rt<Be;rt++)Je[rt]=arguments[rt+2];Ne.children=Je}if(V&&V.defaultProps)for(ye in Be=V.defaultProps,Be)Ne[ye]===void 0&&(Ne[ye]=Be[ye]);return R(V,Re,Ne)},He.createRef=function(){return{current:null}},He.forwardRef=function(V){return{$$typeof:d,render:V}},He.isValidElement=D,He.lazy=function(V){return{$$typeof:v,_payload:{_status:-1,_result:V},_init:Te}},He.memo=function(V,te){return{$$typeof:m,type:V,compare:te===void 0?null:te}},He.startTransition=function(V){var te=C.T,pe={};C.T=pe;try{var ye=V(),Ne=C.S;Ne!==null&&Ne(pe,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then(ce,Me)}catch(Re){Me(Re)}finally{te!==null&&pe.types!==null&&(te.types=pe.types),C.T=te}},He.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},He.use=function(V){return C.H.use(V)},He.useActionState=function(V,te,pe){return C.H.useActionState(V,te,pe)},He.useCallback=function(V,te){return C.H.useCallback(V,te)},He.useContext=function(V){return C.H.useContext(V)},He.useDebugValue=function(){},He.useDeferredValue=function(V,te){return C.H.useDeferredValue(V,te)},He.useEffect=function(V,te){return C.H.useEffect(V,te)},He.useEffectEvent=function(V){return C.H.useEffectEvent(V)},He.useId=function(){return C.H.useId()},He.useImperativeHandle=function(V,te,pe){return C.H.useImperativeHandle(V,te,pe)},He.useInsertionEffect=function(V,te){return C.H.useInsertionEffect(V,te)},He.useLayoutEffect=function(V,te){return C.H.useLayoutEffect(V,te)},He.useMemo=function(V,te){return C.H.useMemo(V,te)},He.useOptimistic=function(V,te){return C.H.useOptimistic(V,te)},He.useReducer=function(V,te,pe){return C.H.useReducer(V,te,pe)},He.useRef=function(V){return C.H.useRef(V)},He.useState=function(V){return C.H.useState(V)},He.useSyncExternalStore=function(V,te,pe){return C.H.useSyncExternalStore(V,te,pe)},He.useTransition=function(){return C.H.useTransition()},He.version="19.2.4",He}var l1;function qd(){return l1||(l1=1,C0.exports=QR()),C0.exports}var j=qd();const sn=Qp(j);var R0={exports:{}},Bu={},k0={exports:{}},D0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1;function YR(){return c1||(c1=1,(function(r){function e(Z,he){var Te=Z.length;Z.push(he);e:for(;0<Te;){var Me=Te-1>>>1,Ve=Z[Me];if(0<i(Ve,he))Z[Me]=he,Z[Te]=Ve,Te=Me;else break e}}function t(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var he=Z[0],Te=Z.pop();if(Te!==he){Z[0]=Te;e:for(var Me=0,Ve=Z.length,V=Ve>>>1;Me<V;){var te=2*(Me+1)-1,pe=Z[te],ye=te+1,Ne=Z[ye];if(0>i(pe,Te))ye<Ve&&0>i(Ne,pe)?(Z[Me]=Ne,Z[ye]=Te,Me=ye):(Z[Me]=pe,Z[te]=Te,Me=te);else if(ye<Ve&&0>i(Ne,Te))Z[Me]=Ne,Z[ye]=Te,Me=ye;else break e}}return he}function i(Z,he){var Te=Z.sortIndex-he.sortIndex;return Te!==0?Te:Z.id-he.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var c=Date,d=c.now();r.unstable_now=function(){return c.now()-d}}var f=[],m=[],v=1,b=null,_=3,S=!1,k=!1,L=!1,B=!1,X=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function le(Z){for(var he=t(m);he!==null;){if(he.callback===null)n(m);else if(he.startTime<=Z)n(m),he.sortIndex=he.expirationTime,e(f,he);else break;he=t(m)}}function fe(Z){if(L=!1,le(Z),!k)if(t(f)!==null)k=!0,ce||(ce=!0,M());else{var he=t(m);he!==null&&gt(fe,he.startTime-Z)}}var ce=!1,C=-1,I=5,R=-1;function U(){return B?!0:!(r.unstable_now()-R<I)}function D(){if(B=!1,ce){var Z=r.unstable_now();R=Z;var he=!0;try{e:{k=!1,L&&(L=!1,re(C),C=-1),S=!0;var Te=_;try{t:{for(le(Z),b=t(f);b!==null&&!(b.expirationTime>Z&&U());){var Me=b.callback;if(typeof Me=="function"){b.callback=null,_=b.priorityLevel;var Ve=Me(b.expirationTime<=Z);if(Z=r.unstable_now(),typeof Ve=="function"){b.callback=Ve,le(Z),he=!0;break t}b===t(f)&&n(f),le(Z)}else n(f);b=t(f)}if(b!==null)he=!0;else{var V=t(m);V!==null&&gt(fe,V.startTime-Z),he=!1}}break e}finally{b=null,_=Te,S=!1}he=void 0}}finally{he?M():ce=!1}}}var M;if(typeof ee=="function")M=function(){ee(D)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,qe=O.port2;O.port1.onmessage=D,M=function(){qe.postMessage(null)}}else M=function(){X(D,0)};function gt(Z,he){C=X(function(){Z(r.unstable_now())},he)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Z){Z.callback=null},r.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Z?Math.floor(1e3/Z):5},r.unstable_getCurrentPriorityLevel=function(){return _},r.unstable_next=function(Z){switch(_){case 1:case 2:case 3:var he=3;break;default:he=_}var Te=_;_=he;try{return Z()}finally{_=Te}},r.unstable_requestPaint=function(){B=!0},r.unstable_runWithPriority=function(Z,he){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Te=_;_=Z;try{return he()}finally{_=Te}},r.unstable_scheduleCallback=function(Z,he,Te){var Me=r.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?Me+Te:Me):Te=Me,Z){case 1:var Ve=-1;break;case 2:Ve=250;break;case 5:Ve=1073741823;break;case 4:Ve=1e4;break;default:Ve=5e3}return Ve=Te+Ve,Z={id:v++,callback:he,priorityLevel:Z,startTime:Te,expirationTime:Ve,sortIndex:-1},Te>Me?(Z.sortIndex=Te,e(m,Z),t(f)===null&&Z===t(m)&&(L?(re(C),C=-1):L=!0,gt(fe,Te-Me))):(Z.sortIndex=Ve,e(f,Z),k||S||(k=!0,ce||(ce=!0,M()))),Z},r.unstable_shouldYield=U,r.unstable_wrapCallback=function(Z){var he=_;return function(){var Te=_;_=he;try{return Z.apply(this,arguments)}finally{_=Te}}}})(D0)),D0}var u1;function XR(){return u1||(u1=1,k0.exports=YR()),k0.exports}var O0={exports:{}},br={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d1;function JR(){if(d1)return br;d1=1;var r=qd();function e(f){var m="https://react.dev/errors/"+f;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(f,m,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:b==null?null:""+b,children:f,containerInfo:m,implementation:v}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,m){if(f==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return br.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,br.createPortal=function(f,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(f,m,null,v)},br.flushSync=function(f){var m=c.T,v=n.p;try{if(c.T=null,n.p=2,f)return f()}finally{c.T=m,n.p=v,n.d.f()}},br.preconnect=function(f,m){typeof f=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,n.d.C(f,m))},br.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},br.preinit=function(f,m){if(typeof f=="string"&&m&&typeof m.as=="string"){var v=m.as,b=d(v,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?n.d.S(f,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:b,integrity:_,fetchPriority:S}):v==="script"&&n.d.X(f,{crossOrigin:b,integrity:_,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},br.preinitModule=function(f,m){if(typeof f=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=d(m.as,m.crossOrigin);n.d.M(f,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&n.d.M(f)},br.preload=function(f,m){if(typeof f=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,b=d(v,m.crossOrigin);n.d.L(f,v,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},br.preloadModule=function(f,m){if(typeof f=="string")if(m){var v=d(m.as,m.crossOrigin);n.d.m(f,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else n.d.m(f)},br.requestFormReset=function(f){n.d.r(f)},br.unstable_batchedUpdates=function(f,m){return f(m)},br.useFormState=function(f,m,v){return c.H.useFormState(f,m,v)},br.useFormStatus=function(){return c.H.useHostTransitionStatus()},br.version="19.2.4",br}var h1;function cS(){if(h1)return O0.exports;h1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),O0.exports=JR(),O0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f1;function WR(){if(f1)return Bu;f1=1;var r=XR(),e=qd(),t=cS();function n(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var a=s,l=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(l=a.return),s=a.return;while(s)}return a.tag===3?l:null}function c(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function d(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function f(s){if(o(s)!==s)throw Error(n(188))}function m(s){var a=s.alternate;if(!a){if(a=o(s),a===null)throw Error(n(188));return a!==s?null:s}for(var l=s,u=a;;){var g=l.return;if(g===null)break;var y=g.alternate;if(y===null){if(u=g.return,u!==null){l=u;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===l)return f(g),s;if(y===u)return f(g),a;y=y.sibling}throw Error(n(188))}if(l.return!==u.return)l=g,u=y;else{for(var w=!1,N=g.child;N;){if(N===l){w=!0,l=g,u=y;break}if(N===u){w=!0,u=g,l=y;break}N=N.sibling}if(!w){for(N=y.child;N;){if(N===l){w=!0,l=y,u=g;break}if(N===u){w=!0,u=y,l=g;break}N=N.sibling}if(!w)throw Error(n(189))}}if(l.alternate!==u)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?s:a}function v(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=v(s),a!==null)return a;s=s.sibling}return null}var b=Object.assign,_=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),re=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),le=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function M(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var O=Symbol.for("react.client.reference");function qe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===O?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case L:return"Fragment";case X:return"Profiler";case B:return"StrictMode";case fe:return"Suspense";case ce:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case k:return"Portal";case ee:return s.displayName||"Context";case re:return(s._context.displayName||"Context")+".Consumer";case le:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return a=s.displayName||null,a!==null?a:qe(s.type)||"Memo";case I:a=s._payload,s=s._init;try{return qe(s(a))}catch{}}return null}var gt=Array.isArray,Z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},Me=[],Ve=-1;function V(s){return{current:s}}function te(s){0>Ve||(s.current=Me[Ve],Me[Ve]=null,Ve--)}function pe(s,a){Ve++,Me[Ve]=s.current,s.current=a}var ye=V(null),Ne=V(null),Re=V(null),Be=V(null);function Je(s,a){switch(pe(Re,a),pe(Ne,s),pe(ye,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?Aw(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=Aw(a),s=Cw(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}te(ye),pe(ye,s)}function rt(){te(ye),te(Ne),te(Re)}function $e(s){s.memoizedState!==null&&pe(Be,s);var a=ye.current,l=Cw(a,s.type);a!==l&&(pe(Ne,s),pe(ye,l))}function Zn(s){Ne.current===s&&(te(ye),te(Ne)),Be.current===s&&(te(Be),Pu._currentValue=Te)}var En,fr;function Ke(s){if(En===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);En=a&&a[1]||"",fr=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+En+s+fr}var Ar=!1;function Bn(s,a){if(!s||Ar)return"";Ar=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(W){var Y=W}Reflect.construct(s,[],oe)}else{try{oe.call()}catch(W){Y=W}s.call(oe.prototype)}}else{try{throw Error()}catch(W){Y=W}(oe=s())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(W){if(W&&Y&&typeof W.stack=="string")return[W.stack,Y.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),w=y[0],N=y[1];if(w&&N){var P=w.split(`
`),Q=N.split(`
`);for(g=u=0;u<P.length&&!P[u].includes("DetermineComponentFrameRoot");)u++;for(;g<Q.length&&!Q[g].includes("DetermineComponentFrameRoot");)g++;if(u===P.length||g===Q.length)for(u=P.length-1,g=Q.length-1;1<=u&&0<=g&&P[u]!==Q[g];)g--;for(;1<=u&&0<=g;u--,g--)if(P[u]!==Q[g]){if(u!==1||g!==1)do if(u--,g--,0>g||P[u]!==Q[g]){var se=`
`+P[u].replace(" at new "," at ");return s.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",s.displayName)),se}while(1<=u&&0<=g);break}}}finally{Ar=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Ke(l):""}function Cs(s,a){switch(s.tag){case 26:case 27:case 5:return Ke(s.type);case 16:return Ke("Lazy");case 13:return s.child!==a&&a!==null?Ke("Suspense Fallback"):Ke("Suspense");case 19:return Ke("SuspenseList");case 0:case 15:return Bn(s.type,!1);case 11:return Bn(s.type.render,!1);case 1:return Bn(s.type,!0);case 31:return Ke("Activity");default:return""}}function Rs(s){try{var a="",l=null;do a+=Cs(s,l),l=s,s=s.return;while(s);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var _t=Object.prototype.hasOwnProperty,st=r.unstable_scheduleCallback,Wt=r.unstable_cancelCallback,Kr=r.unstable_shouldYield,on=r.unstable_requestPaint,zt=r.unstable_now,Tn=r.unstable_getCurrentPriorityLevel,er=r.unstable_ImmediatePriority,ln=r.unstable_UserBlockingPriority,qt=r.unstable_NormalPriority,tr=r.unstable_LowPriority,us=r.unstable_IdlePriority,K=r.log,ve=r.unstable_setDisableYieldValue,Oe=null,Le=null;function et(s){if(typeof K=="function"&&ve(s),Le&&typeof Le.setStrictMode=="function")try{Le.setStrictMode(Oe,s)}catch{}}var we=Math.clz32?Math.clz32:Sn,Ht=Math.log,nr=Math.LN2;function Sn(s){return s>>>=0,s===0?32:31-(Ht(s)/nr|0)|0}var $t=256,kn=262144,Qe=4194304;function xt(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Bt(s,a,l){var u=s.pendingLanes;if(u===0)return 0;var g=0,y=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var N=u&134217727;return N!==0?(u=N&~y,u!==0?g=xt(u):(w&=N,w!==0?g=xt(w):l||(l=N&~s,l!==0&&(g=xt(l))))):(N=u&~y,N!==0?g=xt(N):w!==0?g=xt(w):l||(l=u&~s,l!==0&&(g=xt(l)))),g===0?0:a!==0&&a!==g&&(a&y)===0&&(y=g&-g,l=a&-a,y>=l||y===32&&(l&4194048)!==0)?a:g}function Kt(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function Fn(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pn(){var s=Qe;return Qe<<=1,(Qe&62914560)===0&&(Qe=4194304),s}function Zt(s){for(var a=[],l=0;31>l;l++)a.push(s);return a}function pr(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Qt(s,a,l,u,g,y){var w=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var N=s.entanglements,P=s.expirationTimes,Q=s.hiddenUpdates;for(l=w&~l;0<l;){var se=31-we(l),oe=1<<se;N[se]=0,P[se]=-1;var Y=Q[se];if(Y!==null)for(Q[se]=null,se=0;se<Y.length;se++){var W=Y[se];W!==null&&(W.lane&=-536870913)}l&=~oe}u!==0&&Dn(s,u,0),y!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=y&~(w&~a))}function Dn(s,a,l){s.pendingLanes|=a,s.suspendedLanes&=~a;var u=31-we(a);s.entangledLanes|=a,s.entanglements[u]=s.entanglements[u]|1073741824|l&261930}function yt(s,a){var l=s.entangledLanes|=a;for(s=s.entanglements;l;){var u=31-we(l),g=1<<u;g&a|s[u]&a&&(s[u]|=a),l&=~g}}function _e(s,a){var l=a&-a;return l=(l&42)!==0?1:mr(l),(l&(s.suspendedLanes|a))!==0?0:l}function mr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function rr(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function gr(){var s=he.p;return s!==0?s:(s=window.event,s===void 0?32:Ww(s.type))}function Gn(s,a){var l=he.p;try{return he.p=s,a()}finally{he.p=l}}var Qn=Math.random().toString(36).slice(2),Yt="__reactFiber$"+Qn,mn="__reactProps$"+Qn,ds="__reactContainer$"+Qn,Ki="__reactEvents$"+Qn,Jc="__reactListeners$"+Qn,io="__reactHandles$"+Qn,On="__reactResources$"+Qn,Qr="__reactMarker$"+Qn;function Qi(s){delete s[Yt],delete s[mn],delete s[Ki],delete s[Jc],delete s[io]}function hs(s){var a=s[Yt];if(a)return a;for(var l=s.parentNode;l;){if(a=l[ds]||l[Yt]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(s=Mw(s);s!==null;){if(l=s[Yt])return l;s=Mw(s)}return a}s=l,l=s.parentNode}return null}function Mr(s){if(s=s[Yt]||s[ds]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function yr(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(n(33))}function fs(s){var a=s[On];return a||(a=s[On]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function gn(s){s[Qr]=!0}var Yi=new Set,ao={};function ps(s,a){Yr(s,a),Yr(s+"Capture",a)}function Yr(s,a){for(ao[s]=a,s=0;s<a.length;s++)Yi.add(a[s])}var ms=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xr={},Xi={};function dl(s){return _t.call(Xi,s)?!0:_t.call(Xr,s)?!1:ms.test(s)?Xi[s]=!0:(Xr[s]=!0,!1)}function Cr(s,a,l){if(dl(a))if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+l)}}function cn(s,a,l){if(l===null)s.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+l)}}function en(s,a,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(a,l,""+u)}}function yn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Vr(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ji(s,a,l){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,y=u.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return g.call(this)},set:function(w){l=""+w,y.call(this,w)}}),Object.defineProperty(s,a,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(w){l=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function it(s){if(!s._valueTracker){var a=Vr(s)?"checked":"value";s._valueTracker=Ji(s,a,""+s[a])}}function vn(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return s&&(u=Vr(s)?s.checked?"true":"false":s.value),s=u,s!==l?(a.setValue(s),!0):!1}function Jr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Ks=/[\n"\\]/g;function vr(s){return s.replace(Ks,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Wi(s,a,l,u,g,y,w,N){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+yn(a)):s.value!==""+yn(a)&&(s.value=""+yn(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?Zi(s,w,yn(a)):l!=null?Zi(s,w,yn(l)):u!=null&&s.removeAttribute("value"),g==null&&y!=null&&(s.defaultChecked=!!y),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+yn(N):s.removeAttribute("name")}function oo(s,a,l,u,g,y,w,N){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),a!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||a!=null)){it(s);return}l=l!=null?""+yn(l):"",a=a!=null?""+yn(a):l,N||a===s.value||(s.value=a),s.defaultValue=a}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=N?s.checked:!!u,s.defaultChecked=!!u,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),it(s)}function Zi(s,a,l){a==="number"&&Jr(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function ks(s,a,l,u){if(s=s.options,a){a={};for(var g=0;g<l.length;g++)a["$"+l[g]]=!0;for(l=0;l<s.length;l++)g=a.hasOwnProperty("$"+s[l].value),s[l].selected!==g&&(s[l].selected=g),g&&u&&(s[l].defaultSelected=!0)}else{for(l=""+yn(l),a=null,g=0;g<s.length;g++){if(s[g].value===l){s[g].selected=!0,u&&(s[g].defaultSelected=!0);return}a!==null||s[g].disabled||(a=s[g])}a!==null&&(a.selected=!0)}}function lo(s,a,l){if(a!=null&&(a=""+yn(a),a!==s.value&&(s.value=a),l==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=l!=null?""+yn(l):""}function Ds(s,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(n(92));if(gt(u)){if(1<u.length)throw Error(n(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=yn(a),s.defaultValue=l,u=s.textContent,u===l&&u!==""&&u!==null&&(s.value=u),it(s)}function sr(s,a){if(a){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=a;return}}s.textContent=a}var co=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ea(s,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":u?s.setProperty(a,l):typeof l!="number"||l===0||co.has(a)?a==="float"?s.cssFloat=l:s[a]=(""+l).trim():s[a]=l+"px"}function T(s,a,l){if(a!=null&&typeof a!="object")throw Error(n(62));if(s=s.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var g in a)u=a[g],a.hasOwnProperty(g)&&l[g]!==u&&ea(s,g,u)}else for(var y in a)a.hasOwnProperty(y)&&ea(s,y,a[y])}function ne(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var G=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ue=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function be(s){return ue.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function De(){}var We=null;function vt(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var un=null,St=null;function Os(s){var a=Mr(s);if(a&&(s=a.stateNode)){var l=s[mn]||null;e:switch(s=a.stateNode,a.type){case"input":if(Wi(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+vr(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==s&&u.form===s.form){var g=u[mn]||null;if(!g)throw Error(n(90));Wi(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===s.form&&vn(u)}break e;case"textarea":lo(s,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&ks(s,!!l.multiple,a,!1)}}}var hl=!1;function ta(s,a,l){if(hl)return s(a,l);hl=!0;try{var u=s(a);return u}finally{if(hl=!1,(un!==null||St!==null)&&(sf(),un&&(a=un,s=St,St=un=null,Os(a),s)))for(a=0;a<s.length;a++)Os(s[a])}}function js(s,a){var l=s.stateNode;if(l===null)return null;var u=l[mn]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(n(231,a,typeof l));return l}var gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uo=!1;if(gs)try{var Pt={};Object.defineProperty(Pt,"passive",{get:function(){uo=!0}}),window.addEventListener("test",Pt,Pt),window.removeEventListener("test",Pt,Pt)}catch{uo=!1}var Qs=null,Wc=null,ho=null;function Zc(){if(ho)return ho;var s,a=Wc,l=a.length,u,g="value"in Qs?Qs.value:Qs.textContent,y=g.length;for(s=0;s<l&&a[s]===g[s];s++);var w=l-s;for(u=1;u<=w&&a[l-u]===g[y-u];u++);return ho=g.slice(s,1<u?1-u:void 0)}function fo(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function mi(){return!0}function Ps(){return!1}function ir(s){function a(l,u,g,y,w){this._reactName=l,this._targetInst=g,this.type=u,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(l=s[N],this[N]=l?l(y):y[N]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?mi:Ps,this.isPropagationStopped=Ps,this}return b(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=mi)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=mi)},persist:function(){},isPersistent:mi}),a}var gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ys=ir(gi),na=b({},gi,{view:0,detail:0}),eu=ir(na),ra,fl,Xs,pl=b({},na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sa,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Xs&&(Xs&&s.type==="mousemove"?(ra=s.screenX-Xs.screenX,fl=s.screenY-Xs.screenY):fl=ra=0,Xs=s),ra)},movementY:function(s){return"movementY"in s?s.movementY:fl}}),tu=ir(pl),po=b({},pl,{dataTransfer:0}),hh=ir(po),fh=b({},na,{relatedTarget:0}),mo=ir(fh),nu=b({},gi,{animationName:0,elapsedTime:0,pseudoElement:0}),ph=ir(nu),ml=b({},gi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),mh=ir(ml),gh=b({},gi,{data:0}),Js=ir(gh),yh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xh(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=bh[s])?!!a[s]:!1}function sa(){return xh}var Rr=b({},na,{key:function(s){if(s.key){var a=yh[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=fo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?vh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sa,charCode:function(s){return s.type==="keypress"?fo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?fo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),_h=ir(Rr),wh=b({},pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yi=ir(wh),p=b({},na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sa}),x=ir(p),E=b({},gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=ir(E),H=b({},pl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),J=ir(H),ge=b({},gi,{newState:0,oldState:0}),Ye=ir(ge),Nn=[9,13,27,32],Nt=gs&&"CompositionEvent"in window,tn=null;gs&&"documentMode"in document&&(tn=document.documentMode);var ys=gs&&"TextEvent"in window&&!tn,Ws=gs&&(!Nt||tn&&8<tn&&11>=tn),Ms=" ",Vs=!1;function go(s,a){switch(s){case"keyup":return Nn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var yl=!1;function pC(s,a){switch(s){case"compositionend":return gl(a);case"keypress":return a.which!==32?null:(Vs=!0,Ms);case"textInput":return s=a.data,s===Ms&&Vs?null:s;default:return null}}function mC(s,a){if(yl)return s==="compositionend"||!Nt&&go(s,a)?(s=Zc(),ho=Wc=Qs=null,yl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ws&&a.locale!=="ko"?null:a.data;default:return null}}var gC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ub(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!gC[s.type]:a==="textarea"}function zb(s,a,l,u){un?St?St.push(u):St=[u]:un=u,a=hf(a,"onChange"),0<a.length&&(l=new Ys("onChange","change",null,l,u),s.push({event:l,listeners:a}))}var ru=null,su=null;function yC(s){ww(s,0)}function Eh(s){var a=yr(s);if(vn(a))return s}function Bb(s,a){if(s==="change")return a}var Fb=!1;if(gs){var Pm;if(gs){var Mm="oninput"in document;if(!Mm){var Gb=document.createElement("div");Gb.setAttribute("oninput","return;"),Mm=typeof Gb.oninput=="function"}Pm=Mm}else Pm=!1;Fb=Pm&&(!document.documentMode||9<document.documentMode)}function qb(){ru&&(ru.detachEvent("onpropertychange",Hb),su=ru=null)}function Hb(s){if(s.propertyName==="value"&&Eh(su)){var a=[];zb(a,su,s,vt(s)),ta(yC,a)}}function vC(s,a,l){s==="focusin"?(qb(),ru=a,su=l,ru.attachEvent("onpropertychange",Hb)):s==="focusout"&&qb()}function bC(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Eh(su)}function xC(s,a){if(s==="click")return Eh(a)}function _C(s,a){if(s==="input"||s==="change")return Eh(a)}function wC(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Wr=typeof Object.is=="function"?Object.is:wC;function iu(s,a){if(Wr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var l=Object.keys(s),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var g=l[u];if(!_t.call(a,g)||!Wr(s[g],a[g]))return!1}return!0}function $b(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Kb(s,a){var l=$b(s);s=0;for(var u;l;){if(l.nodeType===3){if(u=s+l.textContent.length,s<=a&&u>=a)return{node:l,offset:a-s};s=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=$b(l)}}function Qb(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?Qb(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function Yb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Jr(s.document);a instanceof s.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)s=a.contentWindow;else break;a=Jr(s.document)}return a}function Vm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var EC=gs&&"documentMode"in document&&11>=document.documentMode,vl=null,Lm=null,au=null,Um=!1;function Xb(s,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Um||vl==null||vl!==Jr(u)||(u=vl,"selectionStart"in u&&Vm(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),au&&iu(au,u)||(au=u,u=hf(Lm,"onSelect"),0<u.length&&(a=new Ys("onSelect","select",null,a,l),s.push({event:a,listeners:u}),a.target=vl)))}function yo(s,a){var l={};return l[s.toLowerCase()]=a.toLowerCase(),l["Webkit"+s]="webkit"+a,l["Moz"+s]="moz"+a,l}var bl={animationend:yo("Animation","AnimationEnd"),animationiteration:yo("Animation","AnimationIteration"),animationstart:yo("Animation","AnimationStart"),transitionrun:yo("Transition","TransitionRun"),transitionstart:yo("Transition","TransitionStart"),transitioncancel:yo("Transition","TransitionCancel"),transitionend:yo("Transition","TransitionEnd")},zm={},Jb={};gs&&(Jb=document.createElement("div").style,"AnimationEvent"in window||(delete bl.animationend.animation,delete bl.animationiteration.animation,delete bl.animationstart.animation),"TransitionEvent"in window||delete bl.transitionend.transition);function vo(s){if(zm[s])return zm[s];if(!bl[s])return s;var a=bl[s],l;for(l in a)if(a.hasOwnProperty(l)&&l in Jb)return zm[s]=a[l];return s}var Wb=vo("animationend"),Zb=vo("animationiteration"),ex=vo("animationstart"),TC=vo("transitionrun"),SC=vo("transitionstart"),NC=vo("transitioncancel"),tx=vo("transitionend"),nx=new Map,Bm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Bm.push("scrollEnd");function Ls(s,a){nx.set(s,a),ps(a,[s])}var Th=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},vs=[],xl=0,Fm=0;function Sh(){for(var s=xl,a=Fm=xl=0;a<s;){var l=vs[a];vs[a++]=null;var u=vs[a];vs[a++]=null;var g=vs[a];vs[a++]=null;var y=vs[a];if(vs[a++]=null,u!==null&&g!==null){var w=u.pending;w===null?g.next=g:(g.next=w.next,w.next=g),u.pending=g}y!==0&&rx(l,g,y)}}function Nh(s,a,l,u){vs[xl++]=s,vs[xl++]=a,vs[xl++]=l,vs[xl++]=u,Fm|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Gm(s,a,l,u){return Nh(s,a,l,u),Ih(s)}function bo(s,a){return Nh(s,null,null,a),Ih(s)}function rx(s,a,l){s.lanes|=l;var u=s.alternate;u!==null&&(u.lanes|=l);for(var g=!1,y=s.return;y!==null;)y.childLanes|=l,u=y.alternate,u!==null&&(u.childLanes|=l),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(g=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,g&&a!==null&&(g=31-we(l),s=y.hiddenUpdates,u=s[g],u===null?s[g]=[a]:u.push(a),a.lane=l|536870912),y):null}function Ih(s){if(50<Au)throw Au=0,Wg=null,Error(n(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var _l={};function IC(s,a,l,u){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zr(s,a,l,u){return new IC(s,a,l,u)}function qm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function vi(s,a){var l=s.alternate;return l===null?(l=Zr(s.tag,a,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=a,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,a=s.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function sx(s,a){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,a=l.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function Ah(s,a,l,u,g,y){var w=0;if(u=s,typeof s=="function")qm(s)&&(w=1);else if(typeof s=="string")w=DR(s,l,ye.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=Zr(31,l,a,g),s.elementType=R,s.lanes=y,s;case L:return xo(l.children,g,y,a);case B:w=8,g|=24;break;case X:return s=Zr(12,l,a,g|2),s.elementType=X,s.lanes=y,s;case fe:return s=Zr(13,l,a,g),s.elementType=fe,s.lanes=y,s;case ce:return s=Zr(19,l,a,g),s.elementType=ce,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ee:w=10;break e;case re:w=9;break e;case le:w=11;break e;case C:w=14;break e;case I:w=16,u=null;break e}w=29,l=Error(n(130,s===null?"null":typeof s,"")),u=null}return a=Zr(w,l,a,g),a.elementType=s,a.type=u,a.lanes=y,a}function xo(s,a,l,u){return s=Zr(7,s,u,a),s.lanes=l,s}function Hm(s,a,l){return s=Zr(6,s,null,a),s.lanes=l,s}function ix(s){var a=Zr(18,null,null,0);return a.stateNode=s,a}function $m(s,a,l){return a=Zr(4,s.children!==null?s.children:[],s.key,a),a.lanes=l,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var ax=new WeakMap;function bs(s,a){if(typeof s=="object"&&s!==null){var l=ax.get(s);return l!==void 0?l:(a={value:s,source:a,stack:Rs(a)},ax.set(s,a),a)}return{value:s,source:a,stack:Rs(a)}}var wl=[],El=0,Ch=null,ou=0,xs=[],_s=0,ia=null,Zs=1,ei="";function bi(s,a){wl[El++]=ou,wl[El++]=Ch,Ch=s,ou=a}function ox(s,a,l){xs[_s++]=Zs,xs[_s++]=ei,xs[_s++]=ia,ia=s;var u=Zs;s=ei;var g=32-we(u)-1;u&=~(1<<g),l+=1;var y=32-we(a)+g;if(30<y){var w=g-g%5;y=(u&(1<<w)-1).toString(32),u>>=w,g-=w,Zs=1<<32-we(a)+g|l<<g|u,ei=y+s}else Zs=1<<y|l<<g|u,ei=s}function Km(s){s.return!==null&&(bi(s,1),ox(s,1,0))}function Qm(s){for(;s===Ch;)Ch=wl[--El],wl[El]=null,ou=wl[--El],wl[El]=null;for(;s===ia;)ia=xs[--_s],xs[_s]=null,ei=xs[--_s],xs[_s]=null,Zs=xs[--_s],xs[_s]=null}function lx(s,a){xs[_s++]=Zs,xs[_s++]=ei,xs[_s++]=ia,Zs=a.id,ei=a.overflow,ia=s}var ar=null,Xt=null,ht=!1,aa=null,ws=!1,Ym=Error(n(519));function oa(s){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw lu(bs(a,s)),Ym}function cx(s){var a=s.stateNode,l=s.type,u=s.memoizedProps;switch(a[Yt]=s,a[mn]=u,l){case"dialog":ot("cancel",a),ot("close",a);break;case"iframe":case"object":case"embed":ot("load",a);break;case"video":case"audio":for(l=0;l<Ru.length;l++)ot(Ru[l],a);break;case"source":ot("error",a);break;case"img":case"image":case"link":ot("error",a),ot("load",a);break;case"details":ot("toggle",a);break;case"input":ot("invalid",a),oo(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":ot("invalid",a);break;case"textarea":ot("invalid",a),Ds(a,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||Nw(a.textContent,l)?(u.popover!=null&&(ot("beforetoggle",a),ot("toggle",a)),u.onScroll!=null&&ot("scroll",a),u.onScrollEnd!=null&&ot("scrollend",a),u.onClick!=null&&(a.onclick=De),a=!0):a=!1,a||oa(s,!0)}function ux(s){for(ar=s.return;ar;)switch(ar.tag){case 5:case 31:case 13:ws=!1;return;case 27:case 3:ws=!0;return;default:ar=ar.return}}function Tl(s){if(s!==ar)return!1;if(!ht)return ux(s),ht=!0,!1;var a=s.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||f0(s.type,s.memoizedProps)),l=!l),l&&Xt&&oa(s),ux(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Xt=Pw(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Xt=Pw(s)}else a===27?(a=Xt,_a(s.type)?(s=v0,v0=null,Xt=s):Xt=a):Xt=ar?Ts(s.stateNode.nextSibling):null;return!0}function _o(){Xt=ar=null,ht=!1}function Xm(){var s=aa;return s!==null&&(Br===null?Br=s:Br.push.apply(Br,s),aa=null),s}function lu(s){aa===null?aa=[s]:aa.push(s)}var Jm=V(null),wo=null,xi=null;function la(s,a,l){pe(Jm,a._currentValue),a._currentValue=l}function _i(s){s._currentValue=Jm.current,te(Jm)}function Wm(s,a,l){for(;s!==null;){var u=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),s===l)break;s=s.return}}function Zm(s,a,l,u){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var y=g.dependencies;if(y!==null){var w=g.child;y=y.firstContext;e:for(;y!==null;){var N=y;y=g;for(var P=0;P<a.length;P++)if(N.context===a[P]){y.lanes|=l,N=y.alternate,N!==null&&(N.lanes|=l),Wm(y.return,l,s),u||(w=null);break e}y=N.next}}else if(g.tag===18){if(w=g.return,w===null)throw Error(n(341));w.lanes|=l,y=w.alternate,y!==null&&(y.lanes|=l),Wm(w,l,s),w=null}else w=g.child;if(w!==null)w.return=g;else for(w=g;w!==null;){if(w===s){w=null;break}if(g=w.sibling,g!==null){g.return=w.return,w=g;break}w=w.return}g=w}}function Sl(s,a,l,u){s=null;for(var g=a,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var w=g.alternate;if(w===null)throw Error(n(387));if(w=w.memoizedProps,w!==null){var N=g.type;Wr(g.pendingProps.value,w.value)||(s!==null?s.push(N):s=[N])}}else if(g===Be.current){if(w=g.alternate,w===null)throw Error(n(387));w.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(Pu):s=[Pu])}g=g.return}s!==null&&Zm(a,s,l,u),a.flags|=262144}function Rh(s){for(s=s.firstContext;s!==null;){if(!Wr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Eo(s){wo=s,xi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function or(s){return dx(wo,s)}function kh(s,a){return wo===null&&Eo(s),dx(s,a)}function dx(s,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},xi===null){if(s===null)throw Error(n(308));xi=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else xi=xi.next=a;return l}var AC=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(l,u){s.push(u)}};this.abort=function(){a.aborted=!0,s.forEach(function(l){return l()})}},CC=r.unstable_scheduleCallback,RC=r.unstable_NormalPriority,jn={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function eg(){return{controller:new AC,data:new Map,refCount:0}}function cu(s){s.refCount--,s.refCount===0&&CC(RC,function(){s.controller.abort()})}var uu=null,tg=0,Nl=0,Il=null;function kC(s,a){if(uu===null){var l=uu=[];tg=0,Nl=s0(),Il={status:"pending",value:void 0,then:function(u){l.push(u)}}}return tg++,a.then(hx,hx),a}function hx(){if(--tg===0&&uu!==null){Il!==null&&(Il.status="fulfilled");var s=uu;uu=null,Nl=0,Il=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function DC(s,a){var l=[],u={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return s.then(function(){u.status="fulfilled",u.value=a;for(var g=0;g<l.length;g++)(0,l[g])(a)},function(g){for(u.status="rejected",u.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),u}var fx=Z.S;Z.S=function(s,a){X_=zt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&kC(s,a),fx!==null&&fx(s,a)};var To=V(null);function ng(){var s=To.current;return s!==null?s:Ut.pooledCache}function Dh(s,a){a===null?pe(To,To.current):pe(To,a.pool)}function px(){var s=ng();return s===null?null:{parent:jn._currentValue,pool:s}}var Al=Error(n(460)),rg=Error(n(474)),Oh=Error(n(542)),jh={then:function(){}};function mx(s){return s=s.status,s==="fulfilled"||s==="rejected"}function gx(s,a,l){switch(l=s[l],l===void 0?s.push(a):l!==a&&(a.then(De,De),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,vx(s),s;default:if(typeof a.status=="string")a.then(De,De);else{if(s=Ut,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=a,s.status="pending",s.then(function(u){if(a.status==="pending"){var g=a;g.status="fulfilled",g.value=u}},function(u){if(a.status==="pending"){var g=a;g.status="rejected",g.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,vx(s),s}throw No=a,Al}}function So(s){try{var a=s._init;return a(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(No=l,Al):l}}var No=null;function yx(){if(No===null)throw Error(n(459));var s=No;return No=null,s}function vx(s){if(s===Al||s===Oh)throw Error(n(483))}var Cl=null,du=0;function Ph(s){var a=du;return du+=1,Cl===null&&(Cl=[]),gx(Cl,s,a)}function hu(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function Mh(s,a){throw a.$$typeof===_?Error(n(525)):(s=Object.prototype.toString.call(a),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function bx(s){function a(F,z){if(s){var $=F.deletions;$===null?(F.deletions=[z],F.flags|=16):$.push(z)}}function l(F,z){if(!s)return null;for(;z!==null;)a(F,z),z=z.sibling;return null}function u(F){for(var z=new Map;F!==null;)F.key!==null?z.set(F.key,F):z.set(F.index,F),F=F.sibling;return z}function g(F,z){return F=vi(F,z),F.index=0,F.sibling=null,F}function y(F,z,$){return F.index=$,s?($=F.alternate,$!==null?($=$.index,$<z?(F.flags|=67108866,z):$):(F.flags|=67108866,z)):(F.flags|=1048576,z)}function w(F){return s&&F.alternate===null&&(F.flags|=67108866),F}function N(F,z,$,ae){return z===null||z.tag!==6?(z=Hm($,F.mode,ae),z.return=F,z):(z=g(z,$),z.return=F,z)}function P(F,z,$,ae){var je=$.type;return je===L?se(F,z,$.props.children,ae,$.key):z!==null&&(z.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===I&&So(je)===z.type)?(z=g(z,$.props),hu(z,$),z.return=F,z):(z=Ah($.type,$.key,$.props,null,F.mode,ae),hu(z,$),z.return=F,z)}function Q(F,z,$,ae){return z===null||z.tag!==4||z.stateNode.containerInfo!==$.containerInfo||z.stateNode.implementation!==$.implementation?(z=$m($,F.mode,ae),z.return=F,z):(z=g(z,$.children||[]),z.return=F,z)}function se(F,z,$,ae,je){return z===null||z.tag!==7?(z=xo($,F.mode,ae,je),z.return=F,z):(z=g(z,$),z.return=F,z)}function oe(F,z,$){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Hm(""+z,F.mode,$),z.return=F,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case S:return $=Ah(z.type,z.key,z.props,null,F.mode,$),hu($,z),$.return=F,$;case k:return z=$m(z,F.mode,$),z.return=F,z;case I:return z=So(z),oe(F,z,$)}if(gt(z)||M(z))return z=xo(z,F.mode,$,null),z.return=F,z;if(typeof z.then=="function")return oe(F,Ph(z),$);if(z.$$typeof===ee)return oe(F,kh(F,z),$);Mh(F,z)}return null}function Y(F,z,$,ae){var je=z!==null?z.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return je!==null?null:N(F,z,""+$,ae);if(typeof $=="object"&&$!==null){switch($.$$typeof){case S:return $.key===je?P(F,z,$,ae):null;case k:return $.key===je?Q(F,z,$,ae):null;case I:return $=So($),Y(F,z,$,ae)}if(gt($)||M($))return je!==null?null:se(F,z,$,ae,null);if(typeof $.then=="function")return Y(F,z,Ph($),ae);if($.$$typeof===ee)return Y(F,z,kh(F,$),ae);Mh(F,$)}return null}function W(F,z,$,ae,je){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return F=F.get($)||null,N(z,F,""+ae,je);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case S:return F=F.get(ae.key===null?$:ae.key)||null,P(z,F,ae,je);case k:return F=F.get(ae.key===null?$:ae.key)||null,Q(z,F,ae,je);case I:return ae=So(ae),W(F,z,$,ae,je)}if(gt(ae)||M(ae))return F=F.get($)||null,se(z,F,ae,je,null);if(typeof ae.then=="function")return W(F,z,$,Ph(ae),je);if(ae.$$typeof===ee)return W(F,z,$,kh(z,ae),je);Mh(z,ae)}return null}function Se(F,z,$,ae){for(var je=null,wt=null,Ce=z,Ze=z=0,ct=null;Ce!==null&&Ze<$.length;Ze++){Ce.index>Ze?(ct=Ce,Ce=null):ct=Ce.sibling;var Et=Y(F,Ce,$[Ze],ae);if(Et===null){Ce===null&&(Ce=ct);break}s&&Ce&&Et.alternate===null&&a(F,Ce),z=y(Et,z,Ze),wt===null?je=Et:wt.sibling=Et,wt=Et,Ce=ct}if(Ze===$.length)return l(F,Ce),ht&&bi(F,Ze),je;if(Ce===null){for(;Ze<$.length;Ze++)Ce=oe(F,$[Ze],ae),Ce!==null&&(z=y(Ce,z,Ze),wt===null?je=Ce:wt.sibling=Ce,wt=Ce);return ht&&bi(F,Ze),je}for(Ce=u(Ce);Ze<$.length;Ze++)ct=W(Ce,F,Ze,$[Ze],ae),ct!==null&&(s&&ct.alternate!==null&&Ce.delete(ct.key===null?Ze:ct.key),z=y(ct,z,Ze),wt===null?je=ct:wt.sibling=ct,wt=ct);return s&&Ce.forEach(function(Na){return a(F,Na)}),ht&&bi(F,Ze),je}function Ue(F,z,$,ae){if($==null)throw Error(n(151));for(var je=null,wt=null,Ce=z,Ze=z=0,ct=null,Et=$.next();Ce!==null&&!Et.done;Ze++,Et=$.next()){Ce.index>Ze?(ct=Ce,Ce=null):ct=Ce.sibling;var Na=Y(F,Ce,Et.value,ae);if(Na===null){Ce===null&&(Ce=ct);break}s&&Ce&&Na.alternate===null&&a(F,Ce),z=y(Na,z,Ze),wt===null?je=Na:wt.sibling=Na,wt=Na,Ce=ct}if(Et.done)return l(F,Ce),ht&&bi(F,Ze),je;if(Ce===null){for(;!Et.done;Ze++,Et=$.next())Et=oe(F,Et.value,ae),Et!==null&&(z=y(Et,z,Ze),wt===null?je=Et:wt.sibling=Et,wt=Et);return ht&&bi(F,Ze),je}for(Ce=u(Ce);!Et.done;Ze++,Et=$.next())Et=W(Ce,F,Ze,Et.value,ae),Et!==null&&(s&&Et.alternate!==null&&Ce.delete(Et.key===null?Ze:Et.key),z=y(Et,z,Ze),wt===null?je=Et:wt.sibling=Et,wt=Et);return s&&Ce.forEach(function(GR){return a(F,GR)}),ht&&bi(F,Ze),je}function Lt(F,z,$,ae){if(typeof $=="object"&&$!==null&&$.type===L&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case S:e:{for(var je=$.key;z!==null;){if(z.key===je){if(je=$.type,je===L){if(z.tag===7){l(F,z.sibling),ae=g(z,$.props.children),ae.return=F,F=ae;break e}}else if(z.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===I&&So(je)===z.type){l(F,z.sibling),ae=g(z,$.props),hu(ae,$),ae.return=F,F=ae;break e}l(F,z);break}else a(F,z);z=z.sibling}$.type===L?(ae=xo($.props.children,F.mode,ae,$.key),ae.return=F,F=ae):(ae=Ah($.type,$.key,$.props,null,F.mode,ae),hu(ae,$),ae.return=F,F=ae)}return w(F);case k:e:{for(je=$.key;z!==null;){if(z.key===je)if(z.tag===4&&z.stateNode.containerInfo===$.containerInfo&&z.stateNode.implementation===$.implementation){l(F,z.sibling),ae=g(z,$.children||[]),ae.return=F,F=ae;break e}else{l(F,z);break}else a(F,z);z=z.sibling}ae=$m($,F.mode,ae),ae.return=F,F=ae}return w(F);case I:return $=So($),Lt(F,z,$,ae)}if(gt($))return Se(F,z,$,ae);if(M($)){if(je=M($),typeof je!="function")throw Error(n(150));return $=je.call($),Ue(F,z,$,ae)}if(typeof $.then=="function")return Lt(F,z,Ph($),ae);if($.$$typeof===ee)return Lt(F,z,kh(F,$),ae);Mh(F,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,z!==null&&z.tag===6?(l(F,z.sibling),ae=g(z,$),ae.return=F,F=ae):(l(F,z),ae=Hm($,F.mode,ae),ae.return=F,F=ae),w(F)):l(F,z)}return function(F,z,$,ae){try{du=0;var je=Lt(F,z,$,ae);return Cl=null,je}catch(Ce){if(Ce===Al||Ce===Oh)throw Ce;var wt=Zr(29,Ce,null,F.mode);return wt.lanes=ae,wt.return=F,wt}finally{}}}var Io=bx(!0),xx=bx(!1),ca=!1;function sg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ig(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ua(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function da(s,a,l){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(It&2)!==0){var g=u.pending;return g===null?a.next=a:(a.next=g.next,g.next=a),u.pending=a,a=Ih(s),rx(s,null,l),a}return Nh(s,u,a,l),Ih(s)}function fu(s,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=s.pendingLanes,l|=u,a.lanes=l,yt(s,l)}}function ag(s,a){var l=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var g=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?g=y=w:y=y.next=w,l=l.next}while(l!==null);y===null?g=y=a:y=y.next=a}else g=y=a;l={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=a:s.next=a,l.lastBaseUpdate=a}var og=!1;function pu(){if(og){var s=Il;if(s!==null)throw s}}function mu(s,a,l,u){og=!1;var g=s.updateQueue;ca=!1;var y=g.firstBaseUpdate,w=g.lastBaseUpdate,N=g.shared.pending;if(N!==null){g.shared.pending=null;var P=N,Q=P.next;P.next=null,w===null?y=Q:w.next=Q,w=P;var se=s.alternate;se!==null&&(se=se.updateQueue,N=se.lastBaseUpdate,N!==w&&(N===null?se.firstBaseUpdate=Q:N.next=Q,se.lastBaseUpdate=P))}if(y!==null){var oe=g.baseState;w=0,se=Q=P=null,N=y;do{var Y=N.lane&-536870913,W=Y!==N.lane;if(W?(lt&Y)===Y:(u&Y)===Y){Y!==0&&Y===Nl&&(og=!0),se!==null&&(se=se.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var Se=s,Ue=N;Y=a;var Lt=l;switch(Ue.tag){case 1:if(Se=Ue.payload,typeof Se=="function"){oe=Se.call(Lt,oe,Y);break e}oe=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Ue.payload,Y=typeof Se=="function"?Se.call(Lt,oe,Y):Se,Y==null)break e;oe=b({},oe,Y);break e;case 2:ca=!0}}Y=N.callback,Y!==null&&(s.flags|=64,W&&(s.flags|=8192),W=g.callbacks,W===null?g.callbacks=[Y]:W.push(Y))}else W={lane:Y,tag:N.tag,payload:N.payload,callback:N.callback,next:null},se===null?(Q=se=W,P=oe):se=se.next=W,w|=Y;if(N=N.next,N===null){if(N=g.shared.pending,N===null)break;W=N,N=W.next,W.next=null,g.lastBaseUpdate=W,g.shared.pending=null}}while(!0);se===null&&(P=oe),g.baseState=P,g.firstBaseUpdate=Q,g.lastBaseUpdate=se,y===null&&(g.shared.lanes=0),ga|=w,s.lanes=w,s.memoizedState=oe}}function _x(s,a){if(typeof s!="function")throw Error(n(191,s));s.call(a)}function wx(s,a){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)_x(l[s],a)}var Rl=V(null),Vh=V(0);function Ex(s,a){s=Ri,pe(Vh,s),pe(Rl,a),Ri=s|a.baseLanes}function lg(){pe(Vh,Ri),pe(Rl,Rl.current)}function cg(){Ri=Vh.current,te(Rl),te(Vh)}var es=V(null),Es=null;function ha(s){var a=s.alternate;pe(In,In.current&1),pe(es,s),Es===null&&(a===null||Rl.current!==null||a.memoizedState!==null)&&(Es=s)}function ug(s){pe(In,In.current),pe(es,s),Es===null&&(Es=s)}function Tx(s){s.tag===22?(pe(In,In.current),pe(es,s),Es===null&&(Es=s)):fa()}function fa(){pe(In,In.current),pe(es,es.current)}function ts(s){te(es),Es===s&&(Es=null),te(In)}var In=V(0);function Lh(s){for(var a=s;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||g0(l)||y0(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var wi=0,Xe=null,Mt=null,Pn=null,Uh=!1,kl=!1,Ao=!1,zh=0,gu=0,Dl=null,OC=0;function bn(){throw Error(n(321))}function dg(s,a){if(a===null)return!1;for(var l=0;l<a.length&&l<s.length;l++)if(!Wr(s[l],a[l]))return!1;return!0}function hg(s,a,l,u,g,y){return wi=y,Xe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Z.H=s===null||s.memoizedState===null?o_:Ig,Ao=!1,y=l(u,g),Ao=!1,kl&&(y=Nx(a,l,u,g)),Sx(s),y}function Sx(s){Z.H=bu;var a=Mt!==null&&Mt.next!==null;if(wi=0,Pn=Mt=Xe=null,Uh=!1,gu=0,Dl=null,a)throw Error(n(300));s===null||Mn||(s=s.dependencies,s!==null&&Rh(s)&&(Mn=!0))}function Nx(s,a,l,u){Xe=s;var g=0;do{if(kl&&(Dl=null),gu=0,kl=!1,25<=g)throw Error(n(301));if(g+=1,Pn=Mt=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}Z.H=l_,y=a(l,u)}while(kl);return y}function jC(){var s=Z.H,a=s.useState()[0];return a=typeof a.then=="function"?yu(a):a,s=s.useState()[0],(Mt!==null?Mt.memoizedState:null)!==s&&(Xe.flags|=1024),a}function fg(){var s=zh!==0;return zh=0,s}function pg(s,a,l){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~l}function mg(s){if(Uh){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Uh=!1}wi=0,Pn=Mt=Xe=null,kl=!1,gu=zh=0,Dl=null}function kr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pn===null?Xe.memoizedState=Pn=s:Pn=Pn.next=s,Pn}function An(){if(Mt===null){var s=Xe.alternate;s=s!==null?s.memoizedState:null}else s=Mt.next;var a=Pn===null?Xe.memoizedState:Pn.next;if(a!==null)Pn=a,Mt=s;else{if(s===null)throw Xe.alternate===null?Error(n(467)):Error(n(310));Mt=s,s={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},Pn===null?Xe.memoizedState=Pn=s:Pn=Pn.next=s}return Pn}function Bh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yu(s){var a=gu;return gu+=1,Dl===null&&(Dl=[]),s=gx(Dl,s,a),a=Xe,(Pn===null?a.memoizedState:Pn.next)===null&&(a=a.alternate,Z.H=a===null||a.memoizedState===null?o_:Ig),s}function Fh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return yu(s);if(s.$$typeof===ee)return or(s)}throw Error(n(438,String(s)))}function gg(s){var a=null,l=Xe.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=Xe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(g){return g.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=Bh(),Xe.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(s),u=0;u<s;u++)l[u]=U;return a.index++,l}function Ei(s,a){return typeof a=="function"?a(s):a}function Gh(s){var a=An();return yg(a,Mt,s)}function yg(s,a,l){var u=s.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=l;var g=s.baseQueue,y=u.pending;if(y!==null){if(g!==null){var w=g.next;g.next=y.next,y.next=w}a.baseQueue=g=y,u.pending=null}if(y=s.baseState,g===null)s.memoizedState=y;else{a=g.next;var N=w=null,P=null,Q=a,se=!1;do{var oe=Q.lane&-536870913;if(oe!==Q.lane?(lt&oe)===oe:(wi&oe)===oe){var Y=Q.revertLane;if(Y===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),oe===Nl&&(se=!0);else if((wi&Y)===Y){Q=Q.next,Y===Nl&&(se=!0);continue}else oe={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(N=P=oe,w=y):P=P.next=oe,Xe.lanes|=Y,ga|=Y;oe=Q.action,Ao&&l(y,oe),y=Q.hasEagerState?Q.eagerState:l(y,oe)}else Y={lane:oe,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(N=P=Y,w=y):P=P.next=Y,Xe.lanes|=oe,ga|=oe;Q=Q.next}while(Q!==null&&Q!==a);if(P===null?w=y:P.next=N,!Wr(y,s.memoizedState)&&(Mn=!0,se&&(l=Il,l!==null)))throw l;s.memoizedState=y,s.baseState=w,s.baseQueue=P,u.lastRenderedState=y}return g===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function vg(s){var a=An(),l=a.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=s;var u=l.dispatch,g=l.pending,y=a.memoizedState;if(g!==null){l.pending=null;var w=g=g.next;do y=s(y,w.action),w=w.next;while(w!==g);Wr(y,a.memoizedState)||(Mn=!0),a.memoizedState=y,a.baseQueue===null&&(a.baseState=y),l.lastRenderedState=y}return[y,u]}function Ix(s,a,l){var u=Xe,g=An(),y=ht;if(y){if(l===void 0)throw Error(n(407));l=l()}else l=a();var w=!Wr((Mt||g).memoizedState,l);if(w&&(g.memoizedState=l,Mn=!0),g=g.queue,_g(Rx.bind(null,u,g,s),[s]),g.getSnapshot!==a||w||Pn!==null&&Pn.memoizedState.tag&1){if(u.flags|=2048,Ol(9,{destroy:void 0},Cx.bind(null,u,g,l,a),null),Ut===null)throw Error(n(349));y||(wi&127)!==0||Ax(u,a,l)}return l}function Ax(s,a,l){s.flags|=16384,s={getSnapshot:a,value:l},a=Xe.updateQueue,a===null?(a=Bh(),Xe.updateQueue=a,a.stores=[s]):(l=a.stores,l===null?a.stores=[s]:l.push(s))}function Cx(s,a,l,u){a.value=l,a.getSnapshot=u,kx(a)&&Dx(s)}function Rx(s,a,l){return l(function(){kx(a)&&Dx(s)})}function kx(s){var a=s.getSnapshot;s=s.value;try{var l=a();return!Wr(s,l)}catch{return!0}}function Dx(s){var a=bo(s,2);a!==null&&Fr(a,s,2)}function bg(s){var a=kr();if(typeof s=="function"){var l=s;if(s=l(),Ao){et(!0);try{l()}finally{et(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:s},a}function Ox(s,a,l,u){return s.baseState=l,yg(s,Mt,typeof u=="function"?u:Ei)}function PC(s,a,l,u,g){if($h(s))throw Error(n(485));if(s=a.action,s!==null){var y={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};Z.T!==null?l(!0):y.isTransition=!1,u(y),l=a.pending,l===null?(y.next=a.pending=y,jx(a,y)):(y.next=l.next,a.pending=l.next=y)}}function jx(s,a){var l=a.action,u=a.payload,g=s.state;if(a.isTransition){var y=Z.T,w={};Z.T=w;try{var N=l(g,u),P=Z.S;P!==null&&P(w,N),Px(s,a,N)}catch(Q){xg(s,a,Q)}finally{y!==null&&w.types!==null&&(y.types=w.types),Z.T=y}}else try{y=l(g,u),Px(s,a,y)}catch(Q){xg(s,a,Q)}}function Px(s,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Mx(s,a,u)},function(u){return xg(s,a,u)}):Mx(s,a,l)}function Mx(s,a,l){a.status="fulfilled",a.value=l,Vx(a),s.state=l,a=s.pending,a!==null&&(l=a.next,l===a?s.pending=null:(l=l.next,a.next=l,jx(s,l)))}function xg(s,a,l){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,Vx(a),a=a.next;while(a!==u)}s.action=null}function Vx(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function Lx(s,a){return a}function Ux(s,a){if(ht){var l=Ut.formState;if(l!==null){e:{var u=Xe;if(ht){if(Xt){t:{for(var g=Xt,y=ws;g.nodeType!==8;){if(!y){g=null;break t}if(g=Ts(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){Xt=Ts(g.nextSibling),u=g.data==="F!";break e}}oa(u)}u=!1}u&&(a=l[0])}}return l=kr(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lx,lastRenderedState:a},l.queue=u,l=s_.bind(null,Xe,u),u.dispatch=l,u=bg(!1),y=Ng.bind(null,Xe,!1,u.queue),u=kr(),g={state:a,dispatch:null,action:s,pending:null},u.queue=g,l=PC.bind(null,Xe,g,y,l),g.dispatch=l,u.memoizedState=s,[a,l,!1]}function zx(s){var a=An();return Bx(a,Mt,s)}function Bx(s,a,l){if(a=yg(s,a,Lx)[0],s=Gh(Ei)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=yu(a)}catch(w){throw w===Al?Oh:w}else u=a;a=An();var g=a.queue,y=g.dispatch;return l!==a.memoizedState&&(Xe.flags|=2048,Ol(9,{destroy:void 0},MC.bind(null,g,l),null)),[u,y,s]}function MC(s,a){s.action=a}function Fx(s){var a=An(),l=Mt;if(l!==null)return Bx(a,l,s);An(),a=a.memoizedState,l=An();var u=l.queue.dispatch;return l.memoizedState=s,[a,u,!1]}function Ol(s,a,l,u){return s={tag:s,create:l,deps:u,inst:a,next:null},a=Xe.updateQueue,a===null&&(a=Bh(),Xe.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=s.next=s:(u=l.next,l.next=s,s.next=u,a.lastEffect=s),s}function Gx(){return An().memoizedState}function qh(s,a,l,u){var g=kr();Xe.flags|=s,g.memoizedState=Ol(1|a,{destroy:void 0},l,u===void 0?null:u)}function Hh(s,a,l,u){var g=An();u=u===void 0?null:u;var y=g.memoizedState.inst;Mt!==null&&u!==null&&dg(u,Mt.memoizedState.deps)?g.memoizedState=Ol(a,y,l,u):(Xe.flags|=s,g.memoizedState=Ol(1|a,y,l,u))}function qx(s,a){qh(8390656,8,s,a)}function _g(s,a){Hh(2048,8,s,a)}function VC(s){Xe.flags|=4;var a=Xe.updateQueue;if(a===null)a=Bh(),Xe.updateQueue=a,a.events=[s];else{var l=a.events;l===null?a.events=[s]:l.push(s)}}function Hx(s){var a=An().memoizedState;return VC({ref:a,nextImpl:s}),function(){if((It&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function $x(s,a){return Hh(4,2,s,a)}function Kx(s,a){return Hh(4,4,s,a)}function Qx(s,a){if(typeof a=="function"){s=s();var l=a(s);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function Yx(s,a,l){l=l!=null?l.concat([s]):null,Hh(4,4,Qx.bind(null,a,s),l)}function wg(){}function Xx(s,a){var l=An();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&dg(a,u[1])?u[0]:(l.memoizedState=[s,a],s)}function Jx(s,a){var l=An();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&dg(a,u[1]))return u[0];if(u=s(),Ao){et(!0);try{s()}finally{et(!1)}}return l.memoizedState=[u,a],u}function Eg(s,a,l){return l===void 0||(wi&1073741824)!==0&&(lt&261930)===0?s.memoizedState=a:(s.memoizedState=l,s=W_(),Xe.lanes|=s,ga|=s,l)}function Wx(s,a,l,u){return Wr(l,a)?l:Rl.current!==null?(s=Eg(s,l,u),Wr(s,a)||(Mn=!0),s):(wi&42)===0||(wi&1073741824)!==0&&(lt&261930)===0?(Mn=!0,s.memoizedState=l):(s=W_(),Xe.lanes|=s,ga|=s,a)}function Zx(s,a,l,u,g){var y=he.p;he.p=y!==0&&8>y?y:8;var w=Z.T,N={};Z.T=N,Ng(s,!1,a,l);try{var P=g(),Q=Z.S;if(Q!==null&&Q(N,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var se=DC(P,u);vu(s,a,se,ss(s))}else vu(s,a,u,ss(s))}catch(oe){vu(s,a,{then:function(){},status:"rejected",reason:oe},ss())}finally{he.p=y,w!==null&&N.types!==null&&(w.types=N.types),Z.T=w}}function LC(){}function Tg(s,a,l,u){if(s.tag!==5)throw Error(n(476));var g=e_(s).queue;Zx(s,g,a,Te,l===null?LC:function(){return t_(s),l(u)})}function e_(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:Te},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:l},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function t_(s){var a=e_(s);a.next===null&&(a=s.alternate.memoizedState),vu(s,a.next.queue,{},ss())}function Sg(){return or(Pu)}function n_(){return An().memoizedState}function r_(){return An().memoizedState}function UC(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var l=ss();s=ua(l);var u=da(a,s,l);u!==null&&(Fr(u,a,l),fu(u,a,l)),a={cache:eg()},s.payload=a;return}a=a.return}}function zC(s,a,l){var u=ss();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},$h(s)?i_(a,l):(l=Gm(s,a,l,u),l!==null&&(Fr(l,s,u),a_(l,a,u)))}function s_(s,a,l){var u=ss();vu(s,a,l,u)}function vu(s,a,l,u){var g={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if($h(s))i_(a,g);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=a.lastRenderedReducer,y!==null))try{var w=a.lastRenderedState,N=y(w,l);if(g.hasEagerState=!0,g.eagerState=N,Wr(N,w))return Nh(s,a,g,0),Ut===null&&Sh(),!1}catch{}finally{}if(l=Gm(s,a,g,u),l!==null)return Fr(l,s,u),a_(l,a,u),!0}return!1}function Ng(s,a,l,u){if(u={lane:2,revertLane:s0(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},$h(s)){if(a)throw Error(n(479))}else a=Gm(s,l,u,2),a!==null&&Fr(a,s,2)}function $h(s){var a=s.alternate;return s===Xe||a!==null&&a===Xe}function i_(s,a){kl=Uh=!0;var l=s.pending;l===null?a.next=a:(a.next=l.next,l.next=a),s.pending=a}function a_(s,a,l){if((l&4194048)!==0){var u=a.lanes;u&=s.pendingLanes,l|=u,a.lanes=l,yt(s,l)}}var bu={readContext:or,use:Fh,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn,useHostTransitionStatus:bn,useFormState:bn,useActionState:bn,useOptimistic:bn,useMemoCache:bn,useCacheRefresh:bn};bu.useEffectEvent=bn;var o_={readContext:or,use:Fh,useCallback:function(s,a){return kr().memoizedState=[s,a===void 0?null:a],s},useContext:or,useEffect:qx,useImperativeHandle:function(s,a,l){l=l!=null?l.concat([s]):null,qh(4194308,4,Qx.bind(null,a,s),l)},useLayoutEffect:function(s,a){return qh(4194308,4,s,a)},useInsertionEffect:function(s,a){qh(4,2,s,a)},useMemo:function(s,a){var l=kr();a=a===void 0?null:a;var u=s();if(Ao){et(!0);try{s()}finally{et(!1)}}return l.memoizedState=[u,a],u},useReducer:function(s,a,l){var u=kr();if(l!==void 0){var g=l(a);if(Ao){et(!0);try{l(a)}finally{et(!1)}}}else g=a;return u.memoizedState=u.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},u.queue=s,s=s.dispatch=zC.bind(null,Xe,s),[u.memoizedState,s]},useRef:function(s){var a=kr();return s={current:s},a.memoizedState=s},useState:function(s){s=bg(s);var a=s.queue,l=s_.bind(null,Xe,a);return a.dispatch=l,[s.memoizedState,l]},useDebugValue:wg,useDeferredValue:function(s,a){var l=kr();return Eg(l,s,a)},useTransition:function(){var s=bg(!1);return s=Zx.bind(null,Xe,s.queue,!0,!1),kr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,l){var u=Xe,g=kr();if(ht){if(l===void 0)throw Error(n(407));l=l()}else{if(l=a(),Ut===null)throw Error(n(349));(lt&127)!==0||Ax(u,a,l)}g.memoizedState=l;var y={value:l,getSnapshot:a};return g.queue=y,qx(Rx.bind(null,u,y,s),[s]),u.flags|=2048,Ol(9,{destroy:void 0},Cx.bind(null,u,y,l,a),null),l},useId:function(){var s=kr(),a=Ut.identifierPrefix;if(ht){var l=ei,u=Zs;l=(u&~(1<<32-we(u)-1)).toString(32)+l,a="_"+a+"R_"+l,l=zh++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=OC++,a="_"+a+"r_"+l.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:Sg,useFormState:Ux,useActionState:Ux,useOptimistic:function(s){var a=kr();a.memoizedState=a.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Ng.bind(null,Xe,!0,l),l.dispatch=a,[s,a]},useMemoCache:gg,useCacheRefresh:function(){return kr().memoizedState=UC.bind(null,Xe)},useEffectEvent:function(s){var a=kr(),l={impl:s};return a.memoizedState=l,function(){if((It&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}},Ig={readContext:or,use:Fh,useCallback:Xx,useContext:or,useEffect:_g,useImperativeHandle:Yx,useInsertionEffect:$x,useLayoutEffect:Kx,useMemo:Jx,useReducer:Gh,useRef:Gx,useState:function(){return Gh(Ei)},useDebugValue:wg,useDeferredValue:function(s,a){var l=An();return Wx(l,Mt.memoizedState,s,a)},useTransition:function(){var s=Gh(Ei)[0],a=An().memoizedState;return[typeof s=="boolean"?s:yu(s),a]},useSyncExternalStore:Ix,useId:n_,useHostTransitionStatus:Sg,useFormState:zx,useActionState:zx,useOptimistic:function(s,a){var l=An();return Ox(l,Mt,s,a)},useMemoCache:gg,useCacheRefresh:r_};Ig.useEffectEvent=Hx;var l_={readContext:or,use:Fh,useCallback:Xx,useContext:or,useEffect:_g,useImperativeHandle:Yx,useInsertionEffect:$x,useLayoutEffect:Kx,useMemo:Jx,useReducer:vg,useRef:Gx,useState:function(){return vg(Ei)},useDebugValue:wg,useDeferredValue:function(s,a){var l=An();return Mt===null?Eg(l,s,a):Wx(l,Mt.memoizedState,s,a)},useTransition:function(){var s=vg(Ei)[0],a=An().memoizedState;return[typeof s=="boolean"?s:yu(s),a]},useSyncExternalStore:Ix,useId:n_,useHostTransitionStatus:Sg,useFormState:Fx,useActionState:Fx,useOptimistic:function(s,a){var l=An();return Mt!==null?Ox(l,Mt,s,a):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:gg,useCacheRefresh:r_};l_.useEffectEvent=Hx;function Ag(s,a,l,u){a=s.memoizedState,l=l(u,a),l=l==null?a:b({},a,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Cg={enqueueSetState:function(s,a,l){s=s._reactInternals;var u=ss(),g=ua(u);g.payload=a,l!=null&&(g.callback=l),a=da(s,g,u),a!==null&&(Fr(a,s,u),fu(a,s,u))},enqueueReplaceState:function(s,a,l){s=s._reactInternals;var u=ss(),g=ua(u);g.tag=1,g.payload=a,l!=null&&(g.callback=l),a=da(s,g,u),a!==null&&(Fr(a,s,u),fu(a,s,u))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var l=ss(),u=ua(l);u.tag=2,a!=null&&(u.callback=a),a=da(s,u,l),a!==null&&(Fr(a,s,l),fu(a,s,l))}};function c_(s,a,l,u,g,y,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,y,w):a.prototype&&a.prototype.isPureReactComponent?!iu(l,u)||!iu(g,y):!0}function u_(s,a,l,u){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==s&&Cg.enqueueReplaceState(a,a.state,null)}function Co(s,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(s=s.defaultProps){l===a&&(l=b({},l));for(var g in s)l[g]===void 0&&(l[g]=s[g])}return l}function d_(s){Th(s)}function h_(s){console.error(s)}function f_(s){Th(s)}function Kh(s,a){try{var l=s.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function p_(s,a,l){try{var u=s.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Rg(s,a,l){return l=ua(l),l.tag=3,l.payload={element:null},l.callback=function(){Kh(s,a)},l}function m_(s){return s=ua(s),s.tag=3,s}function g_(s,a,l,u){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;s.payload=function(){return g(y)},s.callback=function(){p_(a,l,u)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){p_(a,l,u),typeof g!="function"&&(ya===null?ya=new Set([this]):ya.add(this));var N=u.stack;this.componentDidCatch(u.value,{componentStack:N!==null?N:""})})}function BC(s,a,l,u,g){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&Sl(a,l,g,!0),l=es.current,l!==null){switch(l.tag){case 31:case 13:return Es===null?af():l.alternate===null&&xn===0&&(xn=3),l.flags&=-257,l.flags|=65536,l.lanes=g,u===jh?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),t0(s,u,g)),!1;case 22:return l.flags|=65536,u===jh?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),t0(s,u,g)),!1}throw Error(n(435,l.tag))}return t0(s,u,g),af(),!1}if(ht)return a=es.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=g,u!==Ym&&(s=Error(n(422),{cause:u}),lu(bs(s,l)))):(u!==Ym&&(a=Error(n(423),{cause:u}),lu(bs(a,l))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,u=bs(u,l),g=Rg(s.stateNode,u,g),ag(s,g),xn!==4&&(xn=2)),!1;var y=Error(n(520),{cause:u});if(y=bs(y,l),Iu===null?Iu=[y]:Iu.push(y),xn!==4&&(xn=2),a===null)return!0;u=bs(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,s=g&-g,l.lanes|=s,s=Rg(l.stateNode,u,s),ag(l,s),!1;case 1:if(a=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ya===null||!ya.has(y))))return l.flags|=65536,g&=-g,l.lanes|=g,g=m_(g),g_(g,s,l,u),ag(l,g),!1}l=l.return}while(l!==null);return!1}var kg=Error(n(461)),Mn=!1;function lr(s,a,l,u){a.child=s===null?xx(a,null,l,u):Io(a,s.child,l,u)}function y_(s,a,l,u,g){l=l.render;var y=a.ref;if("ref"in u){var w={};for(var N in u)N!=="ref"&&(w[N]=u[N])}else w=u;return Eo(a),u=hg(s,a,l,w,y,g),N=fg(),s!==null&&!Mn?(pg(s,a,g),Ti(s,a,g)):(ht&&N&&Km(a),a.flags|=1,lr(s,a,u,g),a.child)}function v_(s,a,l,u,g){if(s===null){var y=l.type;return typeof y=="function"&&!qm(y)&&y.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=y,b_(s,a,y,u,g)):(s=Ah(l.type,null,u,a,a.mode,g),s.ref=a.ref,s.return=a,a.child=s)}if(y=s.child,!Ug(s,g)){var w=y.memoizedProps;if(l=l.compare,l=l!==null?l:iu,l(w,u)&&s.ref===a.ref)return Ti(s,a,g)}return a.flags|=1,s=vi(y,u),s.ref=a.ref,s.return=a,a.child=s}function b_(s,a,l,u,g){if(s!==null){var y=s.memoizedProps;if(iu(y,u)&&s.ref===a.ref)if(Mn=!1,a.pendingProps=u=y,Ug(s,g))(s.flags&131072)!==0&&(Mn=!0);else return a.lanes=s.lanes,Ti(s,a,g)}return Dg(s,a,l,u,g)}function x_(s,a,l,u){var g=u.children,y=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((a.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,s!==null){for(u=a.child=s.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~y}else u=0,a.child=null;return __(s,a,y,l,u)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&Dh(a,y!==null?y.cachePool:null),y!==null?Ex(a,y):lg(),Tx(a);else return u=a.lanes=536870912,__(s,a,y!==null?y.baseLanes|l:l,l,u)}else y!==null?(Dh(a,y.cachePool),Ex(a,y),fa(),a.memoizedState=null):(s!==null&&Dh(a,null),lg(),fa());return lr(s,a,g,l),a.child}function xu(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function __(s,a,l,u,g){var y=ng();return y=y===null?null:{parent:jn._currentValue,pool:y},a.memoizedState={baseLanes:l,cachePool:y},s!==null&&Dh(a,null),lg(),Tx(a),s!==null&&Sl(s,a,u,!0),a.childLanes=g,null}function Qh(s,a){return a=Xh({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function w_(s,a,l){return Io(a,s.child,null,l),s=Qh(a,a.pendingProps),s.flags|=2,ts(a),a.memoizedState=null,s}function FC(s,a,l){var u=a.pendingProps,g=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(ht){if(u.mode==="hidden")return s=Qh(a,u),a.lanes=536870912,xu(null,s);if(ug(a),(s=Xt)?(s=jw(s,ws),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ia!==null?{id:Zs,overflow:ei}:null,retryLane:536870912,hydrationErrors:null},l=ix(s),l.return=a,a.child=l,ar=a,Xt=null)):s=null,s===null)throw oa(a);return a.lanes=536870912,null}return Qh(a,u)}var y=s.memoizedState;if(y!==null){var w=y.dehydrated;if(ug(a),g)if(a.flags&256)a.flags&=-257,a=w_(s,a,l);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(n(558));else if(Mn||Sl(s,a,l,!1),g=(l&s.childLanes)!==0,Mn||g){if(u=Ut,u!==null&&(w=_e(u,l),w!==0&&w!==y.retryLane))throw y.retryLane=w,bo(s,w),Fr(u,s,w),kg;af(),a=w_(s,a,l)}else s=y.treeContext,Xt=Ts(w.nextSibling),ar=a,ht=!0,aa=null,ws=!1,s!==null&&lx(a,s),a=Qh(a,u),a.flags|=4096;return a}return s=vi(s.child,{mode:u.mode,children:u.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Yh(s,a){var l=a.ref;if(l===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(s===null||s.ref!==l)&&(a.flags|=4194816)}}function Dg(s,a,l,u,g){return Eo(a),l=hg(s,a,l,u,void 0,g),u=fg(),s!==null&&!Mn?(pg(s,a,g),Ti(s,a,g)):(ht&&u&&Km(a),a.flags|=1,lr(s,a,l,g),a.child)}function E_(s,a,l,u,g,y){return Eo(a),a.updateQueue=null,l=Nx(a,u,l,g),Sx(s),u=fg(),s!==null&&!Mn?(pg(s,a,y),Ti(s,a,y)):(ht&&u&&Km(a),a.flags|=1,lr(s,a,l,y),a.child)}function T_(s,a,l,u,g){if(Eo(a),a.stateNode===null){var y=_l,w=l.contextType;typeof w=="object"&&w!==null&&(y=or(w)),y=new l(u,y),a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Cg,a.stateNode=y,y._reactInternals=a,y=a.stateNode,y.props=u,y.state=a.memoizedState,y.refs={},sg(a),w=l.contextType,y.context=typeof w=="object"&&w!==null?or(w):_l,y.state=a.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(Ag(a,l,w,u),y.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Cg.enqueueReplaceState(y,y.state,null),mu(a,u,y,g),pu(),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(s===null){y=a.stateNode;var N=a.memoizedProps,P=Co(l,N);y.props=P;var Q=y.context,se=l.contextType;w=_l,typeof se=="object"&&se!==null&&(w=or(se));var oe=l.getDerivedStateFromProps;se=typeof oe=="function"||typeof y.getSnapshotBeforeUpdate=="function",N=a.pendingProps!==N,se||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(N||Q!==w)&&u_(a,y,u,w),ca=!1;var Y=a.memoizedState;y.state=Y,mu(a,u,y,g),pu(),Q=a.memoizedState,N||Y!==Q||ca?(typeof oe=="function"&&(Ag(a,l,oe,u),Q=a.memoizedState),(P=ca||c_(a,l,P,u,Y,Q,w))?(se||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(a.flags|=4194308)):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=Q),y.props=u,y.state=Q,y.context=w,u=P):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{y=a.stateNode,ig(s,a),w=a.memoizedProps,se=Co(l,w),y.props=se,oe=a.pendingProps,Y=y.context,Q=l.contextType,P=_l,typeof Q=="object"&&Q!==null&&(P=or(Q)),N=l.getDerivedStateFromProps,(Q=typeof N=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==oe||Y!==P)&&u_(a,y,u,P),ca=!1,Y=a.memoizedState,y.state=Y,mu(a,u,y,g),pu();var W=a.memoizedState;w!==oe||Y!==W||ca||s!==null&&s.dependencies!==null&&Rh(s.dependencies)?(typeof N=="function"&&(Ag(a,l,N,u),W=a.memoizedState),(se=ca||c_(a,l,se,u,Y,W,P)||s!==null&&s.dependencies!==null&&Rh(s.dependencies))?(Q||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,W,P),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,W,P)),typeof y.componentDidUpdate=="function"&&(a.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===s.memoizedProps&&Y===s.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&Y===s.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=W),y.props=u,y.state=W,y.context=P,u=se):(typeof y.componentDidUpdate!="function"||w===s.memoizedProps&&Y===s.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&Y===s.memoizedState||(a.flags|=1024),u=!1)}return y=u,Yh(s,a),u=(a.flags&128)!==0,y||u?(y=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:y.render(),a.flags|=1,s!==null&&u?(a.child=Io(a,s.child,null,g),a.child=Io(a,null,l,g)):lr(s,a,l,g),a.memoizedState=y.state,s=a.child):s=Ti(s,a,g),s}function S_(s,a,l,u){return _o(),a.flags|=256,lr(s,a,l,u),a.child}var Og={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jg(s){return{baseLanes:s,cachePool:px()}}function Pg(s,a,l){return s=s!==null?s.childLanes&~l:0,a&&(s|=rs),s}function N_(s,a,l){var u=a.pendingProps,g=!1,y=(a.flags&128)!==0,w;if((w=y)||(w=s!==null&&s.memoizedState===null?!1:(In.current&2)!==0),w&&(g=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(ht){if(g?ha(a):fa(),(s=Xt)?(s=jw(s,ws),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ia!==null?{id:Zs,overflow:ei}:null,retryLane:536870912,hydrationErrors:null},l=ix(s),l.return=a,a.child=l,ar=a,Xt=null)):s=null,s===null)throw oa(a);return y0(s)?a.lanes=32:a.lanes=536870912,null}var N=u.children;return u=u.fallback,g?(fa(),g=a.mode,N=Xh({mode:"hidden",children:N},g),u=xo(u,g,l,null),N.return=a,u.return=a,N.sibling=u,a.child=N,u=a.child,u.memoizedState=jg(l),u.childLanes=Pg(s,w,l),a.memoizedState=Og,xu(null,u)):(ha(a),Mg(a,N))}var P=s.memoizedState;if(P!==null&&(N=P.dehydrated,N!==null)){if(y)a.flags&256?(ha(a),a.flags&=-257,a=Vg(s,a,l)):a.memoizedState!==null?(fa(),a.child=s.child,a.flags|=128,a=null):(fa(),N=u.fallback,g=a.mode,u=Xh({mode:"visible",children:u.children},g),N=xo(N,g,l,null),N.flags|=2,u.return=a,N.return=a,u.sibling=N,a.child=u,Io(a,s.child,null,l),u=a.child,u.memoizedState=jg(l),u.childLanes=Pg(s,w,l),a.memoizedState=Og,a=xu(null,u));else if(ha(a),y0(N)){if(w=N.nextSibling&&N.nextSibling.dataset,w)var Q=w.dgst;w=Q,u=Error(n(419)),u.stack="",u.digest=w,lu({value:u,source:null,stack:null}),a=Vg(s,a,l)}else if(Mn||Sl(s,a,l,!1),w=(l&s.childLanes)!==0,Mn||w){if(w=Ut,w!==null&&(u=_e(w,l),u!==0&&u!==P.retryLane))throw P.retryLane=u,bo(s,u),Fr(w,s,u),kg;g0(N)||af(),a=Vg(s,a,l)}else g0(N)?(a.flags|=192,a.child=s.child,a=null):(s=P.treeContext,Xt=Ts(N.nextSibling),ar=a,ht=!0,aa=null,ws=!1,s!==null&&lx(a,s),a=Mg(a,u.children),a.flags|=4096);return a}return g?(fa(),N=u.fallback,g=a.mode,P=s.child,Q=P.sibling,u=vi(P,{mode:"hidden",children:u.children}),u.subtreeFlags=P.subtreeFlags&65011712,Q!==null?N=vi(Q,N):(N=xo(N,g,l,null),N.flags|=2),N.return=a,u.return=a,u.sibling=N,a.child=u,xu(null,u),u=a.child,N=s.child.memoizedState,N===null?N=jg(l):(g=N.cachePool,g!==null?(P=jn._currentValue,g=g.parent!==P?{parent:P,pool:P}:g):g=px(),N={baseLanes:N.baseLanes|l,cachePool:g}),u.memoizedState=N,u.childLanes=Pg(s,w,l),a.memoizedState=Og,xu(s.child,u)):(ha(a),l=s.child,s=l.sibling,l=vi(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=l,a.memoizedState=null,l)}function Mg(s,a){return a=Xh({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Xh(s,a){return s=Zr(22,s,null,a),s.lanes=0,s}function Vg(s,a,l){return Io(a,s.child,null,l),s=Mg(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function I_(s,a,l){s.lanes|=a;var u=s.alternate;u!==null&&(u.lanes|=a),Wm(s.return,a,l)}function Lg(s,a,l,u,g,y){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:g,treeForkCount:y}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=u,w.tail=l,w.tailMode=g,w.treeForkCount=y)}function A_(s,a,l){var u=a.pendingProps,g=u.revealOrder,y=u.tail;u=u.children;var w=In.current,N=(w&2)!==0;if(N?(w=w&1|2,a.flags|=128):w&=1,pe(In,w),lr(s,a,u,l),u=ht?ou:0,!N&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&I_(s,l,a);else if(s.tag===19)I_(s,l,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(g){case"forwards":for(l=a.child,g=null;l!==null;)s=l.alternate,s!==null&&Lh(s)===null&&(g=l),l=l.sibling;l=g,l===null?(g=a.child,a.child=null):(g=l.sibling,l.sibling=null),Lg(a,!1,g,l,y,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=a.child,a.child=null;g!==null;){if(s=g.alternate,s!==null&&Lh(s)===null){a.child=g;break}s=g.sibling,g.sibling=l,l=g,g=s}Lg(a,!0,l,null,y,u);break;case"together":Lg(a,!1,null,null,void 0,u);break;default:a.memoizedState=null}return a.child}function Ti(s,a,l){if(s!==null&&(a.dependencies=s.dependencies),ga|=a.lanes,(l&a.childLanes)===0)if(s!==null){if(Sl(s,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(n(153));if(a.child!==null){for(s=a.child,l=vi(s,s.pendingProps),a.child=l,l.return=a;s.sibling!==null;)s=s.sibling,l=l.sibling=vi(s,s.pendingProps),l.return=a;l.sibling=null}return a.child}function Ug(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&Rh(s)))}function GC(s,a,l){switch(a.tag){case 3:Je(a,a.stateNode.containerInfo),la(a,jn,s.memoizedState.cache),_o();break;case 27:case 5:$e(a);break;case 4:Je(a,a.stateNode.containerInfo);break;case 10:la(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,ug(a),null;break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(ha(a),a.flags|=128,null):(l&a.child.childLanes)!==0?N_(s,a,l):(ha(a),s=Ti(s,a,l),s!==null?s.sibling:null);ha(a);break;case 19:var g=(s.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(Sl(s,a,l,!1),u=(l&a.childLanes)!==0),g){if(u)return A_(s,a,l);a.flags|=128}if(g=a.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),pe(In,In.current),u)break;return null;case 22:return a.lanes=0,x_(s,a,l,a.pendingProps);case 24:la(a,jn,s.memoizedState.cache)}return Ti(s,a,l)}function C_(s,a,l){if(s!==null)if(s.memoizedProps!==a.pendingProps)Mn=!0;else{if(!Ug(s,l)&&(a.flags&128)===0)return Mn=!1,GC(s,a,l);Mn=(s.flags&131072)!==0}else Mn=!1,ht&&(a.flags&1048576)!==0&&ox(a,ou,a.index);switch(a.lanes=0,a.tag){case 16:e:{var u=a.pendingProps;if(s=So(a.elementType),a.type=s,typeof s=="function")qm(s)?(u=Co(s,u),a.tag=1,a=T_(null,a,s,u,l)):(a.tag=0,a=Dg(null,a,s,u,l));else{if(s!=null){var g=s.$$typeof;if(g===le){a.tag=11,a=y_(null,a,s,u,l);break e}else if(g===C){a.tag=14,a=v_(null,a,s,u,l);break e}}throw a=qe(s)||s,Error(n(306,a,""))}}return a;case 0:return Dg(s,a,a.type,a.pendingProps,l);case 1:return u=a.type,g=Co(u,a.pendingProps),T_(s,a,u,g,l);case 3:e:{if(Je(a,a.stateNode.containerInfo),s===null)throw Error(n(387));u=a.pendingProps;var y=a.memoizedState;g=y.element,ig(s,a),mu(a,u,null,l);var w=a.memoizedState;if(u=w.cache,la(a,jn,u),u!==y.cache&&Zm(a,[jn],l,!0),pu(),u=w.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=y,a.memoizedState=y,a.flags&256){a=S_(s,a,u,l);break e}else if(u!==g){g=bs(Error(n(424)),a),lu(g),a=S_(s,a,u,l);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Xt=Ts(s.firstChild),ar=a,ht=!0,aa=null,ws=!0,l=xx(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(_o(),u===g){a=Ti(s,a,l);break e}lr(s,a,u,l)}a=a.child}return a;case 26:return Yh(s,a),s===null?(l=zw(a.type,null,a.pendingProps,null))?a.memoizedState=l:ht||(l=a.type,s=a.pendingProps,u=ff(Re.current).createElement(l),u[Yt]=a,u[mn]=s,cr(u,l,s),gn(u),a.stateNode=u):a.memoizedState=zw(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return $e(a),s===null&&ht&&(u=a.stateNode=Vw(a.type,a.pendingProps,Re.current),ar=a,ws=!0,g=Xt,_a(a.type)?(v0=g,Xt=Ts(u.firstChild)):Xt=g),lr(s,a,a.pendingProps.children,l),Yh(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&ht&&((g=u=Xt)&&(u=bR(u,a.type,a.pendingProps,ws),u!==null?(a.stateNode=u,ar=a,Xt=Ts(u.firstChild),ws=!1,g=!0):g=!1),g||oa(a)),$e(a),g=a.type,y=a.pendingProps,w=s!==null?s.memoizedProps:null,u=y.children,f0(g,y)?u=null:w!==null&&f0(g,w)&&(a.flags|=32),a.memoizedState!==null&&(g=hg(s,a,jC,null,null,l),Pu._currentValue=g),Yh(s,a),lr(s,a,u,l),a.child;case 6:return s===null&&ht&&((s=l=Xt)&&(l=xR(l,a.pendingProps,ws),l!==null?(a.stateNode=l,ar=a,Xt=null,s=!0):s=!1),s||oa(a)),null;case 13:return N_(s,a,l);case 4:return Je(a,a.stateNode.containerInfo),u=a.pendingProps,s===null?a.child=Io(a,null,u,l):lr(s,a,u,l),a.child;case 11:return y_(s,a,a.type,a.pendingProps,l);case 7:return lr(s,a,a.pendingProps,l),a.child;case 8:return lr(s,a,a.pendingProps.children,l),a.child;case 12:return lr(s,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,la(a,a.type,u.value),lr(s,a,u.children,l),a.child;case 9:return g=a.type._context,u=a.pendingProps.children,Eo(a),g=or(g),u=u(g),a.flags|=1,lr(s,a,u,l),a.child;case 14:return v_(s,a,a.type,a.pendingProps,l);case 15:return b_(s,a,a.type,a.pendingProps,l);case 19:return A_(s,a,l);case 31:return FC(s,a,l);case 22:return x_(s,a,l,a.pendingProps);case 24:return Eo(a),u=or(jn),s===null?(g=ng(),g===null&&(g=Ut,y=eg(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=l),g=y),a.memoizedState={parent:u,cache:g},sg(a),la(a,jn,g)):((s.lanes&l)!==0&&(ig(s,a),mu(a,null,null,l),pu()),g=s.memoizedState,y=a.memoizedState,g.parent!==u?(g={parent:u,cache:u},a.memoizedState=g,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=g),la(a,jn,u)):(u=y.cache,la(a,jn,u),u!==g.cache&&Zm(a,[jn],l,!0))),lr(s,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Si(s){s.flags|=4}function zg(s,a,l,u,g){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(g&335544128)===g)if(s.stateNode.complete)s.flags|=8192;else if(nw())s.flags|=8192;else throw No=jh,rg}else s.flags&=-16777217}function R_(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Hw(a))if(nw())s.flags|=8192;else throw No=jh,rg}function Jh(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?pn():536870912,s.lanes|=a,Vl|=a)}function _u(s,a){if(!ht)switch(s.tailMode){case"hidden":a=s.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function Jt(s){var a=s.alternate!==null&&s.alternate.child===s.child,l=0,u=0;if(a)for(var g=s.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=u,s.childLanes=l,a}function qC(s,a,l){var u=a.pendingProps;switch(Qm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(a),null;case 1:return Jt(a),null;case 3:return l=a.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),_i(jn),rt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Tl(a)?Si(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Xm())),Jt(a),null;case 26:var g=a.type,y=a.memoizedState;return s===null?(Si(a),y!==null?(Jt(a),R_(a,y)):(Jt(a),zg(a,g,null,u,l))):y?y!==s.memoizedState?(Si(a),Jt(a),R_(a,y)):(Jt(a),a.flags&=-16777217):(s=s.memoizedProps,s!==u&&Si(a),Jt(a),zg(a,g,s,u,l)),null;case 27:if(Zn(a),l=Re.current,g=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==u&&Si(a);else{if(!u){if(a.stateNode===null)throw Error(n(166));return Jt(a),null}s=ye.current,Tl(a)?cx(a):(s=Vw(g,u,l),a.stateNode=s,Si(a))}return Jt(a),null;case 5:if(Zn(a),g=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==u&&Si(a);else{if(!u){if(a.stateNode===null)throw Error(n(166));return Jt(a),null}if(y=ye.current,Tl(a))cx(a);else{var w=ff(Re.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?w.createElement("select",{is:u.is}):w.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?w.createElement(g,{is:u.is}):w.createElement(g)}}y[Yt]=a,y[mn]=u;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=y;e:switch(cr(y,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Si(a)}}return Jt(a),zg(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,l),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==u&&Si(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(n(166));if(s=Re.current,Tl(a)){if(s=a.stateNode,l=a.memoizedProps,u=null,g=ar,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}s[Yt]=a,s=!!(s.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||Nw(s.nodeValue,l)),s||oa(a,!0)}else s=ff(s).createTextNode(u),s[Yt]=a,a.stateNode=s}return Jt(a),null;case 31:if(l=a.memoizedState,s===null||s.memoizedState!==null){if(u=Tl(a),l!==null){if(s===null){if(!u)throw Error(n(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[Yt]=a}else _o(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Jt(a),s=!1}else l=Xm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return a.flags&256?(ts(a),a):(ts(a),null);if((a.flags&128)!==0)throw Error(n(558))}return Jt(a),null;case 13:if(u=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=Tl(a),u!==null&&u.dehydrated!==null){if(s===null){if(!g)throw Error(n(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[Yt]=a}else _o(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Jt(a),g=!1}else g=Xm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return a.flags&256?(ts(a),a):(ts(a),null)}return ts(a),(a.flags&128)!==0?(a.lanes=l,a):(l=u!==null,s=s!==null&&s.memoizedState!==null,l&&(u=a.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==g&&(u.flags|=2048)),l!==s&&l&&(a.child.flags|=8192),Jh(a,a.updateQueue),Jt(a),null);case 4:return rt(),s===null&&l0(a.stateNode.containerInfo),Jt(a),null;case 10:return _i(a.type),Jt(a),null;case 19:if(te(In),u=a.memoizedState,u===null)return Jt(a),null;if(g=(a.flags&128)!==0,y=u.rendering,y===null)if(g)_u(u,!1);else{if(xn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(y=Lh(s),y!==null){for(a.flags|=128,_u(u,!1),s=y.updateQueue,a.updateQueue=s,Jh(a,s),a.subtreeFlags=0,s=l,l=a.child;l!==null;)sx(l,s),l=l.sibling;return pe(In,In.current&1|2),ht&&bi(a,u.treeForkCount),a.child}s=s.sibling}u.tail!==null&&zt()>nf&&(a.flags|=128,g=!0,_u(u,!1),a.lanes=4194304)}else{if(!g)if(s=Lh(y),s!==null){if(a.flags|=128,g=!0,s=s.updateQueue,a.updateQueue=s,Jh(a,s),_u(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!ht)return Jt(a),null}else 2*zt()-u.renderingStartTime>nf&&l!==536870912&&(a.flags|=128,g=!0,_u(u,!1),a.lanes=4194304);u.isBackwards?(y.sibling=a.child,a.child=y):(s=u.last,s!==null?s.sibling=y:a.child=y,u.last=y)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=zt(),s.sibling=null,l=In.current,pe(In,g?l&1|2:l&1),ht&&bi(a,u.treeForkCount),s):(Jt(a),null);case 22:case 23:return ts(a),cg(),u=a.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(Jt(a),a.subtreeFlags&6&&(a.flags|=8192)):Jt(a),l=a.updateQueue,l!==null&&Jh(a,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),s!==null&&te(To),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),_i(jn),Jt(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function HC(s,a){switch(Qm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return _i(jn),rt(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Zn(a),null;case 31:if(a.memoizedState!==null){if(ts(a),a.alternate===null)throw Error(n(340));_o()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(ts(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(n(340));_o()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return te(In),null;case 4:return rt(),null;case 10:return _i(a.type),null;case 22:case 23:return ts(a),cg(),s!==null&&te(To),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return _i(jn),null;case 25:return null;default:return null}}function k_(s,a){switch(Qm(a),a.tag){case 3:_i(jn),rt();break;case 26:case 27:case 5:Zn(a);break;case 4:rt();break;case 31:a.memoizedState!==null&&ts(a);break;case 13:ts(a);break;case 19:te(In);break;case 10:_i(a.type);break;case 22:case 23:ts(a),cg(),s!==null&&te(To);break;case 24:_i(jn)}}function wu(s,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var g=u.next;l=g;do{if((l.tag&s)===s){u=void 0;var y=l.create,w=l.inst;u=y(),w.destroy=u}l=l.next}while(l!==g)}}catch(N){kt(a,a.return,N)}}function pa(s,a,l){try{var u=a.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var y=g.next;u=y;do{if((u.tag&s)===s){var w=u.inst,N=w.destroy;if(N!==void 0){w.destroy=void 0,g=a;var P=l,Q=N;try{Q()}catch(se){kt(g,P,se)}}}u=u.next}while(u!==y)}}catch(se){kt(a,a.return,se)}}function D_(s){var a=s.updateQueue;if(a!==null){var l=s.stateNode;try{wx(a,l)}catch(u){kt(s,s.return,u)}}}function O_(s,a,l){l.props=Co(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(u){kt(s,a,u)}}function Eu(s,a){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof l=="function"?s.refCleanup=l(u):l.current=u}}catch(g){kt(s,a,g)}}function ti(s,a){var l=s.ref,u=s.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(g){kt(s,a,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){kt(s,a,g)}else l.current=null}function j_(s){var a=s.type,l=s.memoizedProps,u=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(g){kt(s,s.return,g)}}function Bg(s,a,l){try{var u=s.stateNode;fR(u,s.type,l,a),u[mn]=a}catch(g){kt(s,s.return,g)}}function P_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&_a(s.type)||s.tag===4}function Fg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||P_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&_a(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Gg(s,a,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(s),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=De));else if(u!==4&&(u===27&&_a(s.type)&&(l=s.stateNode,a=null),s=s.child,s!==null))for(Gg(s,a,l),s=s.sibling;s!==null;)Gg(s,a,l),s=s.sibling}function Wh(s,a,l){var u=s.tag;if(u===5||u===6)s=s.stateNode,a?l.insertBefore(s,a):l.appendChild(s);else if(u!==4&&(u===27&&_a(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Wh(s,a,l),s=s.sibling;s!==null;)Wh(s,a,l),s=s.sibling}function M_(s){var a=s.stateNode,l=s.memoizedProps;try{for(var u=s.type,g=a.attributes;g.length;)a.removeAttributeNode(g[0]);cr(a,u,l),a[Yt]=s,a[mn]=l}catch(y){kt(s,s.return,y)}}var Ni=!1,Vn=!1,qg=!1,V_=typeof WeakSet=="function"?WeakSet:Set,Yn=null;function $C(s,a){if(s=s.containerInfo,d0=xf,s=Yb(s),Vm(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var g=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var w=0,N=-1,P=-1,Q=0,se=0,oe=s,Y=null;t:for(;;){for(var W;oe!==l||g!==0&&oe.nodeType!==3||(N=w+g),oe!==y||u!==0&&oe.nodeType!==3||(P=w+u),oe.nodeType===3&&(w+=oe.nodeValue.length),(W=oe.firstChild)!==null;)Y=oe,oe=W;for(;;){if(oe===s)break t;if(Y===l&&++Q===g&&(N=w),Y===y&&++se===u&&(P=w),(W=oe.nextSibling)!==null)break;oe=Y,Y=oe.parentNode}oe=W}l=N===-1||P===-1?null:{start:N,end:P}}else l=null}l=l||{start:0,end:0}}else l=null;for(h0={focusedElem:s,selectionRange:l},xf=!1,Yn=a;Yn!==null;)if(a=Yn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Yn=s;else for(;Yn!==null;){switch(a=Yn,y=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)g=s[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,l=a,g=y.memoizedProps,y=y.memoizedState,u=l.stateNode;try{var Se=Co(l.type,g);s=u.getSnapshotBeforeUpdate(Se,y),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ue){kt(l,l.return,Ue)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,l=s.nodeType,l===9)m0(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":m0(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=a.sibling,s!==null){s.return=a.return,Yn=s;break}Yn=a.return}}function L_(s,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ai(s,l),u&4&&wu(5,l);break;case 1:if(Ai(s,l),u&4)if(s=l.stateNode,a===null)try{s.componentDidMount()}catch(w){kt(l,l.return,w)}else{var g=Co(l.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(g,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){kt(l,l.return,w)}}u&64&&D_(l),u&512&&Eu(l,l.return);break;case 3:if(Ai(s,l),u&64&&(s=l.updateQueue,s!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{wx(s,a)}catch(w){kt(l,l.return,w)}}break;case 27:a===null&&u&4&&M_(l);case 26:case 5:Ai(s,l),a===null&&u&4&&j_(l),u&512&&Eu(l,l.return);break;case 12:Ai(s,l);break;case 31:Ai(s,l),u&4&&B_(s,l);break;case 13:Ai(s,l),u&4&&F_(s,l),u&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=tR.bind(null,l),_R(s,l))));break;case 22:if(u=l.memoizedState!==null||Ni,!u){a=a!==null&&a.memoizedState!==null||Vn,g=Ni;var y=Vn;Ni=u,(Vn=a)&&!y?Ci(s,l,(l.subtreeFlags&8772)!==0):Ai(s,l),Ni=g,Vn=y}break;case 30:break;default:Ai(s,l)}}function U_(s){var a=s.alternate;a!==null&&(s.alternate=null,U_(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Qi(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var nn=null,Lr=!1;function Ii(s,a,l){for(l=l.child;l!==null;)z_(s,a,l),l=l.sibling}function z_(s,a,l){if(Le&&typeof Le.onCommitFiberUnmount=="function")try{Le.onCommitFiberUnmount(Oe,l)}catch{}switch(l.tag){case 26:Vn||ti(l,a),Ii(s,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Vn||ti(l,a);var u=nn,g=Lr;_a(l.type)&&(nn=l.stateNode,Lr=!1),Ii(s,a,l),Du(l.stateNode),nn=u,Lr=g;break;case 5:Vn||ti(l,a);case 6:if(u=nn,g=Lr,nn=null,Ii(s,a,l),nn=u,Lr=g,nn!==null)if(Lr)try{(nn.nodeType===9?nn.body:nn.nodeName==="HTML"?nn.ownerDocument.body:nn).removeChild(l.stateNode)}catch(y){kt(l,a,y)}else try{nn.removeChild(l.stateNode)}catch(y){kt(l,a,y)}break;case 18:nn!==null&&(Lr?(s=nn,Dw(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Hl(s)):Dw(nn,l.stateNode));break;case 4:u=nn,g=Lr,nn=l.stateNode.containerInfo,Lr=!0,Ii(s,a,l),nn=u,Lr=g;break;case 0:case 11:case 14:case 15:pa(2,l,a),Vn||pa(4,l,a),Ii(s,a,l);break;case 1:Vn||(ti(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&O_(l,a,u)),Ii(s,a,l);break;case 21:Ii(s,a,l);break;case 22:Vn=(u=Vn)||l.memoizedState!==null,Ii(s,a,l),Vn=u;break;default:Ii(s,a,l)}}function B_(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Hl(s)}catch(l){kt(a,a.return,l)}}}function F_(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Hl(s)}catch(l){kt(a,a.return,l)}}function KC(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new V_),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new V_),a;default:throw Error(n(435,s.tag))}}function Zh(s,a){var l=KC(s);a.forEach(function(u){if(!l.has(u)){l.add(u);var g=nR.bind(null,s,u);u.then(g,g)}})}function Ur(s,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var g=l[u],y=s,w=a,N=w;e:for(;N!==null;){switch(N.tag){case 27:if(_a(N.type)){nn=N.stateNode,Lr=!1;break e}break;case 5:nn=N.stateNode,Lr=!1;break e;case 3:case 4:nn=N.stateNode.containerInfo,Lr=!0;break e}N=N.return}if(nn===null)throw Error(n(160));z_(y,w,g),nn=null,Lr=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)G_(a,s),a=a.sibling}var Us=null;function G_(s,a){var l=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ur(a,s),zr(s),u&4&&(pa(3,s,s.return),wu(3,s),pa(5,s,s.return));break;case 1:Ur(a,s),zr(s),u&512&&(Vn||l===null||ti(l,l.return)),u&64&&Ni&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var g=Us;if(Ur(a,s),zr(s),u&512&&(Vn||l===null||ti(l,l.return)),u&4){var y=l!==null?l.memoizedState:null;if(u=s.memoizedState,l===null)if(u===null)if(s.stateNode===null){e:{u=s.type,l=s.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":y=g.getElementsByTagName("title")[0],(!y||y[Qr]||y[Yt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(u),g.head.insertBefore(y,g.querySelector("head > title"))),cr(y,u,l),y[Yt]=s,gn(y),u=y;break e;case"link":var w=Gw("link","href",g).get(u+(l.href||""));if(w){for(var N=0;N<w.length;N++)if(y=w[N],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(N,1);break t}}y=g.createElement(u),cr(y,u,l),g.head.appendChild(y);break;case"meta":if(w=Gw("meta","content",g).get(u+(l.content||""))){for(N=0;N<w.length;N++)if(y=w[N],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(N,1);break t}}y=g.createElement(u),cr(y,u,l),g.head.appendChild(y);break;default:throw Error(n(468,u))}y[Yt]=s,gn(y),u=y}s.stateNode=u}else qw(g,s.type,s.stateNode);else s.stateNode=Fw(g,u,s.memoizedProps);else y!==u?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,u===null?qw(g,s.type,s.stateNode):Fw(g,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Bg(s,s.memoizedProps,l.memoizedProps)}break;case 27:Ur(a,s),zr(s),u&512&&(Vn||l===null||ti(l,l.return)),l!==null&&u&4&&Bg(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Ur(a,s),zr(s),u&512&&(Vn||l===null||ti(l,l.return)),s.flags&32){g=s.stateNode;try{sr(g,"")}catch(Se){kt(s,s.return,Se)}}u&4&&s.stateNode!=null&&(g=s.memoizedProps,Bg(s,g,l!==null?l.memoizedProps:g)),u&1024&&(qg=!0);break;case 6:if(Ur(a,s),zr(s),u&4){if(s.stateNode===null)throw Error(n(162));u=s.memoizedProps,l=s.stateNode;try{l.nodeValue=u}catch(Se){kt(s,s.return,Se)}}break;case 3:if(gf=null,g=Us,Us=pf(a.containerInfo),Ur(a,s),Us=g,zr(s),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Hl(a.containerInfo)}catch(Se){kt(s,s.return,Se)}qg&&(qg=!1,q_(s));break;case 4:u=Us,Us=pf(s.stateNode.containerInfo),Ur(a,s),zr(s),Us=u;break;case 12:Ur(a,s),zr(s);break;case 31:Ur(a,s),zr(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Zh(s,u)));break;case 13:Ur(a,s),zr(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(tf=zt()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Zh(s,u)));break;case 22:g=s.memoizedState!==null;var P=l!==null&&l.memoizedState!==null,Q=Ni,se=Vn;if(Ni=Q||g,Vn=se||P,Ur(a,s),Vn=se,Ni=Q,zr(s),u&8192)e:for(a=s.stateNode,a._visibility=g?a._visibility&-2:a._visibility|1,g&&(l===null||P||Ni||Vn||Ro(s)),l=null,a=s;;){if(a.tag===5||a.tag===26){if(l===null){P=l=a;try{if(y=P.stateNode,g)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{N=P.stateNode;var oe=P.memoizedProps.style,Y=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;N.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(Se){kt(P,P.return,Se)}}}else if(a.tag===6){if(l===null){P=a;try{P.stateNode.nodeValue=g?"":P.memoizedProps}catch(Se){kt(P,P.return,Se)}}}else if(a.tag===18){if(l===null){P=a;try{var W=P.stateNode;g?Ow(W,!0):Ow(P.stateNode,!1)}catch(Se){kt(P,P.return,Se)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=s.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Zh(s,l))));break;case 19:Ur(a,s),zr(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Zh(s,u)));break;case 30:break;case 21:break;default:Ur(a,s),zr(s)}}function zr(s){var a=s.flags;if(a&2){try{for(var l,u=s.return;u!==null;){if(P_(u)){l=u;break}u=u.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var g=l.stateNode,y=Fg(s);Wh(s,y,g);break;case 5:var w=l.stateNode;l.flags&32&&(sr(w,""),l.flags&=-33);var N=Fg(s);Wh(s,N,w);break;case 3:case 4:var P=l.stateNode.containerInfo,Q=Fg(s);Gg(s,Q,P);break;default:throw Error(n(161))}}catch(se){kt(s,s.return,se)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function q_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;q_(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function Ai(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)L_(s,a.alternate,a),a=a.sibling}function Ro(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:pa(4,a,a.return),Ro(a);break;case 1:ti(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&O_(a,a.return,l),Ro(a);break;case 27:Du(a.stateNode);case 26:case 5:ti(a,a.return),Ro(a);break;case 22:a.memoizedState===null&&Ro(a);break;case 30:Ro(a);break;default:Ro(a)}s=s.sibling}}function Ci(s,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,g=s,y=a,w=y.flags;switch(y.tag){case 0:case 11:case 15:Ci(g,y,l),wu(4,y);break;case 1:if(Ci(g,y,l),u=y,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(Q){kt(u,u.return,Q)}if(u=y,g=u.updateQueue,g!==null){var N=u.stateNode;try{var P=g.shared.hiddenCallbacks;if(P!==null)for(g.shared.hiddenCallbacks=null,g=0;g<P.length;g++)_x(P[g],N)}catch(Q){kt(u,u.return,Q)}}l&&w&64&&D_(y),Eu(y,y.return);break;case 27:M_(y);case 26:case 5:Ci(g,y,l),l&&u===null&&w&4&&j_(y),Eu(y,y.return);break;case 12:Ci(g,y,l);break;case 31:Ci(g,y,l),l&&w&4&&B_(g,y);break;case 13:Ci(g,y,l),l&&w&4&&F_(g,y);break;case 22:y.memoizedState===null&&Ci(g,y,l),Eu(y,y.return);break;case 30:break;default:Ci(g,y,l)}a=a.sibling}}function Hg(s,a){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&cu(l))}function $g(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&cu(s))}function zs(s,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)H_(s,a,l,u),a=a.sibling}function H_(s,a,l,u){var g=a.flags;switch(a.tag){case 0:case 11:case 15:zs(s,a,l,u),g&2048&&wu(9,a);break;case 1:zs(s,a,l,u);break;case 3:zs(s,a,l,u),g&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&cu(s)));break;case 12:if(g&2048){zs(s,a,l,u),s=a.stateNode;try{var y=a.memoizedProps,w=y.id,N=y.onPostCommit;typeof N=="function"&&N(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(P){kt(a,a.return,P)}}else zs(s,a,l,u);break;case 31:zs(s,a,l,u);break;case 13:zs(s,a,l,u);break;case 23:break;case 22:y=a.stateNode,w=a.alternate,a.memoizedState!==null?y._visibility&2?zs(s,a,l,u):Tu(s,a):y._visibility&2?zs(s,a,l,u):(y._visibility|=2,jl(s,a,l,u,(a.subtreeFlags&10256)!==0||!1)),g&2048&&Hg(w,a);break;case 24:zs(s,a,l,u),g&2048&&$g(a.alternate,a);break;default:zs(s,a,l,u)}}function jl(s,a,l,u,g){for(g=g&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var y=s,w=a,N=l,P=u,Q=w.flags;switch(w.tag){case 0:case 11:case 15:jl(y,w,N,P,g),wu(8,w);break;case 23:break;case 22:var se=w.stateNode;w.memoizedState!==null?se._visibility&2?jl(y,w,N,P,g):Tu(y,w):(se._visibility|=2,jl(y,w,N,P,g)),g&&Q&2048&&Hg(w.alternate,w);break;case 24:jl(y,w,N,P,g),g&&Q&2048&&$g(w.alternate,w);break;default:jl(y,w,N,P,g)}a=a.sibling}}function Tu(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=s,u=a,g=u.flags;switch(u.tag){case 22:Tu(l,u),g&2048&&Hg(u.alternate,u);break;case 24:Tu(l,u),g&2048&&$g(u.alternate,u);break;default:Tu(l,u)}a=a.sibling}}var Su=8192;function Pl(s,a,l){if(s.subtreeFlags&Su)for(s=s.child;s!==null;)$_(s,a,l),s=s.sibling}function $_(s,a,l){switch(s.tag){case 26:Pl(s,a,l),s.flags&Su&&s.memoizedState!==null&&OR(l,Us,s.memoizedState,s.memoizedProps);break;case 5:Pl(s,a,l);break;case 3:case 4:var u=Us;Us=pf(s.stateNode.containerInfo),Pl(s,a,l),Us=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=Su,Su=16777216,Pl(s,a,l),Su=u):Pl(s,a,l));break;default:Pl(s,a,l)}}function K_(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Nu(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Yn=u,Y_(u,s)}K_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Q_(s),s=s.sibling}function Q_(s){switch(s.tag){case 0:case 11:case 15:Nu(s),s.flags&2048&&pa(9,s,s.return);break;case 3:Nu(s);break;case 12:Nu(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,ef(s)):Nu(s);break;default:Nu(s)}}function ef(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Yn=u,Y_(u,s)}K_(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:pa(8,a,a.return),ef(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,ef(a));break;default:ef(a)}s=s.sibling}}function Y_(s,a){for(;Yn!==null;){var l=Yn;switch(l.tag){case 0:case 11:case 15:pa(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:cu(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Yn=u;else e:for(l=s;Yn!==null;){u=Yn;var g=u.sibling,y=u.return;if(U_(u),u===l){Yn=null;break e}if(g!==null){g.return=y,Yn=g;break e}Yn=y}}}var QC={getCacheForType:function(s){var a=or(jn),l=a.data.get(s);return l===void 0&&(l=s(),a.data.set(s,l)),l},cacheSignal:function(){return or(jn).controller.signal}},YC=typeof WeakMap=="function"?WeakMap:Map,It=0,Ut=null,at=null,lt=0,Rt=0,ns=null,ma=!1,Ml=!1,Kg=!1,Ri=0,xn=0,ga=0,ko=0,Qg=0,rs=0,Vl=0,Iu=null,Br=null,Yg=!1,tf=0,X_=0,nf=1/0,rf=null,ya=null,qn=0,va=null,Ll=null,ki=0,Xg=0,Jg=null,J_=null,Au=0,Wg=null;function ss(){return(It&2)!==0&&lt!==0?lt&-lt:Z.T!==null?s0():gr()}function W_(){if(rs===0)if((lt&536870912)===0||ht){var s=kn;kn<<=1,(kn&3932160)===0&&(kn=262144),rs=s}else rs=536870912;return s=es.current,s!==null&&(s.flags|=32),rs}function Fr(s,a,l){(s===Ut&&(Rt===2||Rt===9)||s.cancelPendingCommit!==null)&&(Ul(s,0),ba(s,lt,rs,!1)),pr(s,l),((It&2)===0||s!==Ut)&&(s===Ut&&((It&2)===0&&(ko|=l),xn===4&&ba(s,lt,rs,!1)),ni(s))}function Z_(s,a,l){if((It&6)!==0)throw Error(n(327));var u=!l&&(a&127)===0&&(a&s.expiredLanes)===0||Kt(s,a),g=u?WC(s,a):e0(s,a,!0),y=u;do{if(g===0){Ml&&!u&&ba(s,a,0,!1);break}else{if(l=s.current.alternate,y&&!XC(l)){g=e0(s,a,!1),y=!1;continue}if(g===2){if(y=a,s.errorRecoveryDisabledLanes&y)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var N=s;g=Iu;var P=N.current.memoizedState.isDehydrated;if(P&&(Ul(N,w).flags|=256),w=e0(N,w,!1),w!==2){if(Kg&&!P){N.errorRecoveryDisabledLanes|=y,ko|=y,g=4;break e}y=Br,Br=g,y!==null&&(Br===null?Br=y:Br.push.apply(Br,y))}g=w}if(y=!1,g!==2)continue}}if(g===1){Ul(s,0),ba(s,a,0,!0);break}e:{switch(u=s,y=g,y){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:ba(u,a,rs,!ma);break e;case 2:Br=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(g=tf+300-zt(),10<g)){if(ba(u,a,rs,!ma),Bt(u,0,!0)!==0)break e;ki=a,u.timeoutHandle=Rw(ew.bind(null,u,l,Br,rf,Yg,a,rs,ko,Vl,ma,y,"Throttled",-0,0),g);break e}ew(u,l,Br,rf,Yg,a,rs,ko,Vl,ma,y,null,-0,0)}}break}while(!0);ni(s)}function ew(s,a,l,u,g,y,w,N,P,Q,se,oe,Y,W){if(s.timeoutHandle=-1,oe=a.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:De},$_(a,y,oe);var Se=(y&62914560)===y?tf-zt():(y&4194048)===y?X_-zt():0;if(Se=jR(oe,Se),Se!==null){ki=y,s.cancelPendingCommit=Se(lw.bind(null,s,a,y,l,u,g,w,N,P,se,oe,null,Y,W)),ba(s,y,w,!Q);return}}lw(s,a,y,l,u,g,w,N,P)}function XC(s){for(var a=s;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var g=l[u],y=g.getSnapshot;g=g.value;try{if(!Wr(y(),g))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ba(s,a,l,u){a&=~Qg,a&=~ko,s.suspendedLanes|=a,s.pingedLanes&=~a,u&&(s.warmLanes|=a),u=s.expirationTimes;for(var g=a;0<g;){var y=31-we(g),w=1<<y;u[y]=-1,g&=~w}l!==0&&Dn(s,l,a)}function sf(){return(It&6)===0?(Cu(0),!1):!0}function Zg(){if(at!==null){if(Rt===0)var s=at.return;else s=at,xi=wo=null,mg(s),Cl=null,du=0,s=at;for(;s!==null;)k_(s.alternate,s),s=s.return;at=null}}function Ul(s,a){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,gR(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),ki=0,Zg(),Ut=s,at=l=vi(s.current,null),lt=a,Rt=0,ns=null,ma=!1,Ml=Kt(s,a),Kg=!1,Vl=rs=Qg=ko=ga=xn=0,Br=Iu=null,Yg=!1,(a&8)!==0&&(a|=a&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=a;0<u;){var g=31-we(u),y=1<<g;a|=s[g],u&=~y}return Ri=a,Sh(),l}function tw(s,a){Xe=null,Z.H=bu,a===Al||a===Oh?(a=yx(),Rt=3):a===rg?(a=yx(),Rt=4):Rt=a===kg?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,ns=a,at===null&&(xn=1,Kh(s,bs(a,s.current)))}function nw(){var s=es.current;return s===null?!0:(lt&4194048)===lt?Es===null:(lt&62914560)===lt||(lt&536870912)!==0?s===Es:!1}function rw(){var s=Z.H;return Z.H=bu,s===null?bu:s}function sw(){var s=Z.A;return Z.A=QC,s}function af(){xn=4,ma||(lt&4194048)!==lt&&es.current!==null||(Ml=!0),(ga&134217727)===0&&(ko&134217727)===0||Ut===null||ba(Ut,lt,rs,!1)}function e0(s,a,l){var u=It;It|=2;var g=rw(),y=sw();(Ut!==s||lt!==a)&&(rf=null,Ul(s,a)),a=!1;var w=xn;e:do try{if(Rt!==0&&at!==null){var N=at,P=ns;switch(Rt){case 8:Zg(),w=6;break e;case 3:case 2:case 9:case 6:es.current===null&&(a=!0);var Q=Rt;if(Rt=0,ns=null,zl(s,N,P,Q),l&&Ml){w=0;break e}break;default:Q=Rt,Rt=0,ns=null,zl(s,N,P,Q)}}JC(),w=xn;break}catch(se){tw(s,se)}while(!0);return a&&s.shellSuspendCounter++,xi=wo=null,It=u,Z.H=g,Z.A=y,at===null&&(Ut=null,lt=0,Sh()),w}function JC(){for(;at!==null;)iw(at)}function WC(s,a){var l=It;It|=2;var u=rw(),g=sw();Ut!==s||lt!==a?(rf=null,nf=zt()+500,Ul(s,a)):Ml=Kt(s,a);e:do try{if(Rt!==0&&at!==null){a=at;var y=ns;t:switch(Rt){case 1:Rt=0,ns=null,zl(s,a,y,1);break;case 2:case 9:if(mx(y)){Rt=0,ns=null,aw(a);break}a=function(){Rt!==2&&Rt!==9||Ut!==s||(Rt=7),ni(s)},y.then(a,a);break e;case 3:Rt=7;break e;case 4:Rt=5;break e;case 7:mx(y)?(Rt=0,ns=null,aw(a)):(Rt=0,ns=null,zl(s,a,y,7));break;case 5:var w=null;switch(at.tag){case 26:w=at.memoizedState;case 5:case 27:var N=at;if(w?Hw(w):N.stateNode.complete){Rt=0,ns=null;var P=N.sibling;if(P!==null)at=P;else{var Q=N.return;Q!==null?(at=Q,of(Q)):at=null}break t}}Rt=0,ns=null,zl(s,a,y,5);break;case 6:Rt=0,ns=null,zl(s,a,y,6);break;case 8:Zg(),xn=6;break e;default:throw Error(n(462))}}ZC();break}catch(se){tw(s,se)}while(!0);return xi=wo=null,Z.H=u,Z.A=g,It=l,at!==null?0:(Ut=null,lt=0,Sh(),xn)}function ZC(){for(;at!==null&&!Kr();)iw(at)}function iw(s){var a=C_(s.alternate,s,Ri);s.memoizedProps=s.pendingProps,a===null?of(s):at=a}function aw(s){var a=s,l=a.alternate;switch(a.tag){case 15:case 0:a=E_(l,a,a.pendingProps,a.type,void 0,lt);break;case 11:a=E_(l,a,a.pendingProps,a.type.render,a.ref,lt);break;case 5:mg(a);default:k_(l,a),a=at=sx(a,Ri),a=C_(l,a,Ri)}s.memoizedProps=s.pendingProps,a===null?of(s):at=a}function zl(s,a,l,u){xi=wo=null,mg(a),Cl=null,du=0;var g=a.return;try{if(BC(s,g,a,l,lt)){xn=1,Kh(s,bs(l,s.current)),at=null;return}}catch(y){if(g!==null)throw at=g,y;xn=1,Kh(s,bs(l,s.current)),at=null;return}a.flags&32768?(ht||u===1?s=!0:Ml||(lt&536870912)!==0?s=!1:(ma=s=!0,(u===2||u===9||u===3||u===6)&&(u=es.current,u!==null&&u.tag===13&&(u.flags|=16384))),ow(a,s)):of(a)}function of(s){var a=s;do{if((a.flags&32768)!==0){ow(a,ma);return}s=a.return;var l=qC(a.alternate,a,Ri);if(l!==null){at=l;return}if(a=a.sibling,a!==null){at=a;return}at=a=s}while(a!==null);xn===0&&(xn=5)}function ow(s,a){do{var l=HC(s.alternate,s);if(l!==null){l.flags&=32767,at=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(s=s.sibling,s!==null)){at=s;return}at=s=l}while(s!==null);xn=6,at=null}function lw(s,a,l,u,g,y,w,N,P){s.cancelPendingCommit=null;do lf();while(qn!==0);if((It&6)!==0)throw Error(n(327));if(a!==null){if(a===s.current)throw Error(n(177));if(y=a.lanes|a.childLanes,y|=Fm,Qt(s,l,y,w,N,P),s===Ut&&(at=Ut=null,lt=0),Ll=a,va=s,ki=l,Xg=y,Jg=g,J_=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,rR(qt,function(){return fw(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=Z.T,Z.T=null,g=he.p,he.p=2,w=It,It|=4;try{$C(s,a,l)}finally{It=w,he.p=g,Z.T=u}}qn=1,cw(),uw(),dw()}}function cw(){if(qn===1){qn=0;var s=va,a=Ll,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=Z.T,Z.T=null;var u=he.p;he.p=2;var g=It;It|=4;try{G_(a,s);var y=h0,w=Yb(s.containerInfo),N=y.focusedElem,P=y.selectionRange;if(w!==N&&N&&N.ownerDocument&&Qb(N.ownerDocument.documentElement,N)){if(P!==null&&Vm(N)){var Q=P.start,se=P.end;if(se===void 0&&(se=Q),"selectionStart"in N)N.selectionStart=Q,N.selectionEnd=Math.min(se,N.value.length);else{var oe=N.ownerDocument||document,Y=oe&&oe.defaultView||window;if(Y.getSelection){var W=Y.getSelection(),Se=N.textContent.length,Ue=Math.min(P.start,Se),Lt=P.end===void 0?Ue:Math.min(P.end,Se);!W.extend&&Ue>Lt&&(w=Lt,Lt=Ue,Ue=w);var F=Kb(N,Ue),z=Kb(N,Lt);if(F&&z&&(W.rangeCount!==1||W.anchorNode!==F.node||W.anchorOffset!==F.offset||W.focusNode!==z.node||W.focusOffset!==z.offset)){var $=oe.createRange();$.setStart(F.node,F.offset),W.removeAllRanges(),Ue>Lt?(W.addRange($),W.extend(z.node,z.offset)):($.setEnd(z.node,z.offset),W.addRange($))}}}}for(oe=[],W=N;W=W.parentNode;)W.nodeType===1&&oe.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<oe.length;N++){var ae=oe[N];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}xf=!!d0,h0=d0=null}finally{It=g,he.p=u,Z.T=l}}s.current=a,qn=2}}function uw(){if(qn===2){qn=0;var s=va,a=Ll,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=Z.T,Z.T=null;var u=he.p;he.p=2;var g=It;It|=4;try{L_(s,a.alternate,a)}finally{It=g,he.p=u,Z.T=l}}qn=3}}function dw(){if(qn===4||qn===3){qn=0,on();var s=va,a=Ll,l=ki,u=J_;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?qn=5:(qn=0,Ll=va=null,hw(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(ya=null),rr(l),a=a.stateNode,Le&&typeof Le.onCommitFiberRoot=="function")try{Le.onCommitFiberRoot(Oe,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=Z.T,g=he.p,he.p=2,Z.T=null;try{for(var y=s.onRecoverableError,w=0;w<u.length;w++){var N=u[w];y(N.value,{componentStack:N.stack})}}finally{Z.T=a,he.p=g}}(ki&3)!==0&&lf(),ni(s),g=s.pendingLanes,(l&261930)!==0&&(g&42)!==0?s===Wg?Au++:(Au=0,Wg=s):Au=0,Cu(0)}}function hw(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,cu(a)))}function lf(){return cw(),uw(),dw(),fw()}function fw(){if(qn!==5)return!1;var s=va,a=Xg;Xg=0;var l=rr(ki),u=Z.T,g=he.p;try{he.p=32>l?32:l,Z.T=null,l=Jg,Jg=null;var y=va,w=ki;if(qn=0,Ll=va=null,ki=0,(It&6)!==0)throw Error(n(331));var N=It;if(It|=4,Q_(y.current),H_(y,y.current,w,l),It=N,Cu(0,!1),Le&&typeof Le.onPostCommitFiberRoot=="function")try{Le.onPostCommitFiberRoot(Oe,y)}catch{}return!0}finally{he.p=g,Z.T=u,hw(s,a)}}function pw(s,a,l){a=bs(l,a),a=Rg(s.stateNode,a,2),s=da(s,a,2),s!==null&&(pr(s,2),ni(s))}function kt(s,a,l){if(s.tag===3)pw(s,s,l);else for(;a!==null;){if(a.tag===3){pw(a,s,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ya===null||!ya.has(u))){s=bs(l,s),l=m_(2),u=da(a,l,2),u!==null&&(g_(l,u,a,s),pr(u,2),ni(u));break}}a=a.return}}function t0(s,a,l){var u=s.pingCache;if(u===null){u=s.pingCache=new YC;var g=new Set;u.set(a,g)}else g=u.get(a),g===void 0&&(g=new Set,u.set(a,g));g.has(l)||(Kg=!0,g.add(l),s=eR.bind(null,s,a,l),a.then(s,s))}function eR(s,a,l){var u=s.pingCache;u!==null&&u.delete(a),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Ut===s&&(lt&l)===l&&(xn===4||xn===3&&(lt&62914560)===lt&&300>zt()-tf?(It&2)===0&&Ul(s,0):Qg|=l,Vl===lt&&(Vl=0)),ni(s)}function mw(s,a){a===0&&(a=pn()),s=bo(s,a),s!==null&&(pr(s,a),ni(s))}function tR(s){var a=s.memoizedState,l=0;a!==null&&(l=a.retryLane),mw(s,l)}function nR(s,a){var l=0;switch(s.tag){case 31:case 13:var u=s.stateNode,g=s.memoizedState;g!==null&&(l=g.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(n(314))}u!==null&&u.delete(a),mw(s,l)}function rR(s,a){return st(s,a)}var cf=null,Bl=null,n0=!1,uf=!1,r0=!1,xa=0;function ni(s){s!==Bl&&s.next===null&&(Bl===null?cf=Bl=s:Bl=Bl.next=s),uf=!0,n0||(n0=!0,iR())}function Cu(s,a){if(!r0&&uf){r0=!0;do for(var l=!1,u=cf;u!==null;){if(s!==0){var g=u.pendingLanes;if(g===0)var y=0;else{var w=u.suspendedLanes,N=u.pingedLanes;y=(1<<31-we(42|s)+1)-1,y&=g&~(w&~N),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,bw(u,y))}else y=lt,y=Bt(u,u===Ut?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||Kt(u,y)||(l=!0,bw(u,y));u=u.next}while(l);r0=!1}}function sR(){gw()}function gw(){uf=n0=!1;var s=0;xa!==0&&mR()&&(s=xa);for(var a=zt(),l=null,u=cf;u!==null;){var g=u.next,y=yw(u,a);y===0?(u.next=null,l===null?cf=g:l.next=g,g===null&&(Bl=l)):(l=u,(s!==0||(y&3)!==0)&&(uf=!0)),u=g}qn!==0&&qn!==5||Cu(s),xa!==0&&(xa=0)}function yw(s,a){for(var l=s.suspendedLanes,u=s.pingedLanes,g=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var w=31-we(y),N=1<<w,P=g[w];P===-1?((N&l)===0||(N&u)!==0)&&(g[w]=Fn(N,a)):P<=a&&(s.expiredLanes|=N),y&=~N}if(a=Ut,l=lt,l=Bt(s,s===a?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,l===0||s===a&&(Rt===2||Rt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Wt(u),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Kt(s,l)){if(a=l&-l,a===s.callbackPriority)return a;switch(u!==null&&Wt(u),rr(l)){case 2:case 8:l=ln;break;case 32:l=qt;break;case 268435456:l=us;break;default:l=qt}return u=vw.bind(null,s),l=st(l,u),s.callbackPriority=a,s.callbackNode=l,a}return u!==null&&u!==null&&Wt(u),s.callbackPriority=2,s.callbackNode=null,2}function vw(s,a){if(qn!==0&&qn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(lf()&&s.callbackNode!==l)return null;var u=lt;return u=Bt(s,s===Ut?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(Z_(s,u,a),yw(s,zt()),s.callbackNode!=null&&s.callbackNode===l?vw.bind(null,s):null)}function bw(s,a){if(lf())return null;Z_(s,a,!0)}function iR(){yR(function(){(It&6)!==0?st(er,sR):gw()})}function s0(){if(xa===0){var s=Nl;s===0&&(s=$t,$t<<=1,($t&261888)===0&&($t=256)),xa=s}return xa}function xw(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:be(""+s)}function _w(s,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,s.id&&l.setAttribute("form",s.id),a.parentNode.insertBefore(l,a),s=new FormData(s),l.parentNode.removeChild(l),s}function aR(s,a,l,u,g){if(a==="submit"&&l&&l.stateNode===g){var y=xw((g[mn]||null).action),w=u.submitter;w&&(a=(a=w[mn]||null)?xw(a.formAction):w.getAttribute("formAction"),a!==null&&(y=a,w=null));var N=new Ys("action","action",null,u,g);s.push({event:N,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(xa!==0){var P=w?_w(g,w):new FormData(g);Tg(l,{pending:!0,data:P,method:g.method,action:y},null,P)}}else typeof y=="function"&&(N.preventDefault(),P=w?_w(g,w):new FormData(g),Tg(l,{pending:!0,data:P,method:g.method,action:y},y,P))},currentTarget:g}]})}}for(var i0=0;i0<Bm.length;i0++){var a0=Bm[i0],oR=a0.toLowerCase(),lR=a0[0].toUpperCase()+a0.slice(1);Ls(oR,"on"+lR)}Ls(Wb,"onAnimationEnd"),Ls(Zb,"onAnimationIteration"),Ls(ex,"onAnimationStart"),Ls("dblclick","onDoubleClick"),Ls("focusin","onFocus"),Ls("focusout","onBlur"),Ls(TC,"onTransitionRun"),Ls(SC,"onTransitionStart"),Ls(NC,"onTransitionCancel"),Ls(tx,"onTransitionEnd"),Yr("onMouseEnter",["mouseout","mouseover"]),Yr("onMouseLeave",["mouseout","mouseover"]),Yr("onPointerEnter",["pointerout","pointerover"]),Yr("onPointerLeave",["pointerout","pointerover"]),ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ps("onBeforeInput",["compositionend","keypress","textInput","paste"]),ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ru="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ru));function ww(s,a){a=(a&4)!==0;for(var l=0;l<s.length;l++){var u=s[l],g=u.event;u=u.listeners;e:{var y=void 0;if(a)for(var w=u.length-1;0<=w;w--){var N=u[w],P=N.instance,Q=N.currentTarget;if(N=N.listener,P!==y&&g.isPropagationStopped())break e;y=N,g.currentTarget=Q;try{y(g)}catch(se){Th(se)}g.currentTarget=null,y=P}else for(w=0;w<u.length;w++){if(N=u[w],P=N.instance,Q=N.currentTarget,N=N.listener,P!==y&&g.isPropagationStopped())break e;y=N,g.currentTarget=Q;try{y(g)}catch(se){Th(se)}g.currentTarget=null,y=P}}}}function ot(s,a){var l=a[Ki];l===void 0&&(l=a[Ki]=new Set);var u=s+"__bubble";l.has(u)||(Ew(a,s,2,!1),l.add(u))}function o0(s,a,l){var u=0;a&&(u|=4),Ew(l,s,u,a)}var df="_reactListening"+Math.random().toString(36).slice(2);function l0(s){if(!s[df]){s[df]=!0,Yi.forEach(function(l){l!=="selectionchange"&&(cR.has(l)||o0(l,!1,s),o0(l,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[df]||(a[df]=!0,o0("selectionchange",!1,a))}}function Ew(s,a,l,u){switch(Ww(a)){case 2:var g=VR;break;case 8:g=LR;break;default:g=E0}l=g.bind(null,a,l,s),g=void 0,!uo||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(g=!0),u?g!==void 0?s.addEventListener(a,l,{capture:!0,passive:g}):s.addEventListener(a,l,!0):g!==void 0?s.addEventListener(a,l,{passive:g}):s.addEventListener(a,l,!1)}function c0(s,a,l,u,g){var y=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var w=u.tag;if(w===3||w===4){var N=u.stateNode.containerInfo;if(N===g)break;if(w===4)for(w=u.return;w!==null;){var P=w.tag;if((P===3||P===4)&&w.stateNode.containerInfo===g)return;w=w.return}for(;N!==null;){if(w=hs(N),w===null)return;if(P=w.tag,P===5||P===6||P===26||P===27){u=y=w;continue e}N=N.parentNode}}u=u.return}ta(function(){var Q=y,se=vt(l),oe=[];e:{var Y=nx.get(s);if(Y!==void 0){var W=Ys,Se=s;switch(s){case"keypress":if(fo(l)===0)break e;case"keydown":case"keyup":W=_h;break;case"focusin":Se="focus",W=mo;break;case"focusout":Se="blur",W=mo;break;case"beforeblur":case"afterblur":W=mo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=tu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=hh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=x;break;case Wb:case Zb:case ex:W=ph;break;case tx:W=A;break;case"scroll":case"scrollend":W=eu;break;case"wheel":W=J;break;case"copy":case"cut":case"paste":W=mh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=yi;break;case"toggle":case"beforetoggle":W=Ye}var Ue=(a&4)!==0,Lt=!Ue&&(s==="scroll"||s==="scrollend"),F=Ue?Y!==null?Y+"Capture":null:Y;Ue=[];for(var z=Q,$;z!==null;){var ae=z;if($=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||$===null||F===null||(ae=js(z,F),ae!=null&&Ue.push(ku(z,ae,$))),Lt)break;z=z.return}0<Ue.length&&(Y=new W(Y,Se,null,l,se),oe.push({event:Y,listeners:Ue}))}}if((a&7)===0){e:{if(Y=s==="mouseover"||s==="pointerover",W=s==="mouseout"||s==="pointerout",Y&&l!==We&&(Se=l.relatedTarget||l.fromElement)&&(hs(Se)||Se[ds]))break e;if((W||Y)&&(Y=se.window===se?se:(Y=se.ownerDocument)?Y.defaultView||Y.parentWindow:window,W?(Se=l.relatedTarget||l.toElement,W=Q,Se=Se?hs(Se):null,Se!==null&&(Lt=o(Se),Ue=Se.tag,Se!==Lt||Ue!==5&&Ue!==27&&Ue!==6)&&(Se=null)):(W=null,Se=Q),W!==Se)){if(Ue=tu,ae="onMouseLeave",F="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Ue=yi,ae="onPointerLeave",F="onPointerEnter",z="pointer"),Lt=W==null?Y:yr(W),$=Se==null?Y:yr(Se),Y=new Ue(ae,z+"leave",W,l,se),Y.target=Lt,Y.relatedTarget=$,ae=null,hs(se)===Q&&(Ue=new Ue(F,z+"enter",Se,l,se),Ue.target=$,Ue.relatedTarget=Lt,ae=Ue),Lt=ae,W&&Se)t:{for(Ue=uR,F=W,z=Se,$=0,ae=F;ae;ae=Ue(ae))$++;ae=0;for(var je=z;je;je=Ue(je))ae++;for(;0<$-ae;)F=Ue(F),$--;for(;0<ae-$;)z=Ue(z),ae--;for(;$--;){if(F===z||z!==null&&F===z.alternate){Ue=F;break t}F=Ue(F),z=Ue(z)}Ue=null}else Ue=null;W!==null&&Tw(oe,Y,W,Ue,!1),Se!==null&&Lt!==null&&Tw(oe,Lt,Se,Ue,!0)}}e:{if(Y=Q?yr(Q):window,W=Y.nodeName&&Y.nodeName.toLowerCase(),W==="select"||W==="input"&&Y.type==="file")var wt=Bb;else if(Ub(Y))if(Fb)wt=_C;else{wt=bC;var Ce=vC}else W=Y.nodeName,!W||W.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?Q&&ne(Q.elementType)&&(wt=Bb):wt=xC;if(wt&&(wt=wt(s,Q))){zb(oe,wt,l,se);break e}Ce&&Ce(s,Y,Q),s==="focusout"&&Q&&Y.type==="number"&&Q.memoizedProps.value!=null&&Zi(Y,"number",Y.value)}switch(Ce=Q?yr(Q):window,s){case"focusin":(Ub(Ce)||Ce.contentEditable==="true")&&(vl=Ce,Lm=Q,au=null);break;case"focusout":au=Lm=vl=null;break;case"mousedown":Um=!0;break;case"contextmenu":case"mouseup":case"dragend":Um=!1,Xb(oe,l,se);break;case"selectionchange":if(EC)break;case"keydown":case"keyup":Xb(oe,l,se)}var Ze;if(Nt)e:{switch(s){case"compositionstart":var ct="onCompositionStart";break e;case"compositionend":ct="onCompositionEnd";break e;case"compositionupdate":ct="onCompositionUpdate";break e}ct=void 0}else yl?go(s,l)&&(ct="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(ct="onCompositionStart");ct&&(Ws&&l.locale!=="ko"&&(yl||ct!=="onCompositionStart"?ct==="onCompositionEnd"&&yl&&(Ze=Zc()):(Qs=se,Wc="value"in Qs?Qs.value:Qs.textContent,yl=!0)),Ce=hf(Q,ct),0<Ce.length&&(ct=new Js(ct,s,null,l,se),oe.push({event:ct,listeners:Ce}),Ze?ct.data=Ze:(Ze=gl(l),Ze!==null&&(ct.data=Ze)))),(Ze=ys?pC(s,l):mC(s,l))&&(ct=hf(Q,"onBeforeInput"),0<ct.length&&(Ce=new Js("onBeforeInput","beforeinput",null,l,se),oe.push({event:Ce,listeners:ct}),Ce.data=Ze)),aR(oe,s,Q,l,se)}ww(oe,a)})}function ku(s,a,l){return{instance:s,listener:a,currentTarget:l}}function hf(s,a){for(var l=a+"Capture",u=[];s!==null;){var g=s,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=js(s,l),g!=null&&u.unshift(ku(s,g,y)),g=js(s,a),g!=null&&u.push(ku(s,g,y))),s.tag===3)return u;s=s.return}return[]}function uR(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Tw(s,a,l,u,g){for(var y=a._reactName,w=[];l!==null&&l!==u;){var N=l,P=N.alternate,Q=N.stateNode;if(N=N.tag,P!==null&&P===u)break;N!==5&&N!==26&&N!==27||Q===null||(P=Q,g?(Q=js(l,y),Q!=null&&w.unshift(ku(l,Q,P))):g||(Q=js(l,y),Q!=null&&w.push(ku(l,Q,P)))),l=l.return}w.length!==0&&s.push({event:a,listeners:w})}var dR=/\r\n?/g,hR=/\u0000|\uFFFD/g;function Sw(s){return(typeof s=="string"?s:""+s).replace(dR,`
`).replace(hR,"")}function Nw(s,a){return a=Sw(a),Sw(s)===a}function Vt(s,a,l,u,g,y){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||sr(s,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&sr(s,""+u);break;case"className":cn(s,"class",u);break;case"tabIndex":cn(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":cn(s,l,u);break;case"style":T(s,u,y);break;case"data":if(a!=="object"){cn(s,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){s.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=be(""+u),s.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(a!=="input"&&Vt(s,a,"name",g.name,g,null),Vt(s,a,"formEncType",g.formEncType,g,null),Vt(s,a,"formMethod",g.formMethod,g,null),Vt(s,a,"formTarget",g.formTarget,g,null)):(Vt(s,a,"encType",g.encType,g,null),Vt(s,a,"method",g.method,g,null),Vt(s,a,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(l);break}u=be(""+u),s.setAttribute(l,u);break;case"onClick":u!=null&&(s.onclick=De);break;case"onScroll":u!=null&&ot("scroll",s);break;case"onScrollEnd":u!=null&&ot("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(n(60));s.innerHTML=l}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}l=be(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""+u):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":u===!0?s.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(l,u):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(l,u):s.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(l):s.setAttribute(l,u);break;case"popover":ot("beforetoggle",s),ot("toggle",s),Cr(s,"popover",u);break;case"xlinkActuate":en(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":en(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":en(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":en(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":en(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":en(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":en(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":en(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":en(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Cr(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=G.get(l)||l,Cr(s,l,u))}}function u0(s,a,l,u,g,y){switch(l){case"style":T(s,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(n(60));s.innerHTML=l}}break;case"children":typeof u=="string"?sr(s,u):(typeof u=="number"||typeof u=="bigint")&&sr(s,""+u);break;case"onScroll":u!=null&&ot("scroll",s);break;case"onScrollEnd":u!=null&&ot("scrollend",s);break;case"onClick":u!=null&&(s.onclick=De);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ao.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),a=l.slice(2,g?l.length-7:void 0),y=s[mn]||null,y=y!=null?y[l]:null,typeof y=="function"&&s.removeEventListener(a,y,g),typeof u=="function")){typeof y!="function"&&y!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(a,u,g);break e}l in s?s[l]=u:u===!0?s.setAttribute(l,""):Cr(s,l,u)}}}function cr(s,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ot("error",s),ot("load",s);var u=!1,g=!1,y;for(y in l)if(l.hasOwnProperty(y)){var w=l[y];if(w!=null)switch(y){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:Vt(s,a,y,w,l,null)}}g&&Vt(s,a,"srcSet",l.srcSet,l,null),u&&Vt(s,a,"src",l.src,l,null);return;case"input":ot("invalid",s);var N=y=w=g=null,P=null,Q=null;for(u in l)if(l.hasOwnProperty(u)){var se=l[u];if(se!=null)switch(u){case"name":g=se;break;case"type":w=se;break;case"checked":P=se;break;case"defaultChecked":Q=se;break;case"value":y=se;break;case"defaultValue":N=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(n(137,a));break;default:Vt(s,a,u,se,l,null)}}oo(s,y,N,P,Q,w,g,!1);return;case"select":ot("invalid",s),u=w=y=null;for(g in l)if(l.hasOwnProperty(g)&&(N=l[g],N!=null))switch(g){case"value":y=N;break;case"defaultValue":w=N;break;case"multiple":u=N;default:Vt(s,a,g,N,l,null)}a=y,l=w,s.multiple=!!u,a!=null?ks(s,!!u,a,!1):l!=null&&ks(s,!!u,l,!0);return;case"textarea":ot("invalid",s),y=g=u=null;for(w in l)if(l.hasOwnProperty(w)&&(N=l[w],N!=null))switch(w){case"value":u=N;break;case"defaultValue":g=N;break;case"children":y=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(n(91));break;default:Vt(s,a,w,N,l,null)}Ds(s,u,g,y);return;case"option":for(P in l)if(l.hasOwnProperty(P)&&(u=l[P],u!=null))switch(P){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Vt(s,a,P,u,l,null)}return;case"dialog":ot("beforetoggle",s),ot("toggle",s),ot("cancel",s),ot("close",s);break;case"iframe":case"object":ot("load",s);break;case"video":case"audio":for(u=0;u<Ru.length;u++)ot(Ru[u],s);break;case"image":ot("error",s),ot("load",s);break;case"details":ot("toggle",s);break;case"embed":case"source":case"link":ot("error",s),ot("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in l)if(l.hasOwnProperty(Q)&&(u=l[Q],u!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:Vt(s,a,Q,u,l,null)}return;default:if(ne(a)){for(se in l)l.hasOwnProperty(se)&&(u=l[se],u!==void 0&&u0(s,a,se,u,l,void 0));return}}for(N in l)l.hasOwnProperty(N)&&(u=l[N],u!=null&&Vt(s,a,N,u,l,null))}function fR(s,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,w=null,N=null,P=null,Q=null,se=null;for(W in l){var oe=l[W];if(l.hasOwnProperty(W)&&oe!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":P=oe;default:u.hasOwnProperty(W)||Vt(s,a,W,null,u,oe)}}for(var Y in u){var W=u[Y];if(oe=l[Y],u.hasOwnProperty(Y)&&(W!=null||oe!=null))switch(Y){case"type":y=W;break;case"name":g=W;break;case"checked":Q=W;break;case"defaultChecked":se=W;break;case"value":w=W;break;case"defaultValue":N=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,a));break;default:W!==oe&&Vt(s,a,Y,W,u,oe)}}Wi(s,w,N,P,Q,se,y,g);return;case"select":W=w=N=Y=null;for(y in l)if(P=l[y],l.hasOwnProperty(y)&&P!=null)switch(y){case"value":break;case"multiple":W=P;default:u.hasOwnProperty(y)||Vt(s,a,y,null,u,P)}for(g in u)if(y=u[g],P=l[g],u.hasOwnProperty(g)&&(y!=null||P!=null))switch(g){case"value":Y=y;break;case"defaultValue":N=y;break;case"multiple":w=y;default:y!==P&&Vt(s,a,g,y,u,P)}a=N,l=w,u=W,Y!=null?ks(s,!!l,Y,!1):!!u!=!!l&&(a!=null?ks(s,!!l,a,!0):ks(s,!!l,l?[]:"",!1));return;case"textarea":W=Y=null;for(N in l)if(g=l[N],l.hasOwnProperty(N)&&g!=null&&!u.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Vt(s,a,N,null,u,g)}for(w in u)if(g=u[w],y=l[w],u.hasOwnProperty(w)&&(g!=null||y!=null))switch(w){case"value":Y=g;break;case"defaultValue":W=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==y&&Vt(s,a,w,g,u,y)}lo(s,Y,W);return;case"option":for(var Se in l)if(Y=l[Se],l.hasOwnProperty(Se)&&Y!=null&&!u.hasOwnProperty(Se))switch(Se){case"selected":s.selected=!1;break;default:Vt(s,a,Se,null,u,Y)}for(P in u)if(Y=u[P],W=l[P],u.hasOwnProperty(P)&&Y!==W&&(Y!=null||W!=null))switch(P){case"selected":s.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:Vt(s,a,P,Y,u,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in l)Y=l[Ue],l.hasOwnProperty(Ue)&&Y!=null&&!u.hasOwnProperty(Ue)&&Vt(s,a,Ue,null,u,Y);for(Q in u)if(Y=u[Q],W=l[Q],u.hasOwnProperty(Q)&&Y!==W&&(Y!=null||W!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(n(137,a));break;default:Vt(s,a,Q,Y,u,W)}return;default:if(ne(a)){for(var Lt in l)Y=l[Lt],l.hasOwnProperty(Lt)&&Y!==void 0&&!u.hasOwnProperty(Lt)&&u0(s,a,Lt,void 0,u,Y);for(se in u)Y=u[se],W=l[se],!u.hasOwnProperty(se)||Y===W||Y===void 0&&W===void 0||u0(s,a,se,Y,u,W);return}}for(var F in l)Y=l[F],l.hasOwnProperty(F)&&Y!=null&&!u.hasOwnProperty(F)&&Vt(s,a,F,null,u,Y);for(oe in u)Y=u[oe],W=l[oe],!u.hasOwnProperty(oe)||Y===W||Y==null&&W==null||Vt(s,a,oe,Y,u,W)}function Iw(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function pR(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var g=l[u],y=g.transferSize,w=g.initiatorType,N=g.duration;if(y&&N&&Iw(w)){for(w=0,N=g.responseEnd,u+=1;u<l.length;u++){var P=l[u],Q=P.startTime;if(Q>N)break;var se=P.transferSize,oe=P.initiatorType;se&&Iw(oe)&&(P=P.responseEnd,w+=se*(P<N?1:(N-Q)/(P-Q)))}if(--u,a+=8*(y+w)/(g.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var d0=null,h0=null;function ff(s){return s.nodeType===9?s:s.ownerDocument}function Aw(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Cw(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function f0(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var p0=null;function mR(){var s=window.event;return s&&s.type==="popstate"?s===p0?!1:(p0=s,!0):(p0=null,!1)}var Rw=typeof setTimeout=="function"?setTimeout:void 0,gR=typeof clearTimeout=="function"?clearTimeout:void 0,kw=typeof Promise=="function"?Promise:void 0,yR=typeof queueMicrotask=="function"?queueMicrotask:typeof kw<"u"?function(s){return kw.resolve(null).then(s).catch(vR)}:Rw;function vR(s){setTimeout(function(){throw s})}function _a(s){return s==="head"}function Dw(s,a){var l=a,u=0;do{var g=l.nextSibling;if(s.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(u===0){s.removeChild(g),Hl(a);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Du(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,Du(l);for(var y=l.firstChild;y;){var w=y.nextSibling,N=y.nodeName;y[Qr]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=w}}else l==="body"&&Du(s.ownerDocument.body);l=g}while(l);Hl(a)}function Ow(s,a){var l=s;s=0;do{var u=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=u}while(l)}function m0(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":m0(l),Qi(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function bR(s,a,l,u){for(;s.nodeType===1;){var g=l;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Qr])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Ts(s.nextSibling),s===null)break}return null}function xR(s,a,l){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ts(s.nextSibling),s===null))return null;return s}function jw(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Ts(s.nextSibling),s===null))return null;return s}function g0(s){return s.data==="$?"||s.data==="$~"}function y0(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function _R(s,a){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||l.readyState!=="loading")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function Ts(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var v0=null;function Pw(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(a===0)return Ts(s.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}s=s.nextSibling}return null}function Mw(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return s;a--}else l!=="/$"&&l!=="/&"||a++}s=s.previousSibling}return null}function Vw(s,a,l){switch(a=ff(l),s){case"html":if(s=a.documentElement,!s)throw Error(n(452));return s;case"head":if(s=a.head,!s)throw Error(n(453));return s;case"body":if(s=a.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Du(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Qi(s)}var Ss=new Map,Lw=new Set;function pf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Di=he.d;he.d={f:wR,r:ER,D:TR,C:SR,L:NR,m:IR,X:CR,S:AR,M:RR};function wR(){var s=Di.f(),a=sf();return s||a}function ER(s){var a=Mr(s);a!==null&&a.tag===5&&a.type==="form"?t_(a):Di.r(s)}var Fl=typeof document>"u"?null:document;function Uw(s,a,l){var u=Fl;if(u&&typeof a=="string"&&a){var g=vr(a);g='link[rel="'+s+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),Lw.has(g)||(Lw.add(g),s={rel:s,crossOrigin:l,href:a},u.querySelector(g)===null&&(a=u.createElement("link"),cr(a,"link",s),gn(a),u.head.appendChild(a)))}}function TR(s){Di.D(s),Uw("dns-prefetch",s,null)}function SR(s,a){Di.C(s,a),Uw("preconnect",s,a)}function NR(s,a,l){Di.L(s,a,l);var u=Fl;if(u&&s&&a){var g='link[rel="preload"][as="'+vr(a)+'"]';a==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+vr(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+vr(l.imageSizes)+'"]')):g+='[href="'+vr(s)+'"]';var y=g;switch(a){case"style":y=Gl(s);break;case"script":y=ql(s)}Ss.has(y)||(s=b({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:s,as:a},l),Ss.set(y,s),u.querySelector(g)!==null||a==="style"&&u.querySelector(Ou(y))||a==="script"&&u.querySelector(ju(y))||(a=u.createElement("link"),cr(a,"link",s),gn(a),u.head.appendChild(a)))}}function IR(s,a){Di.m(s,a);var l=Fl;if(l&&s){var u=a&&typeof a.as=="string"?a.as:"script",g='link[rel="modulepreload"][as="'+vr(u)+'"][href="'+vr(s)+'"]',y=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=ql(s)}if(!Ss.has(y)&&(s=b({rel:"modulepreload",href:s},a),Ss.set(y,s),l.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(ju(y)))return}u=l.createElement("link"),cr(u,"link",s),gn(u),l.head.appendChild(u)}}}function AR(s,a,l){Di.S(s,a,l);var u=Fl;if(u&&s){var g=fs(u).hoistableStyles,y=Gl(s);a=a||"default";var w=g.get(y);if(!w){var N={loading:0,preload:null};if(w=u.querySelector(Ou(y)))N.loading=5;else{s=b({rel:"stylesheet",href:s,"data-precedence":a},l),(l=Ss.get(y))&&b0(s,l);var P=w=u.createElement("link");gn(P),cr(P,"link",s),P._p=new Promise(function(Q,se){P.onload=Q,P.onerror=se}),P.addEventListener("load",function(){N.loading|=1}),P.addEventListener("error",function(){N.loading|=2}),N.loading|=4,mf(w,a,u)}w={type:"stylesheet",instance:w,count:1,state:N},g.set(y,w)}}}function CR(s,a){Di.X(s,a);var l=Fl;if(l&&s){var u=fs(l).hoistableScripts,g=ql(s),y=u.get(g);y||(y=l.querySelector(ju(g)),y||(s=b({src:s,async:!0},a),(a=Ss.get(g))&&x0(s,a),y=l.createElement("script"),gn(y),cr(y,"link",s),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function RR(s,a){Di.M(s,a);var l=Fl;if(l&&s){var u=fs(l).hoistableScripts,g=ql(s),y=u.get(g);y||(y=l.querySelector(ju(g)),y||(s=b({src:s,async:!0,type:"module"},a),(a=Ss.get(g))&&x0(s,a),y=l.createElement("script"),gn(y),cr(y,"link",s),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function zw(s,a,l,u){var g=(g=Re.current)?pf(g):null;if(!g)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Gl(l.href),l=fs(g).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Gl(l.href);var y=fs(g).hoistableStyles,w=y.get(s);if(w||(g=g.ownerDocument||g,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,w),(y=g.querySelector(Ou(s)))&&!y._p&&(w.instance=y,w.state.loading=5),Ss.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ss.set(s,l),y||kR(g,s,l,w.state))),a&&u===null)throw Error(n(528,""));return w}if(a&&u!==null)throw Error(n(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ql(l),l=fs(g).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function Gl(s){return'href="'+vr(s)+'"'}function Ou(s){return'link[rel="stylesheet"]['+s+"]"}function Bw(s){return b({},s,{"data-precedence":s.precedence,precedence:null})}function kR(s,a,l,u){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=s.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),cr(a,"link",l),gn(a),s.head.appendChild(a))}function ql(s){return'[src="'+vr(s)+'"]'}function ju(s){return"script[async]"+s}function Fw(s,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=s.querySelector('style[data-href~="'+vr(l.href)+'"]');if(u)return a.instance=u,gn(u),u;var g=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),gn(u),cr(u,"style",g),mf(u,l.precedence,s),a.instance=u;case"stylesheet":g=Gl(l.href);var y=s.querySelector(Ou(g));if(y)return a.state.loading|=4,a.instance=y,gn(y),y;u=Bw(l),(g=Ss.get(g))&&b0(u,g),y=(s.ownerDocument||s).createElement("link"),gn(y);var w=y;return w._p=new Promise(function(N,P){w.onload=N,w.onerror=P}),cr(y,"link",u),a.state.loading|=4,mf(y,l.precedence,s),a.instance=y;case"script":return y=ql(l.src),(g=s.querySelector(ju(y)))?(a.instance=g,gn(g),g):(u=l,(g=Ss.get(y))&&(u=b({},l),x0(u,g)),s=s.ownerDocument||s,g=s.createElement("script"),gn(g),cr(g,"link",u),s.head.appendChild(g),a.instance=g);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,mf(u,l.precedence,s));return a.instance}function mf(s,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,y=g,w=0;w<u.length;w++){var N=u[w];if(N.dataset.precedence===a)y=N;else if(y!==g)break}y?y.parentNode.insertBefore(s,y.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(s,a.firstChild))}function b0(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function x0(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var gf=null;function Gw(s,a,l){if(gf===null){var u=new Map,g=gf=new Map;g.set(l,u)}else g=gf,u=g.get(l),u||(u=new Map,g.set(l,u));if(u.has(s))return u;for(u.set(s,null),l=l.getElementsByTagName(s),g=0;g<l.length;g++){var y=l[g];if(!(y[Qr]||y[Yt]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(a)||"";w=s+w;var N=u.get(w);N?N.push(y):u.set(w,[y])}}return u}function qw(s,a,l){s=s.ownerDocument||s,s.head.insertBefore(l,a==="title"?s.querySelector("head > title"):null)}function DR(s,a,l){if(l===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Hw(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function OR(s,a,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=Gl(u.href),y=a.querySelector(Ou(g));if(y){a=y._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=yf.bind(s),a.then(s,s)),l.state.loading|=4,l.instance=y,gn(y);return}y=a.ownerDocument||a,u=Bw(u),(g=Ss.get(g))&&b0(u,g),y=y.createElement("link"),gn(y);var w=y;w._p=new Promise(function(N,P){w.onload=N,w.onerror=P}),cr(y,"link",u),l.instance=y}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=yf.bind(s),a.addEventListener("load",l),a.addEventListener("error",l))}}var _0=0;function jR(s,a){return s.stylesheets&&s.count===0&&bf(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var u=setTimeout(function(){if(s.stylesheets&&bf(s,s.stylesheets),s.unsuspend){var y=s.unsuspend;s.unsuspend=null,y()}},6e4+a);0<s.imgBytes&&_0===0&&(_0=62500*pR());var g=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&bf(s,s.stylesheets),s.unsuspend)){var y=s.unsuspend;s.unsuspend=null,y()}},(s.imgBytes>_0?50:800)+a);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function yf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bf(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var vf=null;function bf(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,vf=new Map,a.forEach(PR,s),vf=null,yf.call(s))}function PR(s,a){if(!(a.state.loading&4)){var l=vf.get(s);if(l)var u=l.get(null);else{l=new Map,vf.set(s,l);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var w=g[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),u=w)}u&&l.set(null,u)}g=a.instance,w=g.getAttribute("data-precedence"),y=l.get(w)||u,y===u&&l.set(null,g),l.set(w,g),this.count++,u=yf.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),y?y.parentNode.insertBefore(g,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),a.state.loading|=4}}var Pu={$$typeof:ee,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function MR(s,a,l,u,g,y,w,N,P){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Zt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zt(0),this.hiddenUpdates=Zt(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function $w(s,a,l,u,g,y,w,N,P,Q,se,oe){return s=new MR(s,a,l,w,P,Q,se,oe,N),a=1,y===!0&&(a|=24),y=Zr(3,null,null,a),s.current=y,y.stateNode=s,a=eg(),a.refCount++,s.pooledCache=a,a.refCount++,y.memoizedState={element:u,isDehydrated:l,cache:a},sg(y),s}function Kw(s){return s?(s=_l,s):_l}function Qw(s,a,l,u,g,y){g=Kw(g),u.context===null?u.context=g:u.pendingContext=g,u=ua(a),u.payload={element:l},y=y===void 0?null:y,y!==null&&(u.callback=y),l=da(s,u,a),l!==null&&(Fr(l,s,a),fu(l,s,a))}function Yw(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<a?l:a}}function w0(s,a){Yw(s,a),(s=s.alternate)&&Yw(s,a)}function Xw(s){if(s.tag===13||s.tag===31){var a=bo(s,67108864);a!==null&&Fr(a,s,67108864),w0(s,67108864)}}function Jw(s){if(s.tag===13||s.tag===31){var a=ss();a=mr(a);var l=bo(s,a);l!==null&&Fr(l,s,a),w0(s,a)}}var xf=!0;function VR(s,a,l,u){var g=Z.T;Z.T=null;var y=he.p;try{he.p=2,E0(s,a,l,u)}finally{he.p=y,Z.T=g}}function LR(s,a,l,u){var g=Z.T;Z.T=null;var y=he.p;try{he.p=8,E0(s,a,l,u)}finally{he.p=y,Z.T=g}}function E0(s,a,l,u){if(xf){var g=T0(u);if(g===null)c0(s,a,u,_f,l),Zw(s,u);else if(zR(g,s,a,l,u))u.stopPropagation();else if(Zw(s,u),a&4&&-1<UR.indexOf(s)){for(;g!==null;){var y=Mr(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=xt(y.pendingLanes);if(w!==0){var N=y;for(N.pendingLanes|=2,N.entangledLanes|=2;w;){var P=1<<31-we(w);N.entanglements[1]|=P,w&=~P}ni(y),(It&6)===0&&(nf=zt()+500,Cu(0))}}break;case 31:case 13:N=bo(y,2),N!==null&&Fr(N,y,2),sf(),w0(y,2)}if(y=T0(u),y===null&&c0(s,a,u,_f,l),y===g)break;g=y}g!==null&&u.stopPropagation()}else c0(s,a,u,null,l)}}function T0(s){return s=vt(s),S0(s)}var _f=null;function S0(s){if(_f=null,s=hs(s),s!==null){var a=o(s);if(a===null)s=null;else{var l=a.tag;if(l===13){if(s=c(a),s!==null)return s;s=null}else if(l===31){if(s=d(a),s!==null)return s;s=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return _f=s,null}function Ww(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Tn()){case er:return 2;case ln:return 8;case qt:case tr:return 32;case us:return 268435456;default:return 32}default:return 32}}var N0=!1,wa=null,Ea=null,Ta=null,Mu=new Map,Vu=new Map,Sa=[],UR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Zw(s,a){switch(s){case"focusin":case"focusout":wa=null;break;case"dragenter":case"dragleave":Ea=null;break;case"mouseover":case"mouseout":Ta=null;break;case"pointerover":case"pointerout":Mu.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vu.delete(a.pointerId)}}function Lu(s,a,l,u,g,y){return s===null||s.nativeEvent!==y?(s={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:y,targetContainers:[g]},a!==null&&(a=Mr(a),a!==null&&Xw(a)),s):(s.eventSystemFlags|=u,a=s.targetContainers,g!==null&&a.indexOf(g)===-1&&a.push(g),s)}function zR(s,a,l,u,g){switch(a){case"focusin":return wa=Lu(wa,s,a,l,u,g),!0;case"dragenter":return Ea=Lu(Ea,s,a,l,u,g),!0;case"mouseover":return Ta=Lu(Ta,s,a,l,u,g),!0;case"pointerover":var y=g.pointerId;return Mu.set(y,Lu(Mu.get(y)||null,s,a,l,u,g)),!0;case"gotpointercapture":return y=g.pointerId,Vu.set(y,Lu(Vu.get(y)||null,s,a,l,u,g)),!0}return!1}function e1(s){var a=hs(s.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){s.blockedOn=a,Gn(s.priority,function(){Jw(l)});return}}else if(a===31){if(a=d(l),a!==null){s.blockedOn=a,Gn(s.priority,function(){Jw(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function wf(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var l=T0(s.nativeEvent);if(l===null){l=s.nativeEvent;var u=new l.constructor(l.type,l);We=u,l.target.dispatchEvent(u),We=null}else return a=Mr(l),a!==null&&Xw(a),s.blockedOn=l,!1;a.shift()}return!0}function t1(s,a,l){wf(s)&&l.delete(a)}function BR(){N0=!1,wa!==null&&wf(wa)&&(wa=null),Ea!==null&&wf(Ea)&&(Ea=null),Ta!==null&&wf(Ta)&&(Ta=null),Mu.forEach(t1),Vu.forEach(t1)}function Ef(s,a){s.blockedOn===a&&(s.blockedOn=null,N0||(N0=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,BR)))}var Tf=null;function n1(s){Tf!==s&&(Tf=s,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Tf===s&&(Tf=null);for(var a=0;a<s.length;a+=3){var l=s[a],u=s[a+1],g=s[a+2];if(typeof u!="function"){if(S0(u||l)===null)continue;break}var y=Mr(l);y!==null&&(s.splice(a,3),a-=3,Tg(y,{pending:!0,data:g,method:l.method,action:u},u,g))}}))}function Hl(s){function a(P){return Ef(P,s)}wa!==null&&Ef(wa,s),Ea!==null&&Ef(Ea,s),Ta!==null&&Ef(Ta,s),Mu.forEach(a),Vu.forEach(a);for(var l=0;l<Sa.length;l++){var u=Sa[l];u.blockedOn===s&&(u.blockedOn=null)}for(;0<Sa.length&&(l=Sa[0],l.blockedOn===null);)e1(l),l.blockedOn===null&&Sa.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var g=l[u],y=l[u+1],w=g[mn]||null;if(typeof y=="function")w||n1(l);else if(w){var N=null;if(y&&y.hasAttribute("formAction")){if(g=y,w=y[mn]||null)N=w.formAction;else if(S0(g)!==null)continue}else N=w.action;typeof N=="function"?l[u+1]=N:(l.splice(u,3),u-=3),n1(l)}}}function r1(){function s(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return g=w})},focusReset:"manual",scroll:"manual"})}function a(){g!==null&&(g(),g=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),g!==null&&(g(),g=null)}}}function I0(s){this._internalRoot=s}Sf.prototype.render=I0.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(n(409));var l=a.current,u=ss();Qw(l,u,s,a,null,null)},Sf.prototype.unmount=I0.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;Qw(s.current,2,null,s,null,null),sf(),a[ds]=null}};function Sf(s){this._internalRoot=s}Sf.prototype.unstable_scheduleHydration=function(s){if(s){var a=gr();s={blockedOn:null,target:s,priority:a};for(var l=0;l<Sa.length&&a!==0&&a<Sa[l].priority;l++);Sa.splice(l,0,s),l===0&&e1(s)}};var s1=e.version;if(s1!=="19.2.4")throw Error(n(527,s1,"19.2.4"));he.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=m(a),s=s!==null?v(s):null,s=s===null?null:s.stateNode,s};var FR={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nf.isDisabled&&Nf.supportsFiber)try{Oe=Nf.inject(FR),Le=Nf}catch{}}return Bu.createRoot=function(s,a){if(!i(s))throw Error(n(299));var l=!1,u="",g=d_,y=h_,w=f_;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(y=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=$w(s,1,!1,null,null,l,u,null,g,y,w,r1),s[ds]=a.current,l0(s),new I0(a)},Bu.hydrateRoot=function(s,a,l){if(!i(s))throw Error(n(299));var u=!1,g="",y=d_,w=h_,N=f_,P=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(N=l.onRecoverableError),l.formState!==void 0&&(P=l.formState)),a=$w(s,1,!0,a,l??null,u,g,P,y,w,N,r1),a.context=Kw(null),l=a.current,u=ss(),u=mr(u),g=ua(u),g.callback=null,da(l,g,u),l=u,a.current.lanes=l,pr(a,l),ni(a),s[ds]=a.current,l0(s),new Sf(a)},Bu.version="19.2.4",Bu}var p1;function ZR(){if(p1)return R0.exports;p1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),R0.exports=WR(),R0.exports}var ek=ZR();const tk=Qp(ek);var $l={},j0={exports:{}},P0,m1;function nk(){if(m1)return P0;m1=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return P0=r,P0}var M0,g1;function rk(){if(g1)return M0;g1=1;var r=nk();function e(){}function t(){}return t.resetWarningCache=e,M0=function(){function n(c,d,f,m,v,b){if(b!==r){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}n.isRequired=n;function i(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:e};return o.PropTypes=o,o},M0}var y1;function uS(){return y1||(y1=1,j0.exports=rk()()),j0.exports}var V0,v1;function dS(){return v1||(v1=1,V0={L:1,M:0,Q:3,H:2}),V0}var L0,b1;function hS(){return b1||(b1=1,L0={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),L0}var U0,x1;function sk(){if(x1)return U0;x1=1;var r=hS();function e(t){this.mode=r.MODE_8BIT_BYTE,this.data=t}return e.prototype={getLength:function(t){return this.data.length},write:function(t){for(var n=0;n<this.data.length;n++)t.put(this.data.charCodeAt(n),8)}},U0=e,U0}var z0,_1;function ik(){if(_1)return z0;_1=1;var r=dS();function e(t,n){this.totalCount=t,this.dataCount=n}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,n){var i=e.getRsBlockTable(t,n);if(i==null)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+n);for(var o=i.length/3,c=new Array,d=0;d<o;d++)for(var f=i[d*3+0],m=i[d*3+1],v=i[d*3+2],b=0;b<f;b++)c.push(new e(m,v));return c},e.getRsBlockTable=function(t,n){switch(n){case r.L:return e.RS_BLOCK_TABLE[(t-1)*4+0];case r.M:return e.RS_BLOCK_TABLE[(t-1)*4+1];case r.Q:return e.RS_BLOCK_TABLE[(t-1)*4+2];case r.H:return e.RS_BLOCK_TABLE[(t-1)*4+3];default:return}},z0=e,z0}var B0,w1;function ak(){if(w1)return B0;w1=1;function r(){this.buffer=new Array,this.length=0}return r.prototype={get:function(e){var t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(var n=0;n<t;n++)this.putBit((e>>>t-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},B0=r,B0}var F0,E1;function fS(){if(E1)return F0;E1=1;for(var r={glog:function(t){if(t<1)throw new Error("glog("+t+")");return r.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return r.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},e=0;e<8;e++)r.EXP_TABLE[e]=1<<e;for(var e=8;e<256;e++)r.EXP_TABLE[e]=r.EXP_TABLE[e-4]^r.EXP_TABLE[e-5]^r.EXP_TABLE[e-6]^r.EXP_TABLE[e-8];for(var e=0;e<255;e++)r.LOG_TABLE[r.EXP_TABLE[e]]=e;return F0=r,F0}var G0,T1;function pS(){if(T1)return G0;T1=1;var r=fS();function e(t,n){if(t.length==null)throw new Error(t.length+"/"+n);for(var i=0;i<t.length&&t[i]==0;)i++;this.num=new Array(t.length-i+n);for(var o=0;o<t.length-i;o++)this.num[o]=t[o+i]}return e.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var n=new Array(this.getLength()+t.getLength()-1),i=0;i<this.getLength();i++)for(var o=0;o<t.getLength();o++)n[i+o]^=r.gexp(r.glog(this.get(i))+r.glog(t.get(o)));return new e(n,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var n=r.glog(this.get(0))-r.glog(t.get(0)),i=new Array(this.getLength()),o=0;o<this.getLength();o++)i[o]=this.get(o);for(var o=0;o<t.getLength();o++)i[o]^=r.gexp(r.glog(t.get(o))+n);return new e(i,0).mod(t)}},G0=e,G0}var q0,S1;function ok(){if(S1)return q0;S1=1;var r=hS(),e=pS(),t=fS(),n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},i={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(o){for(var c=o<<10;i.getBCHDigit(c)-i.getBCHDigit(i.G15)>=0;)c^=i.G15<<i.getBCHDigit(c)-i.getBCHDigit(i.G15);return(o<<10|c)^i.G15_MASK},getBCHTypeNumber:function(o){for(var c=o<<12;i.getBCHDigit(c)-i.getBCHDigit(i.G18)>=0;)c^=i.G18<<i.getBCHDigit(c)-i.getBCHDigit(i.G18);return o<<12|c},getBCHDigit:function(o){for(var c=0;o!=0;)c++,o>>>=1;return c},getPatternPosition:function(o){return i.PATTERN_POSITION_TABLE[o-1]},getMask:function(o,c,d){switch(o){case n.PATTERN000:return(c+d)%2==0;case n.PATTERN001:return c%2==0;case n.PATTERN010:return d%3==0;case n.PATTERN011:return(c+d)%3==0;case n.PATTERN100:return(Math.floor(c/2)+Math.floor(d/3))%2==0;case n.PATTERN101:return c*d%2+c*d%3==0;case n.PATTERN110:return(c*d%2+c*d%3)%2==0;case n.PATTERN111:return(c*d%3+(c+d)%2)%2==0;default:throw new Error("bad maskPattern:"+o)}},getErrorCorrectPolynomial:function(o){for(var c=new e([1],0),d=0;d<o;d++)c=c.multiply(new e([1,t.gexp(d)],0));return c},getLengthInBits:function(o,c){if(1<=c&&c<10)switch(o){case r.MODE_NUMBER:return 10;case r.MODE_ALPHA_NUM:return 9;case r.MODE_8BIT_BYTE:return 8;case r.MODE_KANJI:return 8;default:throw new Error("mode:"+o)}else if(c<27)switch(o){case r.MODE_NUMBER:return 12;case r.MODE_ALPHA_NUM:return 11;case r.MODE_8BIT_BYTE:return 16;case r.MODE_KANJI:return 10;default:throw new Error("mode:"+o)}else if(c<41)switch(o){case r.MODE_NUMBER:return 14;case r.MODE_ALPHA_NUM:return 13;case r.MODE_8BIT_BYTE:return 16;case r.MODE_KANJI:return 12;default:throw new Error("mode:"+o)}else throw new Error("type:"+c)},getLostPoint:function(o){for(var c=o.getModuleCount(),d=0,f=0;f<c;f++)for(var m=0;m<c;m++){for(var v=0,b=o.isDark(f,m),_=-1;_<=1;_++)if(!(f+_<0||c<=f+_))for(var S=-1;S<=1;S++)m+S<0||c<=m+S||_==0&&S==0||b==o.isDark(f+_,m+S)&&v++;v>5&&(d+=3+v-5)}for(var f=0;f<c-1;f++)for(var m=0;m<c-1;m++){var k=0;o.isDark(f,m)&&k++,o.isDark(f+1,m)&&k++,o.isDark(f,m+1)&&k++,o.isDark(f+1,m+1)&&k++,(k==0||k==4)&&(d+=3)}for(var f=0;f<c;f++)for(var m=0;m<c-6;m++)o.isDark(f,m)&&!o.isDark(f,m+1)&&o.isDark(f,m+2)&&o.isDark(f,m+3)&&o.isDark(f,m+4)&&!o.isDark(f,m+5)&&o.isDark(f,m+6)&&(d+=40);for(var m=0;m<c;m++)for(var f=0;f<c-6;f++)o.isDark(f,m)&&!o.isDark(f+1,m)&&o.isDark(f+2,m)&&o.isDark(f+3,m)&&o.isDark(f+4,m)&&!o.isDark(f+5,m)&&o.isDark(f+6,m)&&(d+=40);for(var L=0,m=0;m<c;m++)for(var f=0;f<c;f++)o.isDark(f,m)&&L++;var B=Math.abs(100*L/c/c-50)/5;return d+=B*10,d}};return q0=i,q0}var H0,N1;function lk(){if(N1)return H0;N1=1;var r=sk(),e=ik(),t=ak(),n=ok(),i=pS();function o(d,f){this.typeNumber=d,this.errorCorrectLevel=f,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var c=o.prototype;return c.addData=function(d){var f=new r(d);this.dataList.push(f),this.dataCache=null},c.isDark=function(d,f){if(d<0||this.moduleCount<=d||f<0||this.moduleCount<=f)throw new Error(d+","+f);return this.modules[d][f]},c.getModuleCount=function(){return this.moduleCount},c.make=function(){if(this.typeNumber<1){var d=1;for(d=1;d<40;d++){for(var f=e.getRSBlocks(d,this.errorCorrectLevel),m=new t,v=0,b=0;b<f.length;b++)v+=f[b].dataCount;for(var b=0;b<this.dataList.length;b++){var _=this.dataList[b];m.put(_.mode,4),m.put(_.getLength(),n.getLengthInBits(_.mode,d)),_.write(m)}if(m.getLengthInBits()<=v*8)break}this.typeNumber=d}this.makeImpl(!1,this.getBestMaskPattern())},c.makeImpl=function(d,f){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var m=0;m<this.moduleCount;m++){this.modules[m]=new Array(this.moduleCount);for(var v=0;v<this.moduleCount;v++)this.modules[m][v]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(d,f),this.typeNumber>=7&&this.setupTypeNumber(d),this.dataCache==null&&(this.dataCache=o.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,f)},c.setupPositionProbePattern=function(d,f){for(var m=-1;m<=7;m++)if(!(d+m<=-1||this.moduleCount<=d+m))for(var v=-1;v<=7;v++)f+v<=-1||this.moduleCount<=f+v||(0<=m&&m<=6&&(v==0||v==6)||0<=v&&v<=6&&(m==0||m==6)||2<=m&&m<=4&&2<=v&&v<=4?this.modules[d+m][f+v]=!0:this.modules[d+m][f+v]=!1)},c.getBestMaskPattern=function(){for(var d=0,f=0,m=0;m<8;m++){this.makeImpl(!0,m);var v=n.getLostPoint(this);(m==0||d>v)&&(d=v,f=m)}return f},c.createMovieClip=function(d,f,m){var v=d.createEmptyMovieClip(f,m),b=1;this.make();for(var _=0;_<this.modules.length;_++)for(var S=_*b,k=0;k<this.modules[_].length;k++){var L=k*b,B=this.modules[_][k];B&&(v.beginFill(0,100),v.moveTo(L,S),v.lineTo(L+b,S),v.lineTo(L+b,S+b),v.lineTo(L,S+b),v.endFill())}return v},c.setupTimingPattern=function(){for(var d=8;d<this.moduleCount-8;d++)this.modules[d][6]==null&&(this.modules[d][6]=d%2==0);for(var f=8;f<this.moduleCount-8;f++)this.modules[6][f]==null&&(this.modules[6][f]=f%2==0)},c.setupPositionAdjustPattern=function(){for(var d=n.getPatternPosition(this.typeNumber),f=0;f<d.length;f++)for(var m=0;m<d.length;m++){var v=d[f],b=d[m];if(this.modules[v][b]==null)for(var _=-2;_<=2;_++)for(var S=-2;S<=2;S++)_==-2||_==2||S==-2||S==2||_==0&&S==0?this.modules[v+_][b+S]=!0:this.modules[v+_][b+S]=!1}},c.setupTypeNumber=function(d){for(var f=n.getBCHTypeNumber(this.typeNumber),m=0;m<18;m++){var v=!d&&(f>>m&1)==1;this.modules[Math.floor(m/3)][m%3+this.moduleCount-8-3]=v}for(var m=0;m<18;m++){var v=!d&&(f>>m&1)==1;this.modules[m%3+this.moduleCount-8-3][Math.floor(m/3)]=v}},c.setupTypeInfo=function(d,f){for(var m=this.errorCorrectLevel<<3|f,v=n.getBCHTypeInfo(m),b=0;b<15;b++){var _=!d&&(v>>b&1)==1;b<6?this.modules[b][8]=_:b<8?this.modules[b+1][8]=_:this.modules[this.moduleCount-15+b][8]=_}for(var b=0;b<15;b++){var _=!d&&(v>>b&1)==1;b<8?this.modules[8][this.moduleCount-b-1]=_:b<9?this.modules[8][15-b-1+1]=_:this.modules[8][15-b-1]=_}this.modules[this.moduleCount-8][8]=!d},c.mapData=function(d,f){for(var m=-1,v=this.moduleCount-1,b=7,_=0,S=this.moduleCount-1;S>0;S-=2)for(S==6&&S--;;){for(var k=0;k<2;k++)if(this.modules[v][S-k]==null){var L=!1;_<d.length&&(L=(d[_]>>>b&1)==1);var B=n.getMask(f,v,S-k);B&&(L=!L),this.modules[v][S-k]=L,b--,b==-1&&(_++,b=7)}if(v+=m,v<0||this.moduleCount<=v){v-=m,m=-m;break}}},o.PAD0=236,o.PAD1=17,o.createData=function(d,f,m){for(var v=e.getRSBlocks(d,f),b=new t,_=0;_<m.length;_++){var S=m[_];b.put(S.mode,4),b.put(S.getLength(),n.getLengthInBits(S.mode,d)),S.write(b)}for(var k=0,_=0;_<v.length;_++)k+=v[_].dataCount;if(b.getLengthInBits()>k*8)throw new Error("code length overflow. ("+b.getLengthInBits()+">"+k*8+")");for(b.getLengthInBits()+4<=k*8&&b.put(0,4);b.getLengthInBits()%8!=0;)b.putBit(!1);for(;!(b.getLengthInBits()>=k*8||(b.put(o.PAD0,8),b.getLengthInBits()>=k*8));)b.put(o.PAD1,8);return o.createBytes(b,v)},o.createBytes=function(d,f){for(var m=0,v=0,b=0,_=new Array(f.length),S=new Array(f.length),k=0;k<f.length;k++){var L=f[k].dataCount,B=f[k].totalCount-L;v=Math.max(v,L),b=Math.max(b,B),_[k]=new Array(L);for(var X=0;X<_[k].length;X++)_[k][X]=255&d.buffer[X+m];m+=L;var re=n.getErrorCorrectPolynomial(B),ee=new i(_[k],re.getLength()-1),le=ee.mod(re);S[k]=new Array(re.getLength()-1);for(var X=0;X<S[k].length;X++){var fe=X+le.getLength()-S[k].length;S[k][X]=fe>=0?le.get(fe):0}}for(var ce=0,X=0;X<f.length;X++)ce+=f[X].totalCount;for(var C=new Array(ce),I=0,X=0;X<v;X++)for(var k=0;k<f.length;k++)X<_[k].length&&(C[I++]=_[k][X]);for(var X=0;X<b;X++)for(var k=0;k<f.length;k++)X<S[k].length&&(C[I++]=S[k][X]);return C},H0=o,H0}var If={},I1;function ck(){if(I1)return If;I1=1,Object.defineProperty(If,"__esModule",{value:!0});var r=Object.assign||function(m){for(var v=1;v<arguments.length;v++){var b=arguments[v];for(var _ in b)Object.prototype.hasOwnProperty.call(b,_)&&(m[_]=b[_])}return m},e=uS(),t=o(e),n=qd(),i=o(n);function o(m){return m&&m.__esModule?m:{default:m}}function c(m,v){var b={};for(var _ in m)v.indexOf(_)>=0||Object.prototype.hasOwnProperty.call(m,_)&&(b[_]=m[_]);return b}var d={bgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,bgD:t.default.string.isRequired,fgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,fgD:t.default.string.isRequired,size:t.default.number.isRequired,title:t.default.string,viewBoxSize:t.default.number.isRequired,xmlns:t.default.string},f=(0,n.forwardRef)(function(m,v){var b=m.bgColor,_=m.bgD,S=m.fgD,k=m.fgColor,L=m.size,B=m.title,X=m.viewBoxSize,re=m.xmlns,ee=re===void 0?"http://www.w3.org/2000/svg":re,le=c(m,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return i.default.createElement("svg",r({},le,{height:L,ref:v,viewBox:"0 0 "+X+" "+X,width:L,xmlns:ee}),B?i.default.createElement("title",null,B):null,i.default.createElement("path",{d:_,fill:b}),i.default.createElement("path",{d:S,fill:k}))});return f.displayName="QRCodeSvg",f.propTypes=d,If.default=f,If}var A1;function uk(){if(A1)return $l;A1=1,Object.defineProperty($l,"__esModule",{value:!0}),$l.QRCode=void 0;var r=Object.assign||function(L){for(var B=1;B<arguments.length;B++){var X=arguments[B];for(var re in X)Object.prototype.hasOwnProperty.call(X,re)&&(L[re]=X[re])}return L},e=uS(),t=b(e),n=dS(),i=b(n),o=lk(),c=b(o),d=qd(),f=b(d),m=ck(),v=b(m);function b(L){return L&&L.__esModule?L:{default:L}}function _(L,B){var X={};for(var re in L)B.indexOf(re)>=0||Object.prototype.hasOwnProperty.call(L,re)&&(X[re]=L[re]);return X}var S={bgColor:t.default.oneOfType([t.default.object,t.default.string]),fgColor:t.default.oneOfType([t.default.object,t.default.string]),level:t.default.string,size:t.default.number,value:t.default.string.isRequired},k=(0,d.forwardRef)(function(L,B){var X=L.bgColor,re=X===void 0?"#FFFFFF":X,ee=L.fgColor,le=ee===void 0?"#000000":ee,fe=L.level,ce=fe===void 0?"L":fe,C=L.size,I=C===void 0?256:C,R=L.value,U=_(L,["bgColor","fgColor","level","size","value"]),D=new c.default(-1,i.default[ce]);D.addData(R),D.make();var M=D.modules;return f.default.createElement(v.default,r({},U,{bgColor:re,bgD:M.map(function(O,qe){return O.map(function(gt,Z){return gt?"":"M "+Z+" "+qe+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:le,fgD:M.map(function(O,qe){return O.map(function(gt,Z){return gt?"M "+Z+" "+qe+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:B,size:I,viewBoxSize:M.length}))});return $l.QRCode=k,k.displayName="QRCode",k.propTypes=S,$l.default=k,$l}var dk=uk();const C1=Qp(dk);var dn=(r=>(r.READY="ready to sing",r.STANDBY="standby",r))(dn||{}),Tt=(r=>(r.SINGING="Singing",r.LISTENING="Listening",r))(Tt||{}),Fe=(r=>(r.PENDING="Pending Approval",r.APPROVED="Approved",r.DONE="Done",r))(Fe||{}),si=(r=>(r.FRESH_MEAT="FRESH_MEAT",r.FAIR_ROTATION="FAIR_ROTATION",r.FIFO="FIFO",r.OLDEST_MEMBER="OLDEST_MEMBER",r.RANDOM="RANDOM",r))(si||{});class hk{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const t of this._parts)e.push(t);return fk(e).buffer}}function fk(r){let e=0;for(const i of r)e+=i.byteLength;const t=new Uint8Array(e);let n=0;for(const i of r){const o=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);t.set(o,n),n+=i.byteLength}return t}function mS(r){return new pk(r).unpack()}function gS(r){const e=new mk,t=e.pack(r);return t instanceof Promise?t.then(()=>e.getBuffer()):e.getBuffer()}class pk{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t}unpack_uint32(){const e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t}unpack_uint64(){const e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t}unpack_string(e){const t=this.read(e);let n=0,i="",o,c;for(;n<e;)o=t[n],o<160?(c=o,n++):(o^192)<32?(c=(o&31)<<6|t[n+1]&63,n+=2):(o^224)<16?(c=(o&15)<<12|(t[n+1]&63)<<6|t[n+2]&63,n+=3):(c=(o&7)<<18|(t[n+1]&63)<<12|(t[n+2]&63)<<6|t[n+3]&63,n+=4),i+=String.fromCodePoint(c);return this.index+=e,i}unpack_array(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=this.unpack();return t}unpack_map(e){const t={};for(let n=0;n<e;n++){const i=this.unpack();t[i]=this.unpack()}return t}unpack_float(){const e=this.unpack_uint32(),t=e>>31,n=(e>>23&255)-127,i=e&8388607|8388608;return(t===0?1:-1)*i*2**(n-23)}unpack_double(){const e=this.unpack_uint32(),t=this.unpack_uint32(),n=e>>31,i=(e>>20&2047)-1023,c=(e&1048575|1048576)*2**(i-20)+t*2**(i-52);return(n===0?1:-1)*c}read(e){const t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")}}class mk{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const t=e.constructor;if(e instanceof Array){const n=this.pack_array(e);if(n instanceof Promise)return n.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const n=e;this.pack_bin(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(n=>{this.pack_bin(new Uint8Array(n)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const n=this.pack_object(e);if(n instanceof Promise)return n.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const t=e.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const t=this._textEncoder.encode(e),n=t.length;if(n<=15)this.pack_uint8(176+n);else if(n<=65535)this._bufferBuilder.append(216),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(e){const t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const n=i=>{if(i<t){const o=this.pack(e[i]);return o instanceof Promise?o.then(()=>n(i+1)):n(i+1)}};return n(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let t=0;e<0&&(t=1,e=-e);const n=Math.floor(Math.log(e)/Math.LN2),i=e/2**n-1,o=Math.floor(i*2**52),c=2**32,d=t<<31|n+1023<<20|o/c&1048575,f=o%c;this._bufferBuilder.append(203),this.pack_int32(d),this.pack_int32(f)}pack_object(e){const t=Object.keys(e),n=t.length;if(n<=15)this.pack_uint8(128+n);else if(n<=65535)this._bufferBuilder.append(222),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(n);else throw new Error("Invalid length");const i=o=>{if(o<t.length){const c=t[o];if(e.hasOwnProperty(c)){this.pack(c);const d=this.pack(e[c]);if(d instanceof Promise)return d.then(()=>i(o+1))}return i(o+1)}};return i(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const t=e&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(e){const t=e/4294967296,n=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const t=Math.floor(e/4294967296),n=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}constructor(){this._bufferBuilder=new hk,this._textEncoder=new TextEncoder}}let yS=!0,vS=!0;function Ju(r,e,t){const n=r.match(e);return n&&n.length>=t&&parseFloat(n[t],10)}function il(r,e,t){if(!r.RTCPeerConnection)return;const n=r.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(c,d){if(c!==e)return i.apply(this,arguments);const f=m=>{const v=t(m);v&&(d.handleEvent?d.handleEvent(v):d(v))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(d,f),i.apply(this,[c,f])};const o=n.removeEventListener;n.removeEventListener=function(c,d){if(c!==e||!this._eventMap||!this._eventMap[e])return o.apply(this,arguments);if(!this._eventMap[e].has(d))return o.apply(this,arguments);const f=this._eventMap[e].get(d);return this._eventMap[e].delete(d),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,o.apply(this,[c,f])},Object.defineProperty(n,"on"+e,{get(){return this["_on"+e]},set(c){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),c&&this.addEventListener(e,this["_on"+e]=c)},enumerable:!0,configurable:!0})}function gk(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(yS=r,r?"adapter.js logging disabled":"adapter.js logging enabled")}function yk(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(vS=!r,"adapter.js deprecation warnings "+(r?"disabled":"enabled"))}function bS(){if(typeof window=="object"){if(yS)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function vv(r,e){vS&&console.warn(r+" is deprecated, please use "+e+" instead.")}function vk(r){const e={browser:null,version:null};if(typeof r>"u"||!r.navigator||!r.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=r;if(t.userAgentData&&t.userAgentData.brands){const n=t.userAgentData.brands.find(i=>i.brand==="Chromium");if(n)return{browser:"chrome",version:parseInt(n.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Ju(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||r.isSecureContext===!1&&r.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Ju(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(r.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Ju(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=r.RTCRtpTransceiver&&"currentDirection"in r.RTCRtpTransceiver.prototype,e._safariVersion=Ju(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function R1(r){return Object.prototype.toString.call(r)==="[object Object]"}function xS(r){return R1(r)?Object.keys(r).reduce(function(e,t){const n=R1(r[t]),i=n?xS(r[t]):r[t],o=n&&!Object.keys(i).length;return i===void 0||o?e:Object.assign(e,{[t]:i})},{}):r}function yy(r,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(n=>{n.endsWith("Id")?yy(r,r.get(e[n]),t):n.endsWith("Ids")&&e[n].forEach(i=>{yy(r,r.get(i),t)})}))}function k1(r,e,t){const n=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const o=[];return r.forEach(c=>{c.type==="track"&&c.trackIdentifier===e.id&&o.push(c)}),o.forEach(c=>{r.forEach(d=>{d.type===n&&d.trackId===c.id&&yy(r,d,i)})}),i}const D1=bS;function _S(r,e){const t=r&&r.navigator;if(!t.mediaDevices)return;const n=function(d){if(typeof d!="object"||d.mandatory||d.optional)return d;const f={};return Object.keys(d).forEach(m=>{if(m==="require"||m==="advanced"||m==="mediaSource")return;const v=typeof d[m]=="object"?d[m]:{ideal:d[m]};v.exact!==void 0&&typeof v.exact=="number"&&(v.min=v.max=v.exact);const b=function(_,S){return _?_+S.charAt(0).toUpperCase()+S.slice(1):S==="deviceId"?"sourceId":S};if(v.ideal!==void 0){f.optional=f.optional||[];let _={};typeof v.ideal=="number"?(_[b("min",m)]=v.ideal,f.optional.push(_),_={},_[b("max",m)]=v.ideal,f.optional.push(_)):(_[b("",m)]=v.ideal,f.optional.push(_))}v.exact!==void 0&&typeof v.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[b("",m)]=v.exact):["min","max"].forEach(_=>{v[_]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[b(_,m)]=v[_])})}),d.advanced&&(f.optional=(f.optional||[]).concat(d.advanced)),f},i=function(d,f){if(e.version>=61)return f(d);if(d=JSON.parse(JSON.stringify(d)),d&&typeof d.audio=="object"){const m=function(v,b,_){b in v&&!(_ in v)&&(v[_]=v[b],delete v[b])};d=JSON.parse(JSON.stringify(d)),m(d.audio,"autoGainControl","googAutoGainControl"),m(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=n(d.audio)}if(d&&typeof d.video=="object"){let m=d.video.facingMode;m=m&&(typeof m=="object"?m:{ideal:m});const v=e.version<66;if(m&&(m.exact==="user"||m.exact==="environment"||m.ideal==="user"||m.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!v)){delete d.video.facingMode;let b;if(m.exact==="environment"||m.ideal==="environment"?b=["back","rear"]:(m.exact==="user"||m.ideal==="user")&&(b=["front"]),b)return t.mediaDevices.enumerateDevices().then(_=>{_=_.filter(k=>k.kind==="videoinput");let S=_.find(k=>b.some(L=>k.label.toLowerCase().includes(L)));return!S&&_.length&&b.includes("back")&&(S=_[_.length-1]),S&&(d.video.deviceId=m.exact?{exact:S.deviceId}:{ideal:S.deviceId}),d.video=n(d.video),D1("chrome: "+JSON.stringify(d)),f(d)})}d.video=n(d.video)}return D1("chrome: "+JSON.stringify(d)),f(d)},o=function(d){return e.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},c=function(d,f,m){i(d,v=>{t.webkitGetUserMedia(v,f,b=>{m&&m(o(b))})})};if(t.getUserMedia=c.bind(t),t.mediaDevices.getUserMedia){const d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(f){return i(f,m=>d(m).then(v=>{if(m.audio&&!v.getAudioTracks().length||m.video&&!v.getVideoTracks().length)throw v.getTracks().forEach(b=>{b.stop()}),new DOMException("","NotFoundError");return v},v=>Promise.reject(o(v))))}}}function wS(r){r.MediaStream=r.MediaStream||r.webkitMediaStream}function ES(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("ontrack"in r.RTCPeerConnection.prototype)){Object.defineProperty(r.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=n=>{n.stream.addEventListener("addtrack",i=>{let o;r.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(d=>d.track&&d.track.id===i.track.id):o={track:i.track};const c=new Event("track");c.track=i.track,c.receiver=o,c.transceiver={receiver:o},c.streams=[n.stream],this.dispatchEvent(c)}),n.stream.getTracks().forEach(i=>{let o;r.RTCPeerConnection.prototype.getReceivers?o=this.getReceivers().find(d=>d.track&&d.track.id===i.id):o={track:i};const c=new Event("track");c.track=i,c.receiver=o,c.transceiver={receiver:o},c.streams=[n.stream],this.dispatchEvent(c)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else il(r,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function TS(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("getSenders"in r.RTCPeerConnection.prototype)&&"createDTMFSender"in r.RTCPeerConnection.prototype){const e=function(i,o){return{track:o,get dtmf(){return this._dtmf===void 0&&(o.kind==="audio"?this._dtmf=i.createDTMFSender(o):this._dtmf=null),this._dtmf},_pc:i}};if(!r.RTCPeerConnection.prototype.getSenders){r.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(d,f){let m=i.apply(this,arguments);return m||(m=e(this,d),this._senders.push(m)),m};const o=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(d){o.apply(this,arguments);const f=this._senders.indexOf(d);f!==-1&&this._senders.splice(f,1)}}const t=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(o){this._senders=this._senders||[],t.apply(this,[o]),o.getTracks().forEach(c=>{this._senders.push(e(this,c))})};const n=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(o){this._senders=this._senders||[],n.apply(this,[o]),o.getTracks().forEach(c=>{const d=this._senders.find(f=>f.track===c);d&&this._senders.splice(this._senders.indexOf(d),1)})}}else if(typeof r=="object"&&r.RTCPeerConnection&&"getSenders"in r.RTCPeerConnection.prototype&&"createDTMFSender"in r.RTCPeerConnection.prototype&&r.RTCRtpSender&&!("dtmf"in r.RTCRtpSender.prototype)){const e=r.RTCPeerConnection.prototype.getSenders;r.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(i=>i._pc=this),n},Object.defineProperty(r.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function SS(r){if(!(typeof r=="object"&&r.RTCPeerConnection&&r.RTCRtpSender&&r.RTCRtpReceiver))return;if(!("getStats"in r.RTCRtpSender.prototype)){const t=r.RTCPeerConnection.prototype.getSenders;t&&(r.RTCPeerConnection.prototype.getSenders=function(){const o=t.apply(this,[]);return o.forEach(c=>c._pc=this),o});const n=r.RTCPeerConnection.prototype.addTrack;n&&(r.RTCPeerConnection.prototype.addTrack=function(){const o=n.apply(this,arguments);return o._pc=this,o}),r.RTCRtpSender.prototype.getStats=function(){const o=this;return this._pc.getStats().then(c=>k1(c,o.track,!0))}}if(!("getStats"in r.RTCRtpReceiver.prototype)){const t=r.RTCPeerConnection.prototype.getReceivers;t&&(r.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(o=>o._pc=this),i}),il(r,"track",n=>(n.receiver._pc=n.srcElement,n)),r.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(o=>k1(o,i.track,!1))}}if(!("getStats"in r.RTCRtpSender.prototype&&"getStats"in r.RTCRtpReceiver.prototype))return;const e=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof r.MediaStreamTrack){const n=arguments[0];let i,o,c;return this.getSenders().forEach(d=>{d.track===n&&(i?c=!0:i=d)}),this.getReceivers().forEach(d=>(d.track===n&&(o?c=!0:o=d),d.track===n)),c||i&&o?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():o?o.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function NS(r){r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(c=>this._shimmedLocalStreams[c][0])};const e=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(c,d){if(!d)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=e.apply(this,arguments);return this._shimmedLocalStreams[d.id]?this._shimmedLocalStreams[d.id].indexOf(f)===-1&&this._shimmedLocalStreams[d.id].push(f):this._shimmedLocalStreams[d.id]=[d,f],f};const t=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(c){this._shimmedLocalStreams=this._shimmedLocalStreams||{},c.getTracks().forEach(m=>{if(this.getSenders().find(b=>b.track===m))throw new DOMException("Track already exists.","InvalidAccessError")});const d=this.getSenders();t.apply(this,arguments);const f=this.getSenders().filter(m=>d.indexOf(m)===-1);this._shimmedLocalStreams[c.id]=[c].concat(f)};const n=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[c.id],n.apply(this,arguments)};const i=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(c){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},c&&Object.keys(this._shimmedLocalStreams).forEach(d=>{const f=this._shimmedLocalStreams[d].indexOf(c);f!==-1&&this._shimmedLocalStreams[d].splice(f,1),this._shimmedLocalStreams[d].length===1&&delete this._shimmedLocalStreams[d]}),i.apply(this,arguments)}}function IS(r,e){if(!r.RTCPeerConnection)return;if(r.RTCPeerConnection.prototype.addTrack&&e.version>=65)return NS(r);const t=r.RTCPeerConnection.prototype.getLocalStreams;r.RTCPeerConnection.prototype.getLocalStreams=function(){const v=t.apply(this);return this._reverseStreams=this._reverseStreams||{},v.map(b=>this._reverseStreams[b.id])};const n=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(v){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},v.getTracks().forEach(b=>{if(this.getSenders().find(S=>S.track===b))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[v.id]){const b=new r.MediaStream(v.getTracks());this._streams[v.id]=b,this._reverseStreams[b.id]=v,v=b}n.apply(this,[v])};const i=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(v){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[v.id]||v]),delete this._reverseStreams[this._streams[v.id]?this._streams[v.id].id:v.id],delete this._streams[v.id]},r.RTCPeerConnection.prototype.addTrack=function(v,b){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const _=[].slice.call(arguments,1);if(_.length!==1||!_[0].getTracks().find(L=>L===v))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(L=>L.track===v))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const k=this._streams[b.id];if(k)k.addTrack(v),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const L=new r.MediaStream([v]);this._streams[b.id]=L,this._reverseStreams[L.id]=b,this.addStream(L)}return this.getSenders().find(L=>L.track===v)};function o(m,v){let b=v.sdp;return Object.keys(m._reverseStreams||[]).forEach(_=>{const S=m._reverseStreams[_],k=m._streams[S.id];b=b.replace(new RegExp(k.id,"g"),S.id)}),new RTCSessionDescription({type:v.type,sdp:b})}function c(m,v){let b=v.sdp;return Object.keys(m._reverseStreams||[]).forEach(_=>{const S=m._reverseStreams[_],k=m._streams[S.id];b=b.replace(new RegExp(S.id,"g"),k.id)}),new RTCSessionDescription({type:v.type,sdp:b})}["createOffer","createAnswer"].forEach(function(m){const v=r.RTCPeerConnection.prototype[m],b={[m](){const _=arguments;return arguments.length&&typeof arguments[0]=="function"?v.apply(this,[k=>{const L=o(this,k);_[0].apply(null,[L])},k=>{_[1]&&_[1].apply(null,k)},arguments[2]]):v.apply(this,arguments).then(k=>o(this,k))}};r.RTCPeerConnection.prototype[m]=b[m]});const d=r.RTCPeerConnection.prototype.setLocalDescription;r.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?d.apply(this,arguments):(arguments[0]=c(this,arguments[0]),d.apply(this,arguments))};const f=Object.getOwnPropertyDescriptor(r.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(r.RTCPeerConnection.prototype,"localDescription",{get(){const m=f.get.apply(this);return m.type===""?m:o(this,m)}}),r.RTCPeerConnection.prototype.removeTrack=function(v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!v._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(v._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let _;Object.keys(this._streams).forEach(S=>{this._streams[S].getTracks().find(L=>v.track===L)&&(_=this._streams[S])}),_&&(_.getTracks().length===1?this.removeStream(this._reverseStreams[_.id]):_.removeTrack(v.track),this.dispatchEvent(new Event("negotiationneeded")))}}function vy(r,e){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection),r.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=r.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};r.RTCPeerConnection.prototype[t]=i[t]})}function AS(r,e){il(r,"negotiationneeded",t=>{const n=t.target;if(!((e.version<72||n.getConfiguration&&n.getConfiguration().sdpSemantics==="plan-b")&&n.signalingState!=="stable"))return t})}const O1=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:AS,shimAddTrackRemoveTrack:IS,shimAddTrackRemoveTrackWithNative:NS,shimGetSendersWithDtmf:TS,shimGetUserMedia:_S,shimMediaStream:wS,shimOnTrack:ES,shimPeerConnection:vy,shimSenderReceiverGetStats:SS},Symbol.toStringTag,{value:"Module"}));function CS(r,e){const t=r&&r.navigator,n=r&&r.MediaStreamTrack;if(t.getUserMedia=function(i,o,c){vv("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(o,c)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(c,d,f){d in c&&!(f in c)&&(c[f]=c[d],delete c[d])},o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(c){return typeof c=="object"&&typeof c.audio=="object"&&(c=JSON.parse(JSON.stringify(c)),i(c.audio,"autoGainControl","mozAutoGainControl"),i(c.audio,"noiseSuppression","mozNoiseSuppression")),o(c)},n&&n.prototype.getSettings){const c=n.prototype.getSettings;n.prototype.getSettings=function(){const d=c.apply(this,arguments);return i(d,"mozAutoGainControl","autoGainControl"),i(d,"mozNoiseSuppression","noiseSuppression"),d}}if(n&&n.prototype.applyConstraints){const c=n.prototype.applyConstraints;n.prototype.applyConstraints=function(d){return this.kind==="audio"&&typeof d=="object"&&(d=JSON.parse(JSON.stringify(d)),i(d,"autoGainControl","mozAutoGainControl"),i(d,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[d])}}}}function bk(r,e){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(r.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return n.video===!0?n.video={mediaSource:e}:n.video.mediaSource=e,r.navigator.mediaDevices.getUserMedia(n)})}function RS(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function by(r,e){if(typeof r!="object"||!(r.RTCPeerConnection||r.mozRTCPeerConnection))return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const o=r.RTCPeerConnection.prototype[i],c={[i](){return arguments[0]=new(i==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),o.apply(this,arguments)}};r.RTCPeerConnection.prototype[i]=c[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[o,c,d]=arguments;return n.apply(this,[o||null]).then(f=>{if(e.version<53&&!c)try{f.forEach(m=>{m.type=t[m.type]||m.type})}catch(m){if(m.name!=="TypeError")throw m;f.forEach((v,b)=>{f.set(b,Object.assign({},v,{type:t[v.type]||v.type}))})}return f}).then(c,d)}}function kS(r){if(!(typeof r=="object"&&r.RTCPeerConnection&&r.RTCRtpSender)||r.RTCRtpSender&&"getStats"in r.RTCRtpSender.prototype)return;const e=r.RTCPeerConnection.prototype.getSenders;e&&(r.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(o=>o._pc=this),i});const t=r.RTCPeerConnection.prototype.addTrack;t&&(r.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),r.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function DS(r){if(!(typeof r=="object"&&r.RTCPeerConnection&&r.RTCRtpSender)||r.RTCRtpSender&&"getStats"in r.RTCRtpReceiver.prototype)return;const e=r.RTCPeerConnection.prototype.getReceivers;e&&(r.RTCPeerConnection.prototype.getReceivers=function(){const n=e.apply(this,[]);return n.forEach(i=>i._pc=this),n}),il(r,"track",t=>(t.receiver._pc=t.srcElement,t)),r.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function OS(r){!r.RTCPeerConnection||"removeStream"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.removeStream=function(t){vv("removeStream","removeTrack"),this.getSenders().forEach(n=>{n.track&&t.getTracks().includes(n.track)&&this.removeTrack(n)})})}function jS(r){r.DataChannel&&!r.RTCDataChannel&&(r.RTCDataChannel=r.DataChannel)}function PS(r){if(!(typeof r=="object"&&r.RTCPeerConnection))return;const e=r.RTCPeerConnection.prototype.addTransceiver;e&&(r.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let n=arguments[1]&&arguments[1].sendEncodings;n===void 0&&(n=[]),n=[...n];const i=n.length>0;i&&n.forEach(c=>{if("rid"in c&&!/^[a-z0-9]{0,16}$/i.test(c.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in c&&!(parseFloat(c.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in c&&!(parseFloat(c.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const o=e.apply(this,arguments);if(i){const{sender:c}=o,d=c.getParameters();(!("encodings"in d)||d.encodings.length===1&&Object.keys(d.encodings[0]).length===0)&&(d.encodings=n,c.sendEncodings=n,this.setParametersPromises.push(c.setParameters(d).then(()=>{delete c.sendEncodings}).catch(()=>{delete c.sendEncodings})))}return o})}function MS(r){if(!(typeof r=="object"&&r.RTCRtpSender))return;const e=r.RTCRtpSender.prototype.getParameters;e&&(r.RTCRtpSender.prototype.getParameters=function(){const n=e.apply(this,arguments);return"encodings"in n||(n.encodings=[].concat(this.sendEncodings||[{}])),n})}function VS(r){if(!(typeof r=="object"&&r.RTCPeerConnection))return;const e=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function LS(r){if(!(typeof r=="object"&&r.RTCPeerConnection))return;const e=r.RTCPeerConnection.prototype.createAnswer;r.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const j1=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:PS,shimCreateAnswer:LS,shimCreateOffer:VS,shimGetDisplayMedia:bk,shimGetParameters:MS,shimGetUserMedia:CS,shimOnTrack:RS,shimPeerConnection:by,shimRTCDataChannel:jS,shimReceiverGetStats:DS,shimRemoveStream:OS,shimSenderGetStats:kS},Symbol.toStringTag,{value:"Module"}));function US(r){if(!(typeof r!="object"||!r.RTCPeerConnection)){if("getLocalStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in r.RTCPeerConnection.prototype)){const e=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addStream=function(n){this._localStreams||(this._localStreams=[]),this._localStreams.includes(n)||this._localStreams.push(n),n.getAudioTracks().forEach(i=>e.call(this,i,n)),n.getVideoTracks().forEach(i=>e.call(this,i,n))},r.RTCPeerConnection.prototype.addTrack=function(n,...i){return i&&i.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),e.apply(this,arguments)}}"removeStream"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const n=this._localStreams.indexOf(t);if(n===-1)return;this._localStreams.splice(n,1);const i=t.getTracks();this.getSenders().forEach(o=>{i.includes(o.track)&&this.removeTrack(o)})})}}function zS(r){if(!(typeof r!="object"||!r.RTCPeerConnection)&&("getRemoteStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in r.RTCPeerConnection.prototype))){Object.defineProperty(r.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=n=>{n.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const o=new Event("addstream");o.stream=i,this.dispatchEvent(o)})})}});const e=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){const n=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(o=>{if(n._remoteStreams||(n._remoteStreams=[]),n._remoteStreams.indexOf(o)>=0)return;n._remoteStreams.push(o);const c=new Event("addstream");c.stream=o,n.dispatchEvent(c)})}),e.apply(n,arguments)}}}function BS(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const e=r.RTCPeerConnection.prototype,t=e.createOffer,n=e.createAnswer,i=e.setLocalDescription,o=e.setRemoteDescription,c=e.addIceCandidate;e.createOffer=function(m,v){const b=arguments.length>=2?arguments[2]:arguments[0],_=t.apply(this,[b]);return v?(_.then(m,v),Promise.resolve()):_},e.createAnswer=function(m,v){const b=arguments.length>=2?arguments[2]:arguments[0],_=n.apply(this,[b]);return v?(_.then(m,v),Promise.resolve()):_};let d=function(f,m,v){const b=i.apply(this,[f]);return v?(b.then(m,v),Promise.resolve()):b};e.setLocalDescription=d,d=function(f,m,v){const b=o.apply(this,[f]);return v?(b.then(m,v),Promise.resolve()):b},e.setRemoteDescription=d,d=function(f,m,v){const b=c.apply(this,[f]);return v?(b.then(m,v),Promise.resolve()):b},e.addIceCandidate=d}function FS(r){const e=r&&r.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,n=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>n(GS(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(n,i,o){e.mediaDevices.getUserMedia(n).then(i,o)}).bind(e))}function GS(r){return r&&r.video!==void 0?Object.assign({},r,{video:xS(r.video)}):r}function qS(r){if(!r.RTCPeerConnection)return;const e=r.RTCPeerConnection;r.RTCPeerConnection=function(n,i){if(n&&n.iceServers){const o=[];for(let c=0;c<n.iceServers.length;c++){let d=n.iceServers[c];d.urls===void 0&&d.url?(vv("RTCIceServer.url","RTCIceServer.urls"),d=JSON.parse(JSON.stringify(d)),d.urls=d.url,delete d.url,o.push(d)):o.push(n.iceServers[c])}n.iceServers=o}return new e(n,i)},r.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function HS(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function $S(r){const e=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(n){if(n){typeof n.offerToReceiveAudio<"u"&&(n.offerToReceiveAudio=!!n.offerToReceiveAudio);const i=this.getTransceivers().find(c=>c.receiver.track.kind==="audio");n.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):n.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof n.offerToReceiveVideo<"u"&&(n.offerToReceiveVideo=!!n.offerToReceiveVideo);const o=this.getTransceivers().find(c=>c.receiver.track.kind==="video");n.offerToReceiveVideo===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):n.offerToReceiveVideo===!0&&!o&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function KS(r){typeof r!="object"||r.AudioContext||(r.AudioContext=r.webkitAudioContext)}const P1=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:KS,shimCallbacksAPI:BS,shimConstraints:GS,shimCreateOfferLegacy:$S,shimGetUserMedia:FS,shimLocalStreamsAPI:US,shimRTCIceServerUrls:qS,shimRemoteStreamsAPI:zS,shimTrackEventTransceiver:HS},Symbol.toStringTag,{value:"Module"}));var $0={exports:{}},M1;function xk(){return M1||(M1=1,(function(r){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(n=>n.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,o)=>(o>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const n=e.splitSections(t);return n&&n[0]},e.getMediaSections=function(t){const n=e.splitSections(t);return n.shift(),n},e.matchPrefix=function(t,n){return e.splitLines(t).filter(i=>i.indexOf(n)===0)},e.parseCandidate=function(t){let n;t.indexOf("a=candidate:")===0?n=t.substring(12).split(" "):n=t.substring(10).split(" ");const i={foundation:n[0],component:{1:"rtp",2:"rtcp"}[n[1]]||n[1],protocol:n[2].toLowerCase(),priority:parseInt(n[3],10),ip:n[4],address:n[4],port:parseInt(n[5],10),type:n[7]};for(let o=8;o<n.length;o+=2)switch(n[o]){case"raddr":i.relatedAddress=n[o+1];break;case"rport":i.relatedPort=parseInt(n[o+1],10);break;case"tcptype":i.tcpType=n[o+1];break;case"ufrag":i.ufrag=n[o+1],i.usernameFragment=n[o+1];break;default:i[n[o]]===void 0&&(i[n[o]]=n[o+1]);break}return i},e.writeCandidate=function(t){const n=[];n.push(t.foundation);const i=t.component;i==="rtp"?n.push(1):i==="rtcp"?n.push(2):n.push(i),n.push(t.protocol.toUpperCase()),n.push(t.priority),n.push(t.address||t.ip),n.push(t.port);const o=t.type;return n.push("typ"),n.push(o),o!=="host"&&t.relatedAddress&&t.relatedPort&&(n.push("raddr"),n.push(t.relatedAddress),n.push("rport"),n.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(n.push("tcptype"),n.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(n.push("ufrag"),n.push(t.usernameFragment||t.ufrag)),"candidate:"+n.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let n=t.substring(9).split(" ");const i={payloadType:parseInt(n.shift(),10)};return n=n[0].split("/"),i.name=n[0],i.clockRate=parseInt(n[1],10),i.channels=n.length===3?parseInt(n[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let n=t.payloadType;t.preferredPayloadType!==void 0&&(n=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+n+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const n=t.substring(9).split(" ");return{id:parseInt(n[0],10),direction:n[0].indexOf("/")>0?n[0].split("/")[1]:"sendrecv",uri:n[1],attributes:n.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const n={};let i;const o=t.substring(t.indexOf(" ")+1).split(";");for(let c=0;c<o.length;c++)i=o[c].trim().split("="),n[i[0].trim()]=i[1];return n},e.writeFmtp=function(t){let n="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const o=[];Object.keys(t.parameters).forEach(c=>{t.parameters[c]!==void 0?o.push(c+"="+t.parameters[c]):o.push(c)}),n+="a=fmtp:"+i+" "+o.join(";")+`\r
`}return n},e.parseRtcpFb=function(t){const n=t.substring(t.indexOf(" ")+1).split(" ");return{type:n.shift(),parameter:n.join(" ")}},e.writeRtcpFb=function(t){let n="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(o=>{n+="a=rtcp-fb:"+i+" "+o.type+(o.parameter&&o.parameter.length?" "+o.parameter:"")+`\r
`}),n},e.parseSsrcMedia=function(t){const n=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,n),10)},o=t.indexOf(":",n);return o>-1?(i.attribute=t.substring(n+1,o),i.value=t.substring(o+1)):i.attribute=t.substring(n+1),i},e.parseSsrcGroup=function(t){const n=t.substring(13).split(" ");return{semantics:n.shift(),ssrcs:n.map(i=>parseInt(i,10))}},e.getMid=function(t){const n=e.matchPrefix(t,"a=mid:")[0];if(n)return n.substring(6)},e.parseFingerprint=function(t){const n=t.substring(14).split(" ");return{algorithm:n[0].toLowerCase(),value:n[1].toUpperCase()}},e.getDtlsParameters=function(t,n){return{role:"auto",fingerprints:e.matchPrefix(t+n,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,n){let i="a=setup:"+n+`\r
`;return t.fingerprints.forEach(o=>{i+="a=fingerprint:"+o.algorithm+" "+o.value+`\r
`}),i},e.parseCryptoLine=function(t){const n=t.substring(9).split(" ");return{tag:parseInt(n[0],10),cryptoSuite:n[1],keyParams:n[2],sessionParams:n.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const n=t.substring(7).split("|");return{keyMethod:"inline",keySalt:n[0],lifeTime:n[1],mkiValue:n[2]?n[2].split(":")[0]:void 0,mkiLength:n[2]?n[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,n){return e.matchPrefix(t+n,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,n){const i=e.matchPrefix(t+n,"a=ice-ufrag:")[0],o=e.matchPrefix(t+n,"a=ice-pwd:")[0];return i&&o?{usernameFragment:i.substring(12),password:o.substring(10)}:null},e.writeIceParameters=function(t){let n="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(n+=`a=ice-lite\r
`),n},e.parseRtpParameters=function(t){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},o=e.splitLines(t)[0].split(" ");n.profile=o[2];for(let d=3;d<o.length;d++){const f=o[d],m=e.matchPrefix(t,"a=rtpmap:"+f+" ")[0];if(m){const v=e.parseRtpMap(m),b=e.matchPrefix(t,"a=fmtp:"+f+" ");switch(v.parameters=b.length?e.parseFmtp(b[0]):{},v.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+f+" ").map(e.parseRtcpFb),n.codecs.push(v),v.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(v.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(d=>{n.headerExtensions.push(e.parseExtmap(d))});const c=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return n.codecs.forEach(d=>{c.forEach(f=>{d.rtcpFeedback.find(v=>v.type===f.type&&v.parameter===f.parameter)||d.rtcpFeedback.push(f)})}),n},e.writeRtpDescription=function(t,n){let i="";i+="m="+t+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map(c=>c.preferredPayloadType!==void 0?c.preferredPayloadType:c.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,n.codecs.forEach(c=>{i+=e.writeRtpMap(c),i+=e.writeFmtp(c),i+=e.writeRtcpFb(c)});let o=0;return n.codecs.forEach(c=>{c.maxptime>o&&(o=c.maxptime)}),o>0&&(i+="a=maxptime:"+o+`\r
`),n.headerExtensions&&n.headerExtensions.forEach(c=>{i+=e.writeExtmap(c)}),i},e.parseRtpEncodingParameters=function(t){const n=[],i=e.parseRtpParameters(t),o=i.fecMechanisms.indexOf("RED")!==-1,c=i.fecMechanisms.indexOf("ULPFEC")!==-1,d=e.matchPrefix(t,"a=ssrc:").map(_=>e.parseSsrcMedia(_)).filter(_=>_.attribute==="cname"),f=d.length>0&&d[0].ssrc;let m;const v=e.matchPrefix(t,"a=ssrc-group:FID").map(_=>_.substring(17).split(" ").map(k=>parseInt(k,10)));v.length>0&&v[0].length>1&&v[0][0]===f&&(m=v[0][1]),i.codecs.forEach(_=>{if(_.name.toUpperCase()==="RTX"&&_.parameters.apt){let S={ssrc:f,codecPayloadType:parseInt(_.parameters.apt,10)};f&&m&&(S.rtx={ssrc:m}),n.push(S),o&&(S=JSON.parse(JSON.stringify(S)),S.fec={ssrc:f,mechanism:c?"red+ulpfec":"red"},n.push(S))}}),n.length===0&&f&&n.push({ssrc:f});let b=e.matchPrefix(t,"b=");return b.length&&(b[0].indexOf("b=TIAS:")===0?b=parseInt(b[0].substring(7),10):b[0].indexOf("b=AS:")===0?b=parseInt(b[0].substring(5),10)*1e3*.95-2e3*8:b=void 0,n.forEach(_=>{_.maxBitrate=b})),n},e.parseRtcpParameters=function(t){const n={},i=e.matchPrefix(t,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname")[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const o=e.matchPrefix(t,"a=rtcp-rsize");n.reducedSize=o.length>0,n.compound=o.length===0;const c=e.matchPrefix(t,"a=rtcp-mux");return n.mux=c.length>0,n},e.writeRtcpParameters=function(t){let n="";return t.reducedSize&&(n+=`a=rtcp-rsize\r
`),t.mux&&(n+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(n+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),n},e.parseMsid=function(t){let n;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const o=e.matchPrefix(t,"a=ssrc:").map(c=>e.parseSsrcMedia(c)).filter(c=>c.attribute==="msid");if(o.length>0)return n=o[0].value.split(" "),{stream:n[0],track:n[1]}},e.parseSctpDescription=function(t){const n=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let o;i.length>0&&(o=parseInt(i[0].substring(19),10)),isNaN(o)&&(o=65536);const c=e.matchPrefix(t,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substring(12),10),protocol:n.fmt,maxMessageSize:o};const d=e.matchPrefix(t,"a=sctpmap:");if(d.length>0){const f=d[0].substring(10).split(" ");return{port:parseInt(f[0],10),protocol:f[1],maxMessageSize:o}}},e.writeSctpDescription=function(t,n){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+n.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+n.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+n.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+n.port+" "+n.protocol+` 65535\r
`],n.maxMessageSize!==void 0&&i.push("a=max-message-size:"+n.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,n,i){let o;const c=n!==void 0?n:2;return t?o=t:o=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+o+" "+c+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,n){const i=e.splitLines(t);for(let o=0;o<i.length;o++)switch(i[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[o].substring(2)}return n?e.getDirection(n):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const n=e.splitLines(t);for(let i=0;i<n.length;i++)if(n[i].length<2||n[i].charAt(1)!=="=")return!1;return!0},r.exports=e})($0)),$0.exports}var QS=xk();const uc=Qp(QS),_k=HR({__proto__:null,default:uc},[QS]);function Uf(r){if(!r.RTCIceCandidate||r.RTCIceCandidate&&"foundation"in r.RTCIceCandidate.prototype)return;const e=r.RTCIceCandidate;r.RTCIceCandidate=function(n){if(typeof n=="object"&&n.candidate&&n.candidate.indexOf("a=")===0&&(n=JSON.parse(JSON.stringify(n)),n.candidate=n.candidate.substring(2)),n.candidate&&n.candidate.length){const i=new e(n),o=uc.parseCandidate(n.candidate);for(const c in o)c in i||Object.defineProperty(i,c,{value:o[c]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(n)},r.RTCIceCandidate.prototype=e.prototype,il(r,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new r.RTCIceCandidate(t.candidate),writable:"false"}),t))}function xy(r){!r.RTCIceCandidate||r.RTCIceCandidate&&"relayProtocol"in r.RTCIceCandidate.prototype||il(r,"icecandidate",e=>{if(e.candidate){const t=uc.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function zf(r,e){if(!r.RTCPeerConnection)return;"sctp"in r.RTCPeerConnection.prototype||Object.defineProperty(r.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(d){if(!d||!d.sdp)return!1;const f=uc.splitSections(d.sdp);return f.shift(),f.some(m=>{const v=uc.parseMLine(m);return v&&v.kind==="application"&&v.protocol.indexOf("SCTP")!==-1})},n=function(d){const f=d.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(f===null||f.length<2)return-1;const m=parseInt(f[1],10);return m!==m?-1:m},i=function(d){let f=65536;return e.browser==="firefox"&&(e.version<57?d===-1?f=16384:f=2147483637:e.version<60?f=e.version===57?65535:65536:f=2147483637),f},o=function(d,f){let m=65536;e.browser==="firefox"&&e.version===57&&(m=65535);const v=uc.matchPrefix(d.sdp,"a=max-message-size:");return v.length>0?m=parseInt(v[0].substring(19),10):e.browser==="firefox"&&f!==-1&&(m=2147483637),m},c=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const f=n(arguments[0]),m=i(f),v=o(arguments[0],f);let b;m===0&&v===0?b=Number.POSITIVE_INFINITY:m===0||v===0?b=Math.max(m,v):b=Math.min(m,v);const _={};Object.defineProperty(_,"maxMessageSize",{get(){return b}}),this._sctp=_}return c.apply(this,arguments)}}function Bf(r){if(!(r.RTCPeerConnection&&"createDataChannel"in r.RTCPeerConnection.prototype))return;function e(n,i){const o=n.send;n.send=function(){const d=arguments[0],f=d.length||d.size||d.byteLength;if(n.readyState==="open"&&i.sctp&&f>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return o.apply(n,arguments)}}const t=r.RTCPeerConnection.prototype.createDataChannel;r.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},il(r,"datachannel",n=>(e(n.channel,n.target),n))}function _y(r){if(!r.RTCPeerConnection||"connectionState"in r.RTCPeerConnection.prototype)return;const e=r.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const n=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const o=i.target;if(o._lastConnectionState!==o.connectionState){o._lastConnectionState=o.connectionState;const c=new Event("connectionstatechange",i);o.dispatchEvent(c)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function wy(r,e){if(!r.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const o=i.sdp.split(`
`).filter(c=>c.trim()!=="a=extmap-allow-mixed").join(`
`);r.RTCSessionDescription&&i instanceof r.RTCSessionDescription?arguments[0]=new r.RTCSessionDescription({type:i.type,sdp:o}):i.sdp=o}return t.apply(this,arguments)}}function Ff(r,e){if(!(r.RTCPeerConnection&&r.RTCPeerConnection.prototype))return;const t=r.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Gf(r,e){if(!(r.RTCPeerConnection&&r.RTCPeerConnection.prototype))return;const t=r.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(r.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(c=>t.apply(this,[c]))})}const wk=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:wy,shimAddIceCandidateNullOrEmpty:Ff,shimConnectionState:_y,shimMaxMessageSize:zf,shimParameterlessSetLocalDescription:Gf,shimRTCIceCandidate:Uf,shimRTCIceCandidateRelayProtocol:xy,shimSendThrowTypeError:Bf},Symbol.toStringTag,{value:"Module"}));function Ek({window:r}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=bS,n=vk(r),i={browserDetails:n,commonShim:wk,extractVersion:Ju,disableLog:gk,disableWarnings:yk,sdp:_k};switch(n.browser){case"chrome":if(!O1||!vy||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(n.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=O1,Ff(r,n),Gf(r),_S(r,n),wS(r),vy(r,n),ES(r),IS(r,n),TS(r),SS(r),AS(r,n),Uf(r),xy(r),_y(r),zf(r,n),Bf(r),wy(r,n);break;case"firefox":if(!j1||!by||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=j1,Ff(r,n),Gf(r),CS(r,n),by(r,n),RS(r),OS(r),kS(r),DS(r),jS(r),PS(r),MS(r),VS(r),LS(r),Uf(r),_y(r),zf(r,n),Bf(r);break;case"safari":if(!P1||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=P1,Ff(r,n),Gf(r),qS(r),$S(r),BS(r),US(r),zS(r),HS(r),FS(r),KS(r),Uf(r),xy(r),zf(r,n),Bf(r),wy(r,n);break;default:t("Unsupported browser!");break}return i}const V1=Ek({window:typeof window>"u"?void 0:window});function al(r,e,t,n){Object.defineProperty(r,e,{get:t,set:n,enumerable:!0,configurable:!0})}class YS{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const t=[],n=e.byteLength,i=Math.ceil(n/this.chunkedMTU);let o=0,c=0;for(;c<n;){const d=Math.min(n,c+this.chunkedMTU),f=e.slice(c,d),m={__peerData:this._dataCount,n:o,data:f,total:i};t.push(m),c=d,o++}return this._dataCount++,t}}}function Tk(r){let e=0;for(const i of r)e+=i.byteLength;const t=new Uint8Array(e);let n=0;for(const i of r)t.set(i,n),n+=i.byteLength;return t}const K0=V1.default||V1,Fu=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const r=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(r)?r==="chrome"?e>=this.minChromeVersion:r==="firefox"?e>=this.minFirefoxVersion:r==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return K0.browserDetails.browser}getVersion(){return K0.browserDetails.version||0}isUnifiedPlanSupported(){const r=this.getBrowser(),e=K0.browserDetails.version||0;if(r==="chrome"&&e<this.minChromeVersion)return!1;if(r==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,n=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),n=!0}catch{}finally{t&&t.close()}return n}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},Sk=r=>!r||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(r),XS=()=>Math.random().toString(36).slice(2),L1={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class Nk extends YS{noop(){}blobToArrayBuffer(e,t){const n=new FileReader;return n.onload=function(i){i.target&&t(i.target.result)},n.readAsArrayBuffer(e),n}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=L1,this.browser=Fu.getBrowser(),this.browserVersion=Fu.getVersion(),this.pack=gS,this.unpack=mS,this.supports=(function(){const t={browser:Fu.isBrowserSupported(),webRTC:Fu.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let n;try{n=new RTCPeerConnection(L1),t.audioVideo=!0;let i;try{i=n.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!i.ordered;try{i.binaryType="blob",t.binaryBlob=!Fu.isIOS}catch{}}catch{}finally{i&&i.close()}}catch{}finally{n&&n.close()}return t})(),this.validateId=Sk,this.randomToken=XS}}const Gr=new Nk,Ik="PeerJS: ";class Ak{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const n=[Ik,...t];for(const i in n)n[i]instanceof Error&&(n[i]="("+n[i].name+") "+n[i].message);e>=3?console.log(...n):e>=2?console.warn("WARNING",...n):e>=1&&console.error("ERROR",...n)}constructor(){this._logLevel=0}}var Ie=new Ak,bv={},Ck=Object.prototype.hasOwnProperty,jr="~";function Ed(){}Object.create&&(Ed.prototype=Object.create(null),new Ed().__proto__||(jr=!1));function Rk(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function JS(r,e,t,n,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var o=new Rk(t,n||r,i),c=jr?jr+e:e;return r._events[c]?r._events[c].fn?r._events[c]=[r._events[c],o]:r._events[c].push(o):(r._events[c]=o,r._eventsCount++),r}function qf(r,e){--r._eventsCount===0?r._events=new Ed:delete r._events[e]}function Ir(){this._events=new Ed,this._eventsCount=0}Ir.prototype.eventNames=function(){var e=[],t,n;if(this._eventsCount===0)return e;for(n in t=this._events)Ck.call(t,n)&&e.push(jr?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};Ir.prototype.listeners=function(e){var t=jr?jr+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,c=new Array(o);i<o;i++)c[i]=n[i].fn;return c};Ir.prototype.listenerCount=function(e){var t=jr?jr+e:e,n=this._events[t];return n?n.fn?1:n.length:0};Ir.prototype.emit=function(e,t,n,i,o,c){var d=jr?jr+e:e;if(!this._events[d])return!1;var f=this._events[d],m=arguments.length,v,b;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),m){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,n),!0;case 4:return f.fn.call(f.context,t,n,i),!0;case 5:return f.fn.call(f.context,t,n,i,o),!0;case 6:return f.fn.call(f.context,t,n,i,o,c),!0}for(b=1,v=new Array(m-1);b<m;b++)v[b-1]=arguments[b];f.fn.apply(f.context,v)}else{var _=f.length,S;for(b=0;b<_;b++)switch(f[b].once&&this.removeListener(e,f[b].fn,void 0,!0),m){case 1:f[b].fn.call(f[b].context);break;case 2:f[b].fn.call(f[b].context,t);break;case 3:f[b].fn.call(f[b].context,t,n);break;case 4:f[b].fn.call(f[b].context,t,n,i);break;default:if(!v)for(S=1,v=new Array(m-1);S<m;S++)v[S-1]=arguments[S];f[b].fn.apply(f[b].context,v)}}return!0};Ir.prototype.on=function(e,t,n){return JS(this,e,t,n,!1)};Ir.prototype.once=function(e,t,n){return JS(this,e,t,n,!0)};Ir.prototype.removeListener=function(e,t,n,i){var o=jr?jr+e:e;if(!this._events[o])return this;if(!t)return qf(this,o),this;var c=this._events[o];if(c.fn)c.fn===t&&(!i||c.once)&&(!n||c.context===n)&&qf(this,o);else{for(var d=0,f=[],m=c.length;d<m;d++)(c[d].fn!==t||i&&!c[d].once||n&&c[d].context!==n)&&f.push(c[d]);f.length?this._events[o]=f.length===1?f[0]:f:qf(this,o)}return this};Ir.prototype.removeAllListeners=function(e){var t;return e?(t=jr?jr+e:e,this._events[t]&&qf(this,t)):(this._events=new Ed,this._eventsCount=0),this};Ir.prototype.off=Ir.prototype.removeListener;Ir.prototype.addListener=Ir.prototype.on;Ir.prefixed=jr;Ir.EventEmitter=Ir;bv=Ir;var ol={};al(ol,"ConnectionType",()=>Fa);al(ol,"PeerErrorType",()=>Un);al(ol,"BaseConnectionErrorType",()=>Ey);al(ol,"DataConnectionErrorType",()=>xv);al(ol,"SerializationType",()=>Yp);al(ol,"SocketEventType",()=>Ua);al(ol,"ServerMessageType",()=>Er);var Fa=(function(r){return r.Data="data",r.Media="media",r})({}),Un=(function(r){return r.BrowserIncompatible="browser-incompatible",r.Disconnected="disconnected",r.InvalidID="invalid-id",r.InvalidKey="invalid-key",r.Network="network",r.PeerUnavailable="peer-unavailable",r.SslUnavailable="ssl-unavailable",r.ServerError="server-error",r.SocketError="socket-error",r.SocketClosed="socket-closed",r.UnavailableID="unavailable-id",r.WebRTC="webrtc",r})({}),Ey=(function(r){return r.NegotiationFailed="negotiation-failed",r.ConnectionClosed="connection-closed",r})({}),xv=(function(r){return r.NotOpenYet="not-open-yet",r.MessageToBig="message-too-big",r})({}),Yp=(function(r){return r.Binary="binary",r.BinaryUTF8="binary-utf8",r.JSON="json",r.None="raw",r})({}),Ua=(function(r){return r.Message="message",r.Disconnected="disconnected",r.Error="error",r.Close="close",r})({}),Er=(function(r){return r.Heartbeat="HEARTBEAT",r.Candidate="CANDIDATE",r.Offer="OFFER",r.Answer="ANSWER",r.Open="OPEN",r.Error="ERROR",r.IdTaken="ID-TAKEN",r.InvalidKey="INVALID-KEY",r.Leave="LEAVE",r.Expire="EXPIRE",r})({});const WS="1.5.5";class kk extends bv.EventEmitter{constructor(e,t,n,i,o,c=5e3){super(),this.pingInterval=c,this._disconnected=!0,this._messagesQueue=[];const d=e?"wss://":"ws://";this._baseUrl=d+t+":"+n+i+"peerjs?key="+o}start(e,t){this._id=e;const n=`${this._baseUrl}&id=${e}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(n+"&version="+WS),this._disconnected=!1,this._socket.onmessage=i=>{let o;try{o=JSON.parse(i.data),Ie.log("Server message received:",o)}catch{Ie.log("Invalid server message",i.data);return}this.emit(Ua.Message,o)},this._socket.onclose=i=>{this._disconnected||(Ie.log("Socket closed.",i),this._cleanup(),this._disconnected=!0,this.emit(Ua.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),Ie.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){Ie.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:Er.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(Ua.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class ZS{constructor(e){this.connection=e}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===Fa.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){const n=this.connection,i={ordered:!!e.reliable},o=t.createDataChannel(n.label,i);n._initializeDataChannel(o),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){Ie.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,n=this.connection.connectionId,i=this.connection.type,o=this.connection.provider;Ie.log("Listening for ICE candidates."),e.onicecandidate=c=>{!c.candidate||!c.candidate.candidate||(Ie.log(`Received ICE candidates for ${t}:`,c.candidate),o.socket.send({type:Er.Candidate,payload:{candidate:c.candidate,type:i,connectionId:n},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":Ie.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(Ey.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":Ie.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(Ey.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":Ie.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},Ie.log("Listening for data channel"),e.ondatachannel=c=>{Ie.log("Received data channel");const d=c.channel;o.getConnection(t,n)._initializeDataChannel(d)},Ie.log("Listening for remote stream"),e.ontrack=c=>{Ie.log("Received remote stream");const d=c.streams[0],f=o.getConnection(t,n);if(f.type===Fa.Media){const m=f;this._addStreamToMediaConnection(d,m)}}}cleanup(){Ie.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const t=e.signalingState!=="closed";let n=!1;const i=this.connection.dataChannel;i&&(n=!!i.readyState&&i.readyState!=="closed"),(t||n)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const n=await e.createOffer(this.connection.options.constraints);Ie.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await e.setLocalDescription(n),Ie.log("Set localDescription:",n,`for:${this.connection.peer}`);let i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===Fa.Data){const o=this.connection;i={...i,label:o.label,reliable:o.reliable,serialization:o.serialization}}t.socket.send({type:Er.Offer,payload:i,dst:this.connection.peer})}catch(i){i!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(Un.WebRTC,i),Ie.log("Failed to setLocalDescription, ",i))}}catch(n){t.emitError(Un.WebRTC,n),Ie.log("Failed to createOffer, ",n)}}async _makeAnswer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const n=await e.createAnswer();Ie.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await e.setLocalDescription(n),Ie.log("Set localDescription:",n,`for:${this.connection.peer}`),t.socket.send({type:Er.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(i){t.emitError(Un.WebRTC,i),Ie.log("Failed to setLocalDescription, ",i)}}catch(n){t.emitError(Un.WebRTC,n),Ie.log("Failed to create answer, ",n)}}async handleSDP(e,t){t=new RTCSessionDescription(t);const n=this.connection.peerConnection,i=this.connection.provider;Ie.log("Setting remote description",t);const o=this;try{await n.setRemoteDescription(t),Ie.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await o._makeAnswer()}catch(c){i.emitError(Un.WebRTC,c),Ie.log("Failed to setRemoteDescription, ",c)}}async handleCandidate(e){Ie.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),Ie.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(Un.WebRTC,t),Ie.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(e,t){if(Ie.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return Ie.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(n=>{t.addTrack(n,e)})}_addStreamToMediaConnection(e,t){Ie.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}}class eN extends bv.EventEmitter{emitError(e,t){Ie.error("Error:",t),this.emit("error",new Dk(`${e}`,t))}}class Dk extends Error{constructor(e,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=e}}class tN extends eN{get open(){return this._open}constructor(e,t,n){super(),this.peer=e,this.provider=t,this.options=n,this._open=!1,this.metadata=n.metadata}}var pv;const _d=class _d extends tN{get type(){return Fa.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,n){super(e,t,n),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||_d.ID_PREFIX+Gr.randomToken(),this._negotiator=new ZS(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Ie.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{Ie.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){Ie.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,n=e.payload;switch(e.type){case Er.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case Er.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:Ie.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(e,t={}){if(this._localStream){Ie.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const n=this.provider._getMessages(this.connectionId);for(const i of n)this.handleMessage(i);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};pv=new WeakMap,Uu(_d,pv,_d.ID_PREFIX="mc_");let cp=_d;class Ok{constructor(e){this._options=e}_buildRequest(e){const t=this._options.secure?"https":"http",{host:n,port:i,path:o,key:c}=this._options,d=new URL(`${t}://${n}:${i}${o}${c}/${e}`);return d.searchParams.set("ts",`${Date.now()}${Math.random()}`),d.searchParams.set("version",WS),fetch(d.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){Ie.error("Error retrieving ID",e);let t="";throw this._options.path==="/"&&this._options.host!==Gr.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let t="";throw this._options.host===Gr.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw Ie.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}var mv,gv;const zo=class zo extends tN{get type(){return Fa.Data}constructor(e,t,n){super(e,t,n),this.connectionId=this.options.connectionId||zo.ID_PREFIX+XS(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new ZS(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Ie.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{Ie.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{Ie.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t=!1){if(!this.open){this.emitError(xv.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,t)}async handleMessage(e){const t=e.payload;switch(e.type){case Er.Answer:await this._negotiator.handleSDP(e.type,t.sdp);break;case Er.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:Ie.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}};mv=new WeakMap,gv=new WeakMap,Uu(zo,mv,zo.ID_PREFIX="dc_"),Uu(zo,gv,zo.MAX_BUFFERED_AMOUNT=8388608);let up=zo;class _v extends up{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>up.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(t){return Ie.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class Q0 extends _v{close(e){super.close(e),this._chunkedData={}}constructor(e,t,n){super(e,t,n),this.chunker=new YS,this.serialization=Yp.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const t=mS(e),n=t.__peerData;if(n){if(n.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(e){const t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=new Uint8Array(e.data),n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];const i=Tk(n.data);this._handleDataMessage({data:i})}}_send(e,t){const n=gS(e);if(n instanceof Promise)return this._send_blob(n);if(!t&&n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}async _send_blob(e){const t=await e;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(e){const t=this.chunker.chunk(e);Ie.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const n of t)this.send(n,!0)}}class jk extends _v{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,t){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=Yp.None}}class Pk extends _v{_handleDataMessage({data:e}){const t=this.parse(this.decoder.decode(e)),n=t.__peerData;if(n&&n.type==="close"){this.close();return}this.emit("data",t)}_send(e,t){const n=this.encoder.encode(this.stringify(e));if(n.byteLength>=Gr.chunkedMTU){this.emitError(xv.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(n)}constructor(...e){super(...e),this.serialization=Yp.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}var yv;const wd=class wd extends eN{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[t,n]of this._connections)e[t]=n;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,t){super(),this._serializers={raw:jk,json:Pk,binary:Q0,"binary-utf8":Q0,default:Q0},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let n;if(e&&e.constructor==Object?t=e:e&&(n=e.toString()),t={debug:0,host:Gr.CLOUD_HOST,port:Gr.CLOUD_PORT,path:"/",key:wd.DEFAULT_KEY,token:Gr.randomToken(),config:Gr.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Gr.CLOUD_HOST?this._options.secure=Gr.isSecure():this._options.host==Gr.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&Ie.setLogFunction(this._options.logFunction),Ie.logLevel=this._options.debug||0,this._api=new Ok(t),this._socket=this._createServerConnection(),!Gr.supports.audioVideo&&!Gr.supports.data){this._delayedAbort(Un.BrowserIncompatible,"The current browser does not support WebRTC");return}if(n&&!Gr.validateId(n)){this._delayedAbort(Un.InvalidID,`ID "${n}" is invalid`);return}n?this._initialize(n):this._api.retrieveId().then(i=>this._initialize(i)).catch(i=>this._abort(Un.ServerError,i))}_createServerConnection(){const e=new kk(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(Ua.Message,t=>{this._handleMessage(t)}),e.on(Ua.Error,t=>{this._abort(Un.SocketError,t)}),e.on(Ua.Disconnected,()=>{this.disconnected||(this.emitError(Un.Network,"Lost connection to server."),this.disconnect())}),e.on(Ua.Close,()=>{this.disconnected||this._abort(Un.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const t=e.type,n=e.payload,i=e.src;switch(t){case Er.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case Er.Error:this._abort(Un.ServerError,n.msg);break;case Er.IdTaken:this._abort(Un.UnavailableID,`ID "${this.id}" is taken`);break;case Er.InvalidKey:this._abort(Un.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case Er.Leave:Ie.log(`Received leave message from ${i}`),this._cleanupPeer(i),this._connections.delete(i);break;case Er.Expire:this.emitError(Un.PeerUnavailable,`Could not connect to peer ${i}`);break;case Er.Offer:{const o=n.connectionId;let c=this.getConnection(i,o);if(c&&(c.close(),Ie.warn(`Offer received for existing Connection ID:${o}`)),n.type===Fa.Media){const f=new cp(i,this,{connectionId:o,_payload:n,metadata:n.metadata});c=f,this._addConnection(i,c),this.emit("call",f)}else if(n.type===Fa.Data){const f=new this._serializers[n.serialization](i,this,{connectionId:o,_payload:n,metadata:n.metadata,label:n.label,serialization:n.serialization,reliable:n.reliable});c=f,this._addConnection(i,c),this.emit("connection",f)}else{Ie.warn(`Received malformed connection type:${n.type}`);return}const d=this._getMessages(o);for(const f of d)c.handleMessage(f);break}default:{if(!n){Ie.warn(`You received a malformed message from ${i} of type ${t}`);return}const o=n.connectionId,c=this.getConnection(i,o);c&&c.peerConnection?c.handleMessage(e):o?this._storeMessage(o,e):Ie.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(t={serialization:"default",...t},this.disconnected){Ie.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(Un.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const n=new this._serializers[t.serialization](e,this,t);return this._addConnection(e,n),n}call(e,t,n={}){if(this.disconnected){Ie.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(Un.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){Ie.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const i=new cp(e,this,{...n,_stream:t});return this._addConnection(e,i),i}_addConnection(e,t){Ie.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const n=t.indexOf(e);n!==-1&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const n=this._connections.get(e);if(!n)return null;for(const i of n)if(i.connectionId===t)return i;return null}_delayedAbort(e,t){setTimeout(()=>{this._abort(e,t)},0)}_abort(e,t){Ie.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(Ie.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(const n of t)n.close()}disconnect(){if(this.disconnected)return;const e=this.id;Ie.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)Ie.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Ie.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=t=>{}){this._api.listAllPeers().then(t=>e(t)).catch(t=>this._abort(Un.ServerError,t))}};yv=new WeakMap,Uu(wd,yv,wd.DEFAULT_KEY="peerjs");let dp=wd;const Mk=()=>{};var U1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nN=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Vk=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=r[t++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=r[t++],c=r[t++],d=r[t++],f=((i&7)<<18|(o&63)<<12|(c&63)<<6|d&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const o=r[t++],c=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|c&63)}}return e.join("")},rN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const o=r[i],c=i+1<r.length,d=c?r[i+1]:0,f=i+2<r.length,m=f?r[i+2]:0,v=o>>2,b=(o&3)<<4|d>>4;let _=(d&15)<<2|m>>6,S=m&63;f||(S=64,c||(_=64)),n.push(t[v],t[b],t[_],t[S])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(nN(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):Vk(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const o=t[r.charAt(i++)],d=i<r.length?t[r.charAt(i)]:0;++i;const m=i<r.length?t[r.charAt(i)]:64;++i;const b=i<r.length?t[r.charAt(i)]:64;if(++i,o==null||d==null||m==null||b==null)throw new Lk;const _=o<<2|d>>4;if(n.push(_),m!==64){const S=d<<4&240|m>>2;if(n.push(S),b!==64){const k=m<<6&192|b;n.push(k)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class Lk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Uk=function(r){const e=nN(r);return rN.encodeByteArray(e,!0)},sN=function(r){return Uk(r).replace(/\./g,"")},iN=function(r){try{return rN.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk=()=>aN().__FIREBASE_DEFAULTS__,Bk=()=>{if(typeof process>"u"||typeof U1>"u")return;const r=U1.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},Fk=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&iN(r[1]);return e&&JSON.parse(e)},Xp=()=>{try{return Mk()||zk()||Bk()||Fk()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},Gk=r=>{var e,t;return(t=(e=Xp())==null?void 0:e.emulatorHosts)==null?void 0:t[r]},oN=()=>{var r;return(r=Xp())==null?void 0:r.config},lN=r=>{var e;return(e=Xp())==null?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cN(r){return(await fetch(r,{credentials:"include"})).ok}const ad={};function Hk(){const r={prod:[],emulator:[]};for(const e of Object.keys(ad))ad[e]?r.emulator.push(e):r.prod.push(e);return r}function $k(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let z1=!1;function Kk(r,e){if(typeof window>"u"||typeof document>"u"||!Uc(window.location.host)||ad[r]===e||ad[r]||z1)return;ad[r]=e;function t(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=Hk().prod.length>0;function c(){const _=document.getElementById(n);_&&_.remove()}function d(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function f(_,S){_.setAttribute("width","24"),_.setAttribute("id",S),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function m(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{z1=!0,c()},_}function v(_,S){_.setAttribute("id",S),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function b(){const _=$k(n),S=t("text"),k=document.getElementById(S)||document.createElement("span"),L=t("learnmore"),B=document.getElementById(L)||document.createElement("a"),X=t("preprendIcon"),re=document.getElementById(X)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const ee=_.element;d(ee),v(B,L);const le=m();f(re,X),ee.append(re,k,B,le),document.body.appendChild(ee)}o?(k.innerText="Preview backend disconnected.",re.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(re.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($n())}function uN(){var e;const r=(e=Xp())==null?void 0:e.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Yk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Xk(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Jk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Wk(){const r=$n();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function dN(){return!uN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function hN(){return!uN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function fN(){try{return typeof indexedDB=="object"}catch{return!1}}function Zk(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD="FirebaseError";class qi extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=eD,Object.setPrototypeOf(this,qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hd.prototype.create)}}class Hd{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],c=o?tD(o,n):"Error",d=`${this.serviceName}: ${c} (${i}).`;return new qi(i,d,n)}}function tD(r,e){return r.replace(nD,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const nD=/\{\$([^}]+)}/g;function rD(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Qo(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const o=r[i],c=e[i];if(B1(o)&&B1(c)){if(!Qo(o,c))return!1}else if(o!==c)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function B1(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $d(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Wu(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,o]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Zu(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function sD(r,e){const t=new iD(r,e);return t.subscribe.bind(t)}class iD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");aD(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=Y0),i.error===void 0&&(i.error=Y0),i.complete===void 0&&(i.complete=Y0);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function aD(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function Y0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(r){return r&&r._delegate?r._delegate:r}class Yo{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new qk;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cD(e))try{this.getOrInitializeService({instanceIdentifier:Oo})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=Oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oo){return this.instances.has(e)}getOptions(e=Oo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(o);n===d&&c.resolve(i)}return i}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:lD(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Oo){return this.component?this.component.multipleInstances?e:Oo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lD(r){return r===Oo?void 0:r}function cD(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new oD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(ut||(ut={}));const dD={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},hD=ut.INFO,fD={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},pD=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=fD[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wv{constructor(e){this.name=e,this._logLevel=hD,this._logHandler=pD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}}const mD=(r,e)=>e.some(t=>r instanceof t);let F1,G1;function gD(){return F1||(F1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yD(){return G1||(G1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pN=new WeakMap,Ty=new WeakMap,mN=new WeakMap,X0=new WeakMap,Ev=new WeakMap;function vD(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",c)},o=()=>{t(Ga(r.result)),i()},c=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&pN.set(t,r)}).catch(()=>{}),Ev.set(e,r),e}function bD(r){if(Ty.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",c),r.removeEventListener("abort",c)},o=()=>{t(),i()},c=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",c),r.addEventListener("abort",c)});Ty.set(r,e)}let Sy={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Ty.get(r);if(e==="objectStoreNames")return r.objectStoreNames||mN.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ga(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function xD(r){Sy=r(Sy)}function _D(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(J0(this),e,...t);return mN.set(n,e.sort?e.sort():[e]),Ga(n)}:yD().includes(r)?function(...e){return r.apply(J0(this),e),Ga(pN.get(this))}:function(...e){return Ga(r.apply(J0(this),e))}}function wD(r){return typeof r=="function"?_D(r):(r instanceof IDBTransaction&&bD(r),mD(r,gD())?new Proxy(r,Sy):r)}function Ga(r){if(r instanceof IDBRequest)return vD(r);if(X0.has(r))return X0.get(r);const e=wD(r);return e!==r&&(X0.set(r,e),Ev.set(e,r)),e}const J0=r=>Ev.get(r);function ED(r,e,{blocked:t,upgrade:n,blocking:i,terminated:o}={}){const c=indexedDB.open(r,e),d=Ga(c);return n&&c.addEventListener("upgradeneeded",f=>{n(Ga(c.result),f.oldVersion,f.newVersion,Ga(c.transaction),f)}),t&&c.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{o&&f.addEventListener("close",()=>o()),i&&f.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const TD=["get","getKey","getAll","getAllKeys","count"],SD=["put","add","delete","clear"],W0=new Map;function q1(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(W0.get(e))return W0.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=SD.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||TD.includes(t)))return;const o=async function(c,...d){const f=this.transaction(c,i?"readwrite":"readonly");let m=f.store;return n&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),i&&f.done]))[0]};return W0.set(e,o),o}xD(r=>({...r,get:(e,t,n)=>q1(e,t)||r.get(e,t,n),has:(e,t)=>!!q1(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ID(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function ID(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ny="@firebase/app",H1="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li=new wv("@firebase/app"),AD="@firebase/app-compat",CD="@firebase/analytics-compat",RD="@firebase/analytics",kD="@firebase/app-check-compat",DD="@firebase/app-check",OD="@firebase/auth",jD="@firebase/auth-compat",PD="@firebase/database",MD="@firebase/data-connect",VD="@firebase/database-compat",LD="@firebase/functions",UD="@firebase/functions-compat",zD="@firebase/installations",BD="@firebase/installations-compat",FD="@firebase/messaging",GD="@firebase/messaging-compat",qD="@firebase/performance",HD="@firebase/performance-compat",$D="@firebase/remote-config",KD="@firebase/remote-config-compat",QD="@firebase/storage",YD="@firebase/storage-compat",XD="@firebase/firestore",JD="@firebase/ai",WD="@firebase/firestore-compat",ZD="firebase",e5="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy="[DEFAULT]",t5={[Ny]:"fire-core",[AD]:"fire-core-compat",[RD]:"fire-analytics",[CD]:"fire-analytics-compat",[DD]:"fire-app-check",[kD]:"fire-app-check-compat",[OD]:"fire-auth",[jD]:"fire-auth-compat",[PD]:"fire-rtdb",[MD]:"fire-data-connect",[VD]:"fire-rtdb-compat",[LD]:"fire-fn",[UD]:"fire-fn-compat",[zD]:"fire-iid",[BD]:"fire-iid-compat",[FD]:"fire-fcm",[GD]:"fire-fcm-compat",[qD]:"fire-perf",[HD]:"fire-perf-compat",[$D]:"fire-rc",[KD]:"fire-rc-compat",[QD]:"fire-gcs",[YD]:"fire-gcs-compat",[XD]:"fire-fst",[WD]:"fire-fst-compat",[JD]:"fire-vertex","fire-js":"fire-js",[ZD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp=new Map,n5=new Map,Ay=new Map;function $1(r,e){try{r.container.addComponent(e)}catch(t){Li.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function vc(r){const e=r.name;if(Ay.has(e))return Li.debug(`There were multiple attempts to register component ${e}.`),!1;Ay.set(e,r);for(const t of hp.values())$1(t,r);for(const t of n5.values())$1(t,r);return!0}function Tv(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Is(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qa=new Hd("app","Firebase",r5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s5{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Yo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zc=e5;function gN(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:Iy,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw qa.create("bad-app-name",{appName:String(i)});if(t||(t=oN()),!t)throw qa.create("no-options");const o=hp.get(i);if(o){if(Qo(t,o.options)&&Qo(n,o.config))return o;throw qa.create("duplicate-app",{appName:i})}const c=new uD(i);for(const f of Ay.values())c.addComponent(f);const d=new s5(t,n,c);return hp.set(i,d),d}function i5(r=Iy){const e=hp.get(r);if(!e&&r===Iy&&oN())return gN();if(!e)throw qa.create("no-app",{appName:r});return e}function Ha(r,e,t){let n=t5[r]??r;t&&(n+=`-${t}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${n}" with version "${e}":`];i&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Li.warn(c.join(" "));return}vc(new Yo(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a5="firebase-heartbeat-database",o5=1,Td="firebase-heartbeat-store";let Z0=null;function yN(){return Z0||(Z0=ED(a5,o5,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Td)}catch(t){console.warn(t)}}}}).catch(r=>{throw qa.create("idb-open",{originalErrorMessage:r.message})})),Z0}async function l5(r){try{const t=(await yN()).transaction(Td),n=await t.objectStore(Td).get(vN(r));return await t.done,n}catch(e){if(e instanceof qi)Li.warn(e.message);else{const t=qa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Li.warn(t.message)}}}async function K1(r,e){try{const n=(await yN()).transaction(Td,"readwrite");await n.objectStore(Td).put(e,vN(r)),await n.done}catch(t){if(t instanceof qi)Li.warn(t.message);else{const n=qa.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Li.warn(n.message)}}}function vN(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c5=1024,u5=30;class d5{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new f5(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Q1();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>u5){const c=p5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Li.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Q1(),{heartbeatsToSend:n,unsentEntries:i}=h5(this._heartbeatsCache.heartbeats),o=sN(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Li.warn(t),""}}}function Q1(){return new Date().toISOString().substring(0,10)}function h5(r,e=c5){const t=[];let n=r.slice();for(const i of r){const o=t.find(c=>c.agent===i.agent);if(o){if(o.dates.push(i.date),Y1(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Y1(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class f5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fN()?Zk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await l5(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return K1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return K1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Y1(r){return sN(JSON.stringify({version:2,heartbeats:r})).length}function p5(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m5(r){vc(new Yo("platform-logger",e=>new ND(e),"PRIVATE")),vc(new Yo("heartbeat",e=>new d5(e),"PRIVATE")),Ha(Ny,H1,r),Ha(Ny,H1,"esm2020"),Ha("fire-js","")}m5("");var g5="firebase",y5="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ha(g5,y5,"app");function bN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const v5=bN,xN=new Hd("auth","Firebase",bN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fp=new wv("@firebase/auth");function b5(r,...e){fp.logLevel<=ut.WARN&&fp.warn(`Auth (${zc}): ${r}`,...e)}function Hf(r,...e){fp.logLevel<=ut.ERROR&&fp.error(`Auth (${zc}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(r,...e){throw Sv(r,...e)}function li(r,...e){return Sv(r,...e)}function _N(r,e,t){const n={...v5(),[e]:t};return new Hd("auth","Firebase",n).create(e,{appName:r.name})}function Vi(r){return _N(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Sv(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return xN.create(r,...e)}function ze(r,e,...t){if(!r)throw Sv(e,...t)}function ji(r){const e="INTERNAL ASSERTION FAILED: "+r;throw Hf(e),new Error(e)}function Ui(r,e){r||ji(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.href)||""}function x5(){return X1()==="http:"||X1()==="https:"}function X1(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _5(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(x5()||Xk()||"connection"in navigator)?navigator.onLine:!0}function w5(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ui(t>e,"Short delay should be less than long delay!"),this.isMobile=Qk()||Jk()}get(){return _5()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(r,e){Ui(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ji("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ji("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ji("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T5=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],S5=new Kd(3e4,6e4);function Za(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function eo(r,e,t,n,i={}){return EN(r,i,async()=>{let o={},c={};n&&(e==="GET"?c=n:o={body:JSON.stringify(n)});const d=$d({key:r.config.apiKey,...c}).slice(1),f=await r._getAdditionalHeaders();f["Content-Type"]="application/json",r.languageCode&&(f["X-Firebase-Locale"]=r.languageCode);const m={method:e,headers:f,...o};return Yk()||(m.referrerPolicy="no-referrer"),r.emulatorConfig&&Uc(r.emulatorConfig.host)&&(m.credentials="include"),wN.fetch()(await TN(r,r.config.apiHost,t,d),m)})}async function EN(r,e,t){r._canInitEmulator=!1;const n={...E5,...e};try{const i=new I5(r),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Af(r,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const d=o.ok?c.errorMessage:c.error.message,[f,m]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Af(r,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw Af(r,"email-already-in-use",c);if(f==="USER_DISABLED")throw Af(r,"user-disabled",c);const v=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw _N(r,v,m);qs(r,v)}}catch(i){if(i instanceof qi)throw i;qs(r,"network-request-failed",{message:String(i)})}}async function Qd(r,e,t,n,i={}){const o=await eo(r,e,t,n,i);return"mfaPendingCredential"in o&&qs(r,"multi-factor-auth-required",{_serverResponse:o}),o}async function TN(r,e,t,n){const i=`${e}${t}?${n}`,o=r,c=o.config.emulator?Nv(r.config,i):`${r.config.apiScheme}://${i}`;return T5.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}function N5(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class I5{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(li(this.auth,"network-request-failed")),S5.get())})}}function Af(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=li(r,e,n);return i.customData._tokenResponse=t,i}function J1(r){return r!==void 0&&r.enterprise!==void 0}class A5{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return N5(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function C5(r,e){return eo(r,"GET","/v2/recaptchaConfig",Za(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R5(r,e){return eo(r,"POST","/v1/accounts:delete",e)}async function pp(r,e){return eo(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function od(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k5(r,e=!1){const t=Wn(r),n=await t.getIdToken(e),i=Iv(n);ze(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,c=o==null?void 0:o.sign_in_provider;return{claims:i,token:n,authTime:od(ey(i.auth_time)),issuedAtTime:od(ey(i.iat)),expirationTime:od(ey(i.exp)),signInProvider:c||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function ey(r){return Number(r)*1e3}function Iv(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return Hf("JWT malformed, contained fewer than 3 sections"),null;try{const i=iN(t);return i?JSON.parse(i):(Hf("Failed to decode base64 JWT payload"),null)}catch(i){return Hf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function W1(r){const e=Iv(r);return ze(e,"internal-error"),ze(typeof e.exp<"u","internal-error"),ze(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sd(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof qi&&D5(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function D5({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O5{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=od(this.lastLoginAt),this.creationTime=od(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mp(r){var b;const e=r.auth,t=await r.getIdToken(),n=await Sd(r,pp(e,{idToken:t}));ze(n==null?void 0:n.users.length,e,"internal-error");const i=n.users[0];r._notifyReloadListener(i);const o=(b=i.providerUserInfo)!=null&&b.length?SN(i.providerUserInfo):[],c=P5(r.providerData,o),d=r.isAnonymous,f=!(r.email&&i.passwordHash)&&!(c!=null&&c.length),m=d?f:!1,v={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new Ry(i.createdAt,i.lastLoginAt),isAnonymous:m};Object.assign(r,v)}async function j5(r){const e=Wn(r);await mp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function P5(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function SN(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M5(r,e){const t=await EN(r,{},async()=>{const n=$d({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=r.config,c=await TN(r,i,"/v1/token",`key=${o}`),d=await r._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:n};return r.emulatorConfig&&Uc(r.emulatorConfig.host)&&(f.credentials="include"),wN.fetch()(c,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function V5(r,e){return eo(r,"POST","/v2/accounts:revokeToken",Za(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ze(e.idToken,"internal-error"),ze(typeof e.idToken<"u","internal-error"),ze(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):W1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ze(e.length!==0,"internal-error");const t=W1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ze(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:o}=await M5(e,t);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:o}=t,c=new dc;return n&&(ze(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),i&&(ze(typeof i=="string","internal-error",{appName:e}),c.accessToken=i),o&&(ze(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dc,this.toJSON())}_performRefresh(){return ji("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(r,e){ze(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class Fs{constructor({uid:e,auth:t,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new O5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ry(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Sd(this,this.stsTokenManager.getToken(this.auth,e));return ze(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return k5(this,e)}reload(){return j5(this)}_assign(e){this!==e&&(ze(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Fs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ze(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await mp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Is(this.auth.app))return Promise.reject(Vi(this.auth));const e=await this.getIdToken();return await Sd(this,R5(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,c=t.photoURL??void 0,d=t.tenantId??void 0,f=t._redirectEventId??void 0,m=t.createdAt??void 0,v=t.lastLoginAt??void 0,{uid:b,emailVerified:_,isAnonymous:S,providerData:k,stsTokenManager:L}=t;ze(b&&L,e,"internal-error");const B=dc.fromJSON(this.name,L);ze(typeof b=="string",e,"internal-error"),Ia(n,e.name),Ia(i,e.name),ze(typeof _=="boolean",e,"internal-error"),ze(typeof S=="boolean",e,"internal-error"),Ia(o,e.name),Ia(c,e.name),Ia(d,e.name),Ia(f,e.name),Ia(m,e.name),Ia(v,e.name);const X=new Fs({uid:b,auth:e,email:i,emailVerified:_,displayName:n,isAnonymous:S,photoURL:c,phoneNumber:o,tenantId:d,stsTokenManager:B,createdAt:m,lastLoginAt:v});return k&&Array.isArray(k)&&(X.providerData=k.map(re=>({...re}))),f&&(X._redirectEventId=f),X}static async _fromIdTokenResponse(e,t,n=!1){const i=new dc;i.updateFromServerResponse(t);const o=new Fs({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await mp(o),o}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];ze(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?SN(i.providerUserInfo):[],c=!(i.email&&i.passwordHash)&&!(o!=null&&o.length),d=new dc;d.updateFromIdToken(n);const f=new Fs({uid:i.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ry(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(o!=null&&o.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1=new Map;function Pi(r){Ui(r instanceof Function,"Expected a class definition");let e=Z1.get(r);return e?(Ui(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,Z1.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}NN.type="NONE";const eE=NN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $f(r,e,t){return`firebase:${r}:${e}:${t}`}class hc{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=$f(this.userKey,i.apiKey,o),this.fullPersistenceKey=$f("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await pp(this.auth,{idToken:e}).catch(()=>{});return t?Fs._fromGetAccountInfoResponse(this.auth,t,e):null}return Fs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new hc(Pi(eE),e,n);const i=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=i[0]||Pi(eE);const c=$f(n,e.config.apiKey,e.name);let d=null;for(const m of t)try{const v=await m._get(c);if(v){let b;if(typeof v=="string"){const _=await pp(e,{idToken:v}).catch(()=>{});if(!_)break;b=await Fs._fromGetAccountInfoResponse(e,_,v)}else b=Fs._fromJSON(e,v);m!==o&&(d=b),o=m;break}}catch{}const f=i.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new hc(o,e,n):(o=f[0],d&&await o._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==o)try{await m._remove(c)}catch{}})),new hc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(IN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(DN(e))return"Blackberry";if(ON(e))return"Webos";if(AN(e))return"Safari";if((e.includes("chrome/")||CN(e))&&!e.includes("edge/"))return"Chrome";if(kN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function IN(r=$n()){return/firefox\//i.test(r)}function AN(r=$n()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function CN(r=$n()){return/crios\//i.test(r)}function RN(r=$n()){return/iemobile/i.test(r)}function kN(r=$n()){return/android/i.test(r)}function DN(r=$n()){return/blackberry/i.test(r)}function ON(r=$n()){return/webos/i.test(r)}function Av(r=$n()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function L5(r=$n()){var e;return Av(r)&&!!((e=window.navigator)!=null&&e.standalone)}function U5(){return Wk()&&document.documentMode===10}function jN(r=$n()){return Av(r)||kN(r)||ON(r)||DN(r)||/windows phone/i.test(r)||RN(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(r,e=[]){let t;switch(r){case"Browser":t=tE($n());break;case"Worker":t=`${tE($n())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${zc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((c,d)=>{try{const f=e(o);c(f)}catch(f){d(f)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B5(r,e={}){return eo(r,"GET","/v2/passwordPolicy",Za(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5=6;class G5{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??F5,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q5{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nE(this),this.idTokenSubscription=new nE(this),this.beforeStateQueue=new z5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Pi(t)),this._initializationPromise=this.queue(async()=>{var n,i,o;if(!this._deleted&&(this.persistenceManager=await hc.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((i=this._popupRedirectResolver)!=null&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await pp(this,{idToken:e}),n=await Fs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(Is(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(o=this.redirectUser)==null?void 0:o._redirectEventId,d=n==null?void 0:n._redirectEventId,f=await this.tryRedirectSignIn(e);(!c||c===d)&&(f!=null&&f.user)&&(n=f.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(c){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ze(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await mp(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=w5()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Is(this.app))return Promise.reject(Vi(this));const t=e?Wn(e):null;return t&&ze(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ze(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Is(this.app)?Promise.reject(Vi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Is(this.app)?Promise.reject(Vi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Pi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await B5(this),t=new G5(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Hd("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await V5(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Pi(e)||this._popupRedirectResolver;ze(t,this,"argument-error"),this.redirectPersistenceManager=await hc.create(this,[Pi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ze(d,this,"internal-error"),d.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,n,i);return()=>{c=!0,f()}}else{const f=e.addObserver(t);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ze(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=PN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var i;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((i=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:i.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(Is(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&b5(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ll(r){return Wn(r)}class nE{constructor(e){this.auth=e,this.observer=null,this.addObserver=sD(t=>this.observer=t)}get next(){return ze(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function H5(r){Jp=r}function MN(r){return Jp.loadJS(r)}function $5(){return Jp.recaptchaEnterpriseScript}function K5(){return Jp.gapiScript}function Q5(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class Y5{constructor(){this.enterprise=new X5}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class X5{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const J5="recaptcha-enterprise",VN="NO_RECAPTCHA";class W5{constructor(e){this.type=J5,this.auth=ll(e)}async verify(e="verify",t=!1){async function n(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,d)=>{C5(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new A5(f);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,c(m.siteKey)}}).catch(f=>{d(f)})})}function i(o,c,d){const f=window.grecaptcha;J1(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(m=>{c(m)}).catch(()=>{c(VN)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Y5().execute("siteKey",{action:"verify"}):new Promise((o,c)=>{n(this.auth).then(d=>{if(!t&&J1(window.grecaptcha))i(d,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let f=$5();f.length!==0&&(f+=d),MN(f).then(()=>{i(d,o,c)}).catch(m=>{c(m)})}}).catch(d=>{c(d)})})}}async function rE(r,e,t,n=!1,i=!1){const o=new W5(r);let c;if(i)c=VN;else try{c=await o.verify(t)}catch{c=await o.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return n?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function ky(r,e,t,n,i){var o;if((o=r._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await rE(r,e,t,t==="getOobCode");return n(r,c)}else return n(r,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await rE(r,e,t,t==="getOobCode");return n(r,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z5(r,e){const t=Tv(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),o=t.getOptions();if(Qo(o,e??{}))return i;qs(i,"already-initialized")}return t.initialize({options:e})}function e4(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Pi);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function t4(r,e,t){const n=ll(r);ze(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=LN(e),{host:c,port:d}=n4(e),f=d===null?"":`:${d}`,m={url:`${o}//${c}${f}/`},v=Object.freeze({host:c,port:d,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){ze(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ze(Qo(m,n.config.emulator)&&Qo(v,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=m,n.emulatorConfig=v,n.settings.appVerificationDisabledForTesting=!0,Uc(c)?(cN(`${o}//${c}${f}`),Kk("Auth",!0)):r4()}function LN(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function n4(r){const e=LN(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:sE(n.substr(o.length+1))}}else{const[o,c]=n.split(":");return{host:o,port:sE(c)}}}function sE(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function r4(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ji("not implemented")}_getIdTokenResponse(e){return ji("not implemented")}_linkToIdToken(e,t){return ji("not implemented")}_getReauthenticationResolver(e){return ji("not implemented")}}async function s4(r,e){return eo(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i4(r,e){return Qd(r,"POST","/v1/accounts:signInWithPassword",Za(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a4(r,e){return Qd(r,"POST","/v1/accounts:signInWithEmailLink",Za(r,e))}async function o4(r,e){return Qd(r,"POST","/v1/accounts:signInWithEmailLink",Za(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd extends Cv{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Nd(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Nd(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ky(e,t,"signInWithPassword",i4);case"emailLink":return a4(e,{email:this._email,oobCode:this._password});default:qs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ky(e,n,"signUpPassword",s4);case"emailLink":return o4(e,{idToken:t,email:this._email,oobCode:this._password});default:qs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fc(r,e){return Qd(r,"POST","/v1/accounts:signInWithIdp",Za(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4="http://localhost";class Xo extends Cv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Xo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=t;if(!n||!i)return null;const c=new Xo(n,i);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return fc(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,fc(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,fc(e,t)}buildRequest(){const e={requestUri:l4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=$d(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function u4(r){const e=Wu(Zu(r)).link,t=e?Wu(Zu(e)).deep_link_id:null,n=Wu(Zu(r)).deep_link_id;return(n?Wu(Zu(n)).link:null)||n||t||e||r}class Rv{constructor(e){const t=Wu(Zu(e)),n=t.apiKey??null,i=t.oobCode??null,o=c4(t.mode??null);ze(n&&i&&o,"argument-error"),this.apiKey=n,this.operation=o,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=u4(e);try{return new Rv(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(){this.providerId=Bc.PROVIDER_ID}static credential(e,t){return Nd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Rv.parseLink(t);return ze(n,"argument-error"),Nd._fromEmailAndCode(e,n.code,n.tenantId)}}Bc.PROVIDER_ID="password";Bc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Bc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd extends UN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja extends Yd{constructor(){super("facebook.com")}static credential(e){return Xo._fromParams({providerId:ja.PROVIDER_ID,signInMethod:ja.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ja.credentialFromTaggedObject(e)}static credentialFromError(e){return ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ja.credential(e.oauthAccessToken)}catch{return null}}}ja.FACEBOOK_SIGN_IN_METHOD="facebook.com";ja.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa extends Yd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Xo._fromParams({providerId:Pa.PROVIDER_ID,signInMethod:Pa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Pa.credentialFromTaggedObject(e)}static credentialFromError(e){return Pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Pa.credential(t,n)}catch{return null}}}Pa.GOOGLE_SIGN_IN_METHOD="google.com";Pa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma extends Yd{constructor(){super("github.com")}static credential(e){return Xo._fromParams({providerId:Ma.PROVIDER_ID,signInMethod:Ma.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ma.credentialFromTaggedObject(e)}static credentialFromError(e){return Ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ma.credential(e.oauthAccessToken)}catch{return null}}}Ma.GITHUB_SIGN_IN_METHOD="github.com";Ma.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va extends Yd{constructor(){super("twitter.com")}static credential(e,t){return Xo._fromParams({providerId:Va.PROVIDER_ID,signInMethod:Va.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Va.credentialFromTaggedObject(e)}static credentialFromError(e){return Va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Va.credential(t,n)}catch{return null}}}Va.TWITTER_SIGN_IN_METHOD="twitter.com";Va.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d4(r,e){return Qd(r,"POST","/v1/accounts:signUp",Za(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const o=await Fs._fromIdTokenResponse(e,n,i),c=iE(n);return new Jo({user:o,providerId:c,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=iE(n);return new Jo({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function iE(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp extends qi{constructor(e,t,n,i){super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,gp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new gp(e,t,n,i)}}function zN(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?gp._fromErrorAndOperation(r,o,e,n):o})}async function h4(r,e,t=!1){const n=await Sd(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Jo._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f4(r,e,t=!1){const{auth:n}=r;if(Is(n.app))return Promise.reject(Vi(n));const i="reauthenticate";try{const o=await Sd(r,zN(n,i,e,r),t);ze(o.idToken,n,"internal-error");const c=Iv(o.idToken);ze(c,n,"internal-error");const{sub:d}=c;return ze(r.uid===d,n,"user-mismatch"),Jo._forOperation(r,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&qs(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BN(r,e,t=!1){if(Is(r.app))return Promise.reject(Vi(r));const n="signIn",i=await zN(r,n,e),o=await Jo._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(o.user),o}async function p4(r,e){return BN(ll(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FN(r){const e=ll(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function m4(r,e,t){if(Is(r.app))return Promise.reject(Vi(r));const n=ll(r),c=await ky(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",d4).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&FN(r),f}),d=await Jo._fromIdTokenResponse(n,"signIn",c);return await n._updateCurrentUser(d.user),d}function g4(r,e,t){return Is(r.app)?Promise.reject(Vi(r)):p4(Wn(r),Bc.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&FN(r),n})}function y4(r,e,t,n){return Wn(r).onIdTokenChanged(e,t,n)}function v4(r,e,t){return Wn(r).beforeAuthStateChanged(e,t)}function b4(r){return Wn(r).signOut()}const yp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yp,"1"),this.storage.removeItem(yp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=1e3,_4=10;class qN extends GN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,f)=>{this.notifyListeners(c,f)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const c=this.storage.getItem(n);!t&&this.localCache[n]===c||this.notifyListeners(n,c)},o=this.storage.getItem(n);U5()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_4):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},x4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qN.type="LOCAL";const w4=qN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN extends GN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}HN.type="SESSION";const $N=HN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E4(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new Wp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:o}=t.data,c=this.handlersMap[i];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const d=Array.from(c).map(async m=>m(t.origin,o)),f=await E4(d);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((d,f)=>{const m=kv("",20);i.port1.start();const v=setTimeout(()=>{f(new Error("unsupported_event"))},n);c={messageChannel:i,onMessage(b){const _=b;if(_.data.eventId===m)switch(_.data.status){case"ack":clearTimeout(v),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),d(_.data.response);break;default:clearTimeout(v),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(c),i.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[i.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(){return window}function S4(r){ci().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(){return typeof ci().WorkerGlobalScope<"u"&&typeof ci().importScripts=="function"}async function N4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function I4(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)==null?void 0:r.controller)||null}function A4(){return KN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN="firebaseLocalStorageDb",C4=1,vp="firebaseLocalStorage",YN="fbase_key";class Xd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Zp(r,e){return r.transaction([vp],e?"readwrite":"readonly").objectStore(vp)}function R4(){const r=indexedDB.deleteDatabase(QN);return new Xd(r).toPromise()}function Dy(){const r=indexedDB.open(QN,C4);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(vp,{keyPath:YN})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(vp)?e(n):(n.close(),await R4(),e(await Dy()))})})}async function aE(r,e,t){const n=Zp(r,!0).put({[YN]:e,value:t});return new Xd(n).toPromise()}async function k4(r,e){const t=Zp(r,!1).get(e),n=await new Xd(t).toPromise();return n===void 0?null:n.value}function oE(r,e){const t=Zp(r,!0).delete(e);return new Xd(t).toPromise()}const D4=800,O4=3;class XN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>O4)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wp._getInstance(A4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await N4(),!this.activeServiceWorker)return;this.sender=new T4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||I4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dy();return await aE(e,yp,"1"),await oE(e,yp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>aE(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>k4(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>oE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Zp(i,!1).getAll();return new Xd(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),D4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XN.type="LOCAL";const j4=XN;new Kd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P4(r,e){return e?Pi(e):(ze(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv extends Cv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return fc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return fc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function M4(r){return BN(r.auth,new Dv(r),r.bypassAuthState)}function V4(r){const{auth:e,user:t}=r;return ze(t,e,"internal-error"),f4(t,new Dv(r),r.bypassAuthState)}async function L4(r){const{auth:e,user:t}=r;return ze(t,e,"internal-error"),h4(t,new Dv(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e,t,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:o,error:c,type:d}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:t,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return M4;case"linkViaPopup":case"linkViaRedirect":return L4;case"reauthViaPopup":case"reauthViaRedirect":return V4;default:qs(this.auth,"internal-error")}}resolve(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U4=new Kd(2e3,1e4);class lc extends JN{constructor(e,t,n,i,o){super(e,t,i,o),this.provider=n,this.authWindow=null,this.pollId=null,lc.currentPopupAction&&lc.currentPopupAction.cancel(),lc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ze(e,this.auth,"internal-error"),e}async onExecution(){Ui(this.filter.length===1,"Popup operations only handle one event");const e=kv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(li(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(li(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,lc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(li(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,U4.get())};e()}}lc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4="pendingRedirect",Kf=new Map;class B4 extends JN{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Kf.get(this.auth._key());if(!e){try{const n=await F4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Kf.set(this.auth._key(),e)}return this.bypassAuthState||Kf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function F4(r,e){const t=H4(e),n=q4(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function G4(r,e){Kf.set(r._key(),e)}function q4(r){return Pi(r._redirectPersistence)}function H4(r){return $f(z4,r.config.apiKey,r.name)}async function $4(r,e,t=!1){if(Is(r.app))return Promise.reject(Vi(r));const n=ll(r),i=P4(n,e),c=await new B4(n,i,t).execute();return c&&!t&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K4=600*1e3;class Q4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Y4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!WN(e)){const i=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(li(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=K4&&this.cachedEventUids.clear(),this.cachedEventUids.has(lE(e))}saveEventToCache(e){this.cachedEventUids.add(lE(e)),this.lastProcessedEventTime=Date.now()}}function lE(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function WN({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Y4(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WN(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X4(r,e={}){return eo(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,W4=/^https?/;async function Z4(r){if(r.config.emulator)return;const{authorizedDomains:e}=await X4(r);for(const t of e)try{if(eO(t))return}catch{}qs(r,"unauthorized-domain")}function eO(r){const e=Cy(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const c=new URL(r);return c.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===n}if(!W4.test(t))return!1;if(J4.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO=new Kd(3e4,6e4);function cE(){const r=ci().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function nO(r){return new Promise((e,t)=>{var i,o,c;function n(){cE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cE(),t(li(r,"network-request-failed"))},timeout:tO.get()})}if((o=(i=ci().gapi)==null?void 0:i.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((c=ci().gapi)!=null&&c.load)n();else{const d=Q5("iframefcb");return ci()[d]=()=>{gapi.load?n():t(li(r,"network-request-failed"))},MN(`${K5()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw Qf=null,e})}let Qf=null;function rO(r){return Qf=Qf||nO(r),Qf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO=new Kd(5e3,15e3),iO="__/auth/iframe",aO="emulator/auth/iframe",oO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},lO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cO(r){const e=r.config;ze(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?Nv(e,aO):`https://${r.config.authDomain}/${iO}`,n={apiKey:e.apiKey,appName:r.name,v:zc},i=lO.get(r.config.apiHost);i&&(n.eid=i);const o=r._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${$d(n).slice(1)}`}async function uO(r){const e=await rO(r),t=ci().gapi;return ze(t,r,"internal-error"),e.open({where:document.body,url:cO(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oO,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const c=li(r,"network-request-failed"),d=ci().setTimeout(()=>{o(c)},sO.get());function f(){ci().clearTimeout(d),i(n)}n.ping(f).then(f,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hO=500,fO=600,pO="_blank",mO="http://localhost";class uE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gO(r,e,t,n=hO,i=fO){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let d="";const f={...dO,width:n.toString(),height:i.toString(),top:o,left:c},m=$n().toLowerCase();t&&(d=CN(m)?pO:t),IN(m)&&(e=e||mO,f.scrollbars="yes");const v=Object.entries(f).reduce((_,[S,k])=>`${_}${S}=${k},`,"");if(L5(m)&&d!=="_self")return yO(e||"",d),new uE(null);const b=window.open(e||"",d,v);ze(b,r,"popup-blocked");try{b.focus()}catch{}return new uE(b)}function yO(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO="__/auth/handler",bO="emulator/auth/handler",xO=encodeURIComponent("fac");async function dE(r,e,t,n,i,o){ze(r.config.authDomain,r,"auth-domain-config-required"),ze(r.config.apiKey,r,"invalid-api-key");const c={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:zc,eventId:i};if(e instanceof UN){e.setDefaultLanguage(r.languageCode),c.providerId=e.providerId||"",rD(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,b]of Object.entries({}))c[v]=b}if(e instanceof Yd){const v=e.getScopes().filter(b=>b!=="");v.length>0&&(c.scopes=v.join(","))}r.tenantId&&(c.tid=r.tenantId);const d=c;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const f=await r._getAppCheckToken(),m=f?`#${xO}=${encodeURIComponent(f)}`:"";return`${_O(r)}?${$d(d).slice(1)}${m}`}function _O({config:r}){return r.emulator?Nv(r,bO):`https://${r.authDomain}/${vO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="webStorageSupport";class wO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$N,this._completeRedirectFn=$4,this._overrideRedirectResult=G4}async _openPopup(e,t,n,i){var c;Ui((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const o=await dE(e,t,n,Cy(),i);return gO(e,o,kv())}async _openRedirect(e,t,n,i){await this._originValidation(e);const o=await dE(e,t,n,Cy(),i);return S4(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Ui(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await uO(e),n=new Q4(e);return t.register("authEvent",i=>(ze(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ty,{type:ty},i=>{var c;const o=(c=i==null?void 0:i[0])==null?void 0:c[ty];o!==void 0&&t(!!o),qs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Z4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jN()||AN()||Av()}}const EO=wO;var hE="@firebase/auth",fE="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ze(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SO(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function NO(r){vc(new Yo("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=n.options;ze(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:c,authDomain:d,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:PN(r)},m=new q5(n,i,o,f);return e4(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),vc(new Yo("auth-internal",e=>{const t=ll(e.getProvider("auth").getImmediate());return(n=>new TO(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ha(hE,fE,SO(r)),Ha(hE,fE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO=300,AO=lN("authIdTokenMaxAge")||IO;let pE=null;const CO=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>AO)return;const i=t==null?void 0:t.token;pE!==i&&(pE=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function RO(r=i5()){const e=Tv(r,"auth");if(e.isInitialized())return e.getImmediate();const t=Z5(r,{popupRedirectResolver:EO,persistence:[j4,w4,$N]}),n=lN("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const c=CO(o.toString());v4(t,c,()=>c(t.currentUser)),y4(t,d=>c(d))}}const i=Gk("auth");return i&&t4(t,`http://${i}`),t}function kO(){var r;return((r=document.getElementsByTagName("head"))==null?void 0:r[0])??document}H5({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const o=li("internal-error");o.customData=i,t(o)},n.type="text/javascript",n.charset="UTF-8",kO().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});NO("Browser");var mE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $a,ZN;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,I){function R(){}R.prototype=I.prototype,C.F=I.prototype,C.prototype=new R,C.prototype.constructor=C,C.D=function(U,D,M){for(var O=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)O[qe-2]=arguments[qe];return I.prototype[D].apply(U,O)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,I,R){R||(R=0);const U=Array(16);if(typeof I=="string")for(var D=0;D<16;++D)U[D]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(D=0;D<16;++D)U[D]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=C.g[0],R=C.g[1],D=C.g[2];let M=C.g[3],O;O=I+(M^R&(D^M))+U[0]+3614090360&4294967295,I=R+(O<<7&4294967295|O>>>25),O=M+(D^I&(R^D))+U[1]+3905402710&4294967295,M=I+(O<<12&4294967295|O>>>20),O=D+(R^M&(I^R))+U[2]+606105819&4294967295,D=M+(O<<17&4294967295|O>>>15),O=R+(I^D&(M^I))+U[3]+3250441966&4294967295,R=D+(O<<22&4294967295|O>>>10),O=I+(M^R&(D^M))+U[4]+4118548399&4294967295,I=R+(O<<7&4294967295|O>>>25),O=M+(D^I&(R^D))+U[5]+1200080426&4294967295,M=I+(O<<12&4294967295|O>>>20),O=D+(R^M&(I^R))+U[6]+2821735955&4294967295,D=M+(O<<17&4294967295|O>>>15),O=R+(I^D&(M^I))+U[7]+4249261313&4294967295,R=D+(O<<22&4294967295|O>>>10),O=I+(M^R&(D^M))+U[8]+1770035416&4294967295,I=R+(O<<7&4294967295|O>>>25),O=M+(D^I&(R^D))+U[9]+2336552879&4294967295,M=I+(O<<12&4294967295|O>>>20),O=D+(R^M&(I^R))+U[10]+4294925233&4294967295,D=M+(O<<17&4294967295|O>>>15),O=R+(I^D&(M^I))+U[11]+2304563134&4294967295,R=D+(O<<22&4294967295|O>>>10),O=I+(M^R&(D^M))+U[12]+1804603682&4294967295,I=R+(O<<7&4294967295|O>>>25),O=M+(D^I&(R^D))+U[13]+4254626195&4294967295,M=I+(O<<12&4294967295|O>>>20),O=D+(R^M&(I^R))+U[14]+2792965006&4294967295,D=M+(O<<17&4294967295|O>>>15),O=R+(I^D&(M^I))+U[15]+1236535329&4294967295,R=D+(O<<22&4294967295|O>>>10),O=I+(D^M&(R^D))+U[1]+4129170786&4294967295,I=R+(O<<5&4294967295|O>>>27),O=M+(R^D&(I^R))+U[6]+3225465664&4294967295,M=I+(O<<9&4294967295|O>>>23),O=D+(I^R&(M^I))+U[11]+643717713&4294967295,D=M+(O<<14&4294967295|O>>>18),O=R+(M^I&(D^M))+U[0]+3921069994&4294967295,R=D+(O<<20&4294967295|O>>>12),O=I+(D^M&(R^D))+U[5]+3593408605&4294967295,I=R+(O<<5&4294967295|O>>>27),O=M+(R^D&(I^R))+U[10]+38016083&4294967295,M=I+(O<<9&4294967295|O>>>23),O=D+(I^R&(M^I))+U[15]+3634488961&4294967295,D=M+(O<<14&4294967295|O>>>18),O=R+(M^I&(D^M))+U[4]+3889429448&4294967295,R=D+(O<<20&4294967295|O>>>12),O=I+(D^M&(R^D))+U[9]+568446438&4294967295,I=R+(O<<5&4294967295|O>>>27),O=M+(R^D&(I^R))+U[14]+3275163606&4294967295,M=I+(O<<9&4294967295|O>>>23),O=D+(I^R&(M^I))+U[3]+4107603335&4294967295,D=M+(O<<14&4294967295|O>>>18),O=R+(M^I&(D^M))+U[8]+1163531501&4294967295,R=D+(O<<20&4294967295|O>>>12),O=I+(D^M&(R^D))+U[13]+2850285829&4294967295,I=R+(O<<5&4294967295|O>>>27),O=M+(R^D&(I^R))+U[2]+4243563512&4294967295,M=I+(O<<9&4294967295|O>>>23),O=D+(I^R&(M^I))+U[7]+1735328473&4294967295,D=M+(O<<14&4294967295|O>>>18),O=R+(M^I&(D^M))+U[12]+2368359562&4294967295,R=D+(O<<20&4294967295|O>>>12),O=I+(R^D^M)+U[5]+4294588738&4294967295,I=R+(O<<4&4294967295|O>>>28),O=M+(I^R^D)+U[8]+2272392833&4294967295,M=I+(O<<11&4294967295|O>>>21),O=D+(M^I^R)+U[11]+1839030562&4294967295,D=M+(O<<16&4294967295|O>>>16),O=R+(D^M^I)+U[14]+4259657740&4294967295,R=D+(O<<23&4294967295|O>>>9),O=I+(R^D^M)+U[1]+2763975236&4294967295,I=R+(O<<4&4294967295|O>>>28),O=M+(I^R^D)+U[4]+1272893353&4294967295,M=I+(O<<11&4294967295|O>>>21),O=D+(M^I^R)+U[7]+4139469664&4294967295,D=M+(O<<16&4294967295|O>>>16),O=R+(D^M^I)+U[10]+3200236656&4294967295,R=D+(O<<23&4294967295|O>>>9),O=I+(R^D^M)+U[13]+681279174&4294967295,I=R+(O<<4&4294967295|O>>>28),O=M+(I^R^D)+U[0]+3936430074&4294967295,M=I+(O<<11&4294967295|O>>>21),O=D+(M^I^R)+U[3]+3572445317&4294967295,D=M+(O<<16&4294967295|O>>>16),O=R+(D^M^I)+U[6]+76029189&4294967295,R=D+(O<<23&4294967295|O>>>9),O=I+(R^D^M)+U[9]+3654602809&4294967295,I=R+(O<<4&4294967295|O>>>28),O=M+(I^R^D)+U[12]+3873151461&4294967295,M=I+(O<<11&4294967295|O>>>21),O=D+(M^I^R)+U[15]+530742520&4294967295,D=M+(O<<16&4294967295|O>>>16),O=R+(D^M^I)+U[2]+3299628645&4294967295,R=D+(O<<23&4294967295|O>>>9),O=I+(D^(R|~M))+U[0]+4096336452&4294967295,I=R+(O<<6&4294967295|O>>>26),O=M+(R^(I|~D))+U[7]+1126891415&4294967295,M=I+(O<<10&4294967295|O>>>22),O=D+(I^(M|~R))+U[14]+2878612391&4294967295,D=M+(O<<15&4294967295|O>>>17),O=R+(M^(D|~I))+U[5]+4237533241&4294967295,R=D+(O<<21&4294967295|O>>>11),O=I+(D^(R|~M))+U[12]+1700485571&4294967295,I=R+(O<<6&4294967295|O>>>26),O=M+(R^(I|~D))+U[3]+2399980690&4294967295,M=I+(O<<10&4294967295|O>>>22),O=D+(I^(M|~R))+U[10]+4293915773&4294967295,D=M+(O<<15&4294967295|O>>>17),O=R+(M^(D|~I))+U[1]+2240044497&4294967295,R=D+(O<<21&4294967295|O>>>11),O=I+(D^(R|~M))+U[8]+1873313359&4294967295,I=R+(O<<6&4294967295|O>>>26),O=M+(R^(I|~D))+U[15]+4264355552&4294967295,M=I+(O<<10&4294967295|O>>>22),O=D+(I^(M|~R))+U[6]+2734768916&4294967295,D=M+(O<<15&4294967295|O>>>17),O=R+(M^(D|~I))+U[13]+1309151649&4294967295,R=D+(O<<21&4294967295|O>>>11),O=I+(D^(R|~M))+U[4]+4149444226&4294967295,I=R+(O<<6&4294967295|O>>>26),O=M+(R^(I|~D))+U[11]+3174756917&4294967295,M=I+(O<<10&4294967295|O>>>22),O=D+(I^(M|~R))+U[2]+718787259&4294967295,D=M+(O<<15&4294967295|O>>>17),O=R+(M^(D|~I))+U[9]+3951481745&4294967295,C.g[0]=C.g[0]+I&4294967295,C.g[1]=C.g[1]+(D+(O<<21&4294967295|O>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+M&4294967295}n.prototype.v=function(C,I){I===void 0&&(I=C.length);const R=I-this.blockSize,U=this.C;let D=this.h,M=0;for(;M<I;){if(D==0)for(;M<=R;)i(this,C,M),M+=this.blockSize;if(typeof C=="string"){for(;M<I;)if(U[D++]=C.charCodeAt(M++),D==this.blockSize){i(this,U),D=0;break}}else for(;M<I;)if(U[D++]=C[M++],D==this.blockSize){i(this,U),D=0;break}}this.h=D,this.o+=I},n.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var I=1;I<C.length-8;++I)C[I]=0;I=this.o*8;for(var R=C.length-8;R<C.length;++R)C[R]=I&255,I/=256;for(this.v(C),C=Array(16),I=0,R=0;R<4;++R)for(let U=0;U<32;U+=8)C[I++]=this.g[R]>>>U&255;return C};function o(C,I){var R=d;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=I(C)}function c(C,I){this.h=I;const R=[];let U=!0;for(let D=C.length-1;D>=0;D--){const M=C[D]|0;U&&M==I||(R[D]=M,U=!1)}this.g=R}var d={};function f(C){return-128<=C&&C<128?o(C,function(I){return new c([I|0],I<0?-1:0)}):new c([C|0],C<0?-1:0)}function m(C){if(isNaN(C)||!isFinite(C))return b;if(C<0)return B(m(-C));const I=[];let R=1;for(let U=0;C>=R;U++)I[U]=C/R|0,R*=4294967296;return new c(I,0)}function v(C,I){if(C.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(C.charAt(0)=="-")return B(v(C.substring(1),I));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=m(Math.pow(I,8));let U=b;for(let M=0;M<C.length;M+=8){var D=Math.min(8,C.length-M);const O=parseInt(C.substring(M,M+D),I);D<8?(D=m(Math.pow(I,D)),U=U.j(D).add(m(O))):(U=U.j(R),U=U.add(m(O)))}return U}var b=f(0),_=f(1),S=f(16777216);r=c.prototype,r.m=function(){if(L(this))return-B(this).m();let C=0,I=1;for(let R=0;R<this.g.length;R++){const U=this.i(R);C+=(U>=0?U:4294967296+U)*I,I*=4294967296}return C},r.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(k(this))return"0";if(L(this))return"-"+B(this).toString(C);const I=m(Math.pow(C,6));var R=this;let U="";for(;;){const D=le(R,I).g;R=X(R,D.j(I));let M=((R.g.length>0?R.g[0]:R.h)>>>0).toString(C);if(R=D,k(R))return M+U;for(;M.length<6;)M="0"+M;U=M+U}},r.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function k(C){if(C.h!=0)return!1;for(let I=0;I<C.g.length;I++)if(C.g[I]!=0)return!1;return!0}function L(C){return C.h==-1}r.l=function(C){return C=X(this,C),L(C)?-1:k(C)?0:1};function B(C){const I=C.g.length,R=[];for(let U=0;U<I;U++)R[U]=~C.g[U];return new c(R,~C.h).add(_)}r.abs=function(){return L(this)?B(this):this},r.add=function(C){const I=Math.max(this.g.length,C.g.length),R=[];let U=0;for(let D=0;D<=I;D++){let M=U+(this.i(D)&65535)+(C.i(D)&65535),O=(M>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);U=O>>>16,M&=65535,O&=65535,R[D]=O<<16|M}return new c(R,R[R.length-1]&-2147483648?-1:0)};function X(C,I){return C.add(B(I))}r.j=function(C){if(k(this)||k(C))return b;if(L(this))return L(C)?B(this).j(B(C)):B(B(this).j(C));if(L(C))return B(this.j(B(C)));if(this.l(S)<0&&C.l(S)<0)return m(this.m()*C.m());const I=this.g.length+C.g.length,R=[];for(var U=0;U<2*I;U++)R[U]=0;for(U=0;U<this.g.length;U++)for(let D=0;D<C.g.length;D++){const M=this.i(U)>>>16,O=this.i(U)&65535,qe=C.i(D)>>>16,gt=C.i(D)&65535;R[2*U+2*D]+=O*gt,re(R,2*U+2*D),R[2*U+2*D+1]+=M*gt,re(R,2*U+2*D+1),R[2*U+2*D+1]+=O*qe,re(R,2*U+2*D+1),R[2*U+2*D+2]+=M*qe,re(R,2*U+2*D+2)}for(C=0;C<I;C++)R[C]=R[2*C+1]<<16|R[2*C];for(C=I;C<2*I;C++)R[C]=0;return new c(R,0)};function re(C,I){for(;(C[I]&65535)!=C[I];)C[I+1]+=C[I]>>>16,C[I]&=65535,I++}function ee(C,I){this.g=C,this.h=I}function le(C,I){if(k(I))throw Error("division by zero");if(k(C))return new ee(b,b);if(L(C))return I=le(B(C),I),new ee(B(I.g),B(I.h));if(L(I))return I=le(C,B(I)),new ee(B(I.g),I.h);if(C.g.length>30){if(L(C)||L(I))throw Error("slowDivide_ only works with positive integers.");for(var R=_,U=I;U.l(C)<=0;)R=fe(R),U=fe(U);var D=ce(R,1),M=ce(U,1);for(U=ce(U,2),R=ce(R,2);!k(U);){var O=M.add(U);O.l(C)<=0&&(D=D.add(R),M=O),U=ce(U,1),R=ce(R,1)}return I=X(C,D.j(I)),new ee(D,I)}for(D=b;C.l(I)>=0;){for(R=Math.max(1,Math.floor(C.m()/I.m())),U=Math.ceil(Math.log(R)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),M=m(R),O=M.j(I);L(O)||O.l(C)>0;)R-=U,M=m(R),O=M.j(I);k(M)&&(M=_),D=D.add(M),C=X(C,O)}return new ee(D,C)}r.B=function(C){return le(this,C).h},r.and=function(C){const I=Math.max(this.g.length,C.g.length),R=[];for(let U=0;U<I;U++)R[U]=this.i(U)&C.i(U);return new c(R,this.h&C.h)},r.or=function(C){const I=Math.max(this.g.length,C.g.length),R=[];for(let U=0;U<I;U++)R[U]=this.i(U)|C.i(U);return new c(R,this.h|C.h)},r.xor=function(C){const I=Math.max(this.g.length,C.g.length),R=[];for(let U=0;U<I;U++)R[U]=this.i(U)^C.i(U);return new c(R,this.h^C.h)};function fe(C){const I=C.g.length+1,R=[];for(let U=0;U<I;U++)R[U]=C.i(U)<<1|C.i(U-1)>>>31;return new c(R,C.h)}function ce(C,I){const R=I>>5;I%=32;const U=C.g.length-R,D=[];for(let M=0;M<U;M++)D[M]=I>0?C.i(M+R)>>>I|C.i(M+R+1)<<32-I:C.i(M+R);return new c(D,C.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,ZN=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=v,$a=c}).apply(typeof mE<"u"?mE:typeof self<"u"?self:typeof window<"u"?window:{});var Cf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var e2,ed,t2,Yf,Oy,n2,r2,s2;(function(){var r,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cf=="object"&&Cf];for(var x=0;x<p.length;++x){var E=p[x];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var n=t(this);function i(p,x){if(x)e:{var E=n;p=p.split(".");for(var A=0;A<p.length-1;A++){var H=p[A];if(!(H in E))break e;E=E[H]}p=p[p.length-1],A=E[p],x=x(A),x!=A&&x!=null&&e(E,p,{configurable:!0,writable:!0,value:x})}}i("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(p){return p||function(x){var E=[],A;for(A in x)Object.prototype.hasOwnProperty.call(x,A)&&E.push([A,x[A]]);return E}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function d(p){var x=typeof p;return x=="object"&&p!=null||x=="function"}function f(p,x,E){return p.call.apply(p.bind,arguments)}function m(p,x,E){return m=f,m.apply(null,arguments)}function v(p,x){var E=Array.prototype.slice.call(arguments,1);return function(){var A=E.slice();return A.push.apply(A,arguments),p.apply(this,A)}}function b(p,x){function E(){}E.prototype=x.prototype,p.Z=x.prototype,p.prototype=new E,p.prototype.constructor=p,p.Ob=function(A,H,J){for(var ge=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)ge[Ye-2]=arguments[Ye];return x.prototype[H].apply(A,ge)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function S(p){const x=p.length;if(x>0){const E=Array(x);for(let A=0;A<x;A++)E[A]=p[A];return E}return[]}function k(p,x){for(let A=1;A<arguments.length;A++){const H=arguments[A];var E=typeof H;if(E=E!="object"?E:H?Array.isArray(H)?"array":E:"null",E=="array"||E=="object"&&typeof H.length=="number"){E=p.length||0;const J=H.length||0;p.length=E+J;for(let ge=0;ge<J;ge++)p[E+ge]=H[ge]}else p.push(H)}}class L{constructor(x,E){this.i=x,this.j=E,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function B(p){c.setTimeout(()=>{throw p},0)}function X(){var p=C;let x=null;return p.g&&(x=p.g,p.g=p.g.next,p.g||(p.h=null),x.next=null),x}class re{constructor(){this.h=this.g=null}add(x,E){const A=ee.get();A.set(x,E),this.h?this.h.next=A:this.g=A,this.h=A}}var ee=new L(()=>new le,p=>p.reset());class le{constructor(){this.next=this.g=this.h=null}set(x,E){this.h=x,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,ce=!1,C=new re,I=()=>{const p=Promise.resolve(void 0);fe=()=>{p.then(R)}};function R(){for(var p;p=X();){try{p.h.call(p.g)}catch(E){B(E)}var x=ee;x.j(p),x.h<100&&(x.h++,p.next=x.g,x.g=p)}ce=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(p,x){this.type=p,this.g=this.target=x,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var p=!1,x=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const E=()=>{};c.addEventListener("test",E,x),c.removeEventListener("test",E,x)}catch{}return p})();function O(p){return/^[\s\xa0]*$/.test(p)}function qe(p,x){D.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,x)}b(qe,D),qe.prototype.init=function(p,x){const E=this.type=p.type,A=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=x,x=p.relatedTarget,x||(E=="mouseover"?x=p.fromElement:E=="mouseout"&&(x=p.toElement)),this.relatedTarget=x,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&qe.Z.h.call(this)},qe.prototype.h=function(){qe.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var gt="closure_listenable_"+(Math.random()*1e6|0),Z=0;function he(p,x,E,A,H){this.listener=p,this.proxy=null,this.src=x,this.type=E,this.capture=!!A,this.ha=H,this.key=++Z,this.da=this.fa=!1}function Te(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Me(p,x,E){for(const A in p)x.call(E,p[A],A,p)}function Ve(p,x){for(const E in p)x.call(void 0,p[E],E,p)}function V(p){const x={};for(const E in p)x[E]=p[E];return x}const te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pe(p,x){let E,A;for(let H=1;H<arguments.length;H++){A=arguments[H];for(E in A)p[E]=A[E];for(let J=0;J<te.length;J++)E=te[J],Object.prototype.hasOwnProperty.call(A,E)&&(p[E]=A[E])}}function ye(p){this.src=p,this.g={},this.h=0}ye.prototype.add=function(p,x,E,A,H){const J=p.toString();p=this.g[J],p||(p=this.g[J]=[],this.h++);const ge=Re(p,x,A,H);return ge>-1?(x=p[ge],E||(x.fa=!1)):(x=new he(x,this.src,J,!!A,H),x.fa=E,p.push(x)),x};function Ne(p,x){const E=x.type;if(E in p.g){var A=p.g[E],H=Array.prototype.indexOf.call(A,x,void 0),J;(J=H>=0)&&Array.prototype.splice.call(A,H,1),J&&(Te(x),p.g[E].length==0&&(delete p.g[E],p.h--))}}function Re(p,x,E,A){for(let H=0;H<p.length;++H){const J=p[H];if(!J.da&&J.listener==x&&J.capture==!!E&&J.ha==A)return H}return-1}var Be="closure_lm_"+(Math.random()*1e6|0),Je={};function rt(p,x,E,A,H){if(Array.isArray(x)){for(let J=0;J<x.length;J++)rt(p,x[J],E,A,H);return null}return E=Rs(E),p&&p[gt]?p.J(x,E,d(A)?!!A.capture:!1,H):$e(p,x,E,!1,A,H)}function $e(p,x,E,A,H,J){if(!x)throw Error("Invalid event type");const ge=d(H)?!!H.capture:!!H;let Ye=Bn(p);if(Ye||(p[Be]=Ye=new ye(p)),E=Ye.add(x,E,A,ge,J),E.proxy)return E;if(A=Zn(),E.proxy=A,A.src=p,A.listener=E,p.addEventListener)M||(H=ge),H===void 0&&(H=!1),p.addEventListener(x.toString(),A,H);else if(p.attachEvent)p.attachEvent(Ke(x.toString()),A);else if(p.addListener&&p.removeListener)p.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Zn(){function p(E){return x.call(p.src,p.listener,E)}const x=Ar;return p}function En(p,x,E,A,H){if(Array.isArray(x))for(var J=0;J<x.length;J++)En(p,x[J],E,A,H);else A=d(A)?!!A.capture:!!A,E=Rs(E),p&&p[gt]?(p=p.i,J=String(x).toString(),J in p.g&&(x=p.g[J],E=Re(x,E,A,H),E>-1&&(Te(x[E]),Array.prototype.splice.call(x,E,1),x.length==0&&(delete p.g[J],p.h--)))):p&&(p=Bn(p))&&(x=p.g[x.toString()],p=-1,x&&(p=Re(x,E,A,H)),(E=p>-1?x[p]:null)&&fr(E))}function fr(p){if(typeof p!="number"&&p&&!p.da){var x=p.src;if(x&&x[gt])Ne(x.i,p);else{var E=p.type,A=p.proxy;x.removeEventListener?x.removeEventListener(E,A,p.capture):x.detachEvent?x.detachEvent(Ke(E),A):x.addListener&&x.removeListener&&x.removeListener(A),(E=Bn(x))?(Ne(E,p),E.h==0&&(E.src=null,x[Be]=null)):Te(p)}}}function Ke(p){return p in Je?Je[p]:Je[p]="on"+p}function Ar(p,x){if(p.da)p=!0;else{x=new qe(x,this);const E=p.listener,A=p.ha||p.src;p.fa&&fr(p),p=E.call(A,x)}return p}function Bn(p){return p=p[Be],p instanceof ye?p:null}var Cs="__closure_events_fn_"+(Math.random()*1e9>>>0);function Rs(p){return typeof p=="function"?p:(p[Cs]||(p[Cs]=function(x){return p.handleEvent(x)}),p[Cs])}function _t(){U.call(this),this.i=new ye(this),this.M=this,this.G=null}b(_t,U),_t.prototype[gt]=!0,_t.prototype.removeEventListener=function(p,x,E,A){En(this,p,x,E,A)};function st(p,x){var E,A=p.G;if(A)for(E=[];A;A=A.G)E.push(A);if(p=p.M,A=x.type||x,typeof x=="string")x=new D(x,p);else if(x instanceof D)x.target=x.target||p;else{var H=x;x=new D(A,p),pe(x,H)}H=!0;let J,ge;if(E)for(ge=E.length-1;ge>=0;ge--)J=x.g=E[ge],H=Wt(J,A,!0,x)&&H;if(J=x.g=p,H=Wt(J,A,!0,x)&&H,H=Wt(J,A,!1,x)&&H,E)for(ge=0;ge<E.length;ge++)J=x.g=E[ge],H=Wt(J,A,!1,x)&&H}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var p=this.i;for(const x in p.g){const E=p.g[x];for(let A=0;A<E.length;A++)Te(E[A]);delete p.g[x],p.h--}}this.G=null},_t.prototype.J=function(p,x,E,A){return this.i.add(String(p),x,!1,E,A)},_t.prototype.K=function(p,x,E,A){return this.i.add(String(p),x,!0,E,A)};function Wt(p,x,E,A){if(x=p.i.g[String(x)],!x)return!0;x=x.concat();let H=!0;for(let J=0;J<x.length;++J){const ge=x[J];if(ge&&!ge.da&&ge.capture==E){const Ye=ge.listener,Nn=ge.ha||ge.src;ge.fa&&Ne(p.i,ge),H=Ye.call(Nn,A)!==!1&&H}}return H&&!A.defaultPrevented}function Kr(p,x){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=m(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:c.setTimeout(p,x||0)}function on(p){p.g=Kr(()=>{p.g=null,p.i&&(p.i=!1,on(p))},p.l);const x=p.h;p.h=null,p.m.apply(null,x)}class zt extends U{constructor(x,E){super(),this.m=x,this.l=E,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:on(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tn(p){U.call(this),this.h=p,this.g={}}b(Tn,U);var er=[];function ln(p){Me(p.g,function(x,E){this.g.hasOwnProperty(E)&&fr(x)},p),p.g={}}Tn.prototype.N=function(){Tn.Z.N.call(this),ln(this)},Tn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qt=c.JSON.stringify,tr=c.JSON.parse,us=class{stringify(p){return c.JSON.stringify(p,void 0)}parse(p){return c.JSON.parse(p,void 0)}};function K(){}function ve(){}var Oe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Le(){D.call(this,"d")}b(Le,D);function et(){D.call(this,"c")}b(et,D);var we={},Ht=null;function nr(){return Ht=Ht||new _t}we.Ia="serverreachability";function Sn(p){D.call(this,we.Ia,p)}b(Sn,D);function $t(p){const x=nr();st(x,new Sn(x))}we.STAT_EVENT="statevent";function kn(p,x){D.call(this,we.STAT_EVENT,p),this.stat=x}b(kn,D);function Qe(p){const x=nr();st(x,new kn(x,p))}we.Ja="timingevent";function xt(p,x){D.call(this,we.Ja,p),this.size=x}b(xt,D);function Bt(p,x){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){p()},x)}function Kt(){this.g=!0}Kt.prototype.ua=function(){this.g=!1};function Fn(p,x,E,A,H,J){p.info(function(){if(p.g)if(J){var ge="",Ye=J.split("&");for(let Nt=0;Nt<Ye.length;Nt++){var Nn=Ye[Nt].split("=");if(Nn.length>1){const tn=Nn[0];Nn=Nn[1];const ys=tn.split("_");ge=ys.length>=2&&ys[1]=="type"?ge+(tn+"="+Nn+"&"):ge+(tn+"=redacted&")}}}else ge=null;else ge=J;return"XMLHTTP REQ ("+A+") [attempt "+H+"]: "+x+`
`+E+`
`+ge})}function pn(p,x,E,A,H,J,ge){p.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+H+"]: "+x+`
`+E+`
`+J+" "+ge})}function Zt(p,x,E,A){p.info(function(){return"XMLHTTP TEXT ("+x+"): "+Qt(p,E)+(A?" "+A:"")})}function pr(p,x){p.info(function(){return"TIMEOUT: "+x})}Kt.prototype.info=function(){};function Qt(p,x){if(!p.g)return x;if(!x)return null;try{const J=JSON.parse(x);if(J){for(p=0;p<J.length;p++)if(Array.isArray(J[p])){var E=J[p];if(!(E.length<2)){var A=E[1];if(Array.isArray(A)&&!(A.length<1)){var H=A[0];if(H!="noop"&&H!="stop"&&H!="close")for(let ge=1;ge<A.length;ge++)A[ge]=""}}}}return qt(J)}catch{return x}}var Dn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},yt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},_e;function mr(){}b(mr,K),mr.prototype.g=function(){return new XMLHttpRequest},_e=new mr;function rr(p){return encodeURIComponent(String(p))}function gr(p){var x=1;p=p.split(":");const E=[];for(;x>0&&p.length;)E.push(p.shift()),x--;return p.length&&E.push(p.join(":")),E}function Gn(p,x,E,A){this.j=p,this.i=x,this.l=E,this.S=A||1,this.V=new Tn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Qn}function Qn(){this.i=null,this.g="",this.h=!1}var Yt={},mn={};function ds(p,x,E){p.M=1,p.A=vn(en(x)),p.u=E,p.R=!0,Ki(p,null)}function Ki(p,x){p.F=Date.now(),Qr(p),p.B=en(p.A);var E=p.B,A=p.S;Array.isArray(A)||(A=[String(A)]),ne(E.i,"t",A),p.C=0,E=p.j.L,p.h=new Qn,p.g=bh(p.j,E?x:null,!p.u),p.P>0&&(p.O=new zt(m(p.Y,p,p.g),p.P)),x=p.V,E=p.g,A=p.ba;var H="readystatechange";Array.isArray(H)||(H&&(er[0]=H.toString()),H=er);for(let J=0;J<H.length;J++){const ge=rt(E,H[J],A||x.handleEvent,!1,x.h||x);if(!ge)break;x.g[ge.key]=ge}x=p.J?V(p.J):{},p.u?(p.v||(p.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,x)):(p.v="GET",p.g.ea(p.B,p.v,null,x)),$t(),Fn(p.i,p.v,p.B,p.l,p.S,p.u)}Gn.prototype.ba=function(p){p=p.target;const x=this.O;x&&Ps(p)==3?x.j():this.Y(p)},Gn.prototype.Y=function(p){try{if(p==this.g)e:{const Ye=Ps(this.g),Nn=this.g.ya(),Nt=this.g.ca();if(!(Ye<3)&&(Ye!=3||this.g&&(this.h.h||this.g.la()||ir(this.g)))){this.K||Ye!=4||Nn==7||(Nn==8||Nt<=0?$t(3):$t(2)),hs(this);var x=this.g.ca();this.X=x;var E=Jc(this);if(this.o=x==200,pn(this.i,this.v,this.B,this.l,this.S,Ye,x),this.o){if(this.U&&!this.L){t:{if(this.g){var A,H=this.g;if((A=H.g?H.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(A)){var J=A;break t}}J=null}if(p=J)Zt(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,fs(this,p);else{this.o=!1,this.m=3,Qe(12),yr(this),Mr(this);break e}}if(this.R){p=!0;let tn;for(;!this.K&&this.C<E.length;)if(tn=On(this,E),tn==mn){Ye==4&&(this.m=4,Qe(14),p=!1),Zt(this.i,this.l,null,"[Incomplete Response]");break}else if(tn==Yt){this.m=4,Qe(15),Zt(this.i,this.l,E,"[Invalid Chunk]"),p=!1;break}else Zt(this.i,this.l,tn,null),fs(this,tn);if(io(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ye!=4||E.length!=0||this.h.h||(this.m=1,Qe(16),p=!1),this.o=this.o&&p,!p)Zt(this.i,this.l,E,"[Invalid Chunked Response]"),yr(this),Mr(this);else if(E.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),nu(ge),ge.P=!0,Qe(11))}}else Zt(this.i,this.l,E,null),fs(this,E);Ye==4&&yr(this),this.o&&!this.K&&(Ye==4?mh(this.j,this):(this.o=!1,Qr(this)))}else gi(this.g),x==400&&E.indexOf("Unknown SID")>0?(this.m=3,Qe(12)):(this.m=0,Qe(13)),yr(this),Mr(this)}}}catch{}finally{}};function Jc(p){if(!io(p))return p.g.la();const x=ir(p.g);if(x==="")return"";let E="";const A=x.length,H=Ps(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return yr(p),Mr(p),"";p.h.i=new c.TextDecoder}for(let J=0;J<A;J++)p.h.h=!0,E+=p.h.i.decode(x[J],{stream:!(H&&J==A-1)});return x.length=0,p.h.g+=E,p.C=0,p.h.g}function io(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function On(p,x){var E=p.C,A=x.indexOf(`
`,E);return A==-1?mn:(E=Number(x.substring(E,A)),isNaN(E)?Yt:(A+=1,A+E>x.length?mn:(x=x.slice(A,A+E),p.C=A+E,x)))}Gn.prototype.cancel=function(){this.K=!0,yr(this)};function Qr(p){p.T=Date.now()+p.H,Qi(p,p.H)}function Qi(p,x){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Bt(m(p.aa,p),x)}function hs(p){p.D&&(c.clearTimeout(p.D),p.D=null)}Gn.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(pr(this.i,this.B),this.M!=2&&($t(),Qe(17)),yr(this),this.m=2,Mr(this)):Qi(this,this.T-p)};function Mr(p){p.j.I==0||p.K||mh(p.j,p)}function yr(p){hs(p);var x=p.O;x&&typeof x.dispose=="function"&&x.dispose(),p.O=null,ln(p.V),p.g&&(x=p.g,p.g=null,x.abort(),x.dispose())}function fs(p,x){try{var E=p.j;if(E.I!=0&&(E.g==p||Yr(E.h,p))){if(!p.L&&Yr(E.h,p)&&E.I==3){try{var A=E.Ba.g.parse(x)}catch{A=null}if(Array.isArray(A)&&A.length==3){var H=A;if(H[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<p.F)ml(E),ra(E);else break e;mo(E),Qe(18)}}else E.xa=H[1],0<E.xa-E.K&&H[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=Bt(m(E.Va,E),6e3));ps(E.h)<=1&&E.ta&&(E.ta=void 0)}else Js(E,11)}else if((p.L||E.g==p)&&ml(E),!O(x))for(H=E.Ba.g.parse(x),x=0;x<H.length;x++){let Nt=H[x];const tn=Nt[0];if(!(tn<=E.K))if(E.K=tn,Nt=Nt[1],E.I==2)if(Nt[0]=="c"){E.M=Nt[1],E.ba=Nt[2];const ys=Nt[3];ys!=null&&(E.ka=ys,E.j.info("VER="+E.ka));const Ws=Nt[4];Ws!=null&&(E.za=Ws,E.j.info("SVER="+E.za));const Ms=Nt[5];Ms!=null&&typeof Ms=="number"&&Ms>0&&(A=1.5*Ms,E.O=A,E.j.info("backChannelRequestTimeoutMs_="+A)),A=E;const Vs=p.g;if(Vs){const go=Vs.g?Vs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(go){var J=A.h;J.g||go.indexOf("spdy")==-1&&go.indexOf("quic")==-1&&go.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(ms(J,J.h),J.h=null))}if(A.G){const gl=Vs.g?Vs.g.getResponseHeader("X-HTTP-Session-Id"):null;gl&&(A.wa=gl,it(A.J,A.G,gl))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-p.F,E.j.info("Handshake RTT: "+E.T+"ms")),A=E;var ge=p;if(A.na=vh(A,A.L?A.ba:null,A.W),ge.L){Xr(A.h,ge);var Ye=ge,Nn=A.O;Nn&&(Ye.H=Nn),Ye.D&&(hs(Ye),Qr(Ye)),A.g=ge}else fh(A);E.i.length>0&&Xs(E)}else Nt[0]!="stop"&&Nt[0]!="close"||Js(E,7);else E.I==3&&(Nt[0]=="stop"||Nt[0]=="close"?Nt[0]=="stop"?Js(E,7):eu(E):Nt[0]!="noop"&&E.l&&E.l.qa(Nt),E.A=0)}}$t(4)}catch{}}var gn=class{constructor(p,x){this.g=p,this.map=x}};function Yi(p){this.l=p||10,c.PerformanceNavigationTiming?(p=c.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ao(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function ps(p){return p.h?1:p.g?p.g.size:0}function Yr(p,x){return p.h?p.h==x:p.g?p.g.has(x):!1}function ms(p,x){p.g?p.g.add(x):p.h=x}function Xr(p,x){p.h&&p.h==x?p.h=null:p.g&&p.g.has(x)&&p.g.delete(x)}Yi.prototype.cancel=function(){if(this.i=Xi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Xi(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let x=p.i;for(const E of p.g.values())x=x.concat(E.G);return x}return S(p.i)}var dl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cr(p,x){if(p){p=p.split("&");for(let E=0;E<p.length;E++){const A=p[E].indexOf("=");let H,J=null;A>=0?(H=p[E].substring(0,A),J=p[E].substring(A+1)):H=p[E],x(H,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function cn(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;p instanceof cn?(this.l=p.l,yn(this,p.j),this.o=p.o,this.g=p.g,Vr(this,p.u),this.h=p.h,Ji(this,G(p.i)),this.m=p.m):p&&(x=String(p).match(dl))?(this.l=!1,yn(this,x[1]||"",!0),this.o=Jr(x[2]||""),this.g=Jr(x[3]||"",!0),Vr(this,x[4]),this.h=Jr(x[5]||"",!0),Ji(this,x[6]||"",!0),this.m=Jr(x[7]||"")):(this.l=!1,this.i=new Ds(null,this.l))}cn.prototype.toString=function(){const p=[];var x=this.j;x&&p.push(Ks(x,Wi,!0),":");var E=this.g;return(E||x=="file")&&(p.push("//"),(x=this.o)&&p.push(Ks(x,Wi,!0),"@"),p.push(rr(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&p.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&p.push("/"),p.push(Ks(E,E.charAt(0)=="/"?Zi:oo,!0))),(E=this.i.toString())&&p.push("?",E),(E=this.m)&&p.push("#",Ks(E,lo)),p.join("")},cn.prototype.resolve=function(p){const x=en(this);let E=!!p.j;E?yn(x,p.j):E=!!p.o,E?x.o=p.o:E=!!p.g,E?x.g=p.g:E=p.u!=null;var A=p.h;if(E)Vr(x,p.u);else if(E=!!p.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var H=x.h.lastIndexOf("/");H!=-1&&(A=x.h.slice(0,H+1)+A)}if(H=A,H==".."||H==".")A="";else if(H.indexOf("./")!=-1||H.indexOf("/.")!=-1){A=H.lastIndexOf("/",0)==0,H=H.split("/");const J=[];for(let ge=0;ge<H.length;){const Ye=H[ge++];Ye=="."?A&&ge==H.length&&J.push(""):Ye==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),A&&ge==H.length&&J.push("")):(J.push(Ye),A=!0)}A=J.join("/")}else A=H}return E?x.h=A:E=p.i.toString()!=="",E?Ji(x,G(p.i)):E=!!p.m,E&&(x.m=p.m),x};function en(p){return new cn(p)}function yn(p,x,E){p.j=E?Jr(x,!0):x,p.j&&(p.j=p.j.replace(/:$/,""))}function Vr(p,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);p.u=x}else p.u=null}function Ji(p,x,E){x instanceof Ds?(p.i=x,be(p.i,p.l)):(E||(x=Ks(x,ks)),p.i=new Ds(x,p.l))}function it(p,x,E){p.i.set(x,E)}function vn(p){return it(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Jr(p,x){return p?x?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Ks(p,x,E){return typeof p=="string"?(p=encodeURI(p).replace(x,vr),E&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function vr(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Wi=/[#\/\?@]/g,oo=/[#\?:]/g,Zi=/[#\?]/g,ks=/[#\?@]/g,lo=/#/g;function Ds(p,x){this.h=this.g=null,this.i=p||null,this.j=!!x}function sr(p){p.g||(p.g=new Map,p.h=0,p.i&&Cr(p.i,function(x,E){p.add(decodeURIComponent(x.replace(/\+/g," ")),E)}))}r=Ds.prototype,r.add=function(p,x){sr(this),this.i=null,p=ue(this,p);let E=this.g.get(p);return E||this.g.set(p,E=[]),E.push(x),this.h+=1,this};function co(p,x){sr(p),x=ue(p,x),p.g.has(x)&&(p.i=null,p.h-=p.g.get(x).length,p.g.delete(x))}function ea(p,x){return sr(p),x=ue(p,x),p.g.has(x)}r.forEach=function(p,x){sr(this),this.g.forEach(function(E,A){E.forEach(function(H){p.call(x,H,A,this)},this)},this)};function T(p,x){sr(p);let E=[];if(typeof x=="string")ea(p,x)&&(E=E.concat(p.g.get(ue(p,x))));else for(p=Array.from(p.g.values()),x=0;x<p.length;x++)E=E.concat(p[x]);return E}r.set=function(p,x){return sr(this),this.i=null,p=ue(this,p),ea(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[x]),this.h+=1,this},r.get=function(p,x){return p?(p=T(this,p),p.length>0?String(p[0]):x):x};function ne(p,x,E){co(p,x),E.length>0&&(p.i=null,p.g.set(ue(p,x),S(E)),p.h+=E.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],x=Array.from(this.g.keys());for(let A=0;A<x.length;A++){var E=x[A];const H=rr(E);E=T(this,E);for(let J=0;J<E.length;J++){let ge=H;E[J]!==""&&(ge+="="+rr(E[J])),p.push(ge)}}return this.i=p.join("&")};function G(p){const x=new Ds;return x.i=p.i,p.g&&(x.g=new Map(p.g),x.h=p.h),x}function ue(p,x){return x=String(x),p.j&&(x=x.toLowerCase()),x}function be(p,x){x&&!p.j&&(sr(p),p.i=null,p.g.forEach(function(E,A){const H=A.toLowerCase();A!=H&&(co(this,A),ne(this,H,E))},p)),p.j=x}function De(p,x){const E=new Kt;if(c.Image){const A=new Image;A.onload=v(vt,E,"TestLoadImage: loaded",!0,x,A),A.onerror=v(vt,E,"TestLoadImage: error",!1,x,A),A.onabort=v(vt,E,"TestLoadImage: abort",!1,x,A),A.ontimeout=v(vt,E,"TestLoadImage: timeout",!1,x,A),c.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=p}else x(!1)}function We(p,x){const E=new Kt,A=new AbortController,H=setTimeout(()=>{A.abort(),vt(E,"TestPingServer: timeout",!1,x)},1e4);fetch(p,{signal:A.signal}).then(J=>{clearTimeout(H),J.ok?vt(E,"TestPingServer: ok",!0,x):vt(E,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(H),vt(E,"TestPingServer: error",!1,x)})}function vt(p,x,E,A,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),A(E)}catch{}}function un(){this.g=new us}function St(p){this.i=p.Sb||null,this.h=p.ab||!1}b(St,K),St.prototype.g=function(){return new Os(this.i,this.h)};function Os(p,x){_t.call(this),this.H=p,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(Os,_t),r=Os.prototype,r.open=function(p,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=x,this.readyState=1,js(this)},r.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(x.body=p),(this.H||c).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ta(this)),this.readyState=0},r.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,js(this)),this.g&&(this.readyState=3,js(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;hl(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function hl(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}r.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var x=p.value?p.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!p.done}))&&(this.response=this.responseText+=x)}p.done?ta(this):js(this),this.readyState==3&&hl(this)}},r.Oa=function(p){this.g&&(this.response=this.responseText=p,ta(this))},r.Na=function(p){this.g&&(this.response=p,ta(this))},r.ga=function(){this.g&&ta(this)};function ta(p){p.readyState=4,p.l=null,p.j=null,p.B=null,js(p)}r.setRequestHeader=function(p,x){this.A.append(p,x)},r.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],x=this.h.entries();for(var E=x.next();!E.done;)E=E.value,p.push(E[0]+": "+E[1]),E=x.next();return p.join(`\r
`)};function js(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Os.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function gs(p){let x="";return Me(p,function(E,A){x+=A,x+=":",x+=E,x+=`\r
`}),x}function uo(p,x,E){e:{for(A in E){var A=!1;break e}A=!0}A||(E=gs(E),typeof p=="string"?E!=null&&rr(E):it(p,x,E))}function Pt(p){_t.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(Pt,_t);var Qs=/^https?$/i,Wc=["POST","PUT"];r=Pt.prototype,r.Fa=function(p){this.H=p},r.ea=function(p,x,E,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);x=x?x.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():_e.g(),this.g.onreadystatechange=_(m(this.Ca,this));try{this.B=!0,this.g.open(x,String(p),!0),this.B=!1}catch(J){ho(this,J);return}if(p=E||"",E=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var H in A)E.set(H,A[H]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const J of A.keys())E.set(J,A.get(J));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(E.keys()).find(J=>J.toLowerCase()=="content-type"),H=c.FormData&&p instanceof c.FormData,!(Array.prototype.indexOf.call(Wc,x,void 0)>=0)||A||H||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ge]of E)this.g.setRequestHeader(J,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(J){ho(this,J)}};function ho(p,x){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=x,p.o=5,Zc(p),mi(p)}function Zc(p){p.A||(p.A=!0,st(p,"complete"),st(p,"error"))}r.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,st(this,"complete"),st(this,"abort"),mi(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mi(this,!0)),Pt.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?fo(this):this.Xa())},r.Xa=function(){fo(this)};function fo(p){if(p.h&&typeof o<"u"){if(p.v&&Ps(p)==4)setTimeout(p.Ca.bind(p),0);else if(st(p,"readystatechange"),Ps(p)==4){p.h=!1;try{const J=p.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var E;if(!(E=x)){var A;if(A=J===0){let ge=String(p.D).match(dl)[1]||null;!ge&&c.self&&c.self.location&&(ge=c.self.location.protocol.slice(0,-1)),A=!Qs.test(ge?ge.toLowerCase():"")}E=A}if(E)st(p,"complete"),st(p,"success");else{p.o=6;try{var H=Ps(p)>2?p.g.statusText:""}catch{H=""}p.l=H+" ["+p.ca()+"]",Zc(p)}}finally{mi(p)}}}}function mi(p,x){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const E=p.g;p.g=null,x||st(p,"ready");try{E.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function Ps(p){return p.g?p.g.readyState:0}r.ca=function(){try{return Ps(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(p){if(this.g){var x=this.g.responseText;return p&&x.indexOf(p)==0&&(x=x.substring(p.length)),tr(x)}};function ir(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function gi(p){const x={};p=(p.g&&Ps(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<p.length;A++){if(O(p[A]))continue;var E=gr(p[A]);const H=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const J=x[H]||[];x[H]=J,J.push(E)}Ve(x,function(A){return A.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ys(p,x,E){return E&&E.internalChannelParams&&E.internalChannelParams[p]||x}function na(p){this.za=0,this.i=[],this.j=new Kt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ys("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ys("baseRetryDelayMs",5e3,p),this.Za=Ys("retryDelaySeedMs",1e4,p),this.Ta=Ys("forwardChannelMaxRetries",2,p),this.va=Ys("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Yi(p&&p.concurrentRequestLimit),this.Ba=new un,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=na.prototype,r.ka=8,r.I=1,r.connect=function(p,x,E,A){Qe(0),this.W=p,this.H=x||{},E&&A!==void 0&&(this.H.OSID=E,this.H.OAID=A),this.F=this.X,this.J=vh(this,null,this.W),Xs(this)};function eu(p){if(fl(p),p.I==3){var x=p.V++,E=en(p.J);if(it(E,"SID",p.M),it(E,"RID",x),it(E,"TYPE","terminate"),po(p,E),x=new Gn(p,p.j,x),x.M=2,x.A=vn(en(E)),E=!1,c.navigator&&c.navigator.sendBeacon)try{E=c.navigator.sendBeacon(x.A.toString(),"")}catch{}!E&&c.Image&&(new Image().src=x.A,E=!0),E||(x.g=bh(x.j,null),x.g.ea(x.A)),x.F=Date.now(),Qr(x)}yh(p)}function ra(p){p.g&&(nu(p),p.g.cancel(),p.g=null)}function fl(p){ra(p),p.v&&(c.clearTimeout(p.v),p.v=null),ml(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&c.clearTimeout(p.m),p.m=null)}function Xs(p){if(!ao(p.h)&&!p.m){p.m=!0;var x=p.Ea;fe||I(),ce||(fe(),ce=!0),C.add(x,p),p.D=0}}function pl(p,x){return ps(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=x.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Bt(m(p.Ea,p,x),gh(p,p.D)),p.D++,!0)}r.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const H=new Gn(this,this.j,p);let J=this.o;if(this.U&&(J?(J=V(J),pe(J,this.U)):J=this.U),this.u!==null||this.R||(H.J=J,J=null),this.S)e:{for(var x=0,E=0;E<this.i.length;E++){t:{var A=this.i[E];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(x+=A,x>4096){x=E;break e}if(x===4096||E===this.i.length-1){x=E+1;break e}}x=1e3}else x=1e3;x=hh(this,H,x),E=en(this.J),it(E,"RID",p),it(E,"CVER",22),this.G&&it(E,"X-HTTP-Session-Id",this.G),po(this,E),J&&(this.R?x="headers="+rr(gs(J))+"&"+x:this.u&&uo(E,this.u,J)),ms(this.h,H),this.Ra&&it(E,"TYPE","init"),this.S?(it(E,"$req",x),it(E,"SID","null"),H.U=!0,ds(H,E,null)):ds(H,E,x),this.I=2}}else this.I==3&&(p?tu(this,p):this.i.length==0||ao(this.h)||tu(this))};function tu(p,x){var E;x?E=x.l:E=p.V++;const A=en(p.J);it(A,"SID",p.M),it(A,"RID",E),it(A,"AID",p.K),po(p,A),p.u&&p.o&&uo(A,p.u,p.o),E=new Gn(p,p.j,E,p.D+1),p.u===null&&(E.J=p.o),x&&(p.i=x.G.concat(p.i)),x=hh(p,E,1e3),E.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ms(p.h,E),ds(E,A,x)}function po(p,x){p.H&&Me(p.H,function(E,A){it(x,A,E)}),p.l&&Me({},function(E,A){it(x,A,E)})}function hh(p,x,E){E=Math.min(p.i.length,E);const A=p.l?m(p.l.Ka,p.l,p):null;e:{var H=p.i;let Ye=-1;for(;;){const Nn=["count="+E];Ye==-1?E>0?(Ye=H[0].g,Nn.push("ofs="+Ye)):Ye=0:Nn.push("ofs="+Ye);let Nt=!0;for(let tn=0;tn<E;tn++){var J=H[tn].g;const ys=H[tn].map;if(J-=Ye,J<0)Ye=Math.max(0,H[tn].g-100),Nt=!1;else try{J="req"+J+"_"||"";try{var ge=ys instanceof Map?ys:Object.entries(ys);for(const[Ws,Ms]of ge){let Vs=Ms;d(Ms)&&(Vs=qt(Ms)),Nn.push(J+Ws+"="+encodeURIComponent(Vs))}}catch(Ws){throw Nn.push(J+"type="+encodeURIComponent("_badmap")),Ws}}catch{A&&A(ys)}}if(Nt){ge=Nn.join("&");break e}}ge=void 0}return p=p.i.splice(0,E),x.G=p,ge}function fh(p){if(!p.g&&!p.v){p.Y=1;var x=p.Da;fe||I(),ce||(fe(),ce=!0),C.add(x,p),p.A=0}}function mo(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Bt(m(p.Da,p),gh(p,p.A)),p.A++,!0)}r.Da=function(){if(this.v=null,ph(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Bt(m(this.Wa,this),p)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Qe(10),ra(this),ph(this))};function nu(p){p.B!=null&&(c.clearTimeout(p.B),p.B=null)}function ph(p){p.g=new Gn(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var x=en(p.na);it(x,"RID","rpc"),it(x,"SID",p.M),it(x,"AID",p.K),it(x,"CI",p.F?"0":"1"),!p.F&&p.ia&&it(x,"TO",p.ia),it(x,"TYPE","xmlhttp"),po(p,x),p.u&&p.o&&uo(x,p.u,p.o),p.O&&(p.g.H=p.O);var E=p.g;p=p.ba,E.M=1,E.A=vn(en(x)),E.u=null,E.R=!0,Ki(E,p)}r.Va=function(){this.C!=null&&(this.C=null,ra(this),mo(this),Qe(19))};function ml(p){p.C!=null&&(c.clearTimeout(p.C),p.C=null)}function mh(p,x){var E=null;if(p.g==x){ml(p),nu(p),p.g=null;var A=2}else if(Yr(p.h,x))E=x.G,Xr(p.h,x),A=1;else return;if(p.I!=0){if(x.o)if(A==1){E=x.u?x.u.length:0,x=Date.now()-x.F;var H=p.D;A=nr(),st(A,new xt(A,E)),Xs(p)}else fh(p);else if(H=x.m,H==3||H==0&&x.X>0||!(A==1&&pl(p,x)||A==2&&mo(p)))switch(E&&E.length>0&&(x=p.h,x.i=x.i.concat(E)),H){case 1:Js(p,5);break;case 4:Js(p,10);break;case 3:Js(p,6);break;default:Js(p,2)}}}function gh(p,x){let E=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(E*=2),E*x}function Js(p,x){if(p.j.info("Error code "+x),x==2){var E=m(p.bb,p),A=p.Ua;const H=!A;A=new cn(A||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||yn(A,"https"),vn(A),H?De(A.toString(),E):We(A.toString(),E)}else Qe(2);p.I=0,p.l&&p.l.pa(x),yh(p),fl(p)}r.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Qe(2)):(this.j.info("Failed to ping google.com"),Qe(1))};function yh(p){if(p.I=0,p.ja=[],p.l){const x=Xi(p.h);(x.length!=0||p.i.length!=0)&&(k(p.ja,x),k(p.ja,p.i),p.h.i.length=0,S(p.i),p.i.length=0),p.l.oa()}}function vh(p,x,E){var A=E instanceof cn?en(E):new cn(E);if(A.g!="")x&&(A.g=x+"."+A.g),Vr(A,A.u);else{var H=c.location;A=H.protocol,x=x?x+"."+H.hostname:H.hostname,H=+H.port;const J=new cn(null);A&&yn(J,A),x&&(J.g=x),H&&Vr(J,H),E&&(J.h=E),A=J}return E=p.G,x=p.wa,E&&x&&it(A,E,x),it(A,"VER",p.ka),po(p,A),A}function bh(p,x,E){if(x&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=p.Aa&&!p.ma?new Pt(new St({ab:E})):new Pt(p.ma),x.Fa(p.L),x}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function xh(){}r=xh.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function sa(){}sa.prototype.g=function(p,x){return new Rr(p,x)};function Rr(p,x){_t.call(this),this.g=new na(x),this.l=p,this.h=x&&x.messageUrlParams||null,p=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(p?p["X-WebChannel-Content-Type"]=x.messageContentType:p={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(p?p["X-WebChannel-Client-Profile"]=x.sa:p={"X-WebChannel-Client-Profile":x.sa}),this.g.U=p,(p=x&&x.Qb)&&!O(p)&&(this.g.u=p),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!O(x)&&(this.g.G=x,p=this.h,p!==null&&x in p&&(p=this.h,x in p&&delete p[x])),this.j=new yi(this)}b(Rr,_t),Rr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Rr.prototype.close=function(){eu(this.g)},Rr.prototype.o=function(p){var x=this.g;if(typeof p=="string"){var E={};E.__data__=p,p=E}else this.v&&(E={},E.__data__=qt(p),p=E);x.i.push(new gn(x.Ya++,p)),x.I==3&&Xs(x)},Rr.prototype.N=function(){this.g.l=null,delete this.j,eu(this.g),delete this.g,Rr.Z.N.call(this)};function _h(p){Le.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var x=p.__sm__;if(x){e:{for(const E in x){p=E;break e}p=void 0}(this.i=p)&&(p=this.i,x=x!==null&&p in x?x[p]:void 0),this.data=x}else this.data=p}b(_h,Le);function wh(){et.call(this),this.status=1}b(wh,et);function yi(p){this.g=p}b(yi,xh),yi.prototype.ra=function(){st(this.g,"a")},yi.prototype.qa=function(p){st(this.g,new _h(p))},yi.prototype.pa=function(p){st(this.g,new wh)},yi.prototype.oa=function(){st(this.g,"b")},sa.prototype.createWebChannel=sa.prototype.g,Rr.prototype.send=Rr.prototype.o,Rr.prototype.open=Rr.prototype.m,Rr.prototype.close=Rr.prototype.close,s2=function(){return new sa},r2=function(){return nr()},n2=we,Oy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Dn.NO_ERROR=0,Dn.TIMEOUT=8,Dn.HTTP_ERROR=6,Yf=Dn,yt.COMPLETE="complete",t2=yt,ve.EventType=Oe,Oe.OPEN="a",Oe.CLOSE="b",Oe.ERROR="c",Oe.MESSAGE="d",_t.prototype.listen=_t.prototype.J,ed=ve,Pt.prototype.listenOnce=Pt.prototype.K,Pt.prototype.getLastError=Pt.prototype.Ha,Pt.prototype.getLastErrorCode=Pt.prototype.ya,Pt.prototype.getStatus=Pt.prototype.ca,Pt.prototype.getResponseJson=Pt.prototype.La,Pt.prototype.getResponseText=Pt.prototype.la,Pt.prototype.send=Pt.prototype.ea,Pt.prototype.setWithCredentials=Pt.prototype.Fa,e2=Pt}).apply(typeof Cf<"u"?Cf:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_r.UNAUTHENTICATED=new _r(null),_r.GOOGLE_CREDENTIALS=new _r("google-credentials-uid"),_r.FIRST_PARTY=new _r("first-party-uid"),_r.MOCK_USER=new _r("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fc="12.9.0";function DO(r){Fc=r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wo=new wv("@firebase/firestore");function rc(){return Wo.logLevel}function de(r,...e){if(Wo.logLevel<=ut.DEBUG){const t=e.map(Ov);Wo.debug(`Firestore (${Fc}): ${r}`,...t)}}function Cn(r,...e){if(Wo.logLevel<=ut.ERROR){const t=e.map(Ov);Wo.error(`Firestore (${Fc}): ${r}`,...t)}}function bc(r,...e){if(Wo.logLevel<=ut.WARN){const t=e.map(Ov);Wo.warn(`Firestore (${Fc}): ${r}`,...t)}}function Ov(r){if(typeof r=="string")return r;try{return(function(t){return JSON.stringify(t)})(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ee(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,i2(r,n,t)}function i2(r,e,t){let n=`FIRESTORE (${Fc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Cn(n),new Error(n)}function ke(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||i2(e,i,n)}function Ae(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends qi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(_r.UNAUTHENTICATED)))}shutdown(){}}class PO{constructor(e){this.t=e,this.currentUser=_r.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ke(this.o===void 0,42304);let n=this.i;const i=f=>this.i!==n?(n=this.i,t(f)):Promise.resolve();let o=new ui;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ui,e.enqueueRetryable((()=>i(this.currentUser)))};const c=()=>{const f=o;e.enqueueRetryable((async()=>{await f.promise,await i(this.currentUser)}))},d=f=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ui)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ke(typeof n.accessToken=="string",31837,{l:n}),new OO(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string",2055,{h:e}),new _r(e)}}class MO{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=_r.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class VO{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new MO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(_r.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Is(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ke(this.o===void 0,3512);const n=o=>{o.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,de("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>n(o)))};const i=o=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ke(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UO(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=UO(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<t&&(n+=e.charAt(i[o]%62))}return n}}function Ge(r,e){return r<e?-1:r>e?1:0}function jy(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const i=r.charAt(n),o=e.charAt(n);if(i!==o)return ny(i)===ny(o)?Ge(i,o):ny(i)?1:-1}return Ge(r.length,e.length)}const zO=55296,BO=57343;function ny(r){const e=r.charCodeAt(0);return e>=zO&&e<=BO}function xc(r,e,t){return r.length===e.length&&r.every(((n,i)=>t(n,e[i])))}function a2(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE="__name__";class ri{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ee(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Ee(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return ri.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ri?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const o=ri.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Ge(e.length,t.length)}static compareSegments(e,t){const n=ri.isNumericId(e),i=ri.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?ri.extractNumericId(e).compare(ri.extractNumericId(t)):jy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $a.fromString(e.substring(4,e.length-2))}}class At extends ri{construct(e,t,n){return new At(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new me(ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((i=>i.length>0)))}return new At(t)}static emptyPath(){return new At([])}}const FO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hn extends ri{construct(e,t,n){return new hn(e,t,n)}static isValidIdentifier(e){return FO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yE}static keyField(){return new hn([yE])}static fromServerFormat(e){const t=[];let n="",i=0;const o=()=>{if(n.length===0)throw new me(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let c=!1;for(;i<e.length;){const d=e[i];if(d==="\\"){if(i+1===e.length)throw new me(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new me(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,i+=2}else d==="`"?(c=!c,i++):d!=="."||c?(n+=d,i++):(o(),i++)}if(o(),c)throw new me(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hn(t)}static emptyPath(){return new hn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.path=e}static fromPath(e){return new xe(At.fromString(e))}static fromName(e){return new xe(At.fromString(e).popFirst(5))}static empty(){return new xe(At.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&At.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return At.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xe(new At(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(r,e,t){if(!t)throw new me(ie.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function GO(r,e,t,n){if(e===!0&&n===!0)throw new me(ie.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function vE(r){if(!xe.isDocumentKey(r))throw new me(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function bE(r){if(xe.isDocumentKey(r))throw new me(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function l2(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function em(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ee(12329,{type:typeof r})}function os(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new me(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=em(r);throw new me(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(r,e){const t={typeString:r};return e&&(t.value=e),t}function Jd(r,e){if(!l2(r))throw new me(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const c=r[n];if(i&&typeof c!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&c!==o.value){t=`Expected '${n}' field to equal '${o.value}'`;break}}if(t)throw new me(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE=-62135596800,_E=1e6;class Dt{static now(){return Dt.fromMillis(Date.now())}static fromDate(e){return Dt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*_E);return new Dt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xE)throw new me(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_E}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Dt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Jd(e,Dt._jsonSchema))return new Dt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Dt._jsonSchemaVersion="firestore/timestamp/1.0",Dt._jsonSchema={type:zn("string",Dt._jsonSchemaVersion),seconds:zn("number"),nanoseconds:zn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new Dt(0,0))}static max(){return new Pe(new Dt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _c=-1;class bp{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function Py(r){return r.fields.find((e=>e.kind===2))}function jo(r){return r.fields.filter((e=>e.kind!==2))}bp.UNKNOWN_ID=-1;class Xf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Id{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Id(0,cs.min())}}function c2(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=Pe.fromTimestamp(n===1e9?new Dt(t+1,0):new Dt(t,n));return new cs(i,xe.empty(),e)}function u2(r){return new cs(r.readTime,r.key,_c)}class cs{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new cs(Pe.min(),xe.empty(),_c)}static max(){return new cs(Pe.max(),xe.empty(),_c)}}function Pv(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=xe.comparator(r.documentKey,e.documentKey),t!==0?t:Ge(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class h2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function to(r){if(r.code!==ie.FAILED_PRECONDITION||r.message!==d2)throw r;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ee(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q(((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):q.reject(t)}static resolve(e){return new q(((t,n)=>{t(e)}))}static reject(e){return new q(((t,n)=>{n(e)}))}static waitFor(e){return new q(((t,n)=>{let i=0,o=0,c=!1;e.forEach((d=>{++i,d.next((()=>{++o,c&&o===i&&t()}),(f=>n(f)))})),c=!0,o===i&&t()}))}static or(e){let t=q.resolve(!1);for(const n of e)t=t.next((i=>i?q.resolve(i):n()));return t}static forEach(e,t){const n=[];return e.forEach(((i,o)=>{n.push(t.call(this,i,o))})),this.waitFor(n)}static mapArray(e,t){return new q(((n,i)=>{const o=e.length,c=new Array(o);let d=0;for(let f=0;f<o;f++){const m=f;t(e[m]).next((v=>{c[m]=v,++d,d===o&&n(c)}),(v=>i(v)))}}))}static doWhile(e,t){return new q(((n,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):n()};o()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const is="SimpleDb";class tm{static open(e,t,n,i){try{return new tm(t,e.transaction(i,n))}catch(o){throw new ld(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ui,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ld(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=Mv(n.target.error);this.S.reject(new ld(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(de(is,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new HO(t)}}class Ka{static delete(e){return de(is,"Removing database:",e),Mo(aN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!fN())return!1;if(Ka.F())return!0;const e=$n(),t=Ka.M(e),n=0<t&&t<10,i=f2(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,Ka.M($n())===12.2&&Cn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(de(is,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const c=o.target.result;t(c)},i.onblocked=()=>{n(new ld(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const c=o.target.error;c.name==="VersionError"?n(new me(ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?n(new me(ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):n(new ld(e,c))},i.onupgradeneeded=o=>{de(is,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const c=o.target.result;this.N.k(c,i.transaction,o.oldVersion,this.version).next((()=>{de(is,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const o=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.L(e);const d=tm.open(this.db,e,o?"readonly":"readwrite",n),f=i(d).next((m=>(d.C(),m))).catch((m=>(d.abort(m),q.reject(m)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,m=f.name!=="FirebaseError"&&c<3;if(de(is,"Transaction failed with error:",f.message,"Retrying:",m),this.close(),!m)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function f2(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class qO{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Mo(this.U.delete())}}class ld extends me{constructor(e,t){super(ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function no(r){return r.name==="IndexedDbTransactionError"}class HO{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(de(is,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(de(is,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Mo(n)}add(e){return de(is,"ADD",this.store.name,e,e),Mo(this.store.add(e))}get(e){return Mo(this.store.get(e)).next((t=>(t===void 0&&(t=null),de(is,"GET",this.store.name,e,t),t)))}delete(e){return de(is,"DELETE",this.store.name,e),Mo(this.store.delete(e))}count(){return de(is,"COUNT",this.store.name),Mo(this.store.count())}H(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(n.range);return new q(((c,d)=>{o.onerror=f=>{d(f.target.error)},o.onsuccess=f=>{c(f.target.result)}}))}{const o=this.cursor(n),c=[];return this.J(o,((d,f)=>{c.push(f)})).next((()=>c))}}Z(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new q(((i,o)=>{n.onerror=c=>{o(c.target.error)},n.onsuccess=c=>{i(c.target.result)}}))}X(e,t){de(is,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const i=this.cursor(n);return this.J(i,((o,c,d)=>d.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.J(i,t)}te(e){const t=this.cursor({});return new q(((n,i)=>{t.onerror=o=>{const c=Mv(o.target.error);i(c)},t.onsuccess=o=>{const c=o.target.result;c?e(c.primaryKey,c.value).next((d=>{d?c.continue():n()})):n()}}))}J(e,t){const n=[];return new q(((i,o)=>{e.onerror=c=>{o(c.target.error)},e.onsuccess=c=>{const d=c.target.result;if(!d)return void i();const f=new qO(d),m=t(d.primaryKey,d.value,f);if(m instanceof q){const v=m.catch((b=>(f.done(),q.reject(b))));n.push(v)}f.isDone?i():f.G===null?d.continue():d.continue(f.G)}})).next((()=>q.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Mo(r){return new q(((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=Mv(n.target.error);t(i)}}))}let wE=!1;function Mv(r){const e=Ka.M($n());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new me("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return wE||(wE=!0,setTimeout((()=>{throw n}),0)),n}}return r}const cd="IndexBackfiller";class $O{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){de(cd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();de(cd,`Documents written: ${t}`)}catch(t){no(t)?de(cd,"Ignoring IndexedDB error during index backfill: ",t):await to(t)}await this.re(6e4)}))}}class KO{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let i=t,o=!0;return q.doWhile((()=>o===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!n.has(c))return de(cd,`Processing collection: ${c}`),this.oe(e,c,i).next((d=>{i-=d,n.add(c)}));o=!1})))).next((()=>t-i))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next((o=>{const c=o.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this._e(i,o))).next((d=>(de(cd,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>c.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((i,o)=>{const c=u2(o);Pv(c,n)>0&&(n=c)})),new cs(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qr.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fo=-1;function nm(r){return r==null}function Ad(r){return r===0&&1/r==-1/0}function p2(r){return typeof r=="number"&&Number.isInteger(r)&&!Ad(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp="";function Nr(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=EE(e)),e=QO(r.get(t),e);return EE(e)}function QO(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const o=r.charAt(i);switch(o){case"\0":t+="";break;case xp:t+="";break;default:t+=o}}return t}function EE(r){return r+xp+""}function ai(r){const e=r.length;if(ke(e>=2,64408,{path:r}),e===2)return ke(r.charAt(0)===xp&&r.charAt(1)==="",56145,{path:r}),At.emptyPath();const t=e-2,n=[];let i="";for(let o=0;o<e;){const c=r.indexOf(xp,o);switch((c<0||c>t)&&Ee(50515,{path:r}),r.charAt(c+1)){case"":const d=r.substring(o,c);let f;i.length===0?f=d:(i+=d,f=i,i=""),n.push(f);break;case"":i+=r.substring(o,c),i+="\0";break;case"":i+=r.substring(o,c+1);break;default:Ee(61167,{path:r})}o=c+2}return new At(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po="remoteDocuments",Wd="owner",Kl="owner",Cd="mutationQueues",YO="userId",Bs="mutations",TE="batchId",Bo="userMutationsIndex",SE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(r,e){return[r,Nr(e)]}function m2(r,e,t){return[r,Nr(e),t]}const XO={},wc="documentMutations",_p="remoteDocumentsV14",JO=["prefixPath","collectionGroup","readTime","documentId"],Wf="documentKeyIndex",WO=["prefixPath","collectionGroup","documentId"],g2="collectionGroupIndex",ZO=["collectionGroup","readTime","prefixPath","documentId"],Rd="remoteDocumentGlobal",My="remoteDocumentGlobalKey",Ec="targets",y2="queryTargetsIndex",ej=["canonicalId","targetId"],Tc="targetDocuments",tj=["targetId","path"],Vv="documentTargetsIndex",nj=["path","targetId"],wp="targetGlobalKey",Go="targetGlobal",kd="collectionParents",rj=["collectionId","parent"],Sc="clientMetadata",sj="clientId",rm="bundles",ij="bundleId",sm="namedQueries",aj="name",Lv="indexConfiguration",oj="indexId",Vy="collectionGroupIndex",lj="collectionGroup",ud="indexState",cj=["indexId","uid"],v2="sequenceNumberIndex",uj=["uid","sequenceNumber"],dd="indexEntries",dj=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],b2="documentKeyIndex",hj=["indexId","uid","orderedDocumentKey"],im="documentOverlays",fj=["userId","collectionPath","documentId"],Ly="collectionPathOverlayIndex",pj=["userId","collectionPath","largestBatchId"],x2="collectionGroupOverlayIndex",mj=["userId","collectionGroup","largestBatchId"],Uv="globals",gj="name",_2=[Cd,Bs,wc,Po,Ec,Wd,Go,Tc,Sc,Rd,kd,rm,sm],yj=[..._2,im],w2=[Cd,Bs,wc,_p,Ec,Wd,Go,Tc,Sc,Rd,kd,rm,sm,im],E2=w2,zv=[...E2,Lv,ud,dd],vj=zv,T2=[...zv,Uv],bj=T2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy extends h2{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Kn(r,e){const t=Ae(r);return Ka.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ro(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function S2(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,t){this.comparator=e,this.root=t||ur.EMPTY}insert(e,t){return new Gt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ur.BLACK,null,null))}remove(e){return new Gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ur.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rf(this.root,e,this.comparator,!0)}}class Rf{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ur{constructor(e,t,n,i,o){this.key=e,this.value=t,this.color=n??ur.RED,this.left=i??ur.EMPTY,this.right=o??ur.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,o){return new ur(e??this.key,t??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,n),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ur.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ur.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ur.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ur.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ee(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ee(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ee(27949);return e+(this.isRed()?0:1)}}ur.EMPTY=null,ur.RED=!0,ur.BLACK=!1;ur.EMPTY=new class{constructor(){this.size=0}get key(){throw Ee(57766)}get value(){throw Ee(16141)}get color(){throw Ee(16727)}get left(){throw Ee(29726)}get right(){throw Ee(36894)}copy(e,t,n,i,o){return this}insert(e,t,n){return new ur(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.comparator=e,this.data=new Gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new IE(this.data.getIterator())}getIteratorFrom(e){return new IE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof jt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new jt(this.comparator);return t.data=e,t}}class IE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ql(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e){this.fields=e,e.sort(hn.comparator)}static empty(){return new Hr([])}unionWith(e){let t=new jt(hn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Hr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xc(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new N2("Invalid base64 string: "+o):o}})(e);return new Rn(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let c=0;c<i.length;++c)o+=String.fromCharCode(i[c]);return o})(e);return new Rn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rn.EMPTY_BYTE_STRING=new Rn("");const xj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zi(r){if(ke(!!r,39018),typeof r=="string"){let e=0;const t=xj.exec(r);if(ke(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:rn(r.seconds),nanos:rn(r.nanos)}}function rn(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Bi(r){return typeof r=="string"?Rn.fromBase64String(r):Rn.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2="server_timestamp",A2="__type__",C2="__previous_value__",R2="__local_write_time__";function Bv(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[A2])==null?void 0:n.stringValue)===I2}function am(r){const e=r.mapValue.fields[C2];return Bv(e)?am(e):e}function Dd(r){const e=zi(r.mapValue.fields[R2].timestampValue);return new Dt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,t,n,i,o,c,d,f,m,v,b){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=m,this.isUsingEmulator=v,this.apiKey=b}}const Ep="(default)";class Zo{constructor(e,t){this.projectId=e,this.database=t||Ep}static empty(){return new Zo("","")}get isDefaultDatabase(){return this.database===Ep}isEqual(e){return e instanceof Zo&&e.projectId===this.projectId&&e.database===this.database}}function wj(r,e){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new me(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zo(r.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv="__type__",k2="__max__",za={mapValue:{fields:{__type__:{stringValue:k2}}}},Gv="__vector__",Nc="value",Zf={nullValue:"NULL_VALUE"};function Ya(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Bv(r)?4:D2(r)?9007199254740991:om(r)?10:11:Ee(28295,{value:r})}function hi(r,e){if(r===e)return!0;const t=Ya(r);if(t!==Ya(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Dd(r).isEqual(Dd(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const c=zi(i.timestampValue),d=zi(o.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(r,e);case 5:return r.stringValue===e.stringValue;case 6:return(function(i,o){return Bi(i.bytesValue).isEqual(Bi(o.bytesValue))})(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return(function(i,o){return rn(i.geoPointValue.latitude)===rn(o.geoPointValue.latitude)&&rn(i.geoPointValue.longitude)===rn(o.geoPointValue.longitude)})(r,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return rn(i.integerValue)===rn(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const c=rn(i.doubleValue),d=rn(o.doubleValue);return c===d?Ad(c)===Ad(d):isNaN(c)&&isNaN(d)}return!1})(r,e);case 9:return xc(r.arrayValue.values||[],e.arrayValue.values||[],hi);case 10:case 11:return(function(i,o){const c=i.mapValue.fields||{},d=o.mapValue.fields||{};if(NE(c)!==NE(d))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(d[f]===void 0||!hi(c[f],d[f])))return!1;return!0})(r,e);default:return Ee(52216,{left:r})}}function Od(r,e){return(r.values||[]).find((t=>hi(t,e)))!==void 0}function Xa(r,e){if(r===e)return 0;const t=Ya(r),n=Ya(e);if(t!==n)return Ge(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ge(r.booleanValue,e.booleanValue);case 2:return(function(o,c){const d=rn(o.integerValue||o.doubleValue),f=rn(c.integerValue||c.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(r,e);case 3:return AE(r.timestampValue,e.timestampValue);case 4:return AE(Dd(r),Dd(e));case 5:return jy(r.stringValue,e.stringValue);case 6:return(function(o,c){const d=Bi(o),f=Bi(c);return d.compareTo(f)})(r.bytesValue,e.bytesValue);case 7:return(function(o,c){const d=o.split("/"),f=c.split("/");for(let m=0;m<d.length&&m<f.length;m++){const v=Ge(d[m],f[m]);if(v!==0)return v}return Ge(d.length,f.length)})(r.referenceValue,e.referenceValue);case 8:return(function(o,c){const d=Ge(rn(o.latitude),rn(c.latitude));return d!==0?d:Ge(rn(o.longitude),rn(c.longitude))})(r.geoPointValue,e.geoPointValue);case 9:return CE(r.arrayValue,e.arrayValue);case 10:return(function(o,c){var _,S,k,L;const d=o.fields||{},f=c.fields||{},m=(_=d[Nc])==null?void 0:_.arrayValue,v=(S=f[Nc])==null?void 0:S.arrayValue,b=Ge(((k=m==null?void 0:m.values)==null?void 0:k.length)||0,((L=v==null?void 0:v.values)==null?void 0:L.length)||0);return b!==0?b:CE(m,v)})(r.mapValue,e.mapValue);case 11:return(function(o,c){if(o===za.mapValue&&c===za.mapValue)return 0;if(o===za.mapValue)return 1;if(c===za.mapValue)return-1;const d=o.fields||{},f=Object.keys(d),m=c.fields||{},v=Object.keys(m);f.sort(),v.sort();for(let b=0;b<f.length&&b<v.length;++b){const _=jy(f[b],v[b]);if(_!==0)return _;const S=Xa(d[f[b]],m[v[b]]);if(S!==0)return S}return Ge(f.length,v.length)})(r.mapValue,e.mapValue);default:throw Ee(23264,{he:t})}}function AE(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Ge(r,e);const t=zi(r),n=zi(e),i=Ge(t.seconds,n.seconds);return i!==0?i:Ge(t.nanos,n.nanos)}function CE(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const o=Xa(t[i],n[i]);if(o)return o}return Ge(t.length,n.length)}function Ic(r){return zy(r)}function zy(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(t){const n=zi(t);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(t){return Bi(t).toBase64()})(r.bytesValue):"referenceValue"in r?(function(t){return xe.fromName(t).toString()})(r.referenceValue):"geoPointValue"in r?(function(t){return`geo(${t.latitude},${t.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(t){let n="[",i=!0;for(const o of t.values||[])i?i=!1:n+=",",n+=zy(o);return n+"]"})(r.arrayValue):"mapValue"in r?(function(t){const n=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const c of n)o?o=!1:i+=",",i+=`${c}:${zy(t.fields[c])}`;return i+"}"})(r.mapValue):Ee(61005,{value:r})}function ep(r){switch(Ya(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=am(r);return e?16+ep(e):16;case 5:return 2*r.stringValue.length;case 6:return Bi(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,o)=>i+ep(o)),0)})(r.arrayValue);case 10:case 11:return(function(n){let i=0;return ro(n.fields,((o,c)=>{i+=o.length+ep(c)})),i})(r.mapValue);default:throw Ee(13486,{value:r})}}function jd(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function By(r){return!!r&&"integerValue"in r}function Pd(r){return!!r&&"arrayValue"in r}function RE(r){return!!r&&"nullValue"in r}function kE(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function tp(r){return!!r&&"mapValue"in r}function om(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[Fv])==null?void 0:n.stringValue)===Gv}function hd(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return ro(r.mapValue.fields,((t,n)=>e.mapValue.fields[t]=hd(n))),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hd(r.arrayValue.values[t]);return e}return{...r}}function D2(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===k2}const O2={mapValue:{fields:{[Fv]:{stringValue:Gv},[Nc]:{arrayValue:{}}}}};function Ej(r){return"nullValue"in r?Zf:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?jd(Zo.empty(),xe.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?om(r)?O2:{mapValue:{}}:Ee(35942,{value:r})}function Tj(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?jd(Zo.empty(),xe.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?O2:"mapValue"in r?om(r)?{mapValue:{}}:za:Ee(61959,{value:r})}function DE(r,e){const t=Xa(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function OE(r,e){const t=Xa(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.value=e}static empty(){return new Tr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!tp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hd(t)}setAll(e){let t=hn.emptyPath(),n={},i=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,n,i),n={},i=[],t=d.popLast()}c?n[d.lastSegment()]=hd(c):i.push(d.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,n,i)}delete(e){const t=this.field(e.popLast());tp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];tp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){ro(t,((i,o)=>e[i]=o));for(const i of n)delete e[i]}clone(){return new Tr(hd(this.value))}}function j2(r){const e=[];return ro(r.fields,((t,n)=>{const i=new hn([t]);if(tp(n)){const o=j2(n.mapValue).fields;if(o.length===0)e.push(i);else for(const c of o)e.push(i.child(c))}else e.push(i)})),new Hr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,t,n,i,o,c,d){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=o,this.data=c,this.documentState=d}static newInvalidDocument(e){return new _n(e,0,Pe.min(),Pe.min(),Pe.min(),Tr.empty(),0)}static newFoundDocument(e,t,n,i){return new _n(e,1,t,Pe.min(),n,i,0)}static newNoDocument(e,t){return new _n(e,2,t,Pe.min(),Pe.min(),Tr.empty(),0)}static newUnknownDocument(e,t){return new _n(e,3,t,Pe.min(),Pe.min(),Tr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Tr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Tr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,t){this.position=e,this.inclusive=t}}function jE(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const o=e[i],c=r.position[i];if(o.field.isKeyField()?n=xe.comparator(xe.fromName(c.referenceValue),t.key):n=Xa(c,t.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function PE(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!hi(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,t="asc"){this.field=e,this.dir=t}}function Sj(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2{}class dt extends P2{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Nj(e,t,n):t==="array-contains"?new Cj(e,n):t==="in"?new B2(e,n):t==="not-in"?new Rj(e,n):t==="array-contains-any"?new kj(e,n):new dt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Ij(e,n):new Aj(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xa(t,this.value)):t!==null&&Ya(this.value)===Ya(t)&&this.matchesComparison(Xa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ee(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ot extends P2{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ot(e,t)}matches(e){return Cc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Cc(r){return r.op==="and"}function Fy(r){return r.op==="or"}function qv(r){return M2(r)&&Cc(r)}function M2(r){for(const e of r.filters)if(e instanceof Ot)return!1;return!0}function Gy(r){if(r instanceof dt)return r.field.canonicalString()+r.op.toString()+Ic(r.value);if(qv(r))return r.filters.map((e=>Gy(e))).join(",");{const e=r.filters.map((t=>Gy(t))).join(",");return`${r.op}(${e})`}}function V2(r,e){return r instanceof dt?(function(n,i){return i instanceof dt&&n.op===i.op&&n.field.isEqual(i.field)&&hi(n.value,i.value)})(r,e):r instanceof Ot?(function(n,i){return i instanceof Ot&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((o,c,d)=>o&&V2(c,i.filters[d])),!0):!1})(r,e):void Ee(19439)}function L2(r,e){const t=r.filters.concat(e);return Ot.create(t,r.op)}function U2(r){return r instanceof dt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ic(t.value)}`})(r):r instanceof Ot?(function(t){return t.op.toString()+" {"+t.getFilters().map(U2).join(" ,")+"}"})(r):"Filter"}class Nj extends dt{constructor(e,t,n){super(e,t,n),this.key=xe.fromName(n.referenceValue)}matches(e){const t=xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ij extends dt{constructor(e,t){super(e,"in",t),this.keys=z2("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Aj extends dt{constructor(e,t){super(e,"not-in",t),this.keys=z2("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function z2(r,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>xe.fromName(n.referenceValue)))}class Cj extends dt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Pd(t)&&Od(t.arrayValue,this.value)}}class B2 extends dt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Od(this.value.arrayValue,t)}}class Rj extends dt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Od(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Od(this.value.arrayValue,t)}}class kj extends dt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Pd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>Od(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e,t=null,n=[],i=[],o=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=c,this.endAt=d,this.Te=null}}function qy(r,e=null,t=[],n=[],i=null,o=null,c=null){return new Dj(r,e,t,n,i,o,c)}function el(r){const e=Ae(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>Gy(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),nm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>Ic(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>Ic(n))).join(",")),e.Te=t}return e.Te}function Zd(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!Sj(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!V2(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!PE(r.startAt,e.startAt)&&PE(r.endAt,e.endAt)}function Sp(r){return xe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Np(r,e){return r.filters.filter((t=>t instanceof dt&&t.field.isEqual(e)))}function ME(r,e,t){let n=Zf,i=!0;for(const o of Np(r,e)){let c=Zf,d=!0;switch(o.op){case"<":case"<=":c=Ej(o.value);break;case"==":case"in":case">=":c=o.value;break;case">":c=o.value,d=!1;break;case"!=":case"not-in":c=Zf}DE({value:n,inclusive:i},{value:c,inclusive:d})<0&&(n=c,i=d)}if(t!==null){for(let o=0;o<r.orderBy.length;++o)if(r.orderBy[o].field.isEqual(e)){const c=t.position[o];DE({value:n,inclusive:i},{value:c,inclusive:t.inclusive})<0&&(n=c,i=t.inclusive);break}}return{value:n,inclusive:i}}function VE(r,e,t){let n=za,i=!0;for(const o of Np(r,e)){let c=za,d=!0;switch(o.op){case">=":case">":c=Tj(o.value),d=!1;break;case"==":case"in":case"<=":c=o.value;break;case"<":c=o.value,d=!1;break;case"!=":case"not-in":c=za}OE({value:n,inclusive:i},{value:c,inclusive:d})>0&&(n=c,i=d)}if(t!==null){for(let o=0;o<r.orderBy.length;++o)if(r.orderBy[o].field.isEqual(e)){const c=t.position[o];OE({value:n,inclusive:i},{value:c,inclusive:t.inclusive})>0&&(n=c,i=t.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,t=null,n=[],i=[],o=null,c="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=c,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function F2(r,e,t,n,i,o,c,d){return new eh(r,e,t,n,i,o,c,d)}function th(r){return new eh(r)}function LE(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Oj(r){return xe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function G2(r){return r.collectionGroup!==null}function fd(r){const e=Ae(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new jt(hn.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Tp(o,n))})),t.has(hn.keyField().canonicalString())||e.Ie.push(new Tp(hn.keyField(),n))}return e.Ie}function ls(r){const e=Ae(r);return e.Ee||(e.Ee=jj(e,fd(r))),e.Ee}function jj(r,e){if(r.limitType==="F")return qy(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new Tp(i.field,o)}));const t=r.endAt?new Ac(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Ac(r.startAt.position,r.startAt.inclusive):null;return qy(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Hy(r,e){const t=r.filters.concat([e]);return new eh(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function $y(r,e,t){return new eh(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function lm(r,e){return Zd(ls(r),ls(e))&&r.limitType===e.limitType}function q2(r){return`${el(ls(r))}|lt:${r.limitType}`}function sc(r){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((i=>U2(i))).join(", ")}]`),nm(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((i=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(i))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((i=>Ic(i))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((i=>Ic(i))).join(",")),`Target(${n})`})(ls(r))}; limitType=${r.limitType})`}function nh(r,e){return e.isFoundDocument()&&(function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):xe.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(r,e)&&(function(n,i){for(const o of fd(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(r,e)&&(function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0})(r,e)&&(function(n,i){return!(n.startAt&&!(function(c,d,f){const m=jE(c,d,f);return c.inclusive?m<=0:m<0})(n.startAt,fd(n),i)||n.endAt&&!(function(c,d,f){const m=jE(c,d,f);return c.inclusive?m>=0:m>0})(n.endAt,fd(n),i))})(r,e)}function H2(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function $2(r){return(e,t)=>{let n=!1;for(const i of fd(r)){const o=Pj(i,e,t);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function Pj(r,e,t){const n=r.field.isKeyField()?xe.comparator(e.key,t.key):(function(o,c,d){const f=c.data.field(o),m=d.data.field(o);return f!==null&&m!==null?Xa(f,m):Ee(42886)})(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ee(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ro(this.inner,((t,n)=>{for(const[i,o]of n)e(i,o)}))}isEmpty(){return S2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj=new Gt(xe.comparator);function as(){return Mj}const K2=new Gt(xe.comparator);function td(...r){let e=K2;for(const t of r)e=e.insert(t.key,t);return e}function Q2(r){let e=K2;return r.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function oi(){return pd()}function Y2(){return pd()}function pd(){return new Hi((r=>r.toString()),((r,e)=>r.isEqual(e)))}const Vj=new Gt(xe.comparator),Lj=new jt(xe.comparator);function tt(...r){let e=Lj;for(const t of r)e=e.add(t);return e}const Uj=new jt(Ge);function Hv(){return Uj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $v(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ad(e)?"-0":e}}function X2(r){return{integerValue:""+r}}function zj(r,e){return p2(e)?X2(e):$v(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(){this._=void 0}}function Bj(r,e,t){return r instanceof Md?(function(i,o){const c={fields:{[A2]:{stringValue:I2},[R2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Bv(o)&&(o=am(o)),o&&(c.fields[C2]=o),{mapValue:c}})(t,e):r instanceof Rc?W2(r,e):r instanceof kc?Z2(r,e):(function(i,o){const c=J2(i,o),d=UE(c)+UE(i.Ae);return By(c)&&By(i.Ae)?X2(d):$v(i.serializer,d)})(r,e)}function Fj(r,e,t){return r instanceof Rc?W2(r,e):r instanceof kc?Z2(r,e):t}function J2(r,e){return r instanceof Vd?(function(n){return By(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(e)?e:{integerValue:0}:null}class Md extends cm{}class Rc extends cm{constructor(e){super(),this.elements=e}}function W2(r,e){const t=eI(e);for(const n of r.elements)t.some((i=>hi(i,n)))||t.push(n);return{arrayValue:{values:t}}}class kc extends cm{constructor(e){super(),this.elements=e}}function Z2(r,e){let t=eI(e);for(const n of r.elements)t=t.filter((i=>!hi(i,n)));return{arrayValue:{values:t}}}class Vd extends cm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function UE(r){return rn(r.integerValue||r.doubleValue)}function eI(r){return Pd(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj{constructor(e,t){this.field=e,this.transform=t}}function qj(r,e){return r.field.isEqual(e.field)&&(function(n,i){return n instanceof Rc&&i instanceof Rc||n instanceof kc&&i instanceof kc?xc(n.elements,i.elements,hi):n instanceof Vd&&i instanceof Vd?hi(n.Ae,i.Ae):n instanceof Md&&i instanceof Md})(r.transform,e.transform)}class Hj{constructor(e,t){this.version=e,this.transformResults=t}}class Sr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Sr}static exists(e){return new Sr(void 0,e)}static updateTime(e){return new Sr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function np(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class um{}function tI(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new dm(r.key,Sr.none()):new Gc(r.key,r.data,Sr.none());{const t=r.data,n=Tr.empty();let i=new jt(hn.comparator);for(let o of e.fields)if(!i.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?n.delete(o):n.set(o,c),i=i.add(o)}return new $i(r.key,n,new Hr(i.toArray()),Sr.none())}}function $j(r,e,t){r instanceof Gc?(function(i,o,c){const d=i.value.clone(),f=BE(i.fieldTransforms,o,c.transformResults);d.setAll(f),o.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(r,e,t):r instanceof $i?(function(i,o,c){if(!np(i.precondition,o))return void o.convertToUnknownDocument(c.version);const d=BE(i.fieldTransforms,o,c.transformResults),f=o.data;f.setAll(nI(i)),f.setAll(d),o.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(r,e,t):(function(i,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function md(r,e,t,n){return r instanceof Gc?(function(o,c,d,f){if(!np(o.precondition,c))return d;const m=o.value.clone(),v=FE(o.fieldTransforms,f,c);return m.setAll(v),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(r,e,t,n):r instanceof $i?(function(o,c,d,f){if(!np(o.precondition,c))return d;const m=FE(o.fieldTransforms,f,c),v=c.data;return v.setAll(nI(o)),v.setAll(m),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),d===null?null:d.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((b=>b.field)))})(r,e,t,n):(function(o,c,d){return np(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(r,e,t)}function Kj(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),o=J2(n.transform,i||null);o!=null&&(t===null&&(t=Tr.empty()),t.set(n.field,o))}return t||null}function zE(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&xc(n,i,((o,c)=>qj(o,c)))})(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Gc extends um{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class $i extends um{constructor(e,t,n,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function nI(r){const e=new Map;return r.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}})),e}function BE(r,e,t){const n=new Map;ke(r.length===t.length,32656,{Ve:t.length,de:r.length});for(let i=0;i<t.length;i++){const o=r[i],c=o.transform,d=e.data.field(o.field);n.set(o.field,Fj(c,d,t[i]))}return n}function FE(r,e,t){const n=new Map;for(const i of r){const o=i.transform,c=t.data.field(i.field);n.set(i.field,Bj(o,c,e))}return n}class dm extends um{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rI extends um{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&$j(o,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=md(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=md(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Y2();return this.mutations.forEach((i=>{const o=e.get(i.key),c=o.overlayedDocument;let d=this.applyToLocalView(c,o.mutatedFields);d=t.has(i.key)?null:d;const f=tI(c,d);f!==null&&n.set(i.key,f),c.isValidDocument()||c.convertToNoDocument(Pe.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),tt())}isEqual(e){return this.batchId===e.batchId&&xc(this.mutations,e.mutations,((t,n)=>zE(t,n)))&&xc(this.baseMutations,e.baseMutations,((t,n)=>zE(t,n)))}}class Qv{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ke(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=(function(){return Vj})();const o=e.mutations;for(let c=0;c<o.length;c++)i=i.insert(o[c].key,n[c].version);return new Qv(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ln,bt;function Yj(r){switch(r){case ie.OK:return Ee(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Ee(15467,{code:r})}}function sI(r){if(r===void 0)return Cn("GRPC error has no .code"),ie.UNKNOWN;switch(r){case Ln.OK:return ie.OK;case Ln.CANCELLED:return ie.CANCELLED;case Ln.UNKNOWN:return ie.UNKNOWN;case Ln.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case Ln.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case Ln.INTERNAL:return ie.INTERNAL;case Ln.UNAVAILABLE:return ie.UNAVAILABLE;case Ln.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case Ln.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case Ln.NOT_FOUND:return ie.NOT_FOUND;case Ln.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case Ln.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case Ln.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case Ln.ABORTED:return ie.ABORTED;case Ln.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case Ln.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case Ln.DATA_LOSS:return ie.DATA_LOSS;default:return Ee(39323,{code:r})}}(bt=Ln||(Ln={}))[bt.OK=0]="OK",bt[bt.CANCELLED=1]="CANCELLED",bt[bt.UNKNOWN=2]="UNKNOWN",bt[bt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",bt[bt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",bt[bt.NOT_FOUND=5]="NOT_FOUND",bt[bt.ALREADY_EXISTS=6]="ALREADY_EXISTS",bt[bt.PERMISSION_DENIED=7]="PERMISSION_DENIED",bt[bt.UNAUTHENTICATED=16]="UNAUTHENTICATED",bt[bt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",bt[bt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",bt[bt.ABORTED=10]="ABORTED",bt[bt.OUT_OF_RANGE=11]="OUT_OF_RANGE",bt[bt.UNIMPLEMENTED=12]="UNIMPLEMENTED",bt[bt.INTERNAL=13]="INTERNAL",bt[bt.UNAVAILABLE=14]="UNAVAILABLE",bt[bt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=new $a([4294967295,4294967295],0);function GE(r){const e=Xj().encode(r),t=new ZN;return t.update(e),new Uint8Array(t.digest())}function qE(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new $a([t,n],0),new $a([i,o],0)]}class Xv{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new nd(`Invalid padding: ${t}`);if(n<0)throw new nd(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new nd(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new nd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=$a.fromNumber(this.ge)}ye(e,t,n){let i=e.add(t.multiply($a.fromNumber(n)));return i.compare(Jj)===1&&(i=new $a([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=GE(e),[n,i]=qE(t);for(let o=0;o<this.hashCount;o++){const c=this.ye(n,i,o);if(!this.we(c))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new Xv(o,i,t);return n.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const t=GE(e),[n,i]=qE(t);for(let o=0;o<this.hashCount;o++){const c=this.ye(n,i,o);this.be(c)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class nd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t,n,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,sh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new rh(Pe.min(),i,new Gt(Ge),as(),tt())}}class sh{constructor(e,t,n,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new sh(n,t,tt(),tt(),tt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,t,n,i){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=i}}class iI{constructor(e,t){this.targetId=e,this.Ce=t}}class aI{constructor(e,t,n=Rn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class HE{constructor(){this.ve=0,this.Fe=$E(),this.Me=Rn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=tt(),t=tt(),n=tt();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Ee(38017,{changeType:o})}})),new sh(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=$E()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,ke(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class Wj{constructor(e){this.Ge=e,this.ze=new Map,this.je=as(),this.He=kf(),this.Je=kf(),this.Ze=new Gt(Ge)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Ee(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,n=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(Sp(o))if(n===0){const c=new xe(o.path);this.et(t,c,_n.newNoDocument(c,Pe.min()))}else ke(n===1,20013,{expectedCount:n});else{const c=this._t(t);if(c!==n){const d=this.ut(e),f=d?this.ct(d,e,c):1;if(f!==0){this.it(t);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=t;let c,d;try{c=Bi(n).toUint8Array()}catch(f){if(f instanceof N2)return bc("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new Xv(c,i,o)}catch(f){return bc(f instanceof nd?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let i=0;return n.forEach((o=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(d)||(this.et(t,o,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((o,c)=>{const d=this.ot(c);if(d){if(o.current&&Sp(d.target)){const f=new xe(d.target.path);this.It(f).has(c)||this.Et(c,f)||this.et(c,f,_n.newNoDocument(f,e))}o.Be&&(t.set(c,o.ke()),o.Ke())}}));let n=tt();this.Je.forEach(((o,c)=>{let d=!0;c.forEachWhile((f=>{const m=this.ot(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(n=n.add(o))})),this.je.forEach(((o,c)=>c.setReadTime(e)));const i=new rh(e,t,this.Ze,this.je,n);return this.je=as(),this.He=kf(),this.Je=kf(),this.Ze=new Gt(Ge),i}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new HE,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new jt(Ge),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new jt(Ge),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||de("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new HE),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function kf(){return new Gt(xe.comparator)}function $E(){return new Gt(xe.comparator)}const Zj={asc:"ASCENDING",desc:"DESCENDING"},eP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tP={and:"AND",or:"OR"};class nP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ky(r,e){return r.useProto3Json||nm(e)?e:{value:e}}function Dc(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oI(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function rP(r,e){return Dc(r,e.toTimestamp())}function Dr(r){return ke(!!r,49232),Pe.fromTimestamp((function(t){const n=zi(t);return new Dt(n.seconds,n.nanos)})(r))}function Jv(r,e){return Qy(r,e).canonicalString()}function Qy(r,e){const t=(function(i){return new At(["projects",i.projectId,"databases",i.database])})(r).child("documents");return e===void 0?t:t.child(e)}function lI(r){const e=At.fromString(r);return ke(yI(e),10190,{key:e.toString()}),e}function Ip(r,e){return Jv(r.databaseId,e.path)}function qo(r,e){const t=lI(e);if(t.get(1)!==r.databaseId.projectId)throw new me(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new me(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new xe(dI(t))}function cI(r,e){return Jv(r.databaseId,e)}function uI(r){const e=lI(r);return e.length===4?At.emptyPath():dI(e)}function Yy(r){return new At(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function dI(r){return ke(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function KE(r,e,t){return{name:Ip(r,e),fields:t.value.mapValue.fields}}function sP(r,e,t){const n=qo(r,e.name),i=Dr(e.updateTime),o=e.createTime?Dr(e.createTime):Pe.min(),c=new Tr({mapValue:{fields:e.fields}}),d=_n.newFoundDocument(n,i,o,c);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function iP(r,e){let t;if("targetChange"in e){e.targetChange;const n=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ee(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(m,v){return m.useProto3Json?(ke(v===void 0||typeof v=="string",58123),Rn.fromBase64String(v||"")):(ke(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),Rn.fromUint8Array(v||new Uint8Array))})(r,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(m){const v=m.code===void 0?ie.UNKNOWN:sI(m.code);return new me(v,m.message||"")})(c);t=new aI(n,i,o,d||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=qo(r,n.document.name),o=Dr(n.document.updateTime),c=n.document.createTime?Dr(n.document.createTime):Pe.min(),d=new Tr({mapValue:{fields:n.document.fields}}),f=_n.newFoundDocument(i,o,c,d),m=n.targetIds||[],v=n.removedTargetIds||[];t=new rp(m,v,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=qo(r,n.document),o=n.readTime?Dr(n.readTime):Pe.min(),c=_n.newNoDocument(i,o),d=n.removedTargetIds||[];t=new rp([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=qo(r,n.document),o=n.removedTargetIds||[];t=new rp([],o,i,null)}else{if(!("filter"in e))return Ee(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,c=new Qj(i,o),d=n.targetId;t=new iI(d,c)}}return t}function Ap(r,e){let t;if(e instanceof Gc)t={update:KE(r,e.key,e.value)};else if(e instanceof dm)t={delete:Ip(r,e.key)};else if(e instanceof $i)t={update:KE(r,e.key,e.data),updateMask:dP(e.fieldMask)};else{if(!(e instanceof rI))return Ee(16599,{dt:e.type});t={verify:Ip(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(o,c){const d=c.transform;if(d instanceof Md)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Rc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof kc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Vd)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw Ee(20930,{transform:c.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:rP(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ee(27497)})(r,e.precondition)),t}function Xy(r,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?Sr.updateTime(Dr(o.updateTime)):o.exists!==void 0?Sr.exists(o.exists):Sr.none()})(e.currentDocument):Sr.none(),n=e.updateTransforms?e.updateTransforms.map((i=>(function(c,d){let f=null;if("setToServerValue"in d)ke(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new Md;else if("appendMissingElements"in d){const v=d.appendMissingElements.values||[];f=new Rc(v)}else if("removeAllFromArray"in d){const v=d.removeAllFromArray.values||[];f=new kc(v)}else"increment"in d?f=new Vd(c,d.increment):Ee(16584,{proto:d});const m=hn.fromServerFormat(d.fieldPath);return new Gj(m,f)})(r,i))):[];if(e.update){e.update.name;const i=qo(r,e.update.name),o=new Tr({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(f){const m=f.fieldPaths||[];return new Hr(m.map((v=>hn.fromServerFormat(v))))})(e.updateMask);return new $i(i,o,c,t,n)}return new Gc(i,o,t,n)}if(e.delete){const i=qo(r,e.delete);return new dm(i,t)}if(e.verify){const i=qo(r,e.verify);return new rI(i,t)}return Ee(1463,{proto:e})}function aP(r,e){return r&&r.length>0?(ke(e!==void 0,14353),r.map((t=>(function(i,o){let c=i.updateTime?Dr(i.updateTime):Dr(o);return c.isEqual(Pe.min())&&(c=Dr(o)),new Hj(c,i.transformResults||[])})(t,e)))):[]}function hI(r,e){return{documents:[cI(r,e.path)]}}function fI(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=cI(r,i);const o=(function(m){if(m.length!==0)return gI(Ot.create(m,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(m){if(m.length!==0)return m.map((v=>(function(_){return{field:ic(_.field),direction:lP(_.dir)}})(v)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Ky(r,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:i}}function pI(r){let e=uI(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){ke(n===1,65062);const v=t.from[0];v.allDescendants?i=v.collectionId:e=e.child(v.collectionId)}let o=[];t.where&&(o=(function(b){const _=mI(b);return _ instanceof Ot&&qv(_)?_.getFilters():[_]})(t.where));let c=[];t.orderBy&&(c=(function(b){return b.map((_=>(function(k){return new Tp(ac(k.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(_)))})(t.orderBy));let d=null;t.limit&&(d=(function(b){let _;return _=typeof b=="object"?b.value:b,nm(_)?null:_})(t.limit));let f=null;t.startAt&&(f=(function(b){const _=!!b.before,S=b.values||[];return new Ac(S,_)})(t.startAt));let m=null;return t.endAt&&(m=(function(b){const _=!b.before,S=b.values||[];return new Ac(S,_)})(t.endAt)),F2(e,i,c,o,d,"F",f,m)}function oP(r,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ee(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function mI(r){return r.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=ac(t.unaryFilter.field);return dt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ac(t.unaryFilter.field);return dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ac(t.unaryFilter.field);return dt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=ac(t.unaryFilter.field);return dt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ee(61313);default:return Ee(60726)}})(r):r.fieldFilter!==void 0?(function(t){return dt.create(ac(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ee(58110);default:return Ee(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(t){return Ot.create(t.compositeFilter.filters.map((n=>mI(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ee(1026)}})(t.compositeFilter.op))})(r):Ee(30097,{filter:r})}function lP(r){return Zj[r]}function cP(r){return eP[r]}function uP(r){return tP[r]}function ic(r){return{fieldPath:r.canonicalString()}}function ac(r){return hn.fromServerFormat(r.fieldPath)}function gI(r){return r instanceof dt?(function(t){if(t.op==="=="){if(kE(t.value))return{unaryFilter:{field:ic(t.field),op:"IS_NAN"}};if(RE(t.value))return{unaryFilter:{field:ic(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(kE(t.value))return{unaryFilter:{field:ic(t.field),op:"IS_NOT_NAN"}};if(RE(t.value))return{unaryFilter:{field:ic(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ic(t.field),op:cP(t.op),value:t.value}}})(r):r instanceof Ot?(function(t){const n=t.getFilters().map((i=>gI(i)));return n.length===1?n[0]:{compositeFilter:{op:uP(t.op),filters:n}}})(r):Ee(54877,{filter:r})}function dP(r){const e=[];return r.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function yI(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}function vI(r){return!!r&&typeof r._toProto=="function"&&r._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,t,n,i,o=Pe.min(),c=Pe.min(),d=Rn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new Mi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e){this.yt=e}}function hP(r,e){let t;if(e.document)t=sP(r.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=xe.fromSegments(e.noDocument.path),i=nl(e.noDocument.readTime);t=_n.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ee(56709);{const n=xe.fromSegments(e.unknownDocument.path),i=nl(e.unknownDocument.version);t=_n.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime((function(i){const o=new Dt(i[0],i[1]);return Pe.fromTimestamp(o)})(e.readTime)),t}function QE(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Cp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(o,c){return{name:Ip(o,c.key),fields:c.data.value.mapValue.fields,updateTime:Dc(o,c.version.toTimestamp()),createTime:Dc(o,c.createTime.toTimestamp())}})(r.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:tl(e.version)};else{if(!e.isUnknownDocument())return Ee(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:tl(e.version)}}return n}function Cp(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function tl(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function nl(r){const e=new Dt(r.seconds,r.nanoseconds);return Pe.fromTimestamp(e)}function Vo(r,e){const t=(e.baseMutations||[]).map((o=>Xy(r.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const c=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const d=e.mutations[o+1];c.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const n=e.mutations.map((o=>Xy(r.yt,o))),i=Dt.fromMillis(e.localWriteTimeMs);return new Kv(e.batchId,i,t,n)}function rd(r){const e=nl(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?nl(r.lastLimboFreeSnapshotVersion):Pe.min();let n;return n=(function(o){return o.documents!==void 0})(r.query)?(function(o){const c=o.documents.length;return ke(c===1,1966,{count:c}),ls(th(uI(o.documents[0])))})(r.query):(function(o){return ls(pI(o))})(r.query),new Mi(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Rn.fromBase64String(r.resumeToken))}function xI(r,e){const t=tl(e.snapshotVersion),n=tl(e.lastLimboFreeSnapshotVersion);let i;i=Sp(e.target)?hI(r.yt,e.target):fI(r.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:el(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function _I(r){const e=pI({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?$y(e,e.limit,"L"):e}function ry(r,e){return new Yv(e.largestBatchId,Xy(r.yt,e.overlayMutation))}function YE(r,e){const t=e.path.lastSegment();return[r,Nr(e.path.popLast()),t]}function XE(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:tl(n.readTime),documentKey:Nr(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{getBundleMetadata(e,t){return JE(e).get(t).next((n=>{if(n)return(function(o){return{id:o.bundleId,createTime:nl(o.createTime),version:o.version}})(n)}))}saveBundleMetadata(e,t){return JE(e).put((function(i){return{bundleId:i.id,createTime:tl(Dr(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return WE(e).get(t).next((n=>{if(n)return(function(o){return{name:o.name,query:_I(o.bundledQuery),readTime:nl(o.readTime)}})(n)}))}saveNamedQuery(e,t){return WE(e).put((function(i){return{name:i.name,readTime:tl(Dr(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function JE(r){return Kn(r,rm)}function WE(r){return Kn(r,sm)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new hm(e,n)}getOverlay(e,t){return Gu(e).get(YE(this.userId,t)).next((n=>n?ry(this.serializer,n):null))}getOverlays(e,t){const n=oi();return q.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&n.set(i,o)})))).next((()=>n))}saveOverlays(e,t,n){const i=[];return n.forEach(((o,c)=>{const d=new Yv(t,c);i.push(this.bt(e,d))})),q.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach((c=>i.add(Nr(c.getCollectionPath()))));const o=[];return i.forEach((c=>{const d=IDBKeyRange.bound([this.userId,c,n],[this.userId,c,n+1],!1,!0);o.push(Gu(e).X(Ly,d))})),q.waitFor(o)}getOverlaysForCollection(e,t,n){const i=oi(),o=Nr(t),c=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Gu(e).H(Ly,c).next((d=>{for(const f of d){const m=ry(this.serializer,f);i.set(m.getKey(),m)}return i}))}getOverlaysForCollectionGroup(e,t,n,i){const o=oi();let c;const d=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Gu(e).ee({index:x2,range:d},((f,m,v)=>{const b=ry(this.serializer,m);o.size()<i||b.largestBatchId===c?(o.set(b.getKey(),b),c=b.largestBatchId):v.done()})).next((()=>o))}bt(e,t){return Gu(e).put((function(i,o,c){const[d,f,m]=YE(o,c.mutation.key);return{userId:o,collectionPath:f,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:Ap(i.yt,c.mutation)}})(this.serializer,this.userId,t))}}function Gu(r){return Kn(r,im)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{St(e){return Kn(e,Uv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const n=t==null?void 0:t.value;return n?Rn.fromUint8Array(n):Rn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(rn(e.integerValue));else if("doubleValue"in e){const n=rn(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Ad(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=zi(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Bi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?D2(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):om(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):Ee(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const n=e.fields||{};this.Ft(t,55);for(const i of Object.keys(n))this.Ot(i,t),this.Ct(n[i],t)}kt(e,t){var c,d;const n=e.fields||{};this.Ft(t,53);const i=Nc,o=((d=(c=n[i].arrayValue)==null?void 0:c.values)==null?void 0:d.length)||0;this.Ft(t,15),t.Mt(rn(o)),this.Ot(i,t),this.Ct(n[i],t)}qt(e,t){const n=e.values||[];this.Ft(t,50);for(const i of n)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),xe.fromName(e).path.forEach((n=>{this.Ft(t,60),this.$t(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Lo.Wt=new Lo;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=255;function mP(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function ZE(r){const e=64-(function(n){let i=0;for(let o=0;o<8;++o){const c=mP(255&n[o]);if(i+=c,c!==8)break}return i})(r);return Math.ceil(e/8)}class gP{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ht(n.value),n=t.next();this.Jt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Xt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ht(n);else if(n<2048)this.Ht(960|n>>>6),this.Ht(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|n>>>12),this.Ht(128|63&n>>>6),this.Ht(128|63&n);else{const i=t.codePointAt(0);this.Ht(240|i>>>18),this.Ht(128|63&i>>>12),this.Ht(128|63&i>>>6),this.Ht(128|63&i)}}this.Jt()}Yt(e){const t=this.en(e),n=ZE(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),n=ZE(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Yl),this.sn(255)}_n(){this.an(Yl),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(o){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,o,!1),new Uint8Array(c.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Yl?(this.sn(Yl),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Yl?(this.an(Yl),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class yP{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class vP{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class qu{constructor(){this.cn=new gP,this.ascending=new yP(this.cn),this.descending=new vP(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,t,n,i){this.hn=e,this.Pn=t,this.Tn=n,this.In=i}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.In,0),t!==e?n.set([0],this.In.length):++n[n.length-1],new Uo(this.hn,this.Pn,this.Tn,n)}Rn(e,t,n){return{indexId:this.hn,uid:e,arrayValue:sp(this.Tn),directionalValue:sp(this.In),orderedDocumentKey:sp(t),documentKey:n.path.toArray()}}An(e,t,n){const i=this.Rn(e,t,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Aa(r,e){let t=r.hn-e.hn;return t!==0?t:(t=eT(r.Tn,e.Tn),t!==0?t:(t=eT(r.In,e.In),t!==0?t:xe.comparator(r.Pn,e.Pn)))}function eT(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function sp(r){return hN()?(function(t){let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);return n})(r):r}function tT(r){return typeof r!="string"?r:(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(r)}class nT{constructor(e){this.Vn=new jt(((t,n)=>hn.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const n=t;n.isInequality()?this.Vn=this.Vn.add(n):this.mn.push(n)}}get fn(){return this.Vn.size>1}gn(e){if(ke(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=Py(e);if(t!==void 0&&!this.pn(t))return!1;const n=jo(e);let i=new Set,o=0,c=0;for(;o<n.length&&this.pn(n[o]);++o)i=i.add(n[o].fieldPath.canonicalString());if(o===n.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!i.has(d.field.canonicalString())){const f=n[o];if(!this.yn(d,f)||!this.wn(this.dn[c++],f))return!1}++o}for(;o<n.length;++o){const d=n[o];if(c>=this.dn.length||!this.wn(this.dn[c++],d))return!1}return!0}bn(){if(this.fn)return null;let e=new jt(hn.comparator);const t=[];for(const n of this.mn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Xf(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Xf(n.field,0))}for(const n of this.dn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Xf(n.field,n.dir==="asc"?0:1)));return new bp(bp.UNKNOWN_ID,this.collectionId,t,Id.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(r){var t,n;if(ke(r instanceof dt||r instanceof Ot,20012),r instanceof dt){if(r instanceof B2){const i=((n=(t=r.value.arrayValue)==null?void 0:t.values)==null?void 0:n.map((o=>dt.create(r.field,"==",o))))||[];return Ot.create(i,"or")}return r}const e=r.filters.map((i=>wI(i)));return Ot.create(e,r.op)}function bP(r){if(r.getFilters().length===0)return[];const e=Zy(wI(r));return ke(EI(e),7391),Jy(e)||Wy(e)?[e]:e.getFilters()}function Jy(r){return r instanceof dt}function Wy(r){return r instanceof Ot&&qv(r)}function EI(r){return Jy(r)||Wy(r)||(function(t){if(t instanceof Ot&&Fy(t)){for(const n of t.getFilters())if(!Jy(n)&&!Wy(n))return!1;return!0}return!1})(r)}function Zy(r){if(ke(r instanceof dt||r instanceof Ot,34018),r instanceof dt)return r;if(r.filters.length===1)return Zy(r.filters[0]);const e=r.filters.map((n=>Zy(n)));let t=Ot.create(e,r.op);return t=Rp(t),EI(t)?t:(ke(t instanceof Ot,64498),ke(Cc(t),40251),ke(t.filters.length>1,57927),t.filters.reduce(((n,i)=>Wv(n,i))))}function Wv(r,e){let t;return ke(r instanceof dt||r instanceof Ot,38388),ke(e instanceof dt||e instanceof Ot,25473),t=r instanceof dt?e instanceof dt?(function(i,o){return Ot.create([i,o],"and")})(r,e):rT(r,e):e instanceof dt?rT(e,r):(function(i,o){if(ke(i.filters.length>0&&o.filters.length>0,48005),Cc(i)&&Cc(o))return L2(i,o.getFilters());const c=Fy(i)?i:o,d=Fy(i)?o:i,f=c.filters.map((m=>Wv(m,d)));return Ot.create(f,"or")})(r,e),Rp(t)}function rT(r,e){if(Cc(e))return L2(e,r.getFilters());{const t=e.filters.map((n=>Wv(r,n)));return Ot.create(t,"or")}}function Rp(r){if(ke(r instanceof dt||r instanceof Ot,11850),r instanceof dt)return r;const e=r.getFilters();if(e.length===1)return Rp(e[0]);if(M2(r))return r;const t=e.map((i=>Rp(i))),n=[];return t.forEach((i=>{i instanceof dt?n.push(i):i instanceof Ot&&(i.op===r.op?n.push(...i.filters):n.push(i))})),n.length===1?n[0]:Ot.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(){this.Sn=new Zv}addToCollectionParentIndex(e,t){return this.Sn.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(cs.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(cs.min())}updateCollectionGroup(e,t,n){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class Zv{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new jt(At.comparator),o=!i.has(n);return this.index[t]=i.add(n),o}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new jt(At.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="IndexedDbIndexManager",Df=new Uint8Array(0);class _P{constructor(e,t){this.databaseId=t,this.Dn=new Zv,this.Cn=new Hi((n=>el(n)),((n,i)=>Zd(n,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const o={collectionId:n,parent:Nr(i)};return iT(e).put(o)}return q.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[a2(t),""],!1,!0);return iT(e).H(i).next((o=>{for(const c of o){if(c.collectionId!==t)break;n.push(ai(c.parent))}return n}))}addFieldIndex(e,t){const n=Hu(e),i=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete i.indexId;const o=n.add(i);if(t.indexState){const c=Jl(e);return o.next((d=>{c.put(XE(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const n=Hu(e),i=Jl(e),o=Xl(e);return n.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Hu(e),n=Xl(e),i=Jl(e);return t.X().next((()=>n.X())).next((()=>i.X()))}createTargetIndexes(e,t){return q.forEach(this.vn(t),(n=>this.getIndexType(e,n).next((i=>{if(i===0||i===1){const o=new nT(n).bn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const n=Xl(e);let i=!0;const o=new Map;return q.forEach(this.vn(t),(c=>this.Fn(e,c).next((d=>{i&&(i=!!d),o.set(c,d)})))).next((()=>{if(i){let c=tt();const d=[];return q.forEach(o,((f,m)=>{de(sT,`Using index ${(function(ee){return`id=${ee.indexId}|cg=${ee.collectionGroup}|f=${ee.fields.map((le=>`${le.fieldPath}:${le.kind}`)).join(",")}`})(f)} to execute ${el(t)}`);const v=(function(ee,le){const fe=Py(le);if(fe===void 0)return null;for(const ce of Np(ee,fe.fieldPath))switch(ce.op){case"array-contains-any":return ce.value.arrayValue.values||[];case"array-contains":return[ce.value]}return null})(m,f),b=(function(ee,le){const fe=new Map;for(const ce of jo(le))for(const C of Np(ee,ce.fieldPath))switch(C.op){case"==":case"in":fe.set(ce.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return fe.set(ce.fieldPath.canonicalString(),C.value),Array.from(fe.values())}return null})(m,f),_=(function(ee,le){const fe=[];let ce=!0;for(const C of jo(le)){const I=C.kind===0?ME(ee,C.fieldPath,ee.startAt):VE(ee,C.fieldPath,ee.startAt);fe.push(I.value),ce&&(ce=I.inclusive)}return new Ac(fe,ce)})(m,f),S=(function(ee,le){const fe=[];let ce=!0;for(const C of jo(le)){const I=C.kind===0?VE(ee,C.fieldPath,ee.endAt):ME(ee,C.fieldPath,ee.endAt);fe.push(I.value),ce&&(ce=I.inclusive)}return new Ac(fe,ce)})(m,f),k=this.Mn(f,m,_),L=this.Mn(f,m,S),B=this.xn(f,m,b),X=this.On(f.indexId,v,k,_.inclusive,L,S.inclusive,B);return q.forEach(X,(re=>n.Z(re,t.limit).next((ee=>{ee.forEach((le=>{const fe=xe.fromSegments(le.documentKey);c.has(fe)||(c=c.add(fe),d.push(fe))}))}))))})).next((()=>d))}return q.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=bP(Ot.create(e.filters,"and")).map((n=>qy(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,n,i,o,c,d){const f=(t!=null?t.length:1)*Math.max(n.length,o.length),m=f/(t!=null?t.length:1),v=[];for(let b=0;b<f;++b){const _=t?this.Nn(t[b/m]):Df,S=this.Bn(e,_,n[b%m],i),k=this.Ln(e,_,o[b%m],c),L=d.map((B=>this.Bn(e,_,B,!0)));v.push(...this.createRange(S,k,L))}return v}Bn(e,t,n,i){const o=new Uo(e,xe.empty(),t,n);return i?o:o.En()}Ln(e,t,n,i){const o=new Uo(e,xe.empty(),t,n);return i?o.En():o}Fn(e,t){const n=new nT(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((o=>{let c=null;for(const d of o)n.gn(d)&&(!c||d.fields.length>c.fields.length)&&(c=d);return c}))}getIndexType(e,t){let n=2;const i=this.vn(t);return q.forEach(i,(o=>this.Fn(e,o).next((c=>{c?n!==0&&c.fields.length<(function(f){let m=new jt(hn.comparator),v=!1;for(const b of f.filters)for(const _ of b.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?v=!0:m=m.add(_.field));for(const b of f.orderBy)b.field.isKeyField()||(m=m.add(b.field));return m.size+(v?1:0)})(o)&&(n=1):n=0})))).next((()=>(function(c){return c.limit!==null})(t)&&i.length>1&&n===2?1:n))}kn(e,t){const n=new qu;for(const i of jo(e)){const o=t.data.field(i.fieldPath);if(o==null)return null;const c=n.ln(i.kind);Lo.Wt.Dt(o,c)}return n.un()}Nn(e){const t=new qu;return Lo.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const n=new qu;return Lo.Wt.Dt(jd(this.databaseId,t),n.ln((function(o){const c=jo(o);return c.length===0?0:c[c.length-1].kind})(e))),n.un()}xn(e,t,n){if(n===null)return[];let i=[];i.push(new qu);let o=0;for(const c of jo(e)){const d=n[o++];for(const f of i)if(this.qn(t,c.fieldPath)&&Pd(d))i=this.Un(i,c,d);else{const m=f.ln(c.kind);Lo.Wt.Dt(d,m)}}return this.$n(i)}Mn(e,t,n){return this.xn(e,t,n.position)}$n(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Un(e,t,n){const i=[...e],o=[];for(const c of n.arrayValue.values||[])for(const d of i){const f=new qu;f.seed(d.un()),Lo.Wt.Dt(c,f.ln(t.kind)),o.push(f)}return o}qn(e,t){return!!e.filters.find((n=>n instanceof dt&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=Hu(e),i=Jl(e);return(t?n.H(Vy,IDBKeyRange.bound(t,t)):n.H()).next((o=>{const c=[];return q.forEach(o,(d=>i.get([d.indexId,this.uid]).next((f=>{c.push((function(v,b){const _=b?new Id(b.sequenceNumber,new cs(nl(b.readTime),new xe(ai(b.documentKey)),b.largestBatchId)):Id.empty(),S=v.fields.map((([k,L])=>new Xf(hn.fromServerFormat(k),L)));return new bp(v.indexId,v.collectionGroup,S,_)})(d,f))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,i)=>{const o=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:Ge(n.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const i=Hu(e),o=Jl(e);return this.Wn(e).next((c=>i.H(Vy,IDBKeyRange.bound(t,t)).next((d=>q.forEach(d,(f=>o.put(XE(f.indexId,this.uid,c,n))))))))}updateIndexEntries(e,t){const n=new Map;return q.forEach(t,((i,o)=>{const c=n.get(i.collectionGroup);return(c?q.resolve(c):this.getFieldIndexes(e,i.collectionGroup)).next((d=>(n.set(i.collectionGroup,d),q.forEach(d,(f=>this.Qn(e,i,f).next((m=>{const v=this.Gn(o,f);return m.isEqual(v)?q.resolve():this.zn(e,o,f,m,v)})))))))}))}jn(e,t,n,i){return Xl(e).put(i.Rn(this.uid,this.Kn(n,t.key),t.key))}Hn(e,t,n,i){return Xl(e).delete(i.An(this.uid,this.Kn(n,t.key),t.key))}Qn(e,t,n){const i=Xl(e);let o=new jt(Aa);return i.ee({index:b2,range:IDBKeyRange.only([n.indexId,this.uid,sp(this.Kn(n,t))])},((c,d)=>{o=o.add(new Uo(n.indexId,t,tT(d.arrayValue),tT(d.directionalValue)))})).next((()=>o))}Gn(e,t){let n=new jt(Aa);const i=this.kn(t,e);if(i==null)return n;const o=Py(t);if(o!=null){const c=e.data.field(o.fieldPath);if(Pd(c))for(const d of c.arrayValue.values||[])n=n.add(new Uo(t.indexId,e.key,this.Nn(d),i))}else n=n.add(new Uo(t.indexId,e.key,Df,i));return n}zn(e,t,n,i,o){de(sT,"Updating index entries for document '%s'",t.key);const c=[];return(function(f,m,v,b,_){const S=f.getIterator(),k=m.getIterator();let L=Ql(S),B=Ql(k);for(;L||B;){let X=!1,re=!1;if(L&&B){const ee=v(L,B);ee<0?re=!0:ee>0&&(X=!0)}else L!=null?re=!0:X=!0;X?(b(B),B=Ql(k)):re?(_(L),L=Ql(S)):(L=Ql(S),B=Ql(k))}})(i,o,Aa,(d=>{c.push(this.jn(e,t,n,d))}),(d=>{c.push(this.Hn(e,t,n,d))})),q.waitFor(c)}Wn(e){let t=1;return Jl(e).ee({index:v2,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,i,o)=>{o.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((c,d)=>Aa(c,d))).filter(((c,d,f)=>!d||Aa(c,f[d-1])!==0));const i=[];i.push(e);for(const c of n){const d=Aa(c,e),f=Aa(c,t);if(d===0)i[0]=e.En();else if(d>0&&f<0)i.push(c),i.push(c.En());else if(f>0)break}i.push(t);const o=[];for(let c=0;c<i.length;c+=2){if(this.Jn(i[c],i[c+1]))return[];const d=i[c].An(this.uid,Df,xe.empty()),f=i[c+1].An(this.uid,Df,xe.empty());o.push(IDBKeyRange.bound(d,f))}return o}Jn(e,t){return Aa(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(aT)}getMinOffset(e,t){return q.mapArray(this.vn(t),(n=>this.Fn(e,n).next((i=>i||Ee(44426))))).next(aT)}}function iT(r){return Kn(r,kd)}function Xl(r){return Kn(r,dd)}function Hu(r){return Kn(r,Lv)}function Jl(r){return Kn(r,ud)}function aT(r){ke(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;Pv(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new cs(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},TI=41943040;class wr{static withCacheSize(e){return new wr(e,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SI(r,e,t){const n=r.store(Bs),i=r.store(wc),o=[],c=IDBKeyRange.only(t.batchId);let d=0;const f=n.ee({range:c},((v,b,_)=>(d++,_.delete())));o.push(f.next((()=>{ke(d===1,47070,{batchId:t.batchId})})));const m=[];for(const v of t.mutations){const b=m2(e,v.key.path,t.batchId);o.push(i.delete(b)),m.push(v.key)}return q.waitFor(o).next((()=>m))}function kp(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ee(14731);e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wr.DEFAULT_COLLECTION_PERCENTILE=10,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wr.DEFAULT=new wr(TI,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wr.DISABLED=new wr(-1,0,0);class fm{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Zn={}}static wt(e,t,n,i){ke(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new fm(o,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ca(e).ee({index:Bo,range:n},((i,o,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,n,i){const o=oc(e),c=Ca(e);return c.add({}).next((d=>{ke(typeof d=="number",49019);const f=new Kv(d,t,n,i),m=(function(S,k,L){const B=L.baseMutations.map((re=>Ap(S.yt,re))),X=L.mutations.map((re=>Ap(S.yt,re)));return{userId:k,batchId:L.batchId,localWriteTimeMs:L.localWriteTime.toMillis(),baseMutations:B,mutations:X}})(this.serializer,this.userId,f),v=[];let b=new jt(((_,S)=>Ge(_.canonicalString(),S.canonicalString())));for(const _ of i){const S=m2(this.userId,_.key.path,d);b=b.add(_.key.path.popLast()),v.push(c.put(m)),v.push(o.put(S,XO))}return b.forEach((_=>{v.push(this.indexManager.addToCollectionParentIndex(e,_))})),e.addOnCommittedListener((()=>{this.Zn[d]=f.keys()})),q.waitFor(v).next((()=>f))}))}lookupMutationBatch(e,t){return Ca(e).get(t).next((n=>n?(ke(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Vo(this.serializer,n)):null))}Xn(e,t){return this.Zn[t]?q.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const i=n.keys();return this.Zn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let o=null;return Ca(e).ee({index:Bo,range:i},((c,d,f)=>{d.userId===this.userId&&(ke(d.batchId>=n,47524,{Yn:n}),o=Vo(this.serializer,d)),f.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Fo;return Ca(e).ee({index:Bo,range:t,reverse:!0},((i,o,c)=>{n=o.batchId,c.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Fo],[this.userId,Number.POSITIVE_INFINITY]);return Ca(e).H(Bo,t).next((n=>n.map((i=>Vo(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Jf(this.userId,t.path),i=IDBKeyRange.lowerBound(n),o=[];return oc(e).ee({range:i},((c,d,f)=>{const[m,v,b]=c,_=ai(v);if(m===this.userId&&t.path.isEqual(_))return Ca(e).get(b).next((S=>{if(!S)throw Ee(61480,{er:c,batchId:b});ke(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:b}),o.push(Vo(this.serializer,S))}));f.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new jt(Ge);const i=[];return t.forEach((o=>{const c=Jf(this.userId,o.path),d=IDBKeyRange.lowerBound(c),f=oc(e).ee({range:d},((m,v,b)=>{const[_,S,k]=m,L=ai(S);_===this.userId&&o.path.isEqual(L)?n=n.add(k):b.done()}));i.push(f)})),q.waitFor(i).next((()=>this.tr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,o=Jf(this.userId,n),c=IDBKeyRange.lowerBound(o);let d=new jt(Ge);return oc(e).ee({range:c},((f,m,v)=>{const[b,_,S]=f,k=ai(_);b===this.userId&&n.isPrefixOf(k)?k.length===i&&(d=d.add(S)):v.done()})).next((()=>this.tr(e,d)))}tr(e,t){const n=[],i=[];return t.forEach((o=>{i.push(Ca(e).get(o).next((c=>{if(c===null)throw Ee(35274,{batchId:o});ke(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:o}),n.push(Vo(this.serializer,c))})))})),q.waitFor(i).next((()=>n))}removeMutationBatch(e,t){return SI(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),q.forEach(n,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return q.resolve();const n=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),i=[];return oc(e).ee({range:n},((o,c,d)=>{if(o[0]===this.userId){const f=ai(o[1]);i.push(f)}else d.done()})).next((()=>{ke(i.length===0,56720,{rr:i.map((o=>o.canonicalString()))})}))}))}containsKey(e,t){return NI(e,this.userId,t)}ir(e){return II(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Fo,lastStreamToken:""}))}}function NI(r,e,t){const n=Jf(e,t.path),i=n[1],o=IDBKeyRange.lowerBound(n);let c=!1;return oc(r).ee({range:o,Y:!0},((d,f,m)=>{const[v,b,_]=d;v===e&&b===i&&(c=!0),m.done()})).next((()=>c))}function Ca(r){return Kn(r,Bs)}function oc(r){return Kn(r,wc)}function II(r){return Kn(r,Cd)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new rl(0)}static ar(){return new rl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const n=new rl(t.highestTargetId);return t.highestTargetId=n.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Pe.fromTimestamp(new Dt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.ur(e).next((i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.cr(e,i))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((n=>(n.targetCount+=1,this.hr(t,n),this.cr(e,n))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Wl(e).delete(t.targetId))).next((()=>this.ur(e))).next((n=>(ke(n.targetCount>0,8065),n.targetCount-=1,this.cr(e,n))))}removeTargets(e,t,n){let i=0;const o=[];return Wl(e).ee(((c,d)=>{const f=rd(d);f.sequenceNumber<=t&&n.get(f.targetId)===null&&(i++,o.push(this.removeTargetData(e,f)))})).next((()=>q.waitFor(o))).next((()=>i))}forEachTarget(e,t){return Wl(e).ee(((n,i)=>{const o=rd(i);t(o)}))}ur(e){return lT(e).get(wp).next((t=>(ke(t!==null,2888),t)))}cr(e,t){return lT(e).put(wp,t)}lr(e,t){return Wl(e).put(xI(this.serializer,t))}hr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const n=el(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let o=null;return Wl(e).ee({range:i,index:y2},((c,d,f)=>{const m=rd(d);Zd(t,m.target)&&(o=m,f.done())})).next((()=>o))}addMatchingKeys(e,t,n){const i=[],o=La(e);return t.forEach((c=>{const d=Nr(c.path);i.push(o.put({targetId:n,path:d})),i.push(this.referenceDelegate.addReference(e,n,c))})),q.waitFor(i)}removeMatchingKeys(e,t,n){const i=La(e);return q.forEach(t,(o=>{const c=Nr(o.path);return q.waitFor([i.delete([n,c]),this.referenceDelegate.removeReference(e,n,o)])}))}removeMatchingKeysForTargetId(e,t){const n=La(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=La(e);let o=tt();return i.ee({range:n,Y:!0},((c,d,f)=>{const m=ai(c[1]),v=new xe(m);o=o.add(v)})).next((()=>o))}containsKey(e,t){const n=Nr(t.path),i=IDBKeyRange.bound([n],[a2(n)],!1,!0);let o=0;return La(e).ee({index:Vv,Y:!0,range:i},(([c,d],f,m)=>{c!==0&&(o++,m.done())})).next((()=>o>0))}At(e,t){return Wl(e).get(t).next((n=>n?rd(n):null))}}function Wl(r){return Kn(r,Ec)}function lT(r){return Kn(r,Go)}function La(r){return Kn(r,Tc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT="LruGarbageCollector",AI=1048576;function uT([r,e],[t,n]){const i=Ge(r,t);return i===0?Ge(e,n):i}class EP{constructor(e){this.Pr=e,this.buffer=new jt(uT),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();uT(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class CI{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){de(cT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){no(t)?de(cT,"Ignoring IndexedDB error during garbage collection: ",t):await to(t)}await this.Ar(3e5)}))}}class TP{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return q.resolve(qr.ce);const n=new EP(t);return this.Vr.forEachTarget(e,(i=>n.Er(i.sequenceNumber))).next((()=>this.Vr.mr(e,(i=>n.Er(i))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(de("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(oT)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(de("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oT):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,i,o,c,d,f,m;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(de("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),i=this.params.maximumSequenceNumbersToCollect):i=b,c=Date.now(),this.nthSequenceNumber(e,i)))).next((b=>(n=b,d=Date.now(),this.removeTargets(e,n,t)))).next((b=>(o=b,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((b=>(m=Date.now(),rc()<=ut.DEBUG&&de("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-v}ms
	Determined least recently used ${i} in `+(d-c)+`ms
	Removed ${o} targets in `+(f-d)+`ms
	Removed ${b} documents in `+(m-f)+`ms
Total Duration: ${m-v}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:b}))))}}function RI(r,e){return new TP(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e,t){this.db=e,this.garbageCollector=RI(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((n,i)=>t(i)))}addReference(e,t,n){return Of(e,n)}removeReference(e,t,n){return Of(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Of(e,t)}wr(e,t){return(function(i,o){let c=!1;return II(i).te((d=>NI(i,d,o).next((f=>(f&&(c=!0),q.resolve(!f)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.yr(e,((c,d)=>{if(d<=t){const f=this.wr(e,c).next((m=>{if(!m)return o++,n.getEntry(e,c).next((()=>(n.removeEntry(c,Pe.min()),La(e).delete((function(b){return[0,Nr(b.path)]})(c)))))}));i.push(f)}})).next((()=>q.waitFor(i))).next((()=>n.apply(e))).next((()=>o))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Of(e,t)}yr(e,t){const n=La(e);let i,o=qr.ce;return n.ee({index:Vv},(([c,d],{path:f,sequenceNumber:m})=>{c===0?(o!==qr.ce&&t(new xe(ai(i)),o),o=m,i=f):o=qr.ce})).next((()=>{o!==qr.ce&&t(new xe(ai(i)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Of(r,e){return La(r).put((function(n,i){return{targetId:0,path:Nr(n.path),sequenceNumber:i}})(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(){this.changes=new Hi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,_n.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?q.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Do(e).put(n)}removeEntry(e,t,n){return Do(e).delete((function(o,c){const d=o.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Cp(c),d[d.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.br(e,n))))}getEntry(e,t){let n=_n.newInvalidDocument(t);return Do(e).ee({index:Wf,range:IDBKeyRange.only($u(t))},((i,o)=>{n=this.Sr(t,o)})).next((()=>n))}Dr(e,t){let n={size:0,document:_n.newInvalidDocument(t)};return Do(e).ee({index:Wf,range:IDBKeyRange.only($u(t))},((i,o)=>{n={document:this.Sr(t,o),size:kp(o)}})).next((()=>n))}getEntries(e,t){let n=as();return this.Cr(e,t,((i,o)=>{const c=this.Sr(i,o);n=n.insert(i,c)})).next((()=>n))}vr(e,t){let n=as(),i=new Gt(xe.comparator);return this.Cr(e,t,((o,c)=>{const d=this.Sr(o,c);n=n.insert(o,d),i=i.insert(o,kp(c))})).next((()=>({documents:n,Fr:i})))}Cr(e,t,n){if(t.isEmpty())return q.resolve();let i=new jt(fT);t.forEach((f=>i=i.add(f)));const o=IDBKeyRange.bound($u(i.first()),$u(i.last())),c=i.getIterator();let d=c.getNext();return Do(e).ee({index:Wf,range:o},((f,m,v)=>{const b=xe.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&fT(d,b)<0;)n(d,null),d=c.getNext();d&&d.isEqual(b)&&(n(d,m),d=c.hasNext()?c.getNext():null),d?v.j($u(d)):v.done()})).next((()=>{for(;d;)n(d,null),d=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,n,i,o){const c=t.path,d=[c.popLast().toArray(),c.lastSegment(),Cp(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],f=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Do(e).H(IDBKeyRange.bound(d,f,!0)).next((m=>{o==null||o.incrementDocumentReadCount(m.length);let v=as();for(const b of m){const _=this.Sr(xe.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);_.isFoundDocument()&&(nh(t,_)||i.has(_.key))&&(v=v.insert(_.key,_))}return v}))}getAllFromCollectionGroup(e,t,n,i){let o=as();const c=hT(t,n),d=hT(t,cs.max());return Do(e).ee({index:g2,range:IDBKeyRange.bound(c,d,!0)},((f,m,v)=>{const b=this.Sr(xe.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);o=o.insert(b.key,b),o.size===i&&v.done()})).next((()=>o))}newChangeBuffer(e){return new IP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return dT(e).get(My).next((t=>(ke(!!t,20021),t)))}br(e,t){return dT(e).put(My,t)}Sr(e,t){if(t){const n=hP(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(Pe.min())))return n}return _n.newInvalidDocument(e)}}function DI(r){return new NP(r)}class IP extends kI{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new Hi((n=>n.toString()),((n,i)=>n.isEqual(i)))}applyChanges(e){const t=[];let n=0,i=new jt(((o,c)=>Ge(o.canonicalString(),c.canonicalString())));return this.changes.forEach(((o,c)=>{const d=this.Or.get(o);if(t.push(this.Mr.removeEntry(e,o,d.readTime)),c.isValidDocument()){const f=QE(this.Mr.serializer,c);i=i.add(o.path.popLast());const m=kp(f);n+=m-d.size,t.push(this.Mr.addEntry(e,o,f))}else if(n-=d.size,this.trackRemovals){const f=QE(this.Mr.serializer,c.convertToNoDocument(Pe.min()));t.push(this.Mr.addEntry(e,o,f))}})),i.forEach((o=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.Mr.updateMetadata(e,n)),q.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((n=>(this.Or.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:n,Fr:i})=>(i.forEach(((o,c)=>{this.Or.set(o,{size:c,readTime:n.get(o).readTime})})),n)))}}function dT(r){return Kn(r,Rd)}function Do(r){return Kn(r,_p)}function $u(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function hT(r,e){const t=e.documentKey.path.toArray();return[r,Cp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function fT(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let o=0;o<t.length-2&&o<n.length-2;++o)if(i=Ge(t[o],n[o]),i)return i;return i=Ge(t.length,n.length),i||(i=Ge(t[t.length-2],n[n.length-2]),i||Ge(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(n!==null&&md(n.mutation,i,Hr.empty(),Dt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,tt()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=tt()){const i=oi();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((o=>{let c=td();return o.forEach(((d,f)=>{c=c.insert(d,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const n=oi();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,tt())))}populateOverlays(e,t,n){const i=[];return n.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,n,i){let o=as();const c=pd(),d=(function(){return pd()})();return t.forEach(((f,m)=>{const v=n.get(m.key);i.has(m.key)&&(v===void 0||v.mutation instanceof $i)?o=o.insert(m.key,m):v!==void 0?(c.set(m.key,v.mutation.getFieldMask()),md(v.mutation,m,v.mutation.getFieldMask(),Dt.now())):c.set(m.key,Hr.empty())})),this.recalculateAndSaveOverlays(e,o).next((f=>(f.forEach(((m,v)=>c.set(m,v))),t.forEach(((m,v)=>d.set(m,new AP(v,c.get(m)??null)))),d)))}recalculateAndSaveOverlays(e,t){const n=pd();let i=new Gt(((c,d)=>c-d)),o=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((f=>{const m=t.get(f);if(m===null)return;let v=n.get(f)||Hr.empty();v=d.applyToLocalView(m,v),n.set(f,v);const b=(i.get(d.batchId)||tt()).add(f);i=i.insert(d.batchId,b)}))})).next((()=>{const c=[],d=i.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),m=f.key,v=f.value,b=Y2();v.forEach((_=>{if(!o.has(_)){const S=tI(t.get(_),n.get(_));S!==null&&b.set(_,S),o=o.add(_)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,b))}return q.waitFor(c)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,i){return Oj(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):G2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((o=>{const c=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-o.size):q.resolve(oi());let d=_c,f=o;return c.next((m=>q.forEach(m,((v,b)=>(d<b.largestBatchId&&(d=b.largestBatchId),o.get(v)?q.resolve():this.remoteDocumentCache.getEntry(e,v).next((_=>{f=f.insert(v,_)}))))).next((()=>this.populateOverlays(e,m,o))).next((()=>this.computeViews(e,f,m,tt()))).next((v=>({batchId:d,changes:Q2(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new xe(t)).next((n=>{let i=td();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const o=t.collectionGroup;let c=td();return this.indexManager.getCollectionParents(e,o).next((d=>q.forEach(d,(f=>{const m=(function(b,_){return new eh(_,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(t,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,n,i).next((v=>{v.forEach(((b,_)=>{c=c.insert(b,_)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,o,i)))).next((c=>{o.forEach(((f,m)=>{const v=m.getKey();c.get(v)===null&&(c=c.insert(v,_n.newInvalidDocument(v)))}));let d=td();return c.forEach(((f,m)=>{const v=o.get(f);v!==void 0&&md(v.mutation,m,Hr.empty(),Dt.now()),nh(t,m)&&(d=d.insert(f,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return q.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Dr(i.createTime)}})(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:_I(i.bundledQuery),readTime:Dr(i.readTime)}})(t)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(){this.overlays=new Gt(xe.comparator),this.Lr=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const n=oi();return q.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&n.set(i,o)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((i,o)=>{this.bt(e,t,o)})),q.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Lr.get(n);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.Lr.delete(n)),q.resolve()}getOverlaysForCollection(e,t,n){const i=oi(),o=t.length+1,c=new xe(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const f=d.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===o&&f.largestBatchId>n&&i.set(f.getKey(),f)}return q.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let o=new Gt(((m,v)=>m-v));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let v=o.get(m.largestBatchId);v===null&&(v=oi(),o=o.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const d=oi(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((m,v)=>d.set(m,v))),!(d.size()>=i)););return q.resolve(d)}bt(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const c=this.Lr.get(i.largestBatchId).delete(n.key);this.Lr.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new Yv(t,n));let o=this.Lr.get(t);o===void 0&&(o=tt(),this.Lr.set(t,o)),this.Lr.set(t,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(){this.sessionToken=Rn.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(){this.kr=new jt(Xn.Kr),this.qr=new jt(Xn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new Xn(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new Xn(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new xe(new At([])),n=new Xn(t,e),i=new Xn(t,e+1),o=[];return this.qr.forEachInRange([n,i],(c=>{this.Wr(c),o.push(c.key)})),o}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new xe(new At([])),n=new Xn(t,e),i=new Xn(t,e+1);let o=tt();return this.qr.forEachInRange([n,i],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new Xn(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Xn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return xe.comparator(e.key,t.key)||Ge(e.Hr,t.Hr)}static Ur(e,t){return Ge(e.Hr,t.Hr)||xe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new jt(Xn.Kr)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new Kv(o,t,n,i);this.mutationQueue.push(c);for(const d of i)this.Jr=this.Jr.add(new Xn(d.key,o)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return q.resolve(c)}lookupMutationBatch(e,t){return q.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Xr(n),o=i<0?0:i;return q.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Fo:this.Yn-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Xn(t,0),i=new Xn(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([n,i],(c=>{const d=this.Zr(c.Hr);o.push(d)})),q.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new jt(Ge);return t.forEach((i=>{const o=new Xn(i,0),c=new Xn(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,c],(d=>{n=n.add(d.Hr)}))})),q.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let o=n;xe.isDocumentKey(o)||(o=o.child(""));const c=new Xn(new xe(o),0);let d=new jt(Ge);return this.Jr.forEachWhile((f=>{const m=f.key.path;return!!n.isPrefixOf(m)&&(m.length===i&&(d=d.add(f.Hr)),!0)}),c),q.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((n=>{const i=this.Zr(n);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){ke(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return q.forEach(t.mutations,(i=>{const o=new Xn(i.key,t.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new Xn(t,0),i=this.Jr.firstAfterOrEqual(n);return q.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e){this.ti=e,this.docs=(function(){return new Gt(xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),o=i?i.size:0,c=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return q.resolve(n?n.document.mutableCopy():_n.newInvalidDocument(t))}getEntries(e,t){let n=as();return t.forEach((i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():_n.newInvalidDocument(i))})),q.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let o=as();const c=t.path,d=new xe(c.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:m,value:{document:v}}=f.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||Pv(u2(v),n)<=0||(i.has(v.key)||nh(t,v))&&(o=o.insert(v.key,v.mutableCopy()))}return q.resolve(o)}getAllFromCollectionGroup(e,t,n,i){Ee(9500)}ni(e,t){return q.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new jP(this)}getSize(e){return q.resolve(this.size)}}class jP extends kI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(n)})),q.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(e){this.persistence=e,this.ri=new Hi((t=>el(t)),Zd),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.ii=0,this.si=new eb,this.targetCount=0,this.oi=rl._r()}forEachTarget(e,t){return this.ri.forEach(((n,i)=>t(i))),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),q.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new rl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.lr(t),q.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,n){let i=0;const o=[];return this.ri.forEach(((c,d)=>{d.sequenceNumber<=t&&n.get(d.targetId)===null&&(this.ri.delete(c),o.push(this.removeMatchingKeysForTargetId(e,d.targetId)),i++)})),q.waitFor(o).next((()=>i))}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return q.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),q.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((c=>{o.push(i.markPotentiallyOrphaned(e,c))})),q.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return q.resolve(n)}containsKey(e,t){return q.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e,t){this._i={},this.overlays={},this.ai=new qr(0),this.ui=!1,this.ui=!0,this.ci=new kP,this.referenceDelegate=e(this),this.li=new PP(this),this.indexManager=new xP,this.remoteDocumentCache=(function(i){return new OP(i)})((n=>this.referenceDelegate.hi(n))),this.serializer=new bI(t),this.Pi=new CP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new RP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new DP(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){de("MemoryPersistence","Starting transaction:",e);const i=new MP(this.ai.next());return this.referenceDelegate.Ti(),n(i).next((o=>this.referenceDelegate.Ii(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ei(e,t){return q.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class MP extends h2{constructor(e){super(),this.currentSequenceNumber=e}}class pm{constructor(e){this.persistence=e,this.Ri=new eb,this.Ai=null}static Vi(e){return new pm(e)}get di(){if(this.Ai)return this.Ai;throw Ee(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),q.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),q.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((i=>this.di.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.di.add(o.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.di,(n=>{const i=xe.fromPath(n);return this.mi(e,i).next((o=>{o||t.removeEntry(i,Pe.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return q.or([()=>q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Dp{constructor(e,t){this.persistence=e,this.fi=new Hi((n=>Nr(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=RI(this,t)}static Vi(e,t){return new Dp(e,t)}Ti(){}Ii(e){return q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return q.forEach(this.fi,((n,i)=>this.wr(e,n,i).next((o=>o?q.resolve():t(i)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ni(e,(c=>this.wr(e,c,t).next((d=>{d||(n++,o.removeEntry(c,Pe.min()))})))).next((()=>o.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),q.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),q.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),q.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ep(e.data.value)),t}wr(e,t,n){return q.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.fi.get(t);return q.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e){this.serializer=e}k(e,t,n,i){const o=new tm("createOrUpgrade",t);n<1&&i>=1&&((function(f){f.createObjectStore(Wd)})(e),(function(f){f.createObjectStore(Cd,{keyPath:YO}),f.createObjectStore(Bs,{keyPath:TE,autoIncrement:!0}).createIndex(Bo,SE,{unique:!0}),f.createObjectStore(wc)})(e),pT(e),(function(f){f.createObjectStore(Po)})(e));let c=q.resolve();return n<3&&i>=3&&(n!==0&&((function(f){f.deleteObjectStore(Tc),f.deleteObjectStore(Ec),f.deleteObjectStore(Go)})(e),pT(e)),c=c.next((()=>(function(f){const m=f.store(Go),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Pe.min().toTimestamp(),targetCount:0};return m.put(wp,v)})(o)))),n<4&&i>=4&&(n!==0&&(c=c.next((()=>(function(f,m){return m.store(Bs).H().next((b=>{f.deleteObjectStore(Bs),f.createObjectStore(Bs,{keyPath:TE,autoIncrement:!0}).createIndex(Bo,SE,{unique:!0});const _=m.store(Bs),S=b.map((k=>_.put(k)));return q.waitFor(S)}))})(e,o)))),c=c.next((()=>{(function(f){f.createObjectStore(Sc,{keyPath:sj})})(e)}))),n<5&&i>=5&&(c=c.next((()=>this.gi(o)))),n<6&&i>=6&&(c=c.next((()=>((function(f){f.createObjectStore(Rd)})(e),this.pi(o))))),n<7&&i>=7&&(c=c.next((()=>this.yi(o)))),n<8&&i>=8&&(c=c.next((()=>this.wi(e,o)))),n<9&&i>=9&&(c=c.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&i>=10&&(c=c.next((()=>this.bi(o)))),n<11&&i>=11&&(c=c.next((()=>{(function(f){f.createObjectStore(rm,{keyPath:ij})})(e),(function(f){f.createObjectStore(sm,{keyPath:aj})})(e)}))),n<12&&i>=12&&(c=c.next((()=>{(function(f){const m=f.createObjectStore(im,{keyPath:fj});m.createIndex(Ly,pj,{unique:!1}),m.createIndex(x2,mj,{unique:!1})})(e)}))),n<13&&i>=13&&(c=c.next((()=>(function(f){const m=f.createObjectStore(_p,{keyPath:JO});m.createIndex(Wf,WO),m.createIndex(g2,ZO)})(e))).next((()=>this.Si(e,o))).next((()=>e.deleteObjectStore(Po)))),n<14&&i>=14&&(c=c.next((()=>this.Di(e,o)))),n<15&&i>=15&&(c=c.next((()=>(function(f){f.createObjectStore(Lv,{keyPath:oj,autoIncrement:!0}).createIndex(Vy,lj,{unique:!1}),f.createObjectStore(ud,{keyPath:cj}).createIndex(v2,uj,{unique:!1}),f.createObjectStore(dd,{keyPath:dj}).createIndex(b2,hj,{unique:!1})})(e)))),n<16&&i>=16&&(c=c.next((()=>{t.objectStore(ud).clear()})).next((()=>{t.objectStore(dd).clear()}))),n<17&&i>=17&&(c=c.next((()=>{(function(f){f.createObjectStore(Uv,{keyPath:gj})})(e)}))),n<18&&i>=18&&hN()&&(c=c.next((()=>{t.objectStore(ud).clear()})).next((()=>{t.objectStore(dd).clear()}))),c}pi(e){let t=0;return e.store(Po).ee(((n,i)=>{t+=kp(i)})).next((()=>{const n={byteSize:t};return e.store(Rd).put(My,n)}))}gi(e){const t=e.store(Cd),n=e.store(Bs);return t.H().next((i=>q.forEach(i,(o=>{const c=IDBKeyRange.bound([o.userId,Fo],[o.userId,o.lastAcknowledgedBatchId]);return n.H(Bo,c).next((d=>q.forEach(d,(f=>{ke(f.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const m=Vo(this.serializer,f);return SI(e,o.userId,m).next((()=>{}))}))))}))))}yi(e){const t=e.store(Tc),n=e.store(Po);return e.store(Go).get(wp).next((i=>{const o=[];return n.ee(((c,d)=>{const f=new At(c),m=(function(b){return[0,Nr(b)]})(f);o.push(t.get(m).next((v=>v?q.resolve():(b=>t.put({targetId:0,path:Nr(b),sequenceNumber:i.highestListenSequenceNumber}))(f))))})).next((()=>q.waitFor(o)))}))}wi(e,t){e.createObjectStore(kd,{keyPath:rj});const n=t.store(kd),i=new Zv,o=c=>{if(i.add(c)){const d=c.lastSegment(),f=c.popLast();return n.put({collectionId:d,parent:Nr(f)})}};return t.store(Po).ee({Y:!0},((c,d)=>{const f=new At(c);return o(f.popLast())})).next((()=>t.store(wc).ee({Y:!0},(([c,d,f],m)=>{const v=ai(d);return o(v.popLast())}))))}bi(e){const t=e.store(Ec);return t.ee(((n,i)=>{const o=rd(i),c=xI(this.serializer,o);return t.put(c)}))}Si(e,t){const n=t.store(Po),i=[];return n.ee(((o,c)=>{const d=t.store(_p),f=(function(b){return b.document?new xe(At.fromString(b.document.name).popFirst(5)):b.noDocument?xe.fromSegments(b.noDocument.path):b.unknownDocument?xe.fromSegments(b.unknownDocument.path):Ee(36783)})(c).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};i.push(d.put(m))})).next((()=>q.waitFor(i)))}Di(e,t){const n=t.store(Bs),i=DI(this.serializer),o=new tb(pm.Vi,this.serializer.yt);return n.H().next((c=>{const d=new Map;return c.forEach((f=>{let m=d.get(f.userId)??tt();Vo(this.serializer,f).keys().forEach((v=>m=m.add(v))),d.set(f.userId,m)})),q.forEach(d,((f,m)=>{const v=new _r(m),b=hm.wt(this.serializer,v),_=o.getIndexManager(v),S=fm.wt(v,this.serializer,_,o.referenceDelegate);return new OI(i,S,b,_).recalculateAndSaveOverlaysForDocumentKeys(new Uy(t,qr.ce),f).next()}))}))}}function pT(r){r.createObjectStore(Tc,{keyPath:tj}).createIndex(Vv,nj,{unique:!0}),r.createObjectStore(Ec,{keyPath:"targetId"}).createIndex(y2,ej,{unique:!0}),r.createObjectStore(Go)}const Ra="IndexedDbPersistence",sy=18e5,iy=5e3,ay="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",LP="main";class nb{constructor(e,t,n,i,o,c,d,f,m,v,b=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ci=o,this.window=c,this.document=d,this.Fi=m,this.Mi=v,this.xi=b,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=_=>Promise.resolve(),!nb.v())throw new me(ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new SP(this,i),this.Ki=t+LP,this.serializer=new bI(f),this.qi=new Ka(this.Ki,this.xi,new VP(this.serializer)),this.ci=new pP,this.li=new wP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=DI(this.serializer),this.Pi=new fP,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,v===!1&&Cn(Ra,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new me(ie.FAILED_PRECONDITION,ay);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new qr(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>jf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(no(e))return de(Ra,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return de(Ra,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Ku(e).get(Kl).next((t=>q.resolve(this.Xi(t))))}Yi(e){return jf(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,sy)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=Kn(t,Sc);return n.H().next((i=>{const o=this.ns(i,sy),c=i.filter((d=>o.indexOf(d)===-1));return q.forEach(c,(d=>n.delete(d.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?q.resolve(!0):Ku(e).get(Kl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,iy)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new me(ie.FAILED_PRECONDITION,ay);return!1}}return!(!this.networkEnabled||!this.inForeground)||jf(e).H().next((n=>this.ns(n,iy).find((i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,c=!this.inForeground&&i.inForeground,d=this.networkEnabled===i.networkEnabled;if(o||c&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&de(Ra,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Wd,Sc],(e=>{const t=new Uy(e,qr.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((n=>this.ts(n.updateTimeMs,t)&&!this.ss(n.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>jf(e).H().next((t=>this.ns(t,sy).map((n=>n.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return fm.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new _P(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return hm.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,n){de(Ra,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",o=(function(f){return f===18?bj:f===17?T2:f===16?vj:f===15?zv:f===14?E2:f===13?w2:f===12?yj:f===11?_2:void Ee(60245)})(this.xi);let c;return this.qi.runTransaction(e,i,o,(d=>(c=new Uy(d,this.ai?this.ai.next():qr.ce),t==="readwrite-primary"?this.ji(c).next((f=>!!f||this.Hi(c))).next((f=>{if(!f)throw Cn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new me(ie.FAILED_PRECONDITION,d2);return n(c)})).next((f=>this.Zi(c).next((()=>f)))):this.Ps(c).next((()=>n(c)))))).then((d=>(c.raiseOnCommittedEvent(),d)))}Ps(e){return Ku(e).get(Kl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,iy)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new me(ie.FAILED_PRECONDITION,ay)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ku(e).put(Kl,t)}static v(){return Ka.v()}Ji(e){const t=Ku(e);return t.get(Kl).next((n=>this.Xi(n)?(de(Ra,"Releasing primary lease."),t.delete(Kl)):q.resolve()))}ts(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Cn(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const t=/(?:Version|Mobile)\/1[456]/;dN()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var t;try{const n=((t=this.Ui)==null?void 0:t.getItem(this.rs(e)))!==null;return de(Ra,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Cn(Ra,"Failed to get zombied client id.",n),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Cn("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ku(r){return Kn(r,Wd)}function jf(r){return Kn(r,Sc)}function jI(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=i}static Es(e,t){let n=tt(),i=tt();for(const o of t.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new rb(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return dN()?8:f2($n())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,i){const o={result:null};return this.gs(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.ps(e,t,i,n).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new UP;return this.ys(e,t,c).next((d=>{if(o.result=d,this.As)return this.ws(e,t,c,d.size)}))})).next((()=>o.result))}ws(e,t,n,i){return n.documentReadCount<this.Vs?(rc()<=ut.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",sc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),q.resolve()):(rc()<=ut.DEBUG&&de("QueryEngine","Query:",sc(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ds*i?(rc()<=ut.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",sc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ls(t))):q.resolve())}gs(e,t){if(LE(t))return q.resolve(null);let n=ls(t);return this.indexManager.getIndexType(e,n).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=$y(t,null,"F"),n=ls(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((o=>{const c=tt(...o);return this.fs.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,n).next((f=>{const m=this.bs(t,d);return this.Ss(t,m,c,f.readTime)?this.gs(e,$y(t,null,"F")):this.Ds(e,m,t,f)}))))})))))}ps(e,t,n,i){return LE(t)||i.isEqual(Pe.min())?q.resolve(null):this.fs.getDocuments(e,n).next((o=>{const c=this.bs(t,o);return this.Ss(t,c,n,i)?q.resolve(null):(rc()<=ut.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),sc(t)),this.Ds(e,c,t,c2(i,_c)).next((d=>d)))}))}bs(e,t){let n=new jt($2(e));return t.forEach(((i,o)=>{nh(e,o)&&(n=n.add(o))})),n}Ss(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ys(e,t,n){return rc()<=ut.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",sc(t)),this.fs.getDocumentsMatchingQuery(e,t,cs.min(),n)}Ds(e,t,n,i){return this.fs.getDocumentsMatchingQuery(e,n,i).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb="LocalStore",zP=3e8;class BP{constructor(e,t,n,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new Gt(Ge),this.Fs=new Hi((o=>el(o)),Zd),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new OI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function MI(r,e,t,n){return new BP(r,e,t,n)}async function VI(r,e){const t=Ae(r);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next((o=>(i=o,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((o=>{const c=[],d=[];let f=tt();for(const m of i){c.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}for(const m of o){d.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}return t.localDocuments.getDocuments(n,f).next((m=>({Ns:m,removedBatchIds:c,addedBatchIds:d})))}))}))}function FP(r,e){const t=Ae(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const i=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,f,m,v){const b=m.batch,_=b.keys();let S=q.resolve();return _.forEach((k=>{S=S.next((()=>v.getEntry(f,k))).next((L=>{const B=m.docVersions.get(k);ke(B!==null,48541),L.version.compareTo(B)<0&&(b.applyToRemoteDocument(L,m),L.isValidDocument()&&(L.setReadTime(m.commitVersion),v.addEntry(L)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(f,b)))})(t,n,e,o).next((()=>o.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(d){let f=tt();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(f=f.add(d.batch.mutations[m].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(n,i)))}))}function LI(r){const e=Ae(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function GP(r,e){const t=Ae(r),n=e.snapshotVersion;let i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;const d=[];e.targetChanges.forEach(((v,b)=>{const _=i.get(b);if(!_)return;d.push(t.li.removeMatchingKeys(o,v.removedDocuments,b).next((()=>t.li.addMatchingKeys(o,v.addedDocuments,b))));let S=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(b)!==null?S=S.withResumeToken(Rn.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):v.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(v.resumeToken,n)),i=i.insert(b,S),(function(L,B,X){return L.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=zP?!0:X.addedDocuments.size+X.modifiedDocuments.size+X.removedDocuments.size>0})(_,S,v)&&d.push(t.li.updateTargetData(o,S))}));let f=as(),m=tt();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(o,v))})),d.push(qP(o,c,e.documentUpdates).next((v=>{f=v.Bs,m=v.Ls}))),!n.isEqual(Pe.min())){const v=t.li.getLastRemoteSnapshotVersion(o).next((b=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,n)));d.push(v)}return q.waitFor(d).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,f,m))).next((()=>f))})).then((o=>(t.vs=i,o)))}function qP(r,e,t){let n=tt(),i=tt();return t.forEach((o=>n=n.add(o))),e.getEntries(r,n).next((o=>{let c=as();return t.forEach(((d,f)=>{const m=o.get(d);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(d)),f.isNoDocument()&&f.version.isEqual(Pe.min())?(e.removeEntry(d,f.readTime),c=c.insert(d,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),c=c.insert(d,f)):de(sb,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",f.version)})),{Bs:c,Ls:i}}))}function HP(r,e){const t=Ae(r);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Fo),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function Op(r,e){const t=Ae(r);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return t.li.getTargetData(n,e).next((o=>o?(i=o,q.resolve(i)):t.li.allocateTargetId(n).next((c=>(i=new Mi(e,c,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=t.vs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function Oc(r,e,t){const n=Ae(r),i=n.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",o,(c=>n.persistence.referenceDelegate.removeTarget(c,i)))}catch(c){if(!no(c))throw c;de(sb,`Failed to update sequence numbers for target ${e}: ${c}`)}n.vs=n.vs.remove(e),n.Fs.delete(i.target)}function ev(r,e,t){const n=Ae(r);let i=Pe.min(),o=tt();return n.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,m,v){const b=Ae(f),_=b.Fs.get(v);return _!==void 0?q.resolve(b.vs.get(_)):b.li.getTargetData(m,v)})(n,c,ls(e)).next((d=>{if(d)return i=d.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(c,d.targetId).next((f=>{o=f}))})).next((()=>n.Cs.getDocumentsMatchingQuery(c,e,t?i:Pe.min(),t?o:tt()))).next((d=>(BI(n,H2(e),d),{documents:d,ks:o})))))}function UI(r,e){const t=Ae(r),n=Ae(t.li),i=t.vs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(o=>n.At(o,e).next((c=>c?c.target:null))))}function zI(r,e){const t=Ae(r),n=t.Ms.get(e)||Pe.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.xs.getAllFromCollectionGroup(i,e,c2(n,_c),Number.MAX_SAFE_INTEGER))).then((i=>(BI(t,e,i),i)))}function BI(r,e,t){let n=r.Ms.get(e)||Pe.min();t.forEach(((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),r.Ms.set(e,n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="firestore_clients";function mT(r,e){return`${FI}_${r}_${e}`}const GI="firestore_mutations";function gT(r,e,t){let n=`${GI}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const qI="firestore_targets";function oy(r,e){return`${qI}_${r}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii="SharedClientState";class jp{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static $s(e,t,n){const i=JSON.parse(n);let o,c=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return c&&i.error&&(c=typeof i.error.message=="string"&&typeof i.error.code=="string",c&&(o=new me(i.error.code,i.error.message))),c?new jp(e,t,i.state,o):(Cn(ii,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gd{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static $s(e,t){const n=JSON.parse(t);let i,o=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return o&&n.error&&(o=typeof n.error.message=="string"&&typeof n.error.code=="string",o&&(i=new me(n.error.code,n.error.message))),o?new gd(e,n.state,i):(Cn(ii,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Pp{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,o=Hv();for(let c=0;i&&c<n.activeTargetIds.length;++c)i=p2(n.activeTargetIds[c]),o=o.add(n.activeTargetIds[c]);return i?new Pp(e,o):(Cn(ii,`Failed to parse client data for instance '${e}': ${t}`),null)}}class ib{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new ib(t.clientId,t.onlineState):(Cn(ii,`Failed to parse online state: ${e}`),null)}}class tv{constructor(){this.activeTargetIds=Hv()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ly{constructor(e,t,n,i,o){this.window=e,this.Ci=t,this.persistenceKey=n,this.zs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new Gt(Ge),this.started=!1,this.Zs=[];const c=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Xs=mT(this.persistenceKey,this.zs),this.Ys=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new tv),this.eo=new RegExp(`^${FI}_${c}_([^_]*)$`),this.no=new RegExp(`^${GI}_${c}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${qI}_${c}_(\\d+)$`),this.io=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this.so=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const n of e){if(n===this.zs)continue;const i=this.getItem(mT(this.persistenceKey,n));if(i){const o=Pp.$s(n,i);o&&(this.Js=this.Js.insert(o.clientId,o))}}this.oo();const t=this.storage.getItem(this.io);if(t){const n=this._o(t);n&&this.ao(n)}for(const n of this.Zs)this.Hs(n);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,n){this.co(e,t,n),this.lo(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(oy(this.persistenceKey,e));if(i){const o=gd.$s(e,i);o&&(n=o.state)}}return t&&this.ho.Qs(e),this.oo(),n}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(oy(this.persistenceKey,e))}updateQueryState(e,t,n){this.Po(e,t,n)}handleUserChange(e,t,n){t.forEach((i=>{this.lo(i)})),this.currentUser=e,n.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return de(ii,"READ",e,t),t}setItem(e,t){de(ii,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){de(ii,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(de(ii,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Cn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const n=this.Eo(t.key);return this.Ro(n,null)}{const n=this.Ao(t.key,t.newValue);if(n)return this.Ro(n.clientId,n)}}else if(this.no.test(t.key)){if(t.newValue!==null){const n=this.Vo(t.key,t.newValue);if(n)return this.mo(n)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const n=this.fo(t.key,t.newValue);if(n)return this.po(n)}}else if(t.key===this.io){if(t.newValue!==null){const n=this._o(t.newValue);if(n)return this.ao(n)}}else if(t.key===this.Ys){const n=(function(o){let c=qr.ce;if(o!=null)try{const d=JSON.parse(o);ke(typeof d=="number",30636,{yo:o}),c=d}catch(d){Cn(ii,"Failed to read sequence number from WebStorage",d)}return c})(t.newValue);n!==qr.ce&&this.sequenceNumberHandler(n)}else if(t.key===this.so){const n=this.wo(t.newValue);await Promise.all(n.map((i=>this.syncEngine.bo(i))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,n){const i=new jp(this.currentUser,e,t,n),o=gT(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Ws())}lo(e){const t=gT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,n){const i=oy(this.persistenceKey,e),o=new gd(e,t,n);this.setItem(i,o.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const n=this.Eo(e);return Pp.$s(n,t)}Vo(e,t){const n=this.no.exec(e),i=Number(n[1]),o=n[2]!==void 0?n[2]:null;return jp.$s(new _r(o),i,t)}fo(e,t){const n=this.ro.exec(e),i=Number(n[1]);return gd.$s(i,t)}_o(e){return ib.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);de(ii,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const n=t?this.Js.insert(e,t):this.Js.remove(e),i=this.uo(this.Js),o=this.uo(n),c=[],d=[];return o.forEach((f=>{i.has(f)||c.push(f)})),i.forEach((f=>{o.has(f)||d.push(f)})),this.syncEngine.Co(c,d).then((()=>{this.Js=n}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=Hv();return e.forEach(((n,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class HI{constructor(){this.vo=new tv,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new tv,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT="ConnectivityMonitor";class vT{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){de(yT,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){de(yT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pf=null;function nv(){return Pf===null?Pf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Pf++,"0x"+Pf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="RestConnection",KP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class QP{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.$o=this.databaseId.database===Ep?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,t,n,i,o){const c=nv(),d=this.Qo(e,t.toUriEncodedString());de(cy,`Sending RPC '${e}' ${c}:`,d,n);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(f,i,o);const{host:m}=new URL(d),v=Uc(m);return this.zo(e,d,f,n,v).then((b=>(de(cy,`Received RPC '${e}' ${c}: `,b),b)),(b=>{throw bc(cy,`RPC '${e}' ${c} failed with error: `,b,"url: ",d,"request:",n),b}))}jo(e,t,n,i,o,c){return this.Wo(e,t,n,i,o)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Fc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),n&&n.headers.forEach(((i,o)=>e[o]=i))}Qo(e,t){const n=KP[e];let i=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr="WebChannelConnection",Qu=(r,e,t)=>{r.listen(e,(n=>{try{t(n)}catch(i){setTimeout((()=>{throw i}),0)}}))};class pc extends QP{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!pc.c_){const e=r2();Qu(e,n2.STAT_EVENT,(t=>{t.stat===Oy.PROXY?de(xr,"STAT_EVENT: detected buffering proxy"):t.stat===Oy.NOPROXY&&de(xr,"STAT_EVENT: detected no buffering proxy")})),pc.c_=!0}}zo(e,t,n,i,o){const c=nv();return new Promise(((d,f)=>{const m=new e2;m.setWithCredentials(!0),m.listenOnce(t2.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Yf.NO_ERROR:const b=m.getResponseJson();de(xr,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(b)),d(b);break;case Yf.TIMEOUT:de(xr,`RPC '${e}' ${c} timed out`),f(new me(ie.DEADLINE_EXCEEDED,"Request time out"));break;case Yf.HTTP_ERROR:const _=m.getStatus();if(de(xr,`RPC '${e}' ${c} failed with status:`,_,"response text:",m.getResponseText()),_>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const k=S==null?void 0:S.error;if(k&&k.status&&k.message){const L=(function(X){const re=X.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(re)>=0?re:ie.UNKNOWN})(k.status);f(new me(L,k.message))}else f(new me(ie.UNKNOWN,"Server responded with status "+m.getStatus()))}else f(new me(ie.UNAVAILABLE,"Connection failed."));break;default:Ee(9055,{l_:e,streamId:c,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{de(xr,`RPC '${e}' ${c} completed.`)}}));const v=JSON.stringify(i);de(xr,`RPC '${e}' ${c} sending request:`,i),m.send(t,"POST",v,n,15)}))}T_(e,t,n){const i=nv(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const m=o.join("");de(xr,`Creating RPC '${e}' stream ${i}: ${m}`,d);const v=c.createWebChannel(m,d);this.I_(v);let b=!1,_=!1;const S=new YP({Ho:k=>{_?de(xr,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(b||(de(xr,`Opening RPC '${e}' stream ${i} transport.`),v.open(),b=!0),de(xr,`RPC '${e}' stream ${i} sending:`,k),v.send(k))},Jo:()=>v.close()});return Qu(v,ed.EventType.OPEN,(()=>{_||(de(xr,`RPC '${e}' stream ${i} transport opened.`),S.i_())})),Qu(v,ed.EventType.CLOSE,(()=>{_||(_=!0,de(xr,`RPC '${e}' stream ${i} transport closed`),S.o_(),this.E_(v))})),Qu(v,ed.EventType.ERROR,(k=>{_||(_=!0,bc(xr,`RPC '${e}' stream ${i} transport errored. Name:`,k.name,"Message:",k.message),S.o_(new me(ie.UNAVAILABLE,"The operation could not be completed")))})),Qu(v,ed.EventType.MESSAGE,(k=>{var L;if(!_){const B=k.data[0];ke(!!B,16349);const X=B,re=(X==null?void 0:X.error)||((L=X[0])==null?void 0:L.error);if(re){de(xr,`RPC '${e}' stream ${i} received error:`,re);const ee=re.status;let le=(function(C){const I=Ln[C];if(I!==void 0)return sI(I)})(ee),fe=re.message;ee==="NOT_FOUND"&&fe.includes("database")&&fe.includes("does not exist")&&fe.includes(this.databaseId.database)&&bc(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),le===void 0&&(le=ie.INTERNAL,fe="Unknown error status: "+ee+" with message "+re.message),_=!0,S.o_(new me(le,fe)),v.close()}else de(xr,`RPC '${e}' stream ${i} received:`,B),S.__(B)}})),pc.u_(),setTimeout((()=>{S.s_()}),0),S}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return s2()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XP(r){return new pc(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $I(){return typeof window<"u"?window:null}function ip(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mm(r){return new nP(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pc.c_=!1;class KI{constructor(e,t,n=1e3,i=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=i,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-n);i>0&&de("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="PersistentStream";class QI{constructor(e,t,n,i,o,c,d,f){this.Ci=e,this.b_=n,this.S_=i,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new KI(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Cn(t.toString()),Cn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===t&&this.G_(n,i)}),(n=>{e((()=>{const i=new me(ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return de(bT,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(de(bT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class JP extends QI{constructor(e,t,n,i,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,c),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=iP(this.serializer,e),n=(function(o){if(!("targetChange"in o))return Pe.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Pe.min():c.readTime?Dr(c.readTime):Pe.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=Yy(this.serializer),t.addTarget=(function(o,c){let d;const f=c.target;if(d=Sp(f)?{documents:hI(o,f)}:{query:fI(o,f).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=oI(o,c.resumeToken);const m=Ky(o,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(Pe.min())>0){d.readTime=Dc(o,c.snapshotVersion.toTimestamp());const m=Ky(o,c.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const n=oP(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=Yy(this.serializer),t.removeTarget=e,this.K_(t)}}class WP extends QI{constructor(e,t,n,i,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,c),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=aP(e.writeResults,e.commitTime),n=Dr(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Yy(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>Ap(this.serializer,n)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{}class e3 extends ZP{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new me(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Wo(e,Qy(t,n),i,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new me(ie.UNKNOWN,o.toString())}))}jo(e,t,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.jo(e,Qy(t,n),i,c,d,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new me(ie.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function t3(r,e,t,n){return new e3(r,e,t,n)}class n3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Cn(t),this.aa=!1):de("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sl="RemoteStore";class r3{constructor(e,t,n,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo((c=>{n.enqueueAndForget((async()=>{cl(this)&&(de(sl,"Restarting streams for network reachability change."),await(async function(f){const m=Ae(f);m.Ea.add(4),await ih(m),m.Va.set("Unknown"),m.Ea.delete(4),await gm(m)})(this))}))})),this.Va=new n3(n,i)}}async function gm(r){if(cl(r))for(const e of r.Ra)await e(!0)}async function ih(r){for(const e of r.Ra)await e(!1)}function ym(r,e){const t=Ae(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),lb(t)?ob(t):Hc(t).O_()&&ab(t,e))}function jc(r,e){const t=Ae(r),n=Hc(t);t.Ia.delete(e),n.O_()&&YI(t,e),t.Ia.size===0&&(n.O_()?n.L_():cl(t)&&t.Va.set("Unknown"))}function ab(r,e){if(r.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Hc(r).Z_(e)}function YI(r,e){r.da.$e(e),Hc(r).X_(e)}function ob(r){r.da=new Wj({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),Hc(r).start(),r.Va.ua()}function lb(r){return cl(r)&&!Hc(r).x_()&&r.Ia.size>0}function cl(r){return Ae(r).Ea.size===0}function XI(r){r.da=void 0}async function s3(r){r.Va.set("Online")}async function i3(r){r.Ia.forEach(((e,t)=>{ab(r,e)}))}async function a3(r,e){XI(r),lb(r)?(r.Va.ha(e),ob(r)):r.Va.set("Unknown")}async function o3(r,e,t){if(r.Va.set("Online"),e instanceof aI&&e.state===2&&e.cause)try{await(async function(i,o){const c=o.cause;for(const d of o.targetIds)i.Ia.has(d)&&(await i.remoteSyncer.rejectListen(d,c),i.Ia.delete(d),i.da.removeTarget(d))})(r,e)}catch(n){de(sl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Mp(r,n)}else if(e instanceof rp?r.da.Xe(e):e instanceof iI?r.da.st(e):r.da.tt(e),!t.isEqual(Pe.min()))try{const n=await LI(r.localStore);t.compareTo(n)>=0&&await(function(o,c){const d=o.da.Tt(c);return d.targetChanges.forEach(((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const v=o.Ia.get(m);v&&o.Ia.set(m,v.withResumeToken(f.resumeToken,c))}})),d.targetMismatches.forEach(((f,m)=>{const v=o.Ia.get(f);if(!v)return;o.Ia.set(f,v.withResumeToken(Rn.EMPTY_BYTE_STRING,v.snapshotVersion)),YI(o,f);const b=new Mi(v.target,f,m,v.sequenceNumber);ab(o,b)})),o.remoteSyncer.applyRemoteEvent(d)})(r,t)}catch(n){de(sl,"Failed to raise snapshot:",n),await Mp(r,n)}}async function Mp(r,e,t){if(!no(e))throw e;r.Ea.add(1),await ih(r),r.Va.set("Offline"),t||(t=()=>LI(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{de(sl,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await gm(r)}))}function JI(r,e){return e().catch((t=>Mp(r,t,e)))}async function qc(r){const e=Ae(r),t=Ja(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fo;for(;l3(e);)try{const i=await HP(e.localStore,n);if(i===null){e.Ta.length===0&&t.L_();break}n=i.batchId,c3(e,i)}catch(i){await Mp(e,i)}WI(e)&&ZI(e)}function l3(r){return cl(r)&&r.Ta.length<10}function c3(r,e){r.Ta.push(e);const t=Ja(r);t.O_()&&t.Y_&&t.ea(e.mutations)}function WI(r){return cl(r)&&!Ja(r).x_()&&r.Ta.length>0}function ZI(r){Ja(r).start()}async function u3(r){Ja(r).ra()}async function d3(r){const e=Ja(r);for(const t of r.Ta)e.ea(t.mutations)}async function h3(r,e,t){const n=r.Ta.shift(),i=Qv.from(n,e,t);await JI(r,(()=>r.remoteSyncer.applySuccessfulWrite(i))),await qc(r)}async function f3(r,e){e&&Ja(r).Y_&&await(async function(n,i){if((function(c){return Yj(c)&&c!==ie.ABORTED})(i.code)){const o=n.Ta.shift();Ja(n).B_(),await JI(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i))),await qc(n)}})(r,e),WI(r)&&ZI(r)}async function xT(r,e){const t=Ae(r);t.asyncQueue.verifyOperationInProgress(),de(sl,"RemoteStore received new credentials");const n=cl(t);t.Ea.add(3),await ih(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await gm(t)}async function rv(r,e){const t=Ae(r);e?(t.Ea.delete(2),await gm(t)):e||(t.Ea.add(2),await ih(t),t.Va.set("Unknown"))}function Hc(r){return r.ma||(r.ma=(function(t,n,i){const o=Ae(t);return o.sa(),new JP(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(r.datastore,r.asyncQueue,{Zo:s3.bind(null,r),Yo:i3.bind(null,r),t_:a3.bind(null,r),J_:o3.bind(null,r)}),r.Ra.push((async e=>{e?(r.ma.B_(),lb(r)?ob(r):r.Va.set("Unknown")):(await r.ma.stop(),XI(r))}))),r.ma}function Ja(r){return r.fa||(r.fa=(function(t,n,i){const o=Ae(t);return o.sa(),new WP(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(r.datastore,r.asyncQueue,{Zo:()=>Promise.resolve(),Yo:u3.bind(null,r),t_:f3.bind(null,r),ta:d3.bind(null,r),na:h3.bind(null,r)}),r.Ra.push((async e=>{e?(r.fa.B_(),await qc(r)):(await r.fa.stop(),r.Ta.length>0&&(de(sl,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))}))),r.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e,t,n,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new ui,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,o){const c=Date.now()+n,d=new cb(e,t,c,i,o);return d.start(n),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ub(r,e){if(Cn("AsyncQueue",`${e}: ${r}`),no(r))return new me(ie.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{static emptySet(e){return new mc(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||xe.comparator(t.key,n.key):(t,n)=>xe.comparator(t.key,n.key),this.keyedMap=td(),this.sortedSet=new Gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof mc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new mc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(){this.ga=new Gt(xe.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ee(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Pc{constructor(e,t,n,i,o,c,d,f,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,i,o){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new Pc(e,t,mc.emptySet(t),c,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class m3{constructor(){this.queries=wT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=Ae(t),o=i.queries;i.queries=wT(),o.forEach(((c,d)=>{for(const f of d.ba)f.onError(n)}))})(this,new me(ie.ABORTED,"Firestore shutting down"))}}function wT(){return new Hi((r=>q2(r)),lm)}async function db(r,e){const t=Ae(r);let n=3;const i=e.query;let o=t.queries.get(i);o?!o.Sa()&&e.Da()&&(n=2):(o=new p3,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(c){const d=ub(c,`Initialization of query '${sc(e.query)}' failed`);return void e.onError(d)}t.queries.set(i,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&fb(t)}async function hb(r,e){const t=Ae(r),n=e.query;let i=3;const o=t.queries.get(n);if(o){const c=o.ba.indexOf(e);c>=0&&(o.ba.splice(c,1),o.ba.length===0?i=e.Da()?0:1:!o.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function g3(r,e){const t=Ae(r);let n=!1;for(const i of e){const o=i.query,c=t.queries.get(o);if(c){for(const d of c.ba)d.Fa(i)&&(n=!0);c.wa=i}}n&&fb(t)}function y3(r,e,t){const n=Ae(r),i=n.queries.get(e);if(i)for(const o of i.ba)o.onError(t);n.queries.delete(e)}function fb(r){r.Ca.forEach((e=>{e.next()}))}var sv,ET;(ET=sv||(sv={})).Ma="default",ET.Cache="cache";class pb{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Pc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Pc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==sv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this.key=e}}class tA{constructor(e){this.key=e}}class v3{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=tt(),this.mutatedKeys=tt(),this.eu=$2(e),this.tu=new mc(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new _T,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,c=i,d=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((v,b)=>{const _=i.get(v),S=nh(this.query,b)?b:null,k=!!_&&this.mutatedKeys.has(_.key),L=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let B=!1;_&&S?_.data.isEqual(S.data)?k!==L&&(n.track({type:3,doc:S}),B=!0):this.su(_,S)||(n.track({type:2,doc:S}),B=!0,(f&&this.eu(S,f)>0||m&&this.eu(S,m)<0)&&(d=!0)):!_&&S?(n.track({type:0,doc:S}),B=!0):_&&!S&&(n.track({type:1,doc:_}),B=!0,(f||m)&&(d=!0)),B&&(S?(c=c.add(S),o=L?o.add(v):o.delete(v)):(c=c.delete(v),o=o.delete(v)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const v=this.query.limitType==="F"?c.last():c.first();c=c.delete(v.key),o=o.delete(v.key),n.track({type:1,doc:v})}return{tu:c,iu:n,Ss:d,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((v,b)=>(function(S,k){const L=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ee(20277,{Vt:B})}};return L(S)-L(k)})(v.type,b.type)||this.eu(v.doc,b.doc))),this.ou(n),i=i??!1;const d=t&&!i?this._u():[],f=this.Ya.size===0&&this.current&&!i?1:0,m=f!==this.Xa;return this.Xa=f,c.length!==0||m?{snapshot:new Pc(this.query,e.tu,o,c,e.mutatedKeys,f===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new _T,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=tt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new tA(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new eA(n))})),t}cu(e){this.Za=e.ks,this.Ya=tt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Pc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const $c="SyncEngine";class b3{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class x3{constructor(e){this.key=e,this.hu=!1}}class _3{constructor(e,t,n,i,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Hi((d=>q2(d)),lm),this.Iu=new Map,this.Eu=new Set,this.Ru=new Gt(xe.comparator),this.Au=new Map,this.Vu=new eb,this.du={},this.mu=new Map,this.fu=rl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function w3(r,e,t=!0){const n=vm(r);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await nA(n,e,t,!0),i}async function E3(r,e){const t=vm(r);await nA(t,e,!0,!1)}async function nA(r,e,t,n){const i=await Op(r.localStore,ls(e)),o=i.targetId,c=r.sharedClientState.addLocalQueryTarget(o,t);let d;return n&&(d=await mb(r,e,o,c==="current",i.resumeToken)),r.isPrimaryClient&&t&&ym(r.remoteStore,i),d}async function mb(r,e,t,n,i){r.pu=(b,_,S)=>(async function(L,B,X,re){let ee=B.view.ru(X);ee.Ss&&(ee=await ev(L.localStore,B.query,!1).then((({documents:C})=>B.view.ru(C,ee))));const le=re&&re.targetChanges.get(B.targetId),fe=re&&re.targetMismatches.get(B.targetId)!=null,ce=B.view.applyChanges(ee,L.isPrimaryClient,le,fe);return iv(L,B.targetId,ce.au),ce.snapshot})(r,b,_,S);const o=await ev(r.localStore,e,!0),c=new v3(e,o.ks),d=c.ru(o.documents),f=sh.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),m=c.applyChanges(d,r.isPrimaryClient,f);iv(r,t,m.au);const v=new b3(e,t,c);return r.Tu.set(e,v),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),m.snapshot}async function T3(r,e,t){const n=Ae(r),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter((c=>!lm(c,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Oc(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),t&&jc(n.remoteStore,i.targetId),Mc(n,i.targetId)})).catch(to)):(Mc(n,i.targetId),await Oc(n.localStore,i.targetId,!0))}async function S3(r,e){const t=Ae(r),n=t.Tu.get(e),i=t.Iu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),jc(t.remoteStore,n.targetId))}async function N3(r,e,t){const n=bb(r);try{const i=await(function(c,d){const f=Ae(c),m=Dt.now(),v=d.reduce(((S,k)=>S.add(k.key)),tt());let b,_;return f.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let k=as(),L=tt();return f.xs.getEntries(S,v).next((B=>{k=B,k.forEach(((X,re)=>{re.isValidDocument()||(L=L.add(X))}))})).next((()=>f.localDocuments.getOverlayedDocuments(S,k))).next((B=>{b=B;const X=[];for(const re of d){const ee=Kj(re,b.get(re.key).overlayedDocument);ee!=null&&X.push(new $i(re.key,ee,j2(ee.value.mapValue),Sr.exists(!0)))}return f.mutationQueue.addMutationBatch(S,m,X,d)})).next((B=>{_=B;const X=B.applyToLocalDocumentSet(b,L);return f.documentOverlayCache.saveOverlays(S,B.batchId,X)}))})).then((()=>({batchId:_.batchId,changes:Q2(b)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),(function(c,d,f){let m=c.du[c.currentUser.toKey()];m||(m=new Gt(Ge)),m=m.insert(d,f),c.du[c.currentUser.toKey()]=m})(n,i.batchId,t),await so(n,i.changes),await qc(n.remoteStore)}catch(i){const o=ub(i,"Failed to persist write");t.reject(o)}}async function rA(r,e){const t=Ae(r);try{const n=await GP(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const c=t.Au.get(o);c&&(ke(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?c.hu=!0:i.modifiedDocuments.size>0?ke(c.hu,14607):i.removedDocuments.size>0&&(ke(c.hu,42227),c.hu=!1))})),await so(t,n,e)}catch(n){await to(n)}}function TT(r,e,t){const n=Ae(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Tu.forEach(((o,c)=>{const d=c.view.va(e);d.snapshot&&i.push(d.snapshot)})),(function(c,d){const f=Ae(c);f.onlineState=d;let m=!1;f.queries.forEach(((v,b)=>{for(const _ of b.ba)_.va(d)&&(m=!0)})),m&&fb(f)})(n.eventManager,e),i.length&&n.Pu.J_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function I3(r,e,t){const n=Ae(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Au.get(e),o=i&&i.key;if(o){let c=new Gt(xe.comparator);c=c.insert(o,_n.newNoDocument(o,Pe.min()));const d=tt().add(o),f=new rh(Pe.min(),new Map,new Gt(Ge),c,d);await rA(n,f),n.Ru=n.Ru.remove(o),n.Au.delete(e),vb(n)}else await Oc(n.localStore,e,!1).then((()=>Mc(n,e,t))).catch(to)}async function A3(r,e){const t=Ae(r),n=e.batch.batchId;try{const i=await FP(t.localStore,e);yb(t,n,null),gb(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await so(t,i)}catch(i){await to(i)}}async function C3(r,e,t){const n=Ae(r);try{const i=await(function(c,d){const f=Ae(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let v;return f.mutationQueue.lookupMutationBatch(m,d).next((b=>(ke(b!==null,37113),v=b.keys(),f.mutationQueue.removeMutationBatch(m,b)))).next((()=>f.mutationQueue.performConsistencyCheck(m))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(m,v,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v))).next((()=>f.localDocuments.getDocuments(m,v)))}))})(n.localStore,e);yb(n,e,t),gb(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await so(n,i)}catch(i){await to(i)}}function gb(r,e){(r.mu.get(e)||[]).forEach((t=>{t.resolve()})),r.mu.delete(e)}function yb(r,e,t){const n=Ae(r);let i=n.du[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),n.du[n.currentUser.toKey()]=i}}function Mc(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Vu.Gr(e).forEach((n=>{r.Vu.containsKey(n)||sA(r,n)}))}function sA(r,e){r.Eu.delete(e.path.canonicalString());const t=r.Ru.get(e);t!==null&&(jc(r.remoteStore,t),r.Ru=r.Ru.remove(e),r.Au.delete(t),vb(r))}function iv(r,e,t){for(const n of t)n instanceof eA?(r.Vu.addReference(n.key,e),R3(r,n)):n instanceof tA?(de($c,"Document no longer in limbo: "+n.key),r.Vu.removeReference(n.key,e),r.Vu.containsKey(n.key)||sA(r,n.key)):Ee(19791,{wu:n})}function R3(r,e){const t=e.key,n=t.path.canonicalString();r.Ru.get(t)||r.Eu.has(n)||(de($c,"New document in limbo: "+t),r.Eu.add(n),vb(r))}function vb(r){for(;r.Eu.size>0&&r.Ru.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new xe(At.fromString(e)),n=r.fu.next();r.Au.set(n,new x3(t)),r.Ru=r.Ru.insert(t,n),ym(r.remoteStore,new Mi(ls(th(t.path)),n,"TargetPurposeLimboResolution",qr.ce))}}async function so(r,e,t){const n=Ae(r),i=[],o=[],c=[];n.Tu.isEmpty()||(n.Tu.forEach(((d,f)=>{c.push(n.pu(f,e,t).then((m=>{var v;if((m||t)&&n.isPrimaryClient){const b=m?!m.fromCache:(v=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:v.current;n.sharedClientState.updateQueryState(f.targetId,b?"current":"not-current")}if(m){i.push(m);const b=rb.Es(f.targetId,m);o.push(b)}})))})),await Promise.all(c),n.Pu.J_(i),await(async function(f,m){const v=Ae(f);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>q.forEach(m,(_=>q.forEach(_.Ts,(S=>v.persistence.referenceDelegate.addReference(b,_.targetId,S))).next((()=>q.forEach(_.Is,(S=>v.persistence.referenceDelegate.removeReference(b,_.targetId,S)))))))))}catch(b){if(!no(b))throw b;de(sb,"Failed to update sequence numbers: "+b)}for(const b of m){const _=b.targetId;if(!b.fromCache){const S=v.vs.get(_),k=S.snapshotVersion,L=S.withLastLimboFreeSnapshotVersion(k);v.vs=v.vs.insert(_,L)}}})(n.localStore,o))}async function k3(r,e){const t=Ae(r);if(!t.currentUser.isEqual(e)){de($c,"User change. New user:",e.toKey());const n=await VI(t.localStore,e);t.currentUser=e,(function(o,c){o.mu.forEach((d=>{d.forEach((f=>{f.reject(new me(ie.CANCELLED,c))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await so(t,n.Ns)}}function D3(r,e){const t=Ae(r),n=t.Au.get(e);if(n&&n.hu)return tt().add(n.key);{let i=tt();const o=t.Iu.get(e);if(!o)return i;for(const c of o){const d=t.Tu.get(c);i=i.unionWith(d.view.nu)}return i}}async function O3(r,e){const t=Ae(r),n=await ev(t.localStore,e.query,!0),i=e.view.cu(n);return t.isPrimaryClient&&iv(t,e.targetId,i.au),i}async function j3(r,e){const t=Ae(r);return zI(t.localStore,e).then((n=>so(t,n)))}async function P3(r,e,t,n){const i=Ae(r),o=await(function(d,f){const m=Ae(d),v=Ae(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(b=>v.Xn(b,f).next((_=>_?m.localDocuments.getDocuments(b,_):q.resolve(null)))))})(i.localStore,e);o!==null?(t==="pending"?await qc(i.remoteStore):t==="acknowledged"||t==="rejected"?(yb(i,e,n||null),gb(i,e),(function(d,f){Ae(Ae(d).mutationQueue).nr(f)})(i.localStore,e)):Ee(6720,"Unknown batchState",{bu:t}),await so(i,o)):de($c,"Cannot apply mutation batch with id: "+e)}async function M3(r,e){const t=Ae(r);if(vm(t),bb(t),e===!0&&t.gu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await ST(t,n.toArray());t.gu=!0,await rv(t.remoteStore,!0);for(const o of i)ym(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const n=[];let i=Promise.resolve();t.Iu.forEach(((o,c)=>{t.sharedClientState.isLocalQueryTarget(c)?n.push(c):i=i.then((()=>(Mc(t,c),Oc(t.localStore,c,!0)))),jc(t.remoteStore,c)})),await i,await ST(t,n),(function(c){const d=Ae(c);d.Au.forEach(((f,m)=>{jc(d.remoteStore,m)})),d.Vu.zr(),d.Au=new Map,d.Ru=new Gt(xe.comparator)})(t),t.gu=!1,await rv(t.remoteStore,!1)}}async function ST(r,e,t){const n=Ae(r),i=[],o=[];for(const c of e){let d;const f=n.Iu.get(c);if(f&&f.length!==0){d=await Op(n.localStore,ls(f[0]));for(const m of f){const v=n.Tu.get(m),b=await O3(n,v);b.snapshot&&o.push(b.snapshot)}}else{const m=await UI(n.localStore,c);d=await Op(n.localStore,m),await mb(n,iA(m),c,!1,d.resumeToken)}i.push(d)}return n.Pu.J_(o),i}function iA(r){return F2(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function V3(r){return(function(t){return Ae(Ae(t).persistence).hs()})(Ae(r).localStore)}async function L3(r,e,t,n){const i=Ae(r);if(i.gu)return void de($c,"Ignoring unexpected query state notification.");const o=i.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const c=await zI(i.localStore,H2(o[0])),d=rh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Rn.EMPTY_BYTE_STRING);await so(i,c,d);break}case"rejected":await Oc(i.localStore,e,!0),Mc(i,e,n);break;default:Ee(64155,t)}}async function U3(r,e,t){const n=vm(r);if(n.gu){for(const i of e){if(n.Iu.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){de($c,"Adding an already active target "+i);continue}const o=await UI(n.localStore,i),c=await Op(n.localStore,o);await mb(n,iA(o),c.targetId,!1,c.resumeToken),ym(n.remoteStore,c)}for(const i of t)n.Iu.has(i)&&await Oc(n.localStore,i,!1).then((()=>{jc(n.remoteStore,i),Mc(n,i)})).catch(to)}}function vm(r){const e=Ae(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=rA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=D3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=I3.bind(null,e),e.Pu.J_=g3.bind(null,e.eventManager),e.Pu.yu=y3.bind(null,e.eventManager),e}function bb(r){const e=Ae(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=A3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=C3.bind(null,e),e}class Ld{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return MI(this.persistence,new PI,e.initialUser,this.serializer)}Cu(e){return new tb(pm.Vi,this.serializer)}Du(e){return new HI}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ld.provider={build:()=>new Ld};class z3 extends Ld{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ke(this.persistence.referenceDelegate instanceof Dp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new CI(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?wr.withCacheSize(this.cacheSizeBytes):wr.DEFAULT;return new tb((n=>Dp.Vi(n,t)),this.serializer)}}class aA extends Ld{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await bb(this.xu.syncEngine),await qc(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return MI(this.persistence,new PI,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new CI(n,e.asyncQueue,t)}Mu(e,t){const n=new KO(t,this.persistence);return new $O(e.asyncQueue,n)}Cu(e){const t=jI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?wr.withCacheSize(this.cacheSizeBytes):wr.DEFAULT;return new nb(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,$I(),ip(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new HI}}class B3 extends aA{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof ly&&(this.sharedClientState.syncEngine={So:P3.bind(null,t),Do:L3.bind(null,t),Co:U3.bind(null,t),hs:V3.bind(null,t),bo:j3.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async n=>{await M3(this.xu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))}Du(e){const t=$I();if(!ly.v(t))throw new me(ie.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=jI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ly(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Ud{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>TT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=k3.bind(null,this.syncEngine),await rv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new m3})()}createDatastore(e){const t=mm(e.databaseInfo.databaseId),n=XP(e.databaseInfo);return t3(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,i,o,c,d){return new r3(n,i,o,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>TT(this.syncEngine,t,0)),(function(){return vT.v()?new vT:new $P})())}createSyncEngine(e,t){return(function(i,o,c,d,f,m,v){const b=new _3(i,o,c,d,f,m);return v&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(i){const o=Ae(i);de(sl,"RemoteStore shutting down."),o.Ea.add(5),await ih(o),o.Aa.shutdown(),o.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Ud.provider={build:()=>new Ud};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Cn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa="FirestoreClient";class F3{constructor(e,t,n,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=i,this.user=_r.UNAUTHENTICATED,this.clientId=jv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async c=>{de(Wa,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(n,(c=>(de(Wa,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ui;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=ub(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function uy(r,e){r.asyncQueue.verifyOperationInProgress(),de(Wa,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener((async i=>{n.isEqual(i)||(await VI(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=e}async function NT(r,e){r.asyncQueue.verifyOperationInProgress();const t=await G3(r);de(Wa,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener((n=>xT(e.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,i)=>xT(e.remoteStore,i))),r._onlineComponents=e}async function G3(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){de(Wa,"Using user provided OfflineComponentProvider");try{await uy(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ie.FAILED_PRECONDITION||i.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;bc("Error using user provided cache. Falling back to memory cache: "+t),await uy(r,new Ld)}}else de(Wa,"Using default OfflineComponentProvider"),await uy(r,new z3(void 0));return r._offlineComponents}async function oA(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(de(Wa,"Using user provided OnlineComponentProvider"),await NT(r,r._uninitializedComponentsProvider._online)):(de(Wa,"Using default OnlineComponentProvider"),await NT(r,new Ud))),r._onlineComponents}function q3(r){return oA(r).then((e=>e.syncEngine))}async function Vp(r){const e=await oA(r),t=e.eventManager;return t.onListen=w3.bind(null,e.syncEngine),t.onUnlisten=T3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=E3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=S3.bind(null,e.syncEngine),t}function H3(r,e,t,n){const i=new xb(n),o=new pb(e,i,t);return r.asyncQueue.enqueueAndForget((async()=>db(await Vp(r),o))),()=>{i.Nu(),r.asyncQueue.enqueueAndForget((async()=>hb(await Vp(r),o)))}}function $3(r,e,t={}){const n=new ui;return r.asyncQueue.enqueueAndForget((async()=>(function(o,c,d,f,m){const v=new xb({next:_=>{v.Nu(),c.enqueueAndForget((()=>hb(o,b)));const S=_.docs.has(d);!S&&_.fromCache?m.reject(new me(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&_.fromCache&&f&&f.source==="server"?m.reject(new me(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(_)},error:_=>m.reject(_)}),b=new pb(th(d.path),v,{includeMetadataChanges:!0,Ka:!0});return db(o,b)})(await Vp(r),r.asyncQueue,e,t,n))),n.promise}function K3(r,e,t={}){const n=new ui;return r.asyncQueue.enqueueAndForget((async()=>(function(o,c,d,f,m){const v=new xb({next:_=>{v.Nu(),c.enqueueAndForget((()=>hb(o,b))),_.fromCache&&f.source==="server"?m.reject(new me(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(_)},error:_=>m.reject(_)}),b=new pb(d,v,{includeMetadataChanges:!0,Ka:!0});return db(o,b)})(await Vp(r),r.asyncQueue,e,t,n))),n.promise}function Q3(r,e){const t=new ui;return r.asyncQueue.enqueueAndForget((async()=>N3(await q3(r),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3="ComponentProvider",IT=new Map;function X3(r,e,t,n,i){return new _j(r,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,lA(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3="firestore.googleapis.com",AT=!0;class CT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new me(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=J3,this.ssl=AT}else this.host=e.host,this.ssl=e.ssl??AT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=TI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<AI)throw new me(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}GO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lA(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new me(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new me(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new me(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _b{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new CT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new CT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new jO;switch(n.type){case"firstParty":return new VO(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new me(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=IT.get(t);n&&(de(Y3,"Removing Datastore"),IT.delete(t),n.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ul(this.firestore,e,this._query)}}class wn{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wn(this.firestore,e,this._key)}toJSON(){return{type:wn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Jd(t,wn._jsonSchema))return new wn(e,n||null,new xe(At.fromString(t.referencePath)))}}wn._jsonSchemaVersion="firestore/documentReference/1.0",wn._jsonSchema={type:zn("string",wn._jsonSchemaVersion),referencePath:zn("string")};class Qa extends ul{constructor(e,t,n){super(e,t,th(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wn(this.firestore,null,new xe(e))}withConverter(e){return new Qa(this.firestore,e,this._path)}}function fi(r,e,...t){if(r=Wn(r),o2("collection","path",e),r instanceof _b){const n=At.fromString(e,...t);return bE(n),new Qa(r,null,n)}{if(!(r instanceof wn||r instanceof Qa))throw new me(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(At.fromString(e,...t));return bE(n),new Qa(r.firestore,null,n)}}function $r(r,e,...t){if(r=Wn(r),arguments.length===1&&(e=jv.newId()),o2("doc","path",e),r instanceof _b){const n=At.fromString(e,...t);return vE(n),new wn(r,null,new xe(n))}{if(!(r instanceof wn||r instanceof Qa))throw new me(ie.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(At.fromString(e,...t));return vE(n),new wn(r.firestore,r instanceof Qa?r.converter:null,new xe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT="AsyncQueue";class kT{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new KI(this,"async_queue_retry"),this._c=()=>{const n=ip();n&&de(RT,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=ip();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ip();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ui;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!no(e))throw e;de(RT,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Cn("INTERNAL UNHANDLED ERROR: ",DT(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=cb.createAndSchedule(this,e,t,n,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&Ee(47125,{Pc:DT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function DT(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}class Fi extends _b{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new kT,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new kT(e),this._firestoreClient=void 0,await e}}}function W3(r,e,t){t||(t=Ep);const n=Tv(r,"firestore");if(n.isInitialized(t)){const i=n.getImmediate({identifier:t}),o=n.getOptions(t);if(Qo(o,e))return i;throw new me(ie.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new me(ie.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<AI)throw new me(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Uc(e.host)&&cN(e.host),n.initialize({options:e,instanceIdentifier:t})}function bm(r){if(r._terminated)throw new me(ie.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Z3(r),r._firestoreClient}function Z3(r){var n,i,o,c;const e=r._freezeSettings(),t=X3(r._databaseId,((n=r._app)==null?void 0:n.options.appId)||"",r._persistenceKey,(i=r._app)==null?void 0:i.options.apiKey,e);r._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((c=e.localCache)!=null&&c._onlineComponentProvider)&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new F3(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e){this._byteString=e}static fromBase64String(e){try{return new As(Rn.fromBase64String(e))}catch(t){throw new me(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new As(Rn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:As._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Jd(e,As._jsonSchema))return As.fromBase64String(e.bytes)}}As._jsonSchemaVersion="firestore/bytes/1.0",As._jsonSchema={type:zn("string",As._jsonSchemaVersion),bytes:zn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:di._jsonSchemaVersion}}static fromJSON(e){if(Jd(e,di._jsonSchema))return new di(e.latitude,e.longitude)}}di._jsonSchemaVersion="firestore/geoPoint/1.0",di._jsonSchema={type:zn("string",di._jsonSchemaVersion),latitude:zn("number"),longitude:zn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Gs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Jd(e,Gs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Gs(e.vectorValues);throw new me(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Gs._jsonSchemaVersion="firestore/vectorValue/1.0",Gs._jsonSchema={type:zn("string",Gs._jsonSchemaVersion),vectorValues:zn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM=/^__.*__$/;class tM{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new $i(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gc(e,this.data,t,this.fieldTransforms)}}class cA{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new $i(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function uA(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ee(40011,{dataSource:r})}}class Tb{constructor(e,t,n,i,o,c){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Tb({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var i;const t=(i=this.path)==null?void 0:i.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePathSegment(e),n}childContextForFieldPath(e){var i;const t=(i=this.path)==null?void 0:i.child(e),n=this.contextWith({path:t,arrayElement:!1});return n.validatePath(),n}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Lp(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(uA(this.dataSource)&&eM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class nM{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||mm(e)}createContext(e,t,n,i=!1){return new Tb({dataSource:e,methodName:t,targetDoc:n,path:hn.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xm(r){const e=r._freezeSettings(),t=mm(r._databaseId);return new nM(r._databaseId,!!e.ignoreUndefinedProperties,t)}function dA(r,e,t,n,i,o={}){const c=r.createContext(o.merge||o.mergeFields?2:0,e,t,i);Sb("Data must be an object, but it was:",c,n);const d=hA(n,c);let f,m;if(o.merge)f=new Hr(c.fieldMask),m=c.fieldTransforms;else if(o.mergeFields){const v=[];for(const b of o.mergeFields){const _=Vc(e,b,t);if(!c.contains(_))throw new me(ie.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);mA(v,_)||v.push(_)}f=new Hr(v),m=c.fieldTransforms.filter((b=>f.covers(b.field)))}else f=null,m=c.fieldTransforms;return new tM(new Tr(d),f,m)}class _m extends Eb{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _m}}function rM(r,e,t,n){const i=r.createContext(1,e,t);Sb("Data must be an object, but it was:",i,n);const o=[],c=Tr.empty();ro(n,((f,m)=>{const v=pA(e,f,t);m=Wn(m);const b=i.childContextForFieldPath(v);if(m instanceof _m)o.push(v);else{const _=ah(m,b);_!=null&&(o.push(v),c.set(v,_))}}));const d=new Hr(o);return new cA(c,d,i.fieldTransforms)}function sM(r,e,t,n,i,o){const c=r.createContext(1,e,t),d=[Vc(e,n,t)],f=[i];if(o.length%2!=0)throw new me(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)d.push(Vc(e,o[_])),f.push(o[_+1]);const m=[],v=Tr.empty();for(let _=d.length-1;_>=0;--_)if(!mA(m,d[_])){const S=d[_];let k=f[_];k=Wn(k);const L=c.childContextForFieldPath(S);if(k instanceof _m)m.push(S);else{const B=ah(k,L);B!=null&&(m.push(S),v.set(S,B))}}const b=new Hr(m);return new cA(v,b,c.fieldTransforms)}function iM(r,e,t,n=!1){return ah(t,r.createContext(n?4:3,e))}function ah(r,e){if(fA(r=Wn(r)))return Sb("Unsupported field value:",e,r),hA(r,e);if(r instanceof Eb)return(function(n,i){if(!uA(i.dataSource))throw i.createError(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(n,i){const o=[];let c=0;for(const d of n){let f=ah(d,i.childContextForArray(c));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),c++}return{arrayValue:{values:o}}})(r,e)}return(function(n,i){if((n=Wn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return zj(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Dt.fromDate(n);return{timestampValue:Dc(i.serializer,o)}}if(n instanceof Dt){const o=new Dt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Dc(i.serializer,o)}}if(n instanceof di)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof As)return{bytesValue:oI(i.serializer,n._byteString)};if(n instanceof wn){const o=i.databaseId,c=n.firestore._databaseId;if(!c.isEqual(o))throw i.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Jv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Gs)return(function(c,d){const f=c instanceof Gs?c.toArray():c;return{mapValue:{fields:{[Fv]:{stringValue:Gv},[Nc]:{arrayValue:{values:f.map((v=>{if(typeof v!="number")throw d.createError("VectorValues must only contain numeric values.");return $v(d.serializer,v)}))}}}}}})(n,i);if(vI(n))return n._toProto(i.serializer);throw i.createError(`Unsupported field value: ${em(n)}`)})(r,e)}function hA(r,e){const t={};return S2(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ro(r,((n,i)=>{const o=ah(i,e.childContextForField(n));o!=null&&(t[n]=o)})),{mapValue:{fields:t}}}function fA(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Dt||r instanceof di||r instanceof As||r instanceof wn||r instanceof Eb||r instanceof Gs||vI(r))}function Sb(r,e,t){if(!fA(t)||!l2(t)){const n=em(t);throw n==="an object"?e.createError(r+" a custom object"):e.createError(r+" "+n)}}function Vc(r,e,t){if((e=Wn(e))instanceof wb)return e._internalPath;if(typeof e=="string")return pA(r,e);throw Lp("Field path arguments must be of type string or ",r,!1,void 0,t)}const aM=new RegExp("[~\\*/\\[\\]]");function pA(r,e,t){if(e.search(aM)>=0)throw Lp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new wb(...e.split("."))._internalPath}catch{throw Lp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Lp(r,e,t,n,i){const o=n&&!n.isEmpty(),c=i!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(o||c)&&(f+=" (found",o&&(f+=` in field ${n}`),c&&(f+=` in document ${i}`),f+=")"),new me(ie.INVALID_ARGUMENT,d+r+f)}function mA(r,e){return r.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{convertValue(e,t="none"){switch(Ya(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Bi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ee(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ro(e,((i,o)=>{n[i]=this.convertValue(o,t)})),n}convertVectorValue(e){var n,i,o;const t=(o=(i=(n=e.fields)==null?void 0:n[Nc].arrayValue)==null?void 0:i.values)==null?void 0:o.map((c=>rn(c.doubleValue)));return new Gs(t)}convertGeoPoint(e){return new di(rn(e.latitude),rn(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=am(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Dd(e));default:return null}}convertTimestamp(e){const t=zi(e);return new Dt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=At.fromString(e);ke(yI(n),9688,{name:e});const i=new Zo(n.get(1),n.get(3)),o=new xe(n.popFirst(5));return i.isEqual(t)||Cn(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb extends oM{constructor(e){super(),this.firestore=e}convertBytes(e){return new As(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wn(this.firestore,null,t)}}const OT="@firebase/firestore",jT="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(r){return(function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of n)if(o in i&&typeof i[o]=="function")return!0;return!1})(r,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,t,n,i,o){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new wn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(Vc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class lM extends gA{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new me(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ib{}class cM extends Ib{}function wm(r,e,...t){let n=[];e instanceof Ib&&n.push(e),n=n.concat(t),(function(o){const c=o.filter((f=>f instanceof Ab)).length,d=o.filter((f=>f instanceof Em)).length;if(c>1||c>0&&d>0)throw new me(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const i of n)r=i._apply(r);return r}class Em extends cM{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Em(e,t,n)}_apply(e){const t=this._parse(e);return vA(e._query,t),new ul(e.firestore,e.converter,Hy(e._query,t))}_parse(e){const t=xm(e.firestore);return(function(o,c,d,f,m,v,b){let _;if(m.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new me(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){VT(b,v);const k=[];for(const L of b)k.push(MT(f,o,L));_={arrayValue:{values:k}}}else _=MT(f,o,b)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||VT(b,v),_=iM(d,c,b,v==="in"||v==="not-in");return dt.create(m,v,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Tm(r,e,t){const n=e,i=Vc("where",r);return Em._create(i,n,t)}class Ab extends Ib{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ab(e,t)}_parse(e){const t=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return t.length===1?t[0]:Ot.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let c=i;const d=o.getFlattenedFilters();for(const f of d)vA(c,f),c=Hy(c,f)})(e._query,t),new ul(e.firestore,e.converter,Hy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function MT(r,e,t){if(typeof(t=Wn(t))=="string"){if(t==="")throw new me(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!G2(e)&&t.indexOf("/")!==-1)throw new me(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(At.fromString(t));if(!xe.isDocumentKey(n))throw new me(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return jd(r,new xe(n))}if(t instanceof wn)return jd(r,t._key);throw new me(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${em(t)}.`)}function VT(r,e){if(!Array.isArray(r)||r.length===0)throw new me(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vA(r,e){const t=(function(i,o){for(const c of i)for(const d of c.getFlattenedFilters())if(o.indexOf(d.op)>=0)return d.op;return null})(r.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new me(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function bA(r,e,t){let n;return n=r?r.toFirestore(e):e,n}class uM{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=pM(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function dM(r){return new uM(r)}class hM{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ud.provider,this._offlineComponentProvider={build:t=>new aA(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class fM{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ud.provider,this._offlineComponentProvider={build:t=>new B3(t,e==null?void 0:e.cacheSizeBytes)}}}function pM(r){return new hM(r==null?void 0:r.forceOwnership)}function mM(){return new fM}class sd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ho extends gA{constructor(e,t,n,i,o,c){super(e,t,n,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ap(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Vc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ho._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ho._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ho._jsonSchema={type:zn("string",Ho._jsonSchemaVersion),bundleSource:zn("string","DocumentSnapshot"),bundleName:zn("string"),bundle:zn("string")};class ap extends Ho{data(e={}){return super.data(e)}}class $o{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new sd(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new ap(this._firestore,this._userDataWriter,n.key,n,new sd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let c=0;return i._snapshot.docChanges.map((d=>{const f=new ap(i._firestore,i._userDataWriter,d.doc.key,d.doc,new sd(i._snapshot.mutatedKeys.has(d.doc.key),i._snapshot.fromCache),i.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((d=>o||d.type!==3)).map((d=>{const f=new ap(i._firestore,i._userDataWriter,d.doc.key,d.doc,new sd(i._snapshot.mutatedKeys.has(d.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,v=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),v=c.indexOf(d.doc.key)),{type:gM(d.type),doc:f,oldIndex:m,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=$o._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gM(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ee(61501,{type:r})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$o._jsonSchemaVersion="firestore/querySnapshot/1.0",$o._jsonSchema={type:zn("string",$o._jsonSchemaVersion),bundleSource:zn("string","QuerySnapshot"),bundleName:zn("string"),bundle:zn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sm(r){r=os(r,wn);const e=os(r.firestore,Fi),t=bm(e);return $3(t,r._key).then((n=>_A(e,r,n)))}function Kc(r){r=os(r,ul);const e=os(r.firestore,Fi),t=bm(e),n=new Nb(e);return yA(r._query),K3(t,r._query).then((i=>new $o(e,n,r,i)))}function xA(r,e,t){r=os(r,wn);const n=os(r.firestore,Fi),i=bA(r.converter,e),o=xm(n);return Im(n,[dA(o,"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,Sr.none())])}function Nm(r,e,t,...n){r=os(r,wn);const i=os(r.firestore,Fi),o=xm(i);let c;return c=typeof(e=Wn(e))=="string"||e instanceof wb?sM(o,"updateDoc",r._key,e,t,n):rM(o,"updateDoc",r._key,e),Im(i,[c.toMutation(r._key,Sr.exists(!0))])}function zd(r){return Im(os(r.firestore,Fi),[new dm(r._key,Sr.none())])}function yM(r,e){const t=os(r.firestore,Fi),n=$r(r),i=bA(r.converter,e),o=xm(r.firestore);return Im(t,[dA(o,"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,Sr.exists(!1))]).then((()=>n))}function Up(r,...e){var m,v,b;r=Wn(r);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||PT(e[n])||(t=e[n++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(PT(e[n])){const _=e[n];e[n]=(m=_.next)==null?void 0:m.bind(_),e[n+1]=(v=_.error)==null?void 0:v.bind(_),e[n+2]=(b=_.complete)==null?void 0:b.bind(_)}let o,c,d;if(r instanceof wn)c=os(r.firestore,Fi),d=th(r._key.path),o={next:_=>{e[n]&&e[n](_A(c,r,_))},error:e[n+1],complete:e[n+2]};else{const _=os(r,ul);c=os(_.firestore,Fi),d=_._query;const S=new Nb(c);o={next:k=>{e[n]&&e[n](new $o(c,S,_,k))},error:e[n+1],complete:e[n+2]},yA(r._query)}const f=bm(c);return H3(f,d,i,o)}function Im(r,e){const t=bm(r);return Q3(t,e)}function _A(r,e,t){const n=t.docs.get(e._key),i=new Nb(r);return new Ho(r,i,e._key,n,new sd(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){DO(zc),vc(new Yo("firestore",((n,{instanceIdentifier:i,options:o})=>{const c=n.getProvider("app").getImmediate(),d=new Fi(new PO(n.getProvider("auth-internal")),new LO(c,n.getProvider("app-check-internal")),wj(c,i),c);return o={useFetchStreams:t,...o},d._setSettings(o),d}),"PUBLIC").setMultipleInstances(!0)),Ha(OT,jT,e),Ha(OT,jT,"esm2020")})();const vM={apiKey:"AIzaSyD2rR0OH2OzSlt4fs2w72TKOUNDngp0zXQ",authDomain:"singmode-7c657.firebaseapp.com",projectId:"singmode-7c657",storageBucket:"singmode-7c657.firebasestorage.app",messagingSenderId:"292866266443",appId:"1:292866266443:web:190d34e55980509c1b04ce"},wA=gN(vM),Cb=RO(wA),fn=W3(wA,{localCache:dM({tabManager:mM()})});class bM{constructor(){this.peer=null,this.lockPeer=null,this.connections=new Map,this.hostId=null,this.isHost=!1,this.heartbeatInterval=null,this.retryCount=0,this.maxRetries=10,this.actionQueue=[],this.onStateReceived=null,this.onActionReceived=null,this.onConnectionStatus=null,this.onPeerConnected=null,this.onDeviceConnected=null,this.onDeviceDisconnected=null,this.staleCheckInterval=null,this.loadQueue()}loadQueue(){try{const e=localStorage.getItem("singmode_pending_actions");e&&(this.actionQueue=JSON.parse(e),console.log(`[Sync] Loaded ${this.actionQueue.length} pending actions from storage.`),this.startStaleActionCleanup())}catch(e){console.warn("[Sync] Failed to load pending actions:",e)}}startStaleActionCleanup(){this.staleCheckInterval&&clearInterval(this.staleCheckInterval),this.staleCheckInterval=window.setInterval(()=>{const e=Date.now(),t=this.actionQueue.length;this.actionQueue=this.actionQueue.filter(n=>{const i=n.bufferedAt||n.timestamp||0;return i===0||e-i<45e3}),this.actionQueue.length!==t&&(console.log(`[Sync] Cleared ${t-this.actionQueue.length} stale actions from queue.`),this.persistQueue())},1e4)}persistQueue(){try{localStorage.setItem("singmode_pending_actions",JSON.stringify(this.actionQueue)),typeof window<"u"&&window.dispatchEvent(new Event("kstar_sync"))}catch(e){console.warn("[Sync] Failed to persist pending actions:",e)}}async getPublicIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip||"unknown-network"}catch(e){return console.warn("[Sync] Could not fetch public IP for lock, using fallback",e),"local-fallback"}}async initialize(e,t){if(this.isHost=e==="DJ",!this.isHost&&t&&(this.hostId=t),this.peer&&this.destroy(),this.isHost&&!t){const n=await this.getPublicIP(),i=`singmode-lock-${btoa(n).replace(/=/g,"").substr(0,12)}`;if(console.log(`[Sync] Attempting to claim network lock: ${i}`),!await new Promise(c=>{const d=new dp(i,{debug:1});d.on("open",()=>{this.lockPeer=d,c(!0)}),d.on("error",f=>{f.type==="unavailable-id"?c(!1):c(!0),d.destroy()})}))throw new Error("COLLISION: A SingMode DJ session is already active on this network.")}return new Promise((n,i)=>{const o=this.isHost?t||`singmode-${Math.random().toString(36).substr(2,6)}`:void 0;this.peer=new dp(o,{debug:1,config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun.stuntmanit.com:3478"},{urls:"stun:stun.ekiga.net"},{urls:"stun:stun.ideasip.com"},{urls:"stun:stun.schlund.de"},{urls:"stun:stun.voiparound.com"},{urls:"stun:stun.voipbuster.com"},{urls:"stun:stun.voipstunt.com"}]}}),this.peer.on("open",c=>{console.log(`[Sync] Peer opened with ID: ${c}`),this.isHost&&(this.hostId=c),this.retryCount=0,this.startHeartbeat(),!this.isHost&&t&&this.connectToHost(t),this.onConnectionStatus&&(!t||this.connections.size>0)&&this.onConnectionStatus("connected"),n(c)}),this.peer.on("disconnected",()=>{var c;console.warn("[Sync] Peer disconnected from signaling server. Attempting reconnect..."),this.onConnectionStatus&&this.onConnectionStatus("connecting"),(c=this.peer)==null||c.reconnect()}),this.peer.on("connection",c=>{this.handleConnection(c)}),this.peer.on("error",c=>{var d;console.error("[Sync] Peer error:",c.type,c),c.type==="unavailable-id"?(this.destroy(),this.initialize(e).then(n).catch(i)):c.type==="network"||c.type==="server-error"||(d=c.message)!=null&&d.includes("Lost connection")?(this.onConnectionStatus&&this.onConnectionStatus("disconnected"),this.handleNetworkError(e,t)):c.type==="peer-unavailable"&&this.onConnectionStatus&&this.onConnectionStatus("disconnected")})})}handleNetworkError(e,t){if(this.retryCount<this.maxRetries){this.retryCount++;const n=Math.min(1e3*Math.pow(2,this.retryCount),3e4);console.log(`[Sync] Network failure. Retrying in ${n}ms... (Attempt ${this.retryCount})`),setTimeout(()=>{this.initialize(e,t)},n)}}startHeartbeat(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.heartbeatInterval=window.setInterval(()=>{this.peer&&this.peer.disconnected&&!this.peer.destroyed&&this.peer.reconnect(),this.lockPeer&&this.lockPeer.disconnected&&!this.lockPeer.destroyed&&this.lockPeer.reconnect()},5e3)}connectToHost(e){if(!this.peer||this.isHost||this.peer.destroyed)return;this.onConnectionStatus&&this.onConnectionStatus("connecting");const t=this.peer.connect(e,{reliable:!0});this.handleConnection(t)}handleConnection(e){e.on("open",()=>{console.log(`[Sync] Data connection established with: ${e.peer}`),this.connections.set(e.peer,e),!this.isHost&&this.actionQueue.length>0&&(console.log(`[Sync] Resending ${this.actionQueue.length} queued actions to host.`),this.actionQueue.forEach(t=>{e.send(t)})),this.onConnectionStatus&&this.onConnectionStatus("connected"),this.isHost&&this.onPeerConnected&&this.onPeerConnected(),this.isHost&&this.onDeviceConnected&&this.onDeviceConnected(e.peer)}),e.on("data",t=>{if(t&&typeof t=="object")if("type"in t){const n={...t,senderId:e.peer};this.onActionReceived&&this.onActionReceived(n)}else"participants"in t&&this.applyIncomingState(t)}),e.on("close",()=>{console.log(`[Sync] Connection closed: ${e.peer}`),this.connections.delete(e.peer),this.connections.size===0&&this.onConnectionStatus&&(this.isHost||(this.onConnectionStatus("disconnected"),this.hostId&&(console.log("[Sync] Attempting background reconnect in 3s..."),setTimeout(()=>this.connectToHost(this.hostId),3e3)))),this.isHost&&this.onDeviceDisconnected&&this.onDeviceDisconnected(e.peer)}),e.on("error",t=>{console.error("[Sync] Connection error:",t),this.connections.delete(e.peer)})}broadcastState(e){this.isHost&&this.connections.forEach(t=>{t.open&&t.send(e)})}broadcastAction(e){this.isHost&&this.connections.forEach(t=>{t.open&&t.send(e)})}async sendAction(e){if(this.isHost)return;if(!this.actionQueue.some(n=>n.type===e.type&&JSON.stringify(n.payload)===JSON.stringify(e.payload))){console.log("[Sync] Queuing new action locally:",e.type),this.actionQueue.push(e),this.persistQueue();let n=!1;if(this.connections.forEach(i=>{i.open&&(n=!0)}),this.hostId)try{const i=yM(fi(fn,"sessions",this.hostId,"pending_actions"),{...e,bufferedAt:Date.now()});n?i.catch(o=>console.warn("[Sync] Background Firestore buffering delayed:",o.message)):(console.log(`[Sync] No active P2P connection. Awaiting explicit Firestore fallback write for ${e.type}...`),await Promise.race([i,new Promise((o,c)=>setTimeout(()=>c(new Error("Firestore write timeout")),5e3))]),console.log(`[Sync] Action ${e.type} confirmed written to Firestore.`))}catch(i){if(console.error(`[Sync] CRITICAL: Failed to write to Firestore fallback: ${i.message}`),!n)throw new Error("Network unreachable. Failed to contact host via P2P or Database.")}else if(!n)throw new Error("Cannot send action: No Room ID and No Active Connection.")}this.connections.forEach(n=>{n.open&&(console.log("[Sync] Sending action directly via PeerJS:",e.type),n.send(e))})}getRoomId(){return this.hostId}getMyPeerId(){var e;return((e=this.peer)==null?void 0:e.id)||null}applyIncomingState(e){if(!this.isHost&&this.actionQueue.length>0){const t=this.actionQueue.length;this.actionQueue=this.actionQueue.filter(n=>{if(n.type==="ADD_REQUEST"){const i=n.payload;return!e.requests.some(o=>o.participantId===i.participantId&&o.songName.toLowerCase().trim()===i.songName.toLowerCase().trim()&&o.artist.toLowerCase().trim()===i.artist.toLowerCase().trim())}return!0}),this.actionQueue.length!==t&&(console.log(`[Sync] Self-cleaned ${t-this.actionQueue.length} processed actions from queue.`),this.persistQueue())}this.onStateReceived&&this.onStateReceived(e)}getPendingActions(){return this.actionQueue}destroy(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.connections.forEach(e=>e.close()),this.connections.clear(),this.peer&&(this.peer.destroy(),this.peer=null),this.lockPeer&&(this.lockPeer.destroy(),this.lockPeer=null)}}const pt=new bM,Rb="kstar_karaoke_session",dr="kstar_active_user",hr="kstar_user_accounts";let Ft=!1,LT=Promise.resolve();const oh=async r=>await(LT=LT.then(async()=>{const t=await nt(),n=await r(t);return await Ct(t),n})),EA={id:"current-session",participants:[],requests:[],currentRound:null,history:[],messages:[],tickerMessages:[],verifiedSongbook:[],isPlayingVideo:!1,nextRequestNumber:1,maxRequestsPerUser:5,bannedUsers:[],deviceConnections:[],queueStrategy:si.FRESH_MEAT,startedAt:Date.now()},av=typeof window<"u"&&window.chrome&&window.chrome.storage,mt={get:async r=>{if(av)return(await window.chrome.storage.local.get([r]))[r];const e=localStorage.getItem(r);return e?JSON.parse(e):null},set:async(r,e)=>{av?await window.chrome.storage.local.set({[r]:e}):localStorage.setItem(r,JSON.stringify(e)),typeof window<"u"&&(window.dispatchEvent(new Event("kstar_sync")),window.dispatchEvent(new Event("storage")))}};pt.onStateReceived=r=>{Ft&&mt.set(Rb,r)};pt.onActionReceived=r=>{TA(r)};pt.onPeerConnected=async()=>{if(!Ft){const r=await nt();pt.broadcastState(r)}};async function TA(r){switch(r.type){case"ADD_REQUEST":await Oi(r.payload);break;case"JOIN_SESSION":{const{id:n,profile:i}=r.payload;if(i){const o=await an(),c=o.findIndex(d=>d.id===n);c===-1?(o.push(i),await mt.set(hr,o)):(o[c]={...o[c],...i},await mt.set(hr,o))}await Ko(n),ov(`${(i==null?void 0:i.name)||n} joined the session`,"info"),await oh(o=>{o.deviceConnections||(o.deviceConnections=[]);const c=o.deviceConnections.findIndex(d=>d.peerId===r.senderId);c>-1?(o.deviceConnections[c].userId=n,o.deviceConnections[c].isGuest=(i==null?void 0:i.isGuest)??!1,r.payload.userAgent&&(o.deviceConnections[c].userAgent=r.payload.userAgent)):o.deviceConnections.push({id:`D-${Math.random().toString(36).substr(2,4).toUpperCase()}`,peerId:r.senderId,connectedAt:Date.now(),lastSeen:Date.now(),status:"connected",userAgent:r.payload.userAgent||"Unknown",userId:n,isGuest:(i==null?void 0:i.isGuest)??!1})});break}case"TOGGLE_STATUS":await Ba(r.payload.id,r.payload.status);break;case"TOGGLE_MIC":await PM(r.payload.id,r.payload.enabled);break;case"HEARTBEAT":await SA(r.senderId);break;case"DELETE_REQUEST":await Da(r.payload);break;case"UPDATE_REQUEST":await yd(r.payload.id,r.payload.updates);break;case"ADD_CHAT":await zM(r.senderId,r.payload.name,r.payload.text);break;case"SYNC_PROFILE":if(Ft){const n=await Or();n&&n.id===r.payload.id&&await mt.set(dr,r.payload)}const e=await an(),t=e.findIndex(n=>n.id===r.payload.id);t>-1?e[t]=r.payload:e.push(r.payload),await mt.set(hr,e);break;case"TOGGLE_FAVORITE":Ft||await CA(r.payload,r.senderId);break;case"REORDER_ROUND":await RA(r.payload);break;case"REORDER_REQUESTS":await kA(r.payload);break;case"REORDER_PENDING":await DA(r.payload);break;case"REORDER_PARTICIPANTS":await OA(r.payload);break;case"REORDER_MY_REQUESTS":await cv(r.senderId,r.payload.requestId,r.payload.direction);break}}const gc=async(r,e)=>{let t=e;if(r==="PARTICIPANT"){if(!t){const i=await zp();if(i.length>0){t=i[0].id,console.log("[Sync] No room provided for participant, joining latest active session:",t);const o=await NA(t);o&&pt.applyIncomingState(o)}}if(t)try{const i=await Sm($r(fn,"sessions",t));if(i.exists()&&i.data().isActive===!1){console.warn("[Sync] Found last room but it is INACTIVE. Clearing stale cache."),localStorage.removeItem("kstar_last_room"),t=void 0;const c=await zp();c.length>0&&(t=c[0].id)}}catch(i){console.warn("[Sync] Error validating session activity:",i)}if(t){Ft=!0,console.log("[Sync] Initializing robust Firestore fallback sync for room:",t),wM(t,o=>{console.log("[Sync] Received state update via Firestore fallback"),pt.applyIncomingState(o)});const i=setInterval(()=>{Ft&&pt.sendAction({type:"HEARTBEAT",payload:{},senderId:pt.getMyPeerId()||"anon"}).catch(o=>console.warn("[Sync] Heartbeat failed:",o.message))},3e4);window.addEventListener("beforeunload",()=>clearInterval(i))}}const n=await pt.initialize(r,t);if(Ft=r==="PARTICIPANT"&&!!t,!Ft&&n){localStorage.setItem("kstar_dj_session_id",n);const i=await Or(),o=(i==null?void 0:i.name)||"SingMode DJ",c=i==null?void 0:i.id;await FM({id:n,hostName:o,hostUid:c,isActive:!0,startedAt:Date.now()});const d=setInterval(()=>{GM(n)},120*1e3);window.addEventListener("beforeunload",()=>{clearInterval(d),jA(n)});const f=fi(fn,"users");Up(f,v=>{const b=[];v.forEach(_=>{b.push(_.data())}),console.log("Synced users from Firestore:",b.length),mt.set(hr,b)}),pt.onDeviceConnected=v=>{SA(v),ov(`New device connected: ${v.substr(0,8)}...`,"info")},pt.onDeviceDisconnected=async v=>{const b=await nt();if(b.deviceConnections){const _=b.deviceConnections.findIndex(S=>S.peerId===v);if(_>-1){const S=b.deviceConnections[_].id;b.deviceConnections[_].status="disconnected",b.deviceConnections[_].lastSeen=Date.now(),await Ct(b),ov(`Device disconnected: ${S}`,"warn")}}};const m=fi(fn,"sessions",n,"pending_actions");Up(m,v=>{v.docChanges().forEach(async b=>{if(b.type==="added"){const _=b.doc.data();console.log("[SessionManager] Received buffered action from Firestore:",_.type),await TA(_),await zd(b.doc.ref)}})})}},SA=async r=>{await oh(e=>{e.deviceConnections||(e.deviceConnections=[]);const t=e.deviceConnections.findIndex(n=>n.peerId===r);t>-1?(e.deviceConnections[t].status="connected",e.deviceConnections[t].lastSeen=Date.now()):e.deviceConnections.push({id:`D-${Math.random().toString(36).substr(2,4).toUpperCase()}`,peerId:r,connectedAt:Date.now(),lastSeen:Date.now(),status:"connected",userAgent:"Unknown"})})},xM=async(r,e,t=!1)=>{await oh(n=>{if(!n.deviceConnections)return;const i=n.deviceConnections.findIndex(o=>o.id===r);i>-1&&(n.deviceConnections[i].userId=e,n.deviceConnections[i].isGuest=t)})},_M=async r=>{await oh(e=>{e.deviceConnections&&(e.deviceConnections=e.deviceConnections.filter(t=>t.id!==r))})},nt=async r=>{if(!Ft&&r){const t=await NA(r);if(t)return t}const e=await mt.get(Rb)||{...EA};return e.history||(e.history=[]),e.messages||(e.messages=[]),e.tickerMessages||(e.tickerMessages=[]),e.verifiedSongbook||(e.verifiedSongbook=[]),e.isPlayingVideo===void 0&&(e.isPlayingVideo=!1),e.nextRequestNumber||(e.nextRequestNumber=1),e.maxRequestsPerUser===void 0&&(e.maxRequestsPerUser=5),e.bannedUsers||(e.bannedUsers=[]),e.deviceConnections||(e.deviceConnections=[]),e.logs||(e.logs=[]),e.queueStrategy||(e.queueStrategy=si.FRESH_MEAT),e},Ct=async r=>{if(await mt.set(Rb,r),pt.broadcastState(r),!Ft&&r.id)try{const e=$r(fn,"sessions",r.id);await Nm(e,{fullState:JSON.stringify(r),lastHeartbeat:Date.now(),participantsCount:r.participants.length})}catch(e){console.error("[SessionManager] Error persisting full state to Firestore:",e)}},NA=async r=>{try{const e=$r(fn,"sessions",r),t=await Sm(e);if(t.exists()){const n=t.data();if(n.fullState)return JSON.parse(n.fullState)}return null}catch(e){return console.error(`[SessionManager] Error fetching session ${r}:`,e),null}},wM=(r,e)=>{const t=$r(fn,"sessions",r);return Up(t,n=>{if(n.exists()){const i=n.data();if(i.fullState)try{const o=JSON.parse(i.fullState);e(o)}catch(o){console.error("[SessionManager] Error parsing session state from Firestore:",o)}}})},ov=async(r,e="info")=>{await oh(t=>{t.logs||(t.logs=[]),t.logs.push({timestamp:Date.now(),message:r,type:e}),t.logs.length>100&&(t.logs=t.logs.slice(-100))})},IA=(r,e)=>{if(e.youtubeUrl&&e.youtubeUrl.trim()!==""){const t=r.verifiedSongbook.find(n=>n.songName.toLowerCase()===e.songName.toLowerCase()&&n.artist.toLowerCase()===e.artist.toLowerCase());if(t)t.youtubeUrl!==e.youtubeUrl&&(t.youtubeUrl=e.youtubeUrl);else{const n={id:Math.random().toString(36).substr(2,9),songName:e.songName,artist:e.artist,youtubeUrl:e.youtubeUrl,type:e.type,addedAt:Date.now()};r.verifiedSongbook.push(n)}}},EM=async r=>{const e=await nt(),t={...r,id:Math.random().toString(36).substr(2,9),addedAt:Date.now()};e.verifiedSongbook.push(t),await Ct(e)},TM=async(r,e)=>{const t=await nt(),n=t.verifiedSongbook.findIndex(i=>i.id===r);n!==-1&&(t.verifiedSongbook[n]={...t.verifiedSongbook[n],...e},await Ct(t))},UT=async r=>{const e=await nt();e.verifiedSongbook=e.verifiedSongbook.filter(t=>t.id!==r),await Ct(e)},SM=async()=>{const r=await nt(),e={};r.requests.forEach(o=>{o.status===Fe.APPROVED&&!o.isInRound&&(e[o.participantId]||(e[o.participantId]=[]),e[o.participantId].push(o))});const n=[...await an()];for(const o in e){const c=n.findIndex(d=>d.id===o);if(c>-1){const f=[...n[c].pendingQueue||[],...e[o]];n[c]={...n[c],pendingQueue:f},await Gi(o,{pendingQueue:f})}}const i={...EA,id:`session-${Date.now()}`,verifiedSongbook:r.verifiedSongbook,nextRequestNumber:1,startedAt:Date.now()};await Ct(i)},an=async()=>{let r=await mt.get(hr);if(!r||r.length===0){try{const t=fi(fn,"users"),n=await Kc(t),i=[];if(n.forEach(o=>i.push(o.data())),i.length>0)return await mt.set(hr,i),i}catch(t){console.error("Error fetching users from Firebase:",t)}return Array.from({length:5},(t,n)=>({id:`singer-${n+1}`,name:`Singer${n+1}`,favorites:[],personalHistory:[],createdAt:Date.now()}))}return r},Gi=async(r,e)=>{try{const t=$r(fn,"users",r);if(e.name&&(await an()).find(d=>{var f;return d.id!==r&&d.name.toLowerCase()===((f=e.name)==null?void 0:f.toLowerCase())}))return{success:!1,error:"Username already exists."};await Nm(t,e);const n=await an(),i=n.findIndex(o=>o.id===r);if(i>-1){n[i]={...n[i],...e},await mt.set(hr,n);const o=await Or();o&&o.id===r&&await mt.set(dr,n[i]),Ft||pt.broadcastAction({type:"SYNC_PROFILE",payload:n[i],senderId:"DJ"})}return{success:!0}}catch(t){return console.error("Error updating account:",t),{success:!1,error:t.message}}},NM=async(r,e)=>{const t=await an(),n=t.findIndex(i=>i.id===r);if(n>-1){const i=t[n].favorites.filter(o=>o.id!==e);await Gi(r,{favorites:i})}},IM=async(r,e,t)=>{const n=await an(),i=n.findIndex(o=>o.id===r);if(i>-1){const o=[...n[i].favorites],c=o.findIndex(d=>d.id===e);c>-1&&(o[c]={...o[c],...t},await Gi(r,{favorites:o}))}},AM=async(r,e)=>{const t=await an(),n=t.findIndex(i=>i.id===r);if(n>-1){const i={...e,id:Math.random().toString(36).substr(2,9)},o=[...t[n].favorites,i];await Gi(r,{favorites:o})}},CM=async(r,e)=>{const t=await an(),n=t.findIndex(i=>i.id===r);if(n>-1){const i=t[n].personalHistory.filter(o=>o.id!==e);await Gi(r,{personalHistory:i})}},RM=async(r,e,t)=>{const n=await an(),i=n.findIndex(o=>o.id===r);if(i>-1){const o=[...n[i].personalHistory],c=o.findIndex(d=>d.id===e);c>-1&&(o[c]={...o[c],...t},await Gi(r,{personalHistory:o}))}},op=async r=>{await lv(r);try{await zd($r(fn,"users",r));let t=await an();t=t.filter(n=>n.id!==r),await mt.set(hr,t)}catch(t){console.error("Error deleting account",t)}const e=await Or();e&&e.id===r&&await Am()},AA=async()=>{try{const r=await an(),e=[],t=new Map;for(const n of r){if(!n.password){e.push(n.id);continue}const i=n.name.toLowerCase().trim();t.has(i)?e.push(n.id):t.set(i,n.id)}if(e.length>0){for(const c of e)await zd($r(fn,"users",c));const n=fi(fn,"users"),i=await Kc(n),o=[];i.forEach(c=>o.push(c.data())),await mt.set(hr,o)}return{success:!0,deletedCount:e.length}}catch(r){return console.error("Cleanup failed:",r),{success:!1,error:String(r)}}},Or=async()=>await mt.get(dr),Lc=async(r,e=!1)=>{var t;try{let n=r.id;const i=!!(r.password&&r.email),o=!!(r.password&&!r.email);if(i)try{n=(await m4(Cb,r.email,r.password)).user.uid}catch(m){if(m.code==="auth/email-already-in-use")return{success:!1,error:"Email already in use."};throw m}else if(o){if((await an()).find(b=>{var _;return b.name.toLowerCase()===((_=r.name)==null?void 0:_.trim().toLowerCase())}))return{success:!1,error:"Username already taken."};n=zT()||`user-${Date.now()}-${Math.random().toString(36).substr(2,5)}`}else n=r.id||zT()||`guest-${Math.random().toString(36).substr(2,9)}`;const c={id:n,name:((t=r.name)==null?void 0:t.trim())||"Guest",email:r.email||void 0,password:o?r.password:void 0,isGuest:!i&&!o,favorites:r.favorites||[],personalHistory:r.personalHistory||[],createdAt:Date.now()},d=JSON.parse(JSON.stringify(c));await xA($r(fn,"users",n),d);const f=await an();return f.some(m=>m.id===n)||(f.push(c),await mt.set(hr,f)),e?await mt.set(dr,c):Ft||pt.broadcastAction({type:"SYNC_PROFILE",payload:c,senderId:"DJ"}),{success:!0,profile:c}}catch(n){return console.error("Registration error:",n),{success:!1,error:n.message}}},zT=()=>{},kM=async(r,e)=>{if(r.toLowerCase()==="singmaster"&&e==="Organized"){const i={id:"admin-singmaster",name:"SingMaster",password:"Organized",favorites:[],personalHistory:[],createdAt:Date.now()};return await mt.set(dr,i),{success:!0,profile:i}}const t=await an();let n=t.find(i=>i.name.toLowerCase()===r.toLowerCase());if(!n)try{const i=fi(fn,"users"),o=wm(i,Tm("name","==",r)),c=await Kc(o);c.empty||(n=c.docs[0].data(),t.push(n),await mt.set(hr,t))}catch(i){console.warn("Error checking remote user:",i)}if(!n&&!e)return await Lc({name:r},!0);if(e)try{const i=`${r.replace(/\s+/g,"").toLowerCase()}@singmode.app`,c=(await g4(Cb,i,e)).user.uid,d=await Sm($r(fn,"users",c));if(d.exists()){const f=d.data();return await mt.set(dr,f),{success:!0,profile:f}}else return n?{success:!0,profile:n}:{success:!1,error:"Profile data missing."}}catch(i){return console.warn("Firebase login failed, checking legacy local storage:",i),n?n.password&&n.password===e?(await mt.set(dr,n),{success:!0,profile:n}):{success:!1,error:"Incorrect passkey."}:{success:!1,error:i.message||"Login failed."}}return n?(await mt.set(dr,n),{success:!0,profile:n}):{success:!1,error:"User not found"}},DM=async r=>{const e=await an();let t=e.find(n=>n.id===r);if(!t)try{const n=$r(fn,"users",r),i=await Sm(n);i.exists()&&(t=i.data(),e.push(t),await mt.set(hr,e))}catch(n){console.error("Error fetching user by ID:",n)}return t?(await mt.set(dr,t),{success:!0,profile:t}):(console.log(`[SessionManager] User ${r} not found, auto-registering as guest.`),await Lc({id:r,name:`Scan-${r.slice(-4)}`},!0))},Am=async()=>{await b4(Cb),av?await window.chrome.storage.local.remove([dr]):localStorage.removeItem(dr),window.dispatchEvent(new Event("kstar_sync"))},Ko=async r=>{var o;const e=await nt(),t=(o=e.bannedUsers)==null?void 0:o.find(c=>c.id===r);if(t)throw new Error(`ACCESS DENIED: ${t.reason}`);if(Ft){const c=await Or();return pt.sendAction({type:"JOIN_SESSION",payload:{id:r,profile:c,userAgent:typeof navigator<"u"?navigator.userAgent:"Unknown"},senderId:pt.getMyPeerId()||r}),{id:r,name:(c==null?void 0:c.name)||"Joining...",status:dn.STANDBY,joinedAt:Date.now()}}const i=(await an()).find(c=>c.id===r);if(!i){const c=await Or();if(c&&c.id===r)return await BT(e,c);throw new Error("Profile not found")}return await BT(e,i)},BT=async(r,e)=>{const t={id:e.id,name:e.name,status:dn.STANDBY,micEnabled:!1,joinedAt:Date.now()},n=r.participants.findIndex(i=>i.id===e.id);return n>-1?r.participants[n]={...r.participants[n],...t,status:r.participants[n].status}:r.participants.push(t),e.pendingQueue&&e.pendingQueue.length>0&&(e.pendingQueue.forEach(i=>{r.requests.find(c=>c.id===i.id||c.songName===i.songName&&c.artist===i.artist&&c.participantId===e.id)||r.requests.push({...i,status:Fe.APPROVED,isInRound:!1,createdAt:Date.now()})}),await Gi(e.id,{pendingQueue:[]})),await Ct(r),t},OM=async(r,e)=>{const t=await an(),n=t.findIndex(i=>i.id===r);if(n>-1){t[n].vocalRange=e,await mt.set(hr,t),Ft||pt.broadcastAction({type:"SYNC_PROFILE",payload:t[n],senderId:"DJ"});const i=await Or();i&&i.id===r&&await mt.set(dr,t[n])}},CA=async(r,e)=>{var o;const t=e||((o=await Or())==null?void 0:o.id);if(!t)return;if(Ft&&!e){pt.sendAction({type:"TOGGLE_FAVORITE",payload:r,senderId:t});const c=await Or();if(c){const d=c.favorites.findIndex(f=>f.songName===r.songName&&f.artist===r.artist);d>-1?c.favorites.splice(d,1):c.favorites.push({...r,id:Math.random().toString(36).substr(2,9)}),await mt.set(dr,c)}return}const n=await an(),i=n.findIndex(c=>c.id===t);if(i>-1){const c=n[i].favorites.findIndex(f=>f.songName===r.songName&&f.artist===r.artist);c>-1?n[i].favorites.splice(c,1):n[i].favorites.push({...r,id:Math.random().toString(36).substr(2,9)}),await mt.set(hr,n),Ft||pt.broadcastAction({type:"SYNC_PROFILE",payload:n[i],senderId:"DJ"});const d=await Or();d&&d.id===t&&await mt.set(dr,n[i])}},lv=async r=>{const e=await nt(),n=e.requests.filter(i=>i.participantId===r).map(i=>({...i,playedAt:Date.now(),status:Fe.DONE,isInRound:!1}));n.length>0&&(e.history=[...n,...e.history].slice(0,100)),e.participants=e.participants.filter(i=>i.id!==r),e.requests=e.requests.filter(i=>i.participantId!==r),e.currentRound&&(e.currentRound=e.currentRound.filter(i=>i.participantId!==r),e.currentRound.length===0&&(e.currentRound=null)),await Ct(e)},Ba=async(r,e)=>{if(Ft){pt.sendAction({type:"TOGGLE_STATUS",payload:{id:r,status:e},senderId:r});return}const t=await nt(),n=t.participants.find(i=>i.id===r);n&&(n.status=e,await Ct(t))},jM=async r=>{const e=await nt();e.maxRequestsPerUser=r,await Ct(e)},cv=async(r,e,t)=>{if(Ft){pt.sendAction({type:"REORDER_MY_REQUESTS",payload:{requestId:e,direction:t},senderId:r});return}const n=await nt(),i=n.requests.filter(v=>v.participantId===r&&v.status!==Fe.DONE),o=i.findIndex(v=>v.id===e);if(o===-1)return;const c=t==="up"?o-1:o+1;if(c<0||c>=i.length)return;const[d]=i.splice(o,1);i.splice(c,0,d);const f=[...n.requests];f.map((v,b)=>v.participantId===r&&v.status!==Fe.DONE?b:-1).filter(v=>v!==-1).forEach((v,b)=>{f[v]=i[b]}),n.requests=f,await Ct(n)},PM=async(r,e)=>{if(Ft){pt.sendAction({type:"TOGGLE_MIC",payload:{id:r,enabled:e},senderId:r});return}const t=await nt(),n=t.participants.find(i=>i.id===r);n&&(n.micEnabled=e,await Ct(t))},Oi=async r=>{if(Ft)return pt.sendAction({type:"ADD_REQUEST",payload:r,senderId:r.participantId}),null;const e=await nt(),t=e.nextRequestNumber++,n={...r,id:Math.random().toString(36).substr(2,9),requestNumber:t,createdAt:Date.now(),status:Fe.PENDING,isInRound:!1},i=e.requests.filter(m=>m.participantId===r.participantId&&m.status===Fe.PENDING);if(e.maxRequestsPerUser&&i.length>=e.maxRequestsPerUser)throw new Error(`Request limit reached. Max ${e.maxRequestsPerUser} requests allowed per performer.`);if(i.some(m=>m.songName.toLowerCase().trim()===r.songName.toLowerCase().trim()&&m.artist.toLowerCase().trim()===r.artist.toLowerCase().trim()))return console.log("[SessionManager] Duplicate request detected, skipping:",r.songName),null;e.requests.unshift(n),IA(e,n);const c=await an(),d=c.findIndex(m=>m.id===r.participantId);d>-1&&(c[d].personalHistory=[n,...c[d].personalHistory].slice(0,50),await mt.set(hr,c),Ft||pt.broadcastAction({type:"SYNC_PROFILE",payload:c[d],senderId:"DJ"}));const f=await Or();if(f&&f.id===r.participantId){const m=c.find(v=>v.id===r.participantId);m&&await mt.set(dr,m)}return await Ct(e),n},yd=async(r,e)=>{if(Ft){pt.sendAction({type:"UPDATE_REQUEST",payload:{id:r,updates:e},senderId:"client"});return}const t=await nt(),n=t.requests.findIndex(o=>o.id===r);let i="";if(n!==-1&&(t.requests[n]={...t.requests[n],...e},i=t.requests[n].participantId,IA(t,t.requests[n])),t.currentRound){const o=t.currentRound.findIndex(c=>c.id===r);o!==-1&&(t.currentRound[o]={...t.currentRound[o],...e},i=t.currentRound[o].participantId)}if(i){const o=await an(),c=o.findIndex(f=>f.id===i);if(c>-1){const f=o[c].personalHistory.findIndex(m=>m.id===r);f!==-1&&(o[c].personalHistory[f]={...o[c].personalHistory[f],...e},await mt.set(hr,o),Ft||pt.broadcastAction({type:"SYNC_PROFILE",payload:o[c],senderId:"DJ"}))}const d=await Or();if(d&&d.id===i){const f=o.find(m=>m.id===i);f&&await mt.set(dr,f)}}await Ct(t)},Zl=async r=>{const e=await nt(),t=e.requests.find(n=>n.id===r);t&&(t.status=Fe.APPROVED,await Ct(e))},MM=async r=>{const e=await nt(),t=e.requests.findIndex(i=>i.id===r);if(t===-1)return;const n=e.requests[t];n.status=Fe.APPROVED,n.isInRound=!0,e.currentRound?e.currentRound.push({...n}):e.currentRound=[{...n}],await Ct(e)},FT=async r=>{if(Ft)return;const e=await nt(),t=e.requests.find(n=>n.id===r);if(t){if(t.status=Fe.DONE,t.completedAt=Date.now(),e.currentRound){const n=e.currentRound.find(i=>i.id===r);n&&(n.status=Fe.DONE,n.completedAt=Date.now())}await Ct(e)}},Da=async r=>{if(Ft){pt.sendAction({type:"DELETE_REQUEST",payload:r,senderId:"client"});return}const e=await nt();e.requests=e.requests.filter(t=>t.id!==r),e.currentRound&&(e.currentRound=e.currentRound.filter(t=>t.id!==r),e.currentRound.length===0&&(e.currentRound=null)),await Ct(e)},GT=async(r,e)=>{const t=await nt(),n=t.requests.findIndex(o=>o.id===r);if(n===-1)return;const i=e==="up"?n-1:n+1;if(i>=0&&i<t.requests.length){const o=t.requests[n];t.requests[n]=t.requests[i],t.requests[i]=o,await Ct(t)}},VM=async r=>{const e=await nt();e.queueStrategy=r,await Ct(e)},LM=async()=>{const r=await nt(),e=r.queueStrategy||si.FRESH_MEAT,t=r.requests.filter(i=>i.status===Fe.APPROVED&&i.type===Tt.SINGING&&!i.isInRound),n=[];if(e===si.FIFO){const i=[...t].sort((o,c)=>o.createdAt-c.createdAt);n.push(...i.slice(0,10))}else{let o=[...r.participants.filter(c=>t.some(d=>d.participantId===c.id))];switch(e){case si.FRESH_MEAT:o.sort((f,m)=>(m.joinedAt||0)-(f.joinedAt||0));break;case si.OLDEST_MEMBER:o.sort((f,m)=>(f.joinedAt||0)-(m.joinedAt||0));break;case si.RANDOM:o.sort(()=>Math.random()-.5);break;case si.FAIR_ROTATION:const c=f=>r.requests.filter(m=>m.participantId===f&&m.status===Fe.DONE).length,d=f=>{var v;return((v=t.filter(b=>b.participantId===f).sort((b,_)=>b.createdAt-_.createdAt)[0])==null?void 0:v.createdAt)||Date.now()};o.sort((f,m)=>{const v=c(f.id),b=c(m.id);return v!==b?v-b:d(f.id)-d(m.id)});break}o.forEach(c=>{const f=t.filter(m=>m.participantId===c.id).sort((m,v)=>m.createdAt-v.createdAt)[0];f&&n.push(f)})}if(n.length===0){const i=r.requests.filter(o=>o.status===Fe.APPROVED&&o.type===Tt.LISTENING&&!o.isInRound).sort((o,c)=>o.createdAt-c.createdAt);i.length>0&&n.push(...i.slice(0,5))}n.forEach(i=>{const o=r.requests.find(c=>c.id===i.id);if(o&&(o.isInRound=!0),i.type===Tt.SINGING){const c=r.participants.find(d=>d.id===i.participantId);c&&(c.status=dn.READY)}}),n.length>0&&(r.currentRound=n,await Ct(r))},RA=async r=>{const e=await nt();e.currentRound=r,await Ct(e)},kA=async r=>{const e=await nt(),t=e.requests.filter(n=>!(n.status===Fe.APPROVED&&n.type===Tt.SINGING&&!n.isInRound));e.requests=[...r,...t],await Ct(e)},DA=async r=>{const e=await nt(),t=e.requests.filter(n=>!(n.status===Fe.PENDING&&!n.isInRound));e.requests=[...r,...t],await Ct(e)},OA=async r=>{const e=await nt();e.participants=r,await Ct(e)},UM=async()=>{const r=await nt();if(!r.currentRound)return;const e=[...r.currentRound].sort((d,f)=>d.completedAt&&f.completedAt?d.completedAt-f.completedAt:d.completedAt?-1:f.completedAt?1:0),t=Date.now(),n=e.map(d=>({...d,playedAt:t,isInRound:!1,status:Fe.DONE,completedAt:d.completedAt||t})),i=r.currentRound.map(d=>d.id);r.history=[...n,...r.history].slice(0,100),r.requests=r.requests.filter(d=>!i.includes(d.id));const o=await an();for(const d of n){const f=o.findIndex(m=>m.id===d.participantId);f!==-1&&(o[f].personalHistory=[d,...o[f].personalHistory].slice(0,50))}await mt.set(hr,o);const c=await Or();if(c){const d=o.find(f=>f.id===c.id);d&&await mt.set(dr,d)}r.currentRound=null,r.isPlayingVideo=!1,await Ct(r)},dy=async(r,e)=>{const t=await nt(),n=t.nextRequestNumber++,i={...r,id:Math.random().toString(36).substr(2,9),requestNumber:n,createdAt:Date.now(),status:Fe.APPROVED,isInRound:!1,playedAt:void 0,aiIntro:void 0};t.requests.push(i),await Ct(t)},qT=async()=>{const r=await nt();r.history=[],await Ct(r)},zM=async(r,e,t)=>{if(Ft){pt.sendAction({type:"ADD_CHAT",payload:{name:e,text:t},senderId:r});return}const n=await nt(),i={id:Math.random().toString(36).substr(2,9),senderId:r,senderName:e,text:t,timestamp:Date.now()};n.messages||(n.messages=[]),n.messages.push(i),await Ct(n)},BM=async()=>{const r=await an(),e=Date.now(),t=1440*60*1e3,n=r.filter(i=>!i.password&&i.createdAt&&e-i.createdAt>t);if(n.length>0){for(const i of n)await op(i.id);console.log(`Cleaned up ${n.length} expired guest accounts.`)}},FM=async r=>{try{const e={id:r.id,hostName:r.hostName||"SingMode DJ",hostUid:r.hostUid||"anonymous-host",appVersion:"singmode-v2",isActive:r.isActive??!0,startedAt:r.startedAt||Date.now(),lastHeartbeat:Date.now(),participantsCount:0,venueName:r.venueName||"SingMode Venue"};await xA($r(fn,"sessions",r.id),e)}catch(e){console.error("Error registering session:",e)}},GM=async r=>{try{const e=$r(fn,"sessions",r);await Nm(e,{lastHeartbeat:Date.now()})}catch(e){console.error("Error sending heartbeat:",e)}},jA=async r=>{try{const e=$r(fn,"sessions",r);await Nm(e,{isActive:!1,endedAt:Date.now()})}catch(e){console.error("Error unregistering session:",e)}},qM=async()=>{try{const r=fi(fn,"sessions"),e=wm(r,Tm("isActive","==",!1)),t=await Kc(e),n=[];return t.forEach(i=>{n.push(i.data())}),n.sort((i,o)=>(o.endedAt||0)-(i.endedAt||0))}catch(r){return console.error("Error fetching session history:",r),[]}},zp=async()=>{try{const r=fi(fn,"sessions"),e=wm(r,Tm("isActive","==",!0)),t=await Kc(e),n=new Map,i=Date.now(),o=300*1e3;return t.forEach(c=>{const d=c.data();if(d.lastHeartbeat&&i-d.lastHeartbeat<o){const m=d.hostUid||`${d.hostName}-${d.venueName}`,v=n.get(m);(!v||d.lastHeartbeat>v.lastHeartbeat)&&n.set(m,d)}}),Array.from(n.values()).sort((c,d)=>d.lastHeartbeat-c.lastHeartbeat)}catch(r){return console.error("Error fetching sessions:",r),[]}},HM=async()=>{try{const r=fi(fn,"sessions"),e=await Kc(r),t=Date.now(),n=1800*1e3;let i=0;for(const o of e.docs){const c=o.data();c.lastHeartbeat&&t-c.lastHeartbeat>n?(await zd(o.ref),i++):!c.lastHeartbeat&&t-c.startedAt>n&&(await zd(o.ref),i++)}return{success:!0,deletedCount:i}}catch(r){return console.error("Cleanup failed:",r),{success:!1,error:String(r)}}},kb=r=>{const e=fi(fn,"sessions"),t=wm(e,Tm("isActive","==",!0));return Up(t,n=>{const i=new Map,o=Date.now(),c=300*1e3;n.forEach(f=>{const m=f.data(),v=m.lastHeartbeat&&o-m.lastHeartbeat<c,b=m.appVersion==="singmode-v2";if(v&&b){const _=m.hostUid||`${m.hostName}-${m.venueName}`,S=i.get(_);(!S||m.lastHeartbeat>S.lastHeartbeat)&&i.set(_,m)}});const d=Array.from(i.values()).sort((f,m)=>m.lastHeartbeat-f.lastHeartbeat);r(d)})},PA=({onSubmit:r,onCancel:e,title:t="Song Request",showSingerName:n=!1,initialSingerName:i="",initialSongName:o="",initialArtist:c="",initialYoutubeUrl:d="",initialType:f=Tt.SINGING,submitLabel:m="SEND REQUEST",participants:v=[],currentUserId:b=""})=>{const[_,S]=j.useState(i),k=_?`${t}: ${_}`:t,[L,B]=j.useState(o),[X,re]=j.useState(c),[ee,le]=j.useState(d),[fe,ce]=j.useState(f),[C,I]=j.useState(""),[R,U]=j.useState(""),D=M=>{if(M.preventDefault(),(!L||!X)&&!ee||n&&!_)return;const O=v.find(qe=>qe.id===R);r({singerName:_,songName:L,artist:X,youtubeUrl:ee,type:fe,message:C,duetPartnerId:R||void 0,duetPartnerName:O==null?void 0:O.name})};return h.jsxs("form",{onSubmit:D,className:"relative w-full bg-[#050510] border-4 border-white/10 rounded-[3rem] p-10 overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] animate-in fade-in zoom-in-95 duration-300",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsxs("div",{className:"mb-8 text-center",children:[h.jsx("h3",{className:"text-3xl font-bold text-white font-bungee uppercase tracking-tight neon-text-glow-purple mb-2",children:k}),h.jsx("p",{className:"text-[10px] text-[var(--neon-cyan)] font-bold uppercase tracking-widest font-righteous opacity-80",children:"NEW REQUEST"})]}),h.jsxs("div",{className:"space-y-6",children:[n&&h.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2",children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Your Name"}),h.jsx("input",{type:"text",required:!0,value:_,onChange:M=>S(M.target.value),placeholder:"e.g. STAR_VIBE",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-cyan)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Song Title"}),h.jsx("input",{type:"text",value:L,onChange:M=>B(M.target.value),placeholder:"TITLE",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-pink)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Artist"}),h.jsx("input",{type:"text",value:X,onChange:M=>re(M.target.value),placeholder:"ARTIST",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-pink)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"YouTube URL (Optional)"}),h.jsx("input",{type:"url",value:ee,onChange:M=>le(M.target.value),placeholder:"https://youtube.com/watch?v=...",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-cyan)] outline-none transition-all text-xs font-mono shadow-inner tracking-wider"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Note for DJ"}),h.jsx("textarea",{value:C,onChange:M=>I(M.target.value),placeholder:"Key change? Dedication?",rows:2,className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-purple)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest resize-none"})]}),fe===Tt.SINGING&&v.length>1&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Duet Partner (Optional)"}),h.jsxs("select",{value:R,onChange:M=>U(M.target.value),className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold focus:border-[var(--neon-green)] outline-none transition-all uppercase shadow-inner text-sm font-righteous tracking-widest appearance-none",children:[h.jsx("option",{value:"",children:"-- NO PARTNER --"}),v.filter(M=>M.id!==b).map(M=>h.jsx("option",{value:M.id,children:M.name},M.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2 ml-4 font-righteous",children:"Performance Mode"}),h.jsx("div",{className:"flex bg-black/40 p-1.5 rounded-2xl border-2 border-white/5",children:Object.values(Tt).map(M=>h.jsx("button",{type:"button",onClick:()=>ce(M),className:`flex-1 py-3 rounded-xl font-bold text-[9px] uppercase tracking-widest transition-all font-righteous ${fe===M?"bg-[var(--neon-cyan)] text-black shadow-[0_0_20px_rgba(0,229,255,0.4)]":"text-slate-600 hover:text-white hover:bg-white/5"}`,children:M},M))})]}),h.jsxs("div",{className:"flex gap-4 pt-6",children:[h.jsx("button",{type:"button",onClick:e,className:"flex-1 py-4 bg-black hover:bg-white/5 text-white rounded-xl font-bold text-[10px] uppercase tracking-widest transition-all border-2 border-white/10 font-righteous",children:"DISCARD"}),h.jsx("button",{type:"submit",className:"flex-[2] py-4 bg-[var(--neon-pink)] hover:bg-white hover:text-black text-white rounded-xl font-bold text-[10px] uppercase tracking-widest shadow-[0_0_30px_rgba(255,0,127,0.4)] transition-all font-righteous hover:scale-105",children:m})]})]})]})};function $M(){if(typeof window>"u")return"/";const r=window.location.pathname.match(/^(\/[^/]+\/)/);return r?r[1]:"/"}function Bp(){if(typeof window>"u")return"";const r=window.location.port?`:${window.location.port}`:"",e=$M(),t=localStorage.getItem("kstar_network_ip");if(t){if(t.startsWith("http")){const c=t.replace(/\/$/,"");return c.endsWith(e.replace(/\/$/,""))?c+"/":c+e}return`http://${t.trim()}${r||":5173"}${e}`}const n=window.location.origin;return!n.includes("localhost")&&!n.includes("127.0.0.1"),n+e}function uv(r){localStorage.setItem("kstar_network_ip",r),window.dispatchEvent(new Event("kstar_sync"))}function MA(){return localStorage.getItem("kstar_network_ip")}var id=cS();function KM(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return j.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const Cm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Qc(r){const e=Object.prototype.toString.call(r);return e==="[object Window]"||e==="[object global]"}function Db(r){return"nodeType"in r}function Pr(r){var e,t;return r?Qc(r)?r:Db(r)&&(e=(t=r.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function Ob(r){const{Document:e}=Pr(r);return r instanceof e}function lh(r){return Qc(r)?!1:r instanceof Pr(r).HTMLElement}function VA(r){return r instanceof Pr(r).SVGElement}function Yc(r){return r?Qc(r)?r.document:Db(r)?Ob(r)?r:lh(r)||VA(r)?r.ownerDocument:document:document:document}const Hs=Cm?j.useLayoutEffect:j.useEffect;function Rm(r){const e=j.useRef(r);return Hs(()=>{e.current=r}),j.useCallback(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function QM(){const r=j.useRef(null),e=j.useCallback((n,i)=>{r.current=setInterval(n,i)},[]),t=j.useCallback(()=>{r.current!==null&&(clearInterval(r.current),r.current=null)},[]);return[e,t]}function Bd(r,e){e===void 0&&(e=[r]);const t=j.useRef(r);return Hs(()=>{t.current!==r&&(t.current=r)},e),t}function ch(r,e){const t=j.useRef();return j.useMemo(()=>{const n=r(t.current);return t.current=n,n},[...e])}function Fp(r){const e=Rm(r),t=j.useRef(null),n=j.useCallback(i=>{i!==t.current&&(e==null||e(i,t.current)),t.current=i},[]);return[t,n]}function Gp(r){const e=j.useRef();return j.useEffect(()=>{e.current=r},[r]),e.current}let hy={};function uh(r,e){return j.useMemo(()=>{if(e)return e;const t=hy[r]==null?0:hy[r]+1;return hy[r]=t,r+"-"+t},[r,e])}function LA(r){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.reduce((o,c)=>{const d=Object.entries(c);for(const[f,m]of d){const v=o[f];v!=null&&(o[f]=v+r*m)}return o},{...e})}}const yc=LA(1),Fd=LA(-1);function YM(r){return"clientX"in r&&"clientY"in r}function km(r){if(!r)return!1;const{KeyboardEvent:e}=Pr(r.target);return e&&r instanceof e}function XM(r){if(!r)return!1;const{TouchEvent:e}=Pr(r.target);return e&&r instanceof e}function qp(r){if(XM(r)){if(r.touches&&r.touches.length){const{clientX:e,clientY:t}=r.touches[0];return{x:e,y:t}}else if(r.changedTouches&&r.changedTouches.length){const{clientX:e,clientY:t}=r.changedTouches[0];return{x:e,y:t}}}return YM(r)?{x:r.clientX,y:r.clientY}:null}const pi=Object.freeze({Translate:{toString(r){if(!r)return;const{x:e,y:t}=r;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(r){if(!r)return;const{scaleX:e,scaleY:t}=r;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(r){if(r)return[pi.Translate.toString(r),pi.Scale.toString(r)].join(" ")}},Transition:{toString(r){let{property:e,duration:t,easing:n}=r;return e+" "+t+"ms "+n}}}),HT="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function JM(r){return r.matches(HT)?r:r.querySelector(HT)}const WM={display:"none"};function ZM(r){let{id:e,value:t}=r;return sn.createElement("div",{id:e,style:WM},t)}function e6(r){let{id:e,announcement:t,ariaLiveType:n="assertive"}=r;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return sn.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},t)}function t6(){const[r,e]=j.useState("");return{announce:j.useCallback(n=>{n!=null&&e(n)},[]),announcement:r}}const UA=j.createContext(null);function n6(r){const e=j.useContext(UA);j.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(r)},[r,e])}function r6(){const[r]=j.useState(()=>new Set),e=j.useCallback(n=>(r.add(n),()=>r.delete(n)),[r]);return[j.useCallback(n=>{let{type:i,event:o}=n;r.forEach(c=>{var d;return(d=c[i])==null?void 0:d.call(c,o)})},[r]),e]}const s6={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},i6={onDragStart(r){let{active:e}=r;return"Picked up draggable item "+e.id+"."},onDragOver(r){let{active:e,over:t}=r;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(r){let{active:e,over:t}=r;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(r){let{active:e}=r;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function a6(r){let{announcements:e=i6,container:t,hiddenTextDescribedById:n,screenReaderInstructions:i=s6}=r;const{announce:o,announcement:c}=t6(),d=uh("DndLiveRegion"),[f,m]=j.useState(!1);if(j.useEffect(()=>{m(!0)},[]),n6(j.useMemo(()=>({onDragStart(b){let{active:_}=b;o(e.onDragStart({active:_}))},onDragMove(b){let{active:_,over:S}=b;e.onDragMove&&o(e.onDragMove({active:_,over:S}))},onDragOver(b){let{active:_,over:S}=b;o(e.onDragOver({active:_,over:S}))},onDragEnd(b){let{active:_,over:S}=b;o(e.onDragEnd({active:_,over:S}))},onDragCancel(b){let{active:_,over:S}=b;o(e.onDragCancel({active:_,over:S}))}}),[o,e])),!f)return null;const v=sn.createElement(sn.Fragment,null,sn.createElement(ZM,{id:n,value:i.draggable}),sn.createElement(e6,{id:d,announcement:c}));return t?id.createPortal(v,t):v}var Hn;(function(r){r.DragStart="dragStart",r.DragMove="dragMove",r.DragEnd="dragEnd",r.DragCancel="dragCancel",r.DragOver="dragOver",r.RegisterDroppable="registerDroppable",r.SetDroppableDisabled="setDroppableDisabled",r.UnregisterDroppable="unregisterDroppable"})(Hn||(Hn={}));function Hp(){}function $T(r,e){return j.useMemo(()=>({sensor:r,options:e??{}}),[r,e])}function o6(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return j.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const $s=Object.freeze({x:0,y:0});function zA(r,e){return Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2))}function l6(r,e){const t=qp(r);if(!t)return"0 0";const n={x:(t.x-e.left)/e.width*100,y:(t.y-e.top)/e.height*100};return n.x+"% "+n.y+"%"}function BA(r,e){let{data:{value:t}}=r,{data:{value:n}}=e;return t-n}function c6(r,e){let{data:{value:t}}=r,{data:{value:n}}=e;return n-t}function KT(r){let{left:e,top:t,height:n,width:i}=r;return[{x:e,y:t},{x:e+i,y:t},{x:e,y:t+n},{x:e+i,y:t+n}]}function FA(r,e){if(!r||r.length===0)return null;const[t]=r;return t[e]}function QT(r,e,t){return e===void 0&&(e=r.left),t===void 0&&(t=r.top),{x:e+r.width*.5,y:t+r.height*.5}}const u6=r=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=r;const i=QT(e,e.left,e.top),o=[];for(const c of n){const{id:d}=c,f=t.get(d);if(f){const m=zA(QT(f),i);o.push({id:d,data:{droppableContainer:c,value:m}})}}return o.sort(BA)},d6=r=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=r;const i=KT(e),o=[];for(const c of n){const{id:d}=c,f=t.get(d);if(f){const m=KT(f),v=i.reduce((_,S,k)=>_+zA(m[k],S),0),b=Number((v/4).toFixed(4));o.push({id:d,data:{droppableContainer:c,value:b}})}}return o.sort(BA)};function h6(r,e){const t=Math.max(e.top,r.top),n=Math.max(e.left,r.left),i=Math.min(e.left+e.width,r.left+r.width),o=Math.min(e.top+e.height,r.top+r.height),c=i-n,d=o-t;if(n<i&&t<o){const f=e.width*e.height,m=r.width*r.height,v=c*d,b=v/(f+m-v);return Number(b.toFixed(4))}return 0}const f6=r=>{let{collisionRect:e,droppableRects:t,droppableContainers:n}=r;const i=[];for(const o of n){const{id:c}=o,d=t.get(c);if(d){const f=h6(d,e);f>0&&i.push({id:c,data:{droppableContainer:o,value:f}})}}return i.sort(c6)};function p6(r,e,t){return{...r,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function GA(r,e){return r&&e?{x:r.left-e.left,y:r.top-e.top}:$s}function m6(r){return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i.reduce((c,d)=>({...c,top:c.top+r*d.y,bottom:c.bottom+r*d.y,left:c.left+r*d.x,right:c.right+r*d.x}),{...t})}}const g6=m6(1);function qA(r){if(r.startsWith("matrix3d(")){const e=r.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(r.startsWith("matrix(")){const e=r.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function y6(r,e,t){const n=qA(e);if(!n)return r;const{scaleX:i,scaleY:o,x:c,y:d}=n,f=r.left-c-(1-i)*parseFloat(t),m=r.top-d-(1-o)*parseFloat(t.slice(t.indexOf(" ")+1)),v=i?r.width/i:r.width,b=o?r.height/o:r.height;return{width:v,height:b,top:m,right:f+v,bottom:m+b,left:f}}const v6={ignoreTransform:!1};function Xc(r,e){e===void 0&&(e=v6);let t=r.getBoundingClientRect();if(e.ignoreTransform){const{transform:m,transformOrigin:v}=Pr(r).getComputedStyle(r);m&&(t=y6(t,m,v))}const{top:n,left:i,width:o,height:c,bottom:d,right:f}=t;return{top:n,left:i,width:o,height:c,bottom:d,right:f}}function YT(r){return Xc(r,{ignoreTransform:!0})}function b6(r){const e=r.innerWidth,t=r.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function x6(r,e){return e===void 0&&(e=Pr(r).getComputedStyle(r)),e.position==="fixed"}function _6(r,e){e===void 0&&(e=Pr(r).getComputedStyle(r));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=e[i];return typeof o=="string"?t.test(o):!1})}function Dm(r,e){const t=[];function n(i){if(e!=null&&t.length>=e||!i)return t;if(Ob(i)&&i.scrollingElement!=null&&!t.includes(i.scrollingElement))return t.push(i.scrollingElement),t;if(!lh(i)||VA(i)||t.includes(i))return t;const o=Pr(r).getComputedStyle(i);return i!==r&&_6(i,o)&&t.push(i),x6(i,o)?t:n(i.parentNode)}return r?n(r):t}function HA(r){const[e]=Dm(r,1);return e??null}function fy(r){return!Cm||!r?null:Qc(r)?r:Db(r)?Ob(r)||r===Yc(r).scrollingElement?window:lh(r)?r:null:null}function $A(r){return Qc(r)?r.scrollX:r.scrollLeft}function KA(r){return Qc(r)?r.scrollY:r.scrollTop}function dv(r){return{x:$A(r),y:KA(r)}}var Jn;(function(r){r[r.Forward=1]="Forward",r[r.Backward=-1]="Backward"})(Jn||(Jn={}));function QA(r){return!Cm||!r?!1:r===document.scrollingElement}function YA(r){const e={x:0,y:0},t=QA(r)?{height:window.innerHeight,width:window.innerWidth}:{height:r.clientHeight,width:r.clientWidth},n={x:r.scrollWidth-t.width,y:r.scrollHeight-t.height},i=r.scrollTop<=e.y,o=r.scrollLeft<=e.x,c=r.scrollTop>=n.y,d=r.scrollLeft>=n.x;return{isTop:i,isLeft:o,isBottom:c,isRight:d,maxScroll:n,minScroll:e}}const w6={x:.2,y:.2};function E6(r,e,t,n,i){let{top:o,left:c,right:d,bottom:f}=t;n===void 0&&(n=10),i===void 0&&(i=w6);const{isTop:m,isBottom:v,isLeft:b,isRight:_}=YA(r),S={x:0,y:0},k={x:0,y:0},L={height:e.height*i.y,width:e.width*i.x};return!m&&o<=e.top+L.height?(S.y=Jn.Backward,k.y=n*Math.abs((e.top+L.height-o)/L.height)):!v&&f>=e.bottom-L.height&&(S.y=Jn.Forward,k.y=n*Math.abs((e.bottom-L.height-f)/L.height)),!_&&d>=e.right-L.width?(S.x=Jn.Forward,k.x=n*Math.abs((e.right-L.width-d)/L.width)):!b&&c<=e.left+L.width&&(S.x=Jn.Backward,k.x=n*Math.abs((e.left+L.width-c)/L.width)),{direction:S,speed:k}}function T6(r){if(r===document.scrollingElement){const{innerWidth:o,innerHeight:c}=window;return{top:0,left:0,right:o,bottom:c,width:o,height:c}}const{top:e,left:t,right:n,bottom:i}=r.getBoundingClientRect();return{top:e,left:t,right:n,bottom:i,width:r.clientWidth,height:r.clientHeight}}function XA(r){return r.reduce((e,t)=>yc(e,dv(t)),$s)}function S6(r){return r.reduce((e,t)=>e+$A(t),0)}function N6(r){return r.reduce((e,t)=>e+KA(t),0)}function JA(r,e){if(e===void 0&&(e=Xc),!r)return;const{top:t,left:n,bottom:i,right:o}=e(r);HA(r)&&(i<=0||o<=0||t>=window.innerHeight||n>=window.innerWidth)&&r.scrollIntoView({block:"center",inline:"center"})}const I6=[["x",["left","right"],S6],["y",["top","bottom"],N6]];class jb{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Dm(t),i=XA(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,c,d]of I6)for(const f of c)Object.defineProperty(this,f,{get:()=>{const m=d(n),v=i[o]-m;return this.rect[f]+v},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class vd{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...t)})},this.target=e}add(e,t,n){var i;(i=this.target)==null||i.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function A6(r){const{EventTarget:e}=Pr(r);return r instanceof e?r:Yc(r)}function py(r,e){const t=Math.abs(r.x),n=Math.abs(r.y);return typeof e=="number"?Math.sqrt(t**2+n**2)>e:"x"in e&&"y"in e?t>e.x&&n>e.y:"x"in e?t>e.x:"y"in e?n>e.y:!1}var Ns;(function(r){r.Click="click",r.DragStart="dragstart",r.Keydown="keydown",r.ContextMenu="contextmenu",r.Resize="resize",r.SelectionChange="selectionchange",r.VisibilityChange="visibilitychange"})(Ns||(Ns={}));function XT(r){r.preventDefault()}function C6(r){r.stopPropagation()}var ft;(function(r){r.Space="Space",r.Down="ArrowDown",r.Right="ArrowRight",r.Left="ArrowLeft",r.Up="ArrowUp",r.Esc="Escape",r.Enter="Enter",r.Tab="Tab"})(ft||(ft={}));const WA={start:[ft.Space,ft.Enter],cancel:[ft.Esc],end:[ft.Space,ft.Enter,ft.Tab]},R6=(r,e)=>{let{currentCoordinates:t}=e;switch(r.code){case ft.Right:return{...t,x:t.x+25};case ft.Left:return{...t,x:t.x-25};case ft.Down:return{...t,y:t.y+25};case ft.Up:return{...t,y:t.y-25}}};class Pb{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new vd(Yc(t)),this.windowListeners=new vd(Pr(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ns.Resize,this.handleCancel),this.windowListeners.add(Ns.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ns.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,n=e.node.current;n&&JA(n),t($s)}handleKeyDown(e){if(km(e)){const{active:t,context:n,options:i}=this.props,{keyboardCodes:o=WA,coordinateGetter:c=R6,scrollBehavior:d="smooth"}=i,{code:f}=e;if(o.end.includes(f)){this.handleEnd(e);return}if(o.cancel.includes(f)){this.handleCancel(e);return}const{collisionRect:m}=n.current,v=m?{x:m.left,y:m.top}:$s;this.referenceCoordinates||(this.referenceCoordinates=v);const b=c(e,{active:t,context:n.current,currentCoordinates:v});if(b){const _=Fd(b,v),S={x:0,y:0},{scrollableAncestors:k}=n.current;for(const L of k){const B=e.code,{isTop:X,isRight:re,isLeft:ee,isBottom:le,maxScroll:fe,minScroll:ce}=YA(L),C=T6(L),I={x:Math.min(B===ft.Right?C.right-C.width/2:C.right,Math.max(B===ft.Right?C.left:C.left+C.width/2,b.x)),y:Math.min(B===ft.Down?C.bottom-C.height/2:C.bottom,Math.max(B===ft.Down?C.top:C.top+C.height/2,b.y))},R=B===ft.Right&&!re||B===ft.Left&&!ee,U=B===ft.Down&&!le||B===ft.Up&&!X;if(R&&I.x!==b.x){const D=L.scrollLeft+_.x,M=B===ft.Right&&D<=fe.x||B===ft.Left&&D>=ce.x;if(M&&!_.y){L.scrollTo({left:D,behavior:d});return}M?S.x=L.scrollLeft-D:S.x=B===ft.Right?L.scrollLeft-fe.x:L.scrollLeft-ce.x,S.x&&L.scrollBy({left:-S.x,behavior:d});break}else if(U&&I.y!==b.y){const D=L.scrollTop+_.y,M=B===ft.Down&&D<=fe.y||B===ft.Up&&D>=ce.y;if(M&&!_.x){L.scrollTo({top:D,behavior:d});return}M?S.y=L.scrollTop-D:S.y=B===ft.Down?L.scrollTop-fe.y:L.scrollTop-ce.y,S.y&&L.scrollBy({top:-S.y,behavior:d});break}}this.handleMove(e,yc(Fd(b,this.referenceCoordinates),S))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Pb.activators=[{eventName:"onKeyDown",handler:(r,e,t)=>{let{keyboardCodes:n=WA,onActivation:i}=e,{active:o}=t;const{code:c}=r.nativeEvent;if(n.start.includes(c)){const d=o.activatorNode.current;return d&&r.target!==d?!1:(r.preventDefault(),i==null||i({event:r.nativeEvent}),!0)}return!1}}];function JT(r){return!!(r&&"distance"in r)}function WT(r){return!!(r&&"delay"in r)}class Mb{constructor(e,t,n){var i;n===void 0&&(n=A6(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:o}=e,{target:c}=o;this.props=e,this.events=t,this.document=Yc(c),this.documentListeners=new vd(this.document),this.listeners=new vd(n),this.windowListeners=new vd(Pr(c)),this.initialCoordinates=(i=qp(o))!=null?i:$s,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Ns.Resize,this.handleCancel),this.windowListeners.add(Ns.DragStart,XT),this.windowListeners.add(Ns.VisibilityChange,this.handleCancel),this.windowListeners.add(Ns.ContextMenu,XT),this.documentListeners.add(Ns.Keydown,this.handleKeydown),t){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(WT(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(JT(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Ns.Click,C6,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ns.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:i,props:o}=this,{onMove:c,options:{activationConstraint:d}}=o;if(!i)return;const f=(t=qp(e))!=null?t:$s,m=Fd(i,f);if(!n&&d){if(JT(d)){if(d.tolerance!=null&&py(m,d.tolerance))return this.handleCancel();if(py(m,d.distance))return this.handleStart()}if(WT(d)&&py(m,d.tolerance))return this.handleCancel();this.handlePending(d,m);return}e.cancelable&&e.preventDefault(),c(f)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===ft.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const k6={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Vb extends Mb{constructor(e){const{event:t}=e,n=Yc(t.target);super(e,k6,n)}}Vb.activators=[{eventName:"onPointerDown",handler:(r,e)=>{let{nativeEvent:t}=r,{onActivation:n}=e;return!t.isPrimary||t.button!==0?!1:(n==null||n({event:t}),!0)}}];const D6={move:{name:"mousemove"},end:{name:"mouseup"}};var hv;(function(r){r[r.RightClick=2]="RightClick"})(hv||(hv={}));class O6 extends Mb{constructor(e){super(e,D6,Yc(e.event.target))}}O6.activators=[{eventName:"onMouseDown",handler:(r,e)=>{let{nativeEvent:t}=r,{onActivation:n}=e;return t.button===hv.RightClick?!1:(n==null||n({event:t}),!0)}}];const my={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class j6 extends Mb{constructor(e){super(e,my)}static setup(){return window.addEventListener(my.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(my.move.name,e)};function e(){}}}j6.activators=[{eventName:"onTouchStart",handler:(r,e)=>{let{nativeEvent:t}=r,{onActivation:n}=e;const{touches:i}=t;return i.length>1?!1:(n==null||n({event:t}),!0)}}];var bd;(function(r){r[r.Pointer=0]="Pointer",r[r.DraggableRect=1]="DraggableRect"})(bd||(bd={}));var $p;(function(r){r[r.TreeOrder=0]="TreeOrder",r[r.ReversedTreeOrder=1]="ReversedTreeOrder"})($p||($p={}));function P6(r){let{acceleration:e,activator:t=bd.Pointer,canScroll:n,draggingRect:i,enabled:o,interval:c=5,order:d=$p.TreeOrder,pointerCoordinates:f,scrollableAncestors:m,scrollableAncestorRects:v,delta:b,threshold:_}=r;const S=V6({delta:b,disabled:!o}),[k,L]=QM(),B=j.useRef({x:0,y:0}),X=j.useRef({x:0,y:0}),re=j.useMemo(()=>{switch(t){case bd.Pointer:return f?{top:f.y,bottom:f.y,left:f.x,right:f.x}:null;case bd.DraggableRect:return i}},[t,i,f]),ee=j.useRef(null),le=j.useCallback(()=>{const ce=ee.current;if(!ce)return;const C=B.current.x*X.current.x,I=B.current.y*X.current.y;ce.scrollBy(C,I)},[]),fe=j.useMemo(()=>d===$p.TreeOrder?[...m].reverse():m,[d,m]);j.useEffect(()=>{if(!o||!m.length||!re){L();return}for(const ce of fe){if((n==null?void 0:n(ce))===!1)continue;const C=m.indexOf(ce),I=v[C];if(!I)continue;const{direction:R,speed:U}=E6(ce,I,re,e,_);for(const D of["x","y"])S[D][R[D]]||(U[D]=0,R[D]=0);if(U.x>0||U.y>0){L(),ee.current=ce,k(le,c),B.current=U,X.current=R;return}}B.current={x:0,y:0},X.current={x:0,y:0},L()},[e,le,n,L,o,c,JSON.stringify(re),JSON.stringify(S),k,m,fe,v,JSON.stringify(_)])}const M6={x:{[Jn.Backward]:!1,[Jn.Forward]:!1},y:{[Jn.Backward]:!1,[Jn.Forward]:!1}};function V6(r){let{delta:e,disabled:t}=r;const n=Gp(e);return ch(i=>{if(t||!n||!i)return M6;const o={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[Jn.Backward]:i.x[Jn.Backward]||o.x===-1,[Jn.Forward]:i.x[Jn.Forward]||o.x===1},y:{[Jn.Backward]:i.y[Jn.Backward]||o.y===-1,[Jn.Forward]:i.y[Jn.Forward]||o.y===1}}},[t,e,n])}function L6(r,e){const t=e!=null?r.get(e):void 0,n=t?t.node.current:null;return ch(i=>{var o;return e==null?null:(o=n??i)!=null?o:null},[n,e])}function U6(r,e){return j.useMemo(()=>r.reduce((t,n)=>{const{sensor:i}=n,o=i.activators.map(c=>({eventName:c.eventName,handler:e(c.handler,n)}));return[...t,...o]},[]),[r,e])}var Gd;(function(r){r[r.Always=0]="Always",r[r.BeforeDragging=1]="BeforeDragging",r[r.WhileDragging=2]="WhileDragging"})(Gd||(Gd={}));var fv;(function(r){r.Optimized="optimized"})(fv||(fv={}));const ZT=new Map;function z6(r,e){let{dragging:t,dependencies:n,config:i}=e;const[o,c]=j.useState(null),{frequency:d,measure:f,strategy:m}=i,v=j.useRef(r),b=B(),_=Bd(b),S=j.useCallback(function(X){X===void 0&&(X=[]),!_.current&&c(re=>re===null?X:re.concat(X.filter(ee=>!re.includes(ee))))},[_]),k=j.useRef(null),L=ch(X=>{if(b&&!t)return ZT;if(!X||X===ZT||v.current!==r||o!=null){const re=new Map;for(let ee of r){if(!ee)continue;if(o&&o.length>0&&!o.includes(ee.id)&&ee.rect.current){re.set(ee.id,ee.rect.current);continue}const le=ee.node.current,fe=le?new jb(f(le),le):null;ee.rect.current=fe,fe&&re.set(ee.id,fe)}return re}return X},[r,o,t,b,f]);return j.useEffect(()=>{v.current=r},[r]),j.useEffect(()=>{b||S()},[t,b]),j.useEffect(()=>{o&&o.length>0&&c(null)},[JSON.stringify(o)]),j.useEffect(()=>{b||typeof d!="number"||k.current!==null||(k.current=setTimeout(()=>{S(),k.current=null},d))},[d,b,S,...n]),{droppableRects:L,measureDroppableContainers:S,measuringScheduled:o!=null};function B(){switch(m){case Gd.Always:return!1;case Gd.BeforeDragging:return t;default:return!t}}}function Lb(r,e){return ch(t=>r?t||(typeof e=="function"?e(r):r):null,[e,r])}function B6(r,e){return Lb(r,e)}function F6(r){let{callback:e,disabled:t}=r;const n=Rm(e),i=j.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,t]);return j.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Om(r){let{callback:e,disabled:t}=r;const n=Rm(e),i=j.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[t]);return j.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function G6(r){return new jb(Xc(r),r)}function eS(r,e,t){e===void 0&&(e=G6);const[n,i]=j.useState(null);function o(){i(f=>{if(!r)return null;if(r.isConnected===!1){var m;return(m=f??t)!=null?m:null}const v=e(r);return JSON.stringify(f)===JSON.stringify(v)?f:v})}const c=F6({callback(f){if(r)for(const m of f){const{type:v,target:b}=m;if(v==="childList"&&b instanceof HTMLElement&&b.contains(r)){o();break}}}}),d=Om({callback:o});return Hs(()=>{o(),r?(d==null||d.observe(r),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(d==null||d.disconnect(),c==null||c.disconnect())},[r]),n}function q6(r){const e=Lb(r);return GA(r,e)}const tS=[];function H6(r){const e=j.useRef(r),t=ch(n=>r?n&&n!==tS&&r&&e.current&&r.parentNode===e.current.parentNode?n:Dm(r):tS,[r]);return j.useEffect(()=>{e.current=r},[r]),t}function $6(r){const[e,t]=j.useState(null),n=j.useRef(r),i=j.useCallback(o=>{const c=fy(o.target);c&&t(d=>d?(d.set(c,dv(c)),new Map(d)):null)},[]);return j.useEffect(()=>{const o=n.current;if(r!==o){c(o);const d=r.map(f=>{const m=fy(f);return m?(m.addEventListener("scroll",i,{passive:!0}),[m,dv(m)]):null}).filter(f=>f!=null);t(d.length?new Map(d):null),n.current=r}return()=>{c(r),c(o)};function c(d){d.forEach(f=>{const m=fy(f);m==null||m.removeEventListener("scroll",i)})}},[i,r]),j.useMemo(()=>r.length?e?Array.from(e.values()).reduce((o,c)=>yc(o,c),$s):XA(r):$s,[r,e])}function nS(r,e){e===void 0&&(e=[]);const t=j.useRef(null);return j.useEffect(()=>{t.current=null},e),j.useEffect(()=>{const n=r!==$s;n&&!t.current&&(t.current=r),!n&&t.current&&(t.current=null)},[r]),t.current?Fd(r,t.current):$s}function K6(r){j.useEffect(()=>{if(!Cm)return;const e=r.map(t=>{let{sensor:n}=t;return n.setup==null?void 0:n.setup()});return()=>{for(const t of e)t==null||t()}},r.map(e=>{let{sensor:t}=e;return t}))}function Q6(r,e){return j.useMemo(()=>r.reduce((t,n)=>{let{eventName:i,handler:o}=n;return t[i]=c=>{o(c,e)},t},{}),[r,e])}function ZA(r){return j.useMemo(()=>r?b6(r):null,[r])}const rS=[];function Y6(r,e){e===void 0&&(e=Xc);const[t]=r,n=ZA(t?Pr(t):null),[i,o]=j.useState(rS);function c(){o(()=>r.length?r.map(f=>QA(f)?n:new jb(e(f),f)):rS)}const d=Om({callback:c});return Hs(()=>{d==null||d.disconnect(),c(),r.forEach(f=>d==null?void 0:d.observe(f))},[r]),i}function eC(r){if(!r)return null;if(r.children.length>1)return r;const e=r.children[0];return lh(e)?e:r}function X6(r){let{measure:e}=r;const[t,n]=j.useState(null),i=j.useCallback(m=>{for(const{target:v}of m)if(lh(v)){n(b=>{const _=e(v);return b?{...b,width:_.width,height:_.height}:_});break}},[e]),o=Om({callback:i}),c=j.useCallback(m=>{const v=eC(m);o==null||o.disconnect(),v&&(o==null||o.observe(v)),n(v?e(v):null)},[e,o]),[d,f]=Fp(c);return j.useMemo(()=>({nodeRef:d,rect:t,setRef:f}),[t,d,f])}const J6=[{sensor:Vb,options:{}},{sensor:Pb,options:{}}],W6={current:{}},lp={draggable:{measure:YT},droppable:{measure:YT,strategy:Gd.WhileDragging,frequency:fv.Optimized},dragOverlay:{measure:Xc}};class xd extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,n;return(t=(n=this.get(e))==null?void 0:n.node.current)!=null?t:void 0}}const Z6={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new xd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Hp},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:lp,measureDroppableContainers:Hp,windowRect:null,measuringScheduled:!1},tC={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Hp,draggableNodes:new Map,over:null,measureDroppableContainers:Hp},dh=j.createContext(tC),nC=j.createContext(Z6);function eV(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new xd}}}function tV(r,e){switch(e.type){case Hn.DragStart:return{...r,draggable:{...r.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Hn.DragMove:return r.draggable.active==null?r:{...r,draggable:{...r.draggable,translate:{x:e.coordinates.x-r.draggable.initialCoordinates.x,y:e.coordinates.y-r.draggable.initialCoordinates.y}}};case Hn.DragEnd:case Hn.DragCancel:return{...r,draggable:{...r.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Hn.RegisterDroppable:{const{element:t}=e,{id:n}=t,i=new xd(r.droppable.containers);return i.set(n,t),{...r,droppable:{...r.droppable,containers:i}}}case Hn.SetDroppableDisabled:{const{id:t,key:n,disabled:i}=e,o=r.droppable.containers.get(t);if(!o||n!==o.key)return r;const c=new xd(r.droppable.containers);return c.set(t,{...o,disabled:i}),{...r,droppable:{...r.droppable,containers:c}}}case Hn.UnregisterDroppable:{const{id:t,key:n}=e,i=r.droppable.containers.get(t);if(!i||n!==i.key)return r;const o=new xd(r.droppable.containers);return o.delete(t),{...r,droppable:{...r.droppable,containers:o}}}default:return r}}function nV(r){let{disabled:e}=r;const{active:t,activatorEvent:n,draggableNodes:i}=j.useContext(dh),o=Gp(n),c=Gp(t==null?void 0:t.id);return j.useEffect(()=>{if(!e&&!n&&o&&c!=null){if(!km(o)||document.activeElement===o.target)return;const d=i.get(c);if(!d)return;const{activatorNode:f,node:m}=d;if(!f.current&&!m.current)return;requestAnimationFrame(()=>{for(const v of[f.current,m.current]){if(!v)continue;const b=JM(v);if(b){b.focus();break}}})}},[n,e,i,c,o]),null}function rC(r,e){let{transform:t,...n}=e;return r!=null&&r.length?r.reduce((i,o)=>o({transform:i,...n}),t):t}function rV(r){return j.useMemo(()=>({draggable:{...lp.draggable,...r==null?void 0:r.draggable},droppable:{...lp.droppable,...r==null?void 0:r.droppable},dragOverlay:{...lp.dragOverlay,...r==null?void 0:r.dragOverlay}}),[r==null?void 0:r.draggable,r==null?void 0:r.droppable,r==null?void 0:r.dragOverlay])}function sV(r){let{activeNode:e,measure:t,initialRect:n,config:i=!0}=r;const o=j.useRef(!1),{x:c,y:d}=typeof i=="boolean"?{x:i,y:i}:i;Hs(()=>{if(!c&&!d||!e){o.current=!1;return}if(o.current||!n)return;const m=e==null?void 0:e.node.current;if(!m||m.isConnected===!1)return;const v=t(m),b=GA(v,n);if(c||(b.x=0),d||(b.y=0),o.current=!0,Math.abs(b.x)>0||Math.abs(b.y)>0){const _=HA(m);_&&_.scrollBy({top:b.y,left:b.x})}},[e,c,d,n,t])}const jm=j.createContext({...$s,scaleX:1,scaleY:1});var Oa;(function(r){r[r.Uninitialized=0]="Uninitialized",r[r.Initializing=1]="Initializing",r[r.Initialized=2]="Initialized"})(Oa||(Oa={}));const iV=j.memo(function(e){var t,n,i,o;let{id:c,accessibility:d,autoScroll:f=!0,children:m,sensors:v=J6,collisionDetection:b=f6,measuring:_,modifiers:S,...k}=e;const L=j.useReducer(tV,void 0,eV),[B,X]=L,[re,ee]=r6(),[le,fe]=j.useState(Oa.Uninitialized),ce=le===Oa.Initialized,{draggable:{active:C,nodes:I,translate:R},droppable:{containers:U}}=B,D=C!=null?I.get(C):null,M=j.useRef({initial:null,translated:null}),O=j.useMemo(()=>{var Qe;return C!=null?{id:C,data:(Qe=D==null?void 0:D.data)!=null?Qe:W6,rect:M}:null},[C,D]),qe=j.useRef(null),[gt,Z]=j.useState(null),[he,Te]=j.useState(null),Me=Bd(k,Object.values(k)),Ve=uh("DndDescribedBy",c),V=j.useMemo(()=>U.getEnabled(),[U]),te=rV(_),{droppableRects:pe,measureDroppableContainers:ye,measuringScheduled:Ne}=z6(V,{dragging:ce,dependencies:[R.x,R.y],config:te.droppable}),Re=L6(I,C),Be=j.useMemo(()=>he?qp(he):null,[he]),Je=kn(),rt=B6(Re,te.draggable.measure);sV({activeNode:C!=null?I.get(C):null,config:Je.layoutShiftCompensation,initialRect:rt,measure:te.draggable.measure});const $e=eS(Re,te.draggable.measure,rt),Zn=eS(Re?Re.parentElement:null),En=j.useRef({activatorEvent:null,active:null,activeNode:Re,collisionRect:null,collisions:null,droppableRects:pe,draggableNodes:I,draggingNode:null,draggingNodeRect:null,droppableContainers:U,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),fr=U.getNodeFor((t=En.current.over)==null?void 0:t.id),Ke=X6({measure:te.dragOverlay.measure}),Ar=(n=Ke.nodeRef.current)!=null?n:Re,Bn=ce?(i=Ke.rect)!=null?i:$e:null,Cs=!!(Ke.nodeRef.current&&Ke.rect),Rs=q6(Cs?null:$e),_t=ZA(Ar?Pr(Ar):null),st=H6(ce?fr??Re:null),Wt=Y6(st),Kr=rC(S,{transform:{x:R.x-Rs.x,y:R.y-Rs.y,scaleX:1,scaleY:1},activatorEvent:he,active:O,activeNodeRect:$e,containerNodeRect:Zn,draggingNodeRect:Bn,over:En.current.over,overlayNodeRect:Ke.rect,scrollableAncestors:st,scrollableAncestorRects:Wt,windowRect:_t}),on=Be?yc(Be,R):null,zt=$6(st),Tn=nS(zt),er=nS(zt,[$e]),ln=yc(Kr,Tn),qt=Bn?g6(Bn,Kr):null,tr=O&&qt?b({active:O,collisionRect:qt,droppableRects:pe,droppableContainers:V,pointerCoordinates:on}):null,us=FA(tr,"id"),[K,ve]=j.useState(null),Oe=Cs?Kr:yc(Kr,er),Le=p6(Oe,(o=K==null?void 0:K.rect)!=null?o:null,$e),et=j.useRef(null),we=j.useCallback((Qe,xt)=>{let{sensor:Bt,options:Kt}=xt;if(qe.current==null)return;const Fn=I.get(qe.current);if(!Fn)return;const pn=Qe.nativeEvent,Zt=new Bt({active:qe.current,activeNode:Fn,event:pn,options:Kt,context:En,onAbort(Qt){if(!I.get(Qt))return;const{onDragAbort:yt}=Me.current,_e={id:Qt};yt==null||yt(_e),re({type:"onDragAbort",event:_e})},onPending(Qt,Dn,yt,_e){if(!I.get(Qt))return;const{onDragPending:rr}=Me.current,gr={id:Qt,constraint:Dn,initialCoordinates:yt,offset:_e};rr==null||rr(gr),re({type:"onDragPending",event:gr})},onStart(Qt){const Dn=qe.current;if(Dn==null)return;const yt=I.get(Dn);if(!yt)return;const{onDragStart:_e}=Me.current,mr={activatorEvent:pn,active:{id:Dn,data:yt.data,rect:M}};id.unstable_batchedUpdates(()=>{_e==null||_e(mr),fe(Oa.Initializing),X({type:Hn.DragStart,initialCoordinates:Qt,active:Dn}),re({type:"onDragStart",event:mr}),Z(et.current),Te(pn)})},onMove(Qt){X({type:Hn.DragMove,coordinates:Qt})},onEnd:pr(Hn.DragEnd),onCancel:pr(Hn.DragCancel)});et.current=Zt;function pr(Qt){return async function(){const{active:yt,collisions:_e,over:mr,scrollAdjustedTranslate:rr}=En.current;let gr=null;if(yt&&rr){const{cancelDrop:Gn}=Me.current;gr={activatorEvent:pn,active:yt,collisions:_e,delta:rr,over:mr},Qt===Hn.DragEnd&&typeof Gn=="function"&&await Promise.resolve(Gn(gr))&&(Qt=Hn.DragCancel)}qe.current=null,id.unstable_batchedUpdates(()=>{X({type:Qt}),fe(Oa.Uninitialized),ve(null),Z(null),Te(null),et.current=null;const Gn=Qt===Hn.DragEnd?"onDragEnd":"onDragCancel";if(gr){const Qn=Me.current[Gn];Qn==null||Qn(gr),re({type:Gn,event:gr})}})}}},[I]),Ht=j.useCallback((Qe,xt)=>(Bt,Kt)=>{const Fn=Bt.nativeEvent,pn=I.get(Kt);if(qe.current!==null||!pn||Fn.dndKit||Fn.defaultPrevented)return;const Zt={active:pn};Qe(Bt,xt.options,Zt)===!0&&(Fn.dndKit={capturedBy:xt.sensor},qe.current=Kt,we(Bt,xt))},[I,we]),nr=U6(v,Ht);K6(v),Hs(()=>{$e&&le===Oa.Initializing&&fe(Oa.Initialized)},[$e,le]),j.useEffect(()=>{const{onDragMove:Qe}=Me.current,{active:xt,activatorEvent:Bt,collisions:Kt,over:Fn}=En.current;if(!xt||!Bt)return;const pn={active:xt,activatorEvent:Bt,collisions:Kt,delta:{x:ln.x,y:ln.y},over:Fn};id.unstable_batchedUpdates(()=>{Qe==null||Qe(pn),re({type:"onDragMove",event:pn})})},[ln.x,ln.y]),j.useEffect(()=>{const{active:Qe,activatorEvent:xt,collisions:Bt,droppableContainers:Kt,scrollAdjustedTranslate:Fn}=En.current;if(!Qe||qe.current==null||!xt||!Fn)return;const{onDragOver:pn}=Me.current,Zt=Kt.get(us),pr=Zt&&Zt.rect.current?{id:Zt.id,rect:Zt.rect.current,data:Zt.data,disabled:Zt.disabled}:null,Qt={active:Qe,activatorEvent:xt,collisions:Bt,delta:{x:Fn.x,y:Fn.y},over:pr};id.unstable_batchedUpdates(()=>{ve(pr),pn==null||pn(Qt),re({type:"onDragOver",event:Qt})})},[us]),Hs(()=>{En.current={activatorEvent:he,active:O,activeNode:Re,collisionRect:qt,collisions:tr,droppableRects:pe,draggableNodes:I,draggingNode:Ar,draggingNodeRect:Bn,droppableContainers:U,over:K,scrollableAncestors:st,scrollAdjustedTranslate:ln},M.current={initial:Bn,translated:qt}},[O,Re,tr,qt,I,Ar,Bn,pe,U,K,st,ln]),P6({...Je,delta:R,draggingRect:qt,pointerCoordinates:on,scrollableAncestors:st,scrollableAncestorRects:Wt});const Sn=j.useMemo(()=>({active:O,activeNode:Re,activeNodeRect:$e,activatorEvent:he,collisions:tr,containerNodeRect:Zn,dragOverlay:Ke,draggableNodes:I,droppableContainers:U,droppableRects:pe,over:K,measureDroppableContainers:ye,scrollableAncestors:st,scrollableAncestorRects:Wt,measuringConfiguration:te,measuringScheduled:Ne,windowRect:_t}),[O,Re,$e,he,tr,Zn,Ke,I,U,pe,K,ye,st,Wt,te,Ne,_t]),$t=j.useMemo(()=>({activatorEvent:he,activators:nr,active:O,activeNodeRect:$e,ariaDescribedById:{draggable:Ve},dispatch:X,draggableNodes:I,over:K,measureDroppableContainers:ye}),[he,nr,O,$e,X,Ve,I,K,ye]);return sn.createElement(UA.Provider,{value:ee},sn.createElement(dh.Provider,{value:$t},sn.createElement(nC.Provider,{value:Sn},sn.createElement(jm.Provider,{value:Le},m)),sn.createElement(nV,{disabled:(d==null?void 0:d.restoreFocus)===!1})),sn.createElement(a6,{...d,hiddenTextDescribedById:Ve}));function kn(){const Qe=(gt==null?void 0:gt.autoScrollEnabled)===!1,xt=typeof f=="object"?f.enabled===!1:f===!1,Bt=ce&&!Qe&&!xt;return typeof f=="object"?{...f,enabled:Bt}:{enabled:Bt}}}),aV=j.createContext(null),sS="button",oV="Draggable";function sC(r){let{id:e,data:t,disabled:n=!1,attributes:i}=r;const o=uh(oV),{activators:c,activatorEvent:d,active:f,activeNodeRect:m,ariaDescribedById:v,draggableNodes:b,over:_}=j.useContext(dh),{role:S=sS,roleDescription:k="draggable",tabIndex:L=0}=i??{},B=(f==null?void 0:f.id)===e,X=j.useContext(B?jm:aV),[re,ee]=Fp(),[le,fe]=Fp(),ce=Q6(c,e),C=Bd(t);Hs(()=>(b.set(e,{id:e,key:o,node:re,activatorNode:le,data:C}),()=>{const R=b.get(e);R&&R.key===o&&b.delete(e)}),[b,e]);const I=j.useMemo(()=>({role:S,tabIndex:L,"aria-disabled":n,"aria-pressed":B&&S===sS?!0:void 0,"aria-roledescription":k,"aria-describedby":v.draggable}),[n,S,L,B,k,v.draggable]);return{active:f,activatorEvent:d,activeNodeRect:m,attributes:I,isDragging:B,listeners:n?void 0:ce,node:re,over:_,setNodeRef:ee,setActivatorNodeRef:fe,transform:X}}function iC(){return j.useContext(nC)}const lV="Droppable",cV={timeout:25};function uV(r){let{data:e,disabled:t=!1,id:n,resizeObserverConfig:i}=r;const o=uh(lV),{active:c,dispatch:d,over:f,measureDroppableContainers:m}=j.useContext(dh),v=j.useRef({disabled:t}),b=j.useRef(!1),_=j.useRef(null),S=j.useRef(null),{disabled:k,updateMeasurementsFor:L,timeout:B}={...cV,...i},X=Bd(L??n),re=j.useCallback(()=>{if(!b.current){b.current=!0;return}S.current!=null&&clearTimeout(S.current),S.current=setTimeout(()=>{m(Array.isArray(X.current)?X.current:[X.current]),S.current=null},B)},[B]),ee=Om({callback:re,disabled:k||!c}),le=j.useCallback((I,R)=>{ee&&(R&&(ee.unobserve(R),b.current=!1),I&&ee.observe(I))},[ee]),[fe,ce]=Fp(le),C=Bd(e);return j.useEffect(()=>{!ee||!fe.current||(ee.disconnect(),b.current=!1,ee.observe(fe.current))},[fe,ee]),j.useEffect(()=>(d({type:Hn.RegisterDroppable,element:{id:n,key:o,disabled:t,node:fe,rect:_,data:C}}),()=>d({type:Hn.UnregisterDroppable,key:o,id:n})),[n]),j.useEffect(()=>{t!==v.current.disabled&&(d({type:Hn.SetDroppableDisabled,id:n,key:o,disabled:t}),v.current.disabled=t)},[n,o,t,d]),{active:c,rect:_,isOver:(f==null?void 0:f.id)===n,node:fe,over:f,setNodeRef:ce}}function dV(r){let{animation:e,children:t}=r;const[n,i]=j.useState(null),[o,c]=j.useState(null),d=Gp(t);return!t&&!n&&d&&i(d),Hs(()=>{if(!o)return;const f=n==null?void 0:n.key,m=n==null?void 0:n.props.id;if(f==null||m==null){i(null);return}Promise.resolve(e(m,o)).then(()=>{i(null)})},[e,n,o]),sn.createElement(sn.Fragment,null,t,n?j.cloneElement(n,{ref:c}):null)}const hV={x:0,y:0,scaleX:1,scaleY:1};function fV(r){let{children:e}=r;return sn.createElement(dh.Provider,{value:tC},sn.createElement(jm.Provider,{value:hV},e))}const pV={position:"fixed",touchAction:"none"},mV=r=>km(r)?"transform 250ms ease":void 0,gV=j.forwardRef((r,e)=>{let{as:t,activatorEvent:n,adjustScale:i,children:o,className:c,rect:d,style:f,transform:m,transition:v=mV}=r;if(!d)return null;const b=i?m:{...m,scaleX:1,scaleY:1},_={...pV,width:d.width,height:d.height,top:d.top,left:d.left,transform:pi.Transform.toString(b),transformOrigin:i&&n?l6(n,d):void 0,transition:typeof v=="function"?v(n):v,...f};return sn.createElement(t,{className:c,style:_,ref:e},o)}),aC=r=>e=>{let{active:t,dragOverlay:n}=e;const i={},{styles:o,className:c}=r;if(o!=null&&o.active)for(const[d,f]of Object.entries(o.active))f!==void 0&&(i[d]=t.node.style.getPropertyValue(d),t.node.style.setProperty(d,f));if(o!=null&&o.dragOverlay)for(const[d,f]of Object.entries(o.dragOverlay))f!==void 0&&n.node.style.setProperty(d,f);return c!=null&&c.active&&t.node.classList.add(c.active),c!=null&&c.dragOverlay&&n.node.classList.add(c.dragOverlay),function(){for(const[f,m]of Object.entries(i))t.node.style.setProperty(f,m);c!=null&&c.active&&t.node.classList.remove(c.active)}},yV=r=>{let{transform:{initial:e,final:t}}=r;return[{transform:pi.Transform.toString(e)},{transform:pi.Transform.toString(t)}]},vV={duration:250,easing:"ease",keyframes:yV,sideEffects:aC({styles:{active:{opacity:"0"}}})};function bV(r){let{config:e,draggableNodes:t,droppableContainers:n,measuringConfiguration:i}=r;return Rm((o,c)=>{if(e===null)return;const d=t.get(o);if(!d)return;const f=d.node.current;if(!f)return;const m=eC(c);if(!m)return;const{transform:v}=Pr(c).getComputedStyle(c),b=qA(v);if(!b)return;const _=typeof e=="function"?e:xV(e);return JA(f,i.draggable.measure),_({active:{id:o,data:d.data,node:f,rect:i.draggable.measure(f)},draggableNodes:t,dragOverlay:{node:c,rect:i.dragOverlay.measure(m)},droppableContainers:n,measuringConfiguration:i,transform:b})})}function xV(r){const{duration:e,easing:t,sideEffects:n,keyframes:i}={...vV,...r};return o=>{let{active:c,dragOverlay:d,transform:f,...m}=o;if(!e)return;const v={x:d.rect.left-c.rect.left,y:d.rect.top-c.rect.top},b={scaleX:f.scaleX!==1?c.rect.width*f.scaleX/d.rect.width:1,scaleY:f.scaleY!==1?c.rect.height*f.scaleY/d.rect.height:1},_={x:f.x-v.x,y:f.y-v.y,...b},S=i({...m,active:c,dragOverlay:d,transform:{initial:f,final:_}}),[k]=S,L=S[S.length-1];if(JSON.stringify(k)===JSON.stringify(L))return;const B=n==null?void 0:n({active:c,dragOverlay:d,...m}),X=d.node.animate(S,{duration:e,easing:t,fill:"forwards"});return new Promise(re=>{X.onfinish=()=>{B==null||B(),re()}})}}let iS=0;function _V(r){return j.useMemo(()=>{if(r!=null)return iS++,iS},[r])}const wV=sn.memo(r=>{let{adjustScale:e=!1,children:t,dropAnimation:n,style:i,transition:o,modifiers:c,wrapperElement:d="div",className:f,zIndex:m=999}=r;const{activatorEvent:v,active:b,activeNodeRect:_,containerNodeRect:S,draggableNodes:k,droppableContainers:L,dragOverlay:B,over:X,measuringConfiguration:re,scrollableAncestors:ee,scrollableAncestorRects:le,windowRect:fe}=iC(),ce=j.useContext(jm),C=_V(b==null?void 0:b.id),I=rC(c,{activatorEvent:v,active:b,activeNodeRect:_,containerNodeRect:S,draggingNodeRect:B.rect,over:X,overlayNodeRect:B.rect,scrollableAncestors:ee,scrollableAncestorRects:le,transform:ce,windowRect:fe}),R=Lb(_),U=bV({config:n,draggableNodes:k,droppableContainers:L,measuringConfiguration:re}),D=R?B.setRef:void 0;return sn.createElement(fV,null,sn.createElement(dV,{animation:U},b&&C?sn.createElement(gV,{key:C,id:b.id,ref:D,as:d,activatorEvent:v,adjustScale:e,className:f,transition:o,rect:R,style:{zIndex:m,...i},transform:I},t):null))});function cc(r,e,t){const n=r.slice();return n.splice(t<0?n.length+t:t,0,n.splice(e,1)[0]),n}function EV(r,e){return r.reduce((t,n,i)=>{const o=e.get(n);return o&&(t[i]=o),t},Array(r.length))}function Mf(r){return r!==null&&r>=0}function TV(r,e){if(r===e)return!0;if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function SV(r){return typeof r=="boolean"?{draggable:r,droppable:r}:r}const oC=r=>{let{rects:e,activeIndex:t,overIndex:n,index:i}=r;const o=cc(e,n,t),c=e[i],d=o[i];return!d||!c?null:{x:d.left-c.left,y:d.top-c.top,scaleX:d.width/c.width,scaleY:d.height/c.height}},Vf={scaleX:1,scaleY:1},ec=r=>{var e;let{activeIndex:t,activeNodeRect:n,index:i,rects:o,overIndex:c}=r;const d=(e=o[t])!=null?e:n;if(!d)return null;if(i===t){const m=o[c];return m?{x:0,y:t<c?m.top+m.height-(d.top+d.height):m.top-d.top,...Vf}:null}const f=NV(o,i,t);return i>t&&i<=c?{x:0,y:-d.height-f,...Vf}:i<t&&i>=c?{x:0,y:d.height+f,...Vf}:{x:0,y:0,...Vf}};function NV(r,e,t){const n=r[e],i=r[e-1],o=r[e+1];return n?t<e?i?n.top-(i.top+i.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const lC="Sortable",cC=sn.createContext({activeIndex:-1,containerId:lC,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:oC,disabled:{draggable:!1,droppable:!1}});function tc(r){let{children:e,id:t,items:n,strategy:i=oC,disabled:o=!1}=r;const{active:c,dragOverlay:d,droppableRects:f,over:m,measureDroppableContainers:v}=iC(),b=uh(lC,t),_=d.rect!==null,S=j.useMemo(()=>n.map(ce=>typeof ce=="object"&&"id"in ce?ce.id:ce),[n]),k=c!=null,L=c?S.indexOf(c.id):-1,B=m?S.indexOf(m.id):-1,X=j.useRef(S),re=!TV(S,X.current),ee=B!==-1&&L===-1||re,le=SV(o);Hs(()=>{re&&k&&v(S)},[re,S,k,v]),j.useEffect(()=>{X.current=S},[S]);const fe=j.useMemo(()=>({activeIndex:L,containerId:b,disabled:le,disableTransforms:ee,items:S,overIndex:B,useDragOverlay:_,sortedRects:EV(S,f),strategy:i}),[L,b,le.draggable,le.droppable,ee,S,B,f,_,i]);return sn.createElement(cC.Provider,{value:fe},e)}const IV=r=>{let{id:e,items:t,activeIndex:n,overIndex:i}=r;return cc(t,n,i).indexOf(e)},AV=r=>{let{containerId:e,isSorting:t,wasDragging:n,index:i,items:o,newIndex:c,previousItems:d,previousContainerId:f,transition:m}=r;return!m||!n||d!==o&&i===c?!1:t?!0:c!==i&&e===f},CV={duration:200,easing:"ease"},uC="transform",RV=pi.Transition.toString({property:uC,duration:0,easing:"linear"}),kV={roleDescription:"sortable"};function DV(r){let{disabled:e,index:t,node:n,rect:i}=r;const[o,c]=j.useState(null),d=j.useRef(t);return Hs(()=>{if(!e&&t!==d.current&&n.current){const f=i.current;if(f){const m=Xc(n.current,{ignoreTransform:!0}),v={x:f.left-m.left,y:f.top-m.top,scaleX:f.width/m.width,scaleY:f.height/m.height};(v.x||v.y)&&c(v)}}t!==d.current&&(d.current=t)},[e,t,n,i]),j.useEffect(()=>{o&&c(null)},[o]),o}function dC(r){let{animateLayoutChanges:e=AV,attributes:t,disabled:n,data:i,getNewIndex:o=IV,id:c,strategy:d,resizeObserverConfig:f,transition:m=CV}=r;const{items:v,containerId:b,activeIndex:_,disabled:S,disableTransforms:k,sortedRects:L,overIndex:B,useDragOverlay:X,strategy:re}=j.useContext(cC),ee=OV(n,S),le=v.indexOf(c),fe=j.useMemo(()=>({sortable:{containerId:b,index:le,items:v},...i}),[b,i,le,v]),ce=j.useMemo(()=>v.slice(v.indexOf(c)),[v,c]),{rect:C,node:I,isOver:R,setNodeRef:U}=uV({id:c,data:fe,disabled:ee.droppable,resizeObserverConfig:{updateMeasurementsFor:ce,...f}}),{active:D,activatorEvent:M,activeNodeRect:O,attributes:qe,setNodeRef:gt,listeners:Z,isDragging:he,over:Te,setActivatorNodeRef:Me,transform:Ve}=sC({id:c,data:fe,attributes:{...kV,...t},disabled:ee.draggable}),V=KM(U,gt),te=!!D,pe=te&&!k&&Mf(_)&&Mf(B),ye=!X&&he,Ne=ye&&pe?Ve:null,Be=pe?Ne??(d??re)({rects:L,activeNodeRect:O,activeIndex:_,overIndex:B,index:le}):null,Je=Mf(_)&&Mf(B)?o({id:c,items:v,activeIndex:_,overIndex:B}):le,rt=D==null?void 0:D.id,$e=j.useRef({activeId:rt,items:v,newIndex:Je,containerId:b}),Zn=v!==$e.current.items,En=e({active:D,containerId:b,isDragging:he,isSorting:te,id:c,index:le,items:v,newIndex:$e.current.newIndex,previousItems:$e.current.items,previousContainerId:$e.current.containerId,transition:m,wasDragging:$e.current.activeId!=null}),fr=DV({disabled:!En,index:le,node:I,rect:C});return j.useEffect(()=>{te&&$e.current.newIndex!==Je&&($e.current.newIndex=Je),b!==$e.current.containerId&&($e.current.containerId=b),v!==$e.current.items&&($e.current.items=v)},[te,Je,b,v]),j.useEffect(()=>{if(rt===$e.current.activeId)return;if(rt!=null&&$e.current.activeId==null){$e.current.activeId=rt;return}const Ar=setTimeout(()=>{$e.current.activeId=rt},50);return()=>clearTimeout(Ar)},[rt]),{active:D,activeIndex:_,attributes:qe,data:fe,rect:C,index:le,newIndex:Je,items:v,isOver:R,isSorting:te,isDragging:he,listeners:Z,node:I,overIndex:B,over:Te,setNodeRef:V,setActivatorNodeRef:Me,setDroppableNodeRef:U,setDraggableNodeRef:gt,transform:fr??Be,transition:Ke()};function Ke(){if(fr||Zn&&$e.current.newIndex===le)return RV;if(!(ye&&!km(M)||!m)&&(te||En))return pi.Transition.toString({...m,property:uC})}}function OV(r,e){var t,n;return typeof r=="boolean"?{draggable:r,droppable:!1}:{draggable:(t=r==null?void 0:r.draggable)!=null?t:e.draggable,droppable:(n=r==null?void 0:r.droppable)!=null?n:e.droppable}}function Kp(r){if(!r)return!1;const e=r.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const jV=[ft.Down,ft.Right,ft.Up,ft.Left],PV=(r,e)=>{let{context:{active:t,collisionRect:n,droppableRects:i,droppableContainers:o,over:c,scrollableAncestors:d}}=e;if(jV.includes(r.code)){if(r.preventDefault(),!t||!n)return;const f=[];o.getEnabled().forEach(b=>{if(!b||b!=null&&b.disabled)return;const _=i.get(b.id);if(_)switch(r.code){case ft.Down:n.top<_.top&&f.push(b);break;case ft.Up:n.top>_.top&&f.push(b);break;case ft.Left:n.left>_.left&&f.push(b);break;case ft.Right:n.left<_.left&&f.push(b);break}});const m=d6({collisionRect:n,droppableRects:i,droppableContainers:f});let v=FA(m,"id");if(v===(c==null?void 0:c.id)&&m.length>1&&(v=m[1].id),v!=null){const b=o.get(t.id),_=o.get(v),S=_?i.get(_.id):null,k=_==null?void 0:_.node.current;if(k&&S&&b&&_){const B=Dm(k).some((ce,C)=>d[C]!==ce),X=hC(b,_),re=MV(b,_),ee=B||!X?{x:0,y:0}:{x:re?n.width-S.width:0,y:re?n.height-S.height:0},le={x:S.left,y:S.top};return ee.x&&ee.y?le:Fd(le,ee)}}}};function hC(r,e){return!Kp(r)||!Kp(e)?!1:r.data.current.sortable.containerId===e.data.current.sortable.containerId}function MV(r,e){return!Kp(r)||!Kp(e)||!hC(r,e)?!1:r.data.current.sortable.index<e.data.current.sortable.index}const VV=({songName:r,artist:e,participantName:t})=>h.jsxs("div",{className:"bg-[#150030] border-2 border-[var(--neon-pink)] p-4 rounded-3xl shadow-[0_0_30px_rgba(255,42,109,0.5)] flex items-center gap-4 w-[350px] opacity-90 scale-105 rotate-2",children:[h.jsx("div",{className:"text-3xl animate-bounce",children:""}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-xl font-black text-white uppercase truncate font-bungee leading-tight",children:r}),h.jsx("div",{className:"text-sm text-[var(--neon-cyan)] uppercase truncate font-righteous",children:e})]}),t&&h.jsxs("div",{className:"text-xs font-black text-[var(--neon-pink)] uppercase font-righteous",children:["@",t]})]}),Lf=({id:r,data:e,children:t,className:n})=>{const{attributes:i,listeners:o,setNodeRef:c,transform:d,transition:f,isDragging:m}=dC({id:r,data:e}),v={transform:pi.Transform.toString(d),transition:f,opacity:m?.3:1};return h.jsx("div",{ref:c,style:v,...i,...o,className:n,children:t})},gy=({id:r,data:e,children:t,className:n})=>{const{attributes:i,listeners:o,setNodeRef:c,transform:d,isDragging:f}=sC({id:r,data:e}),m={transform:pi.Translate.toString(d),opacity:f?.3:1};return h.jsx("div",{ref:c,style:m,...i,...o,className:n,children:t})},LV=({name:r})=>h.jsxs("div",{className:"bg-[#002a1a] border-2 border-[var(--neon-green)] p-6 rounded-[2rem] shadow-[0_0_50px_rgba(0,255,157,0.4)] flex items-center gap-6 w-[400px] opacity-90 scale-105",children:[h.jsx("div",{className:"w-12 h-12 rounded-full bg-[var(--neon-green)] flex items-center justify-center text-black font-black",children:""}),h.jsx("div",{className:"text-3xl font-black text-white uppercase tracking-tight font-bungee",children:r})]}),aS=({id:r,data:e,activeData:t,children:n,className:i})=>{const{attributes:o,listeners:c,setNodeRef:d,transform:f,transition:m,isDragging:v,over:b}=dC({id:r,data:e}),_=(b==null?void 0:b.id)===r&&(t==null?void 0:t.type)!=="PARTICIPANT",S={transform:pi.Transform.toString(f),transition:m,opacity:v?.3:1},k=_?"ring-4 ring-[var(--neon-green)] scale-[1.02] shadow-[0_0_30px_rgba(0,255,157,0.5)] z-10 transition-all":"";return h.jsx("div",{ref:d,style:S,...o,...c,className:`${i} ${k}`,children:n})},UV=[{songName:"Bohemian Rhapsody",artist:"Queen"},{songName:"Toxic",artist:"Britney Spears"},{songName:"Someone Like You",artist:"Adele"},{songName:"Sweet Caroline",artist:"Neil Diamond"},{songName:"Wonderwall",artist:"Oasis"},{songName:"Dancing Queen",artist:"ABBA"},{songName:"I Will Survive",artist:"Gloria Gaynor"},{songName:"Don't Stop Believin'",artist:"Journey"},{songName:"Livin' on a Prayer",artist:"Bon Jovi"},{songName:"My Way",artist:"Frank Sinatra"}],ka=({url:r})=>r?h.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",title:"Open Video Link",className:"p-3 rounded-2xl text-[var(--neon-cyan)] hover:bg-[var(--neon-cyan)]/20 border-2 border-[var(--neon-cyan)]/10 transition-all shadow-xl",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),h.jsx("polyline",{points:"15 3 21 3 21 9"}),h.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})}):null,oS=({url:r})=>{const[e,t]=j.useState(!1);if(!r)return null;const n=()=>{navigator.clipboard.writeText(r).then(()=>{t(!0),setTimeout(()=>t(!1),2e3)})};return h.jsx("button",{onClick:n,title:"Copy Video URL",className:`p-3 rounded-2xl transition-all border-2 ${e?"bg-[var(--neon-cyan)] text-black border-[var(--neon-cyan)] shadow-[0_0_20px_var(--neon-cyan)]":"text-slate-400 hover:text-[var(--neon-cyan)] hover:bg-[var(--neon-cyan)]/10 border-white/5 shadow-xl"}`,children:e?h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),h.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1-2-2h9a2 2 0 0 1 2 2v1"})]})})},Yu=({request:r})=>{const[e,t]=j.useState(!1),n=r.songName||r.songName,i=()=>{const c=(r.type||r.type||Tt.SINGING)===Tt.SINGING?" Karaoke":" Lyric",d=`${n} ${r.artist}${c}`;navigator.clipboard.writeText(d).then(()=>{t(!0),setTimeout(()=>t(!1),2e3)})};return h.jsx("button",{onClick:i,title:"Copy Command String",className:`p-3 rounded-2xl transition-all border-2 ${e?"bg-[var(--neon-green)] text-black border-[var(--neon-green)] shadow-[0_0_20px_rgba(0,255,157,0.4)]":"text-slate-400 hover:text-[var(--neon-green)] hover:bg-[var(--neon-green)]/10 border-white/5 shadow-xl"}`,children:e?h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),h.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})},Xu=({request:r})=>{const e=r.songName||r.songName,t=()=>{const i=(r.type||r.type||Tt.SINGING)===Tt.SINGING?" Karaoke":" Lyric",o=encodeURIComponent(`${e} ${r.artist}${i}`);window.open(`https://www.youtube.com/results?search_query=${o}`,"_blank")};return h.jsx("button",{onClick:t,title:"Search on YouTube",className:"p-3 rounded-2xl transition-all border-2 text-rose-500 hover:text-white hover:bg-rose-500 border-white/5 shadow-xl",children:h.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"})})})},zV=({onAdminAccess:r})=>{var oo,Zi,ks,lo,Ds,sr,co,ea;const[e,t]=j.useState(null),[n,i]=j.useState([]),[o,c]=j.useState(!1),[d,f]=j.useState(!1),[m,v]=j.useState(null),[b,_]=j.useState(!1),[S,k]=j.useState(!1),[L,B]=j.useState(!1),[X,re]=j.useState(!1),[ee,le]=j.useState(!1),[fe,ce]=j.useState([]),[C,I]=j.useState(null),[R,U]=j.useState(null),[D,M]=j.useState(null),[O,qe]=j.useState({}),[gt,Z]=j.useState(!1),[he,Te]=j.useState(!1),[Me,Ve]=j.useState([]),[V,te]=j.useState("DAY_SHOW"),[pe,ye]=j.useState(!1),[Ne,Re]=j.useState(MA()||""),[Be,Je]=j.useState(""),[rt,$e]=j.useState(!1),[Zn,En]=j.useState(0),[fr,Ke]=j.useState(null),[Ar,Bn]=j.useState(new Set),[Cs,Rs]=j.useState(""),[_t,st]=j.useState(null),[Wt,Kr]=j.useState("COMMAND"),[on,zt]=j.useState(""),[Tn,er]=j.useState(null),[ln,qt]=j.useState(""),[tr,us]=j.useState(localStorage.getItem("singmode_last_session_name")),K=j.useRef(null);j.useRef(null);const ve=j.useRef(null),Oe=j.useRef(null),[Le,et]=j.useState(null),[we,Ht]=j.useState(null),[nr,Sn]=j.useState(!1),[$t,kn]=j.useState({name:"",password:""}),[Qe,xt]=j.useState(""),[Bt,Kt]=j.useState(!1),[Fn,pn]=j.useState(""),[Zt,pr]=j.useState([]),[Qt,Dn]=j.useState({isOpen:!1,message:"",onConfirm:()=>{}}),yt=(T,ne)=>{Dn({isOpen:!0,message:T,onConfirm:ne})};j.useEffect(()=>{const T=kb(ne=>{pr(ne)});return()=>T()},[]);const _e=j.useCallback(async()=>{const T=await nt();t(T);const ne=await an();i(ne)},[]);j.useEffect(()=>{if(we&&n.length>0){const T=n.find(ne=>ne.id===we.id);T&&JSON.stringify(T)!==JSON.stringify(we)&&Ht(T)}},[n,we]),j.useEffect(()=>(_e(),window.addEventListener("kstar_sync",_e),window.addEventListener("storage",_e),()=>{window.removeEventListener("kstar_sync",_e),window.removeEventListener("storage",_e),rr()}),[_e]),j.useEffect(()=>{he&&qM().then(Ve).catch(console.error)},[he]);const mr=async T=>{ye(!0);const ne=T||V;try{await gc("DJ",ne),localStorage.setItem("singmode_last_session_name",ne),us(ne),_e()}catch(G){alert(G.message)}finally{ye(!1)}};j.useEffect(()=>{(!(e!=null&&e.currentRound)||e.currentRound.length===0)&&Bn(new Set)},[e==null?void 0:e.currentRound]);const rr=()=>{Oe.current&&cancelAnimationFrame(Oe.current),ve.current&&(ve.current.getTracks().forEach(T=>T.stop()),ve.current=null),K.current&&(K.current.close(),K.current=null),$e(!1),En(0)},gr=async(T,ne,G)=>{const ue=`Taking the stage now, it's ${T} with "${ne}"!`;await yd(G,{aiIntro:ue}),qe(be=>({...be,[G]:ue})),await _e()},Gn=async T=>{if(R&&we)R.type==="favorite"?await IM(we.id,R.itemId,{songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type}):await RM(we.id,R.itemId,{songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type,message:T.message}),U(null);else if(C)await yd(C.id,{participantName:T.singerName||C.participantName,songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type,message:T.message}),I(null);else if(m)await TM(m.id,{songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type}),v(null);else if(d)await EM({songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type}),f(!1);else{let ne=(D==null?void 0:D.id)||"DJ-MANUAL",G=T.singerName||(D==null?void 0:D.name)||"Guest";if(!D&&T.singerName){const ue=await Lc({name:T.singerName});ue.success&&ue.profile&&(ne=ue.profile.id,G=ue.profile.name,await Ko(ne))}await Oi({participantId:ne,participantName:G,songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type,message:T.message}),c(!1),M(null)}await _e()},Qn=async T=>{await Ko(T.id);const ne=[],G=new Set,ue=be=>{be.forEach(De=>{if(ne.length>=3)return;const We=`${De.songName.toLowerCase().trim()}|${De.artist.toLowerCase().trim()}`;G.has(We)||(G.add(We),ne.push({songName:De.songName,artist:De.artist,youtubeUrl:De.youtubeUrl||""}))})};ue([...T.favorites].sort(()=>Math.random()-.5)),ne.length<3&&ue([...T.personalHistory].sort(()=>Math.random()-.5)),ne.length<3&&(e!=null&&e.verifiedSongbook)&&ue([...e.verifiedSongbook].sort(()=>Math.random()-.5)),ne.length<3&&ue([...UV].sort(()=>Math.random()-.5));for(const be of ne){const De=await Oi({participantId:T.id,participantName:T.name,songName:be.songName,artist:be.artist,youtubeUrl:be.youtubeUrl,type:Tt.SINGING});De&&await Zl(De.id)}await Ba(T.id,dn.READY),await _e()},Yt=(T,ne,G)=>{const ue=G===Tt.SINGING?`${T} ${ne} karaoke`:`${T} ${ne} Lyrics Letra`,be=`https://www.youtube.com/results?search_query=${encodeURIComponent(ue)}`;window.open(be,"_blank")},mn=async T=>{var ue;await MM(T),await _e();const G=(ue=(await nt()).currentRound)==null?void 0:ue.find(be=>be.id===T);G&&gr(G.participantName,G.songName,G.id)},ds=T=>{T.youtubeUrl?window.open(T.youtubeUrl,"_blank"):Yt(T.songName,T.artist,T.type)},Ki=async T=>{T.preventDefault(),xt("");const ne={name:$t.name,password:$t.password||void 0};let G;Le?G=await Gi(Le.id,ne):G=await Lc(ne),G.success?(et(null),Sn(!1),kn({name:"",password:""}),xt(""),await _e()):xt(G.error||"Action failed.")},[Jc,io]=j.useState(null),[On,Qr]=j.useState(null),Qi=o6($T(Vb,{activationConstraint:{distance:8}}),$T(Pb,{coordinateGetter:PV})),hs=T=>{io(T.active.id),Qr(T.active.data.current)},Mr=async T=>{var De;io(null),Qr(null);const{active:ne,over:G}=T;if(!G)return;const ue=String(G.id),be=String(ne.id);if(ue.startsWith("drop-participant-")||ue.startsWith("participant-")&&(On==null?void 0:On.type)!=="PARTICIPANT"){const We=ue.replace("participant-","").replace("drop-participant-","").replace("side-",""),vt=e==null?void 0:e.participants.find(St=>St.id===We),un=(De=ne.data.current)==null?void 0:De.item;if(vt&&un){const St=await Oi({participantId:vt.id,participantName:vt.name,songName:un.songName,artist:un.artist,youtubeUrl:un.youtubeUrl||"",type:un.type||Tt.SINGING});St&&await Zl(St.id),await _e()}return}if(ne.id!==G.id){if(be.startsWith("participant-")&&ue.startsWith("participant-")){const We=be.startsWith("participant-side-")?"participant-side-":"participant-",vt=e.participants.findIndex(St=>`${We}${St.id}`===be),un=e.participants.findIndex(St=>`${We}${St.id}`===ue);if(vt!==-1&&un!==-1){const St=cc(e.participants,vt,un);await OA(St),await _e()}}else if(typeof ne.id=="string"&&ne.id.startsWith("pending-")&&String(G.id).startsWith("pending-")){const We=Xr.findIndex(St=>`pending-${St.id}`===ne.id),vt=Xr.findIndex(St=>`pending-${St.id}`===G.id),un=cc(Xr,We,vt);await DA(un),await _e()}else if(typeof ne.id=="string"&&ne.id.startsWith("queue-")&&String(G.id).startsWith("queue-")){const We=cn.findIndex(St=>`queue-${St.id}`===ne.id),vt=cn.findIndex(St=>`queue-${St.id}`===G.id),un=cc(cn,We,vt);await kA(un),await _e()}else if(typeof ne.id=="string"&&ne.id.startsWith("round-")&&String(G.id).startsWith("round-")&&e!=null&&e.currentRound){const We=ne.id.startsWith("round-rot-")?"round-rot-":"round-",vt=e.currentRound.findIndex(Os=>`${We}${Os.id}`===ne.id),un=e.currentRound.findIndex(Os=>`${We}${Os.id}`===G.id),St=cc(e.currentRound,vt,un);await RA(St),await _e()}}},yr=T=>{et(T),Sn(!0),kn({name:T.name,password:T.password||""})},fs=T=>{et(T),pn(""),Kt(!0),xt(""),Ht(null)},gn=async T=>{if(T.preventDefault(),!Le)return;const ne=await Gi(Le.id,{password:Fn});ne.success?(Ht(Le),et(null),Kt(!1),pn(""),xt(""),await _e()):xt(ne.error||"Update failed.")},Yi=()=>{c(!1),I(null),U(null),M(null),_(!1),k(!1),B(!1),re(!1),le(!1),Sn(!1),Kt(!1),et(null),Ht(null),Z(!1),f(!1),v(null),st(null),er(null)},ao=()=>{uv(Ne),Z(!1),_e()},ps=async()=>{k(!1),await LM(),await _e();const T=await nt();T.currentRound&&T.currentRound.forEach(ne=>{ne.aiIntro||gr(ne.participantName,ne.songName,ne.id)})},Yr=async()=>{await SM(),le(!1),await _e()},ms=T=>{const ne=n.find(G=>G.id===T);ne&&(Ht(ne),B(!0))};if(!e)return h.jsx("div",{className:"flex items-center justify-center p-20 min-h-screen",children:h.jsx("div",{className:"w-12 h-12 border-4 border-teal-400 border-t-transparent rounded-full animate-spin"})});const Xr=e.requests.filter(T=>T.status===Fe.PENDING&&!T.isInRound),Xi=e.requests.filter(T=>T.status===Fe.APPROVED&&T.type===Tt.SINGING&&!T.isInRound),dl=e.participants.filter(T=>Xi.some(ne=>ne.participantId===T.id)).sort((T,ne)=>(ne.joinedAt||0)-(T.joinedAt||0)),Cr={};Xi.forEach(T=>{Cr[T.participantId]||(Cr[T.participantId]=[]),Cr[T.participantId].push(T)}),Object.keys(Cr).forEach(T=>{Cr[T].sort((ne,G)=>ne.createdAt-G.createdAt)});const cn=[];let en=0,yn=!0;for(;yn;)yn=!1,dl.forEach(T=>{Cr[T.id]&&Cr[T.id][en]&&(cn.push(Cr[T.id][en]),yn=!0)}),en++;const Vr=e.requests.filter(T=>T.status===Fe.APPROVED&&T.type===Tt.LISTENING&&!T.isInRound),Ji=e.participants.filter(T=>T.status===dn.READY).length,it=e.verifiedSongbook||[],vn=pt.getRoomId();Bp()+(vn?`?room=${vn}`:"");const Jr=({name:T,isActive:ne})=>{const G=T.split(" ").map(De=>De[0]).join("").toUpperCase().slice(0,2),ue=["from-teal-400 to-indigo-500","from-rose-400 to-orange-500","from-amber-400 to-rose-500","from-indigo-400 to-purple-500","from-emerald-400 to-teal-500"],be=T.length%ue.length;return h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:`w-12 h-12 rounded-2xl bg-gradient-to-br ${ue[be]} p-[2px] shadow-lg shadow-black/20`,children:h.jsx("div",{className:"w-full h-full bg-slate-950 rounded-[14px] flex items-center justify-center",children:h.jsx("span",{className:"text-xl font-black text-white tracking-widest",children:G})})}),ne&&h.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-[var(--neon-green)] rounded-full border-4 border-slate-950 animate-pulse"})]})},Ks=it.filter(T=>T.songName.toLowerCase().includes(on.toLowerCase())||T.artist.toLowerCase().includes(on.toLowerCase())),vr=async T=>{if(_t){const ne=await Oi({participantId:_t.id,participantName:_t.name,songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl||"",type:T.type});ne&&await Zl(ne.id),st(null),zt(""),await _e()}},Wi=T=>{v(T)};return h.jsxs("div",{className:"max-w-[1600px] mx-auto p-4 lg:p-8 space-y-12 relative font-inter text-slate-300",children:[h.jsxs("header",{className:"relative rounded-[4rem] p-1 overflow-hidden shadow-3xl mb-12 group",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-blue)] opacity-80 group-hover:opacity-100 transition-all duration-1000 animate-gradient-x"}),h.jsxs("div",{className:"relative glass-panel rounded-[3.9rem] p-10 flex flex-col md:flex-row justify-between items-center gap-12 border border-white/20 backdrop-blur-3xl",children:[h.jsxs("div",{className:"flex items-center gap-10",children:[h.jsxs("div",{className:"relative group/logo",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-[var(--neon-yellow)] to-[var(--neon-pink)] rounded-full blur-xl opacity-60 group-hover/logo:opacity-100 transition-opacity duration-500"}),h.jsx("div",{className:"relative p-1.5 rounded-full border-4 border-white/10 shadow-2xl bg-black/40",children:h.jsx("img",{src:"IGK.jpeg",alt:"Island Groove",className:"w-32 h-32 rounded-full transition-transform duration-700 group-hover/logo:rotate-[360deg]"})})]}),h.jsxs("div",{children:[h.jsxs("h1",{className:"text-8xl font-bold font-bungee text-white flex items-center gap-6 uppercase tracking-tight neon-glow-pink leading-none",children:["Singmode ",h.jsx("span",{className:"text-[var(--neon-blue)] neon-glow-cyan text-5xl font-righteous translate-y-2",children:"beta"})]}),h.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[h.jsx("span",{className:"px-4 py-1.5 rounded-full bg-[var(--neon-pink)]/10 border border-[var(--neon-pink)]/30 text-[var(--neon-pink)] text-lg font-bold uppercase tracking-widest font-righteous",children:"DJ CONSOLE"}),h.jsx("span",{className:"text-[var(--neon-blue)]/30",children:"||"}),h.jsxs("span",{className:"text-[var(--neon-blue)] text-lg font-bold uppercase tracking-widest font-righteous neon-glow-cyan",children:["SINGERS: ",e.participants.length]})]})]})]}),h.jsx("div",{className:"flex gap-4",children:h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-base text-[var(--neon-yellow)] font-bold uppercase tracking-widest font-righteous mb-1",children:"STATUS"}),h.jsxs("div",{className:"text-4xl text-white font-bold uppercase tracking-widest font-bungee flex items-center justify-end gap-3",children:["ONLINE ",h.jsx("div",{className:"w-3 h-3 bg-[var(--neon-green)] rounded-full animate-pulse shadow-[0_0_10px_var(--neon-green)]"})]})]})})]})]}),h.jsxs("div",{className:"bg-[#0a0a10]/90 backdrop-blur-2xl rounded-[2.5rem] p-6 border border-white/5 shadow-xl relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-[var(--neon-purple)]/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/4 pointer-events-none"}),h.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-6 relative z-10",children:[h.jsxs("div",{className:"flex items-center gap-5",children:[h.jsx("span",{className:"text-4xl",children:""}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold font-bungee text-white uppercase neon-glow-purple",children:"DAY_SHOW SESSION"}),h.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[h.jsx("span",{className:`text-xs font-black uppercase tracking-widest font-righteous ${vn?"text-[var(--neon-green)]":"text-slate-500"}`,children:vn?" ACTIVE":" OFFLINE"}),vn&&h.jsxs("span",{className:"text-slate-400 font-mono text-xs",children:["ROOM: ",h.jsx("span",{className:"text-white font-bold",children:vn})]})]})]})]}),h.jsxs("div",{className:"flex gap-3",children:[!vn&&h.jsx("button",{onClick:()=>Kr("SESSION"),className:"px-6 py-3 bg-[var(--neon-purple)] text-white rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-fuchsia-500 transition-all font-righteous shadow-[0_0_20px_rgba(180,0,255,0.3)]",children:" OPEN BROADCAST"}),h.jsx("button",{onClick:()=>Te(!he),className:"px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl font-black text-xs uppercase tracking-widest font-righteous text-slate-400 hover:text-white transition-all",children:he?" HIDE HISTORY":" SESSION HISTORY"})]})]}),he&&h.jsx("div",{className:"mt-6 pt-6 border-t border-white/5",children:Me.length===0?h.jsx("p",{className:"text-slate-600 font-black uppercase tracking-widest text-xs font-righteous py-4 text-center",children:"NO PREVIOUS SESSIONS RECORDED"}):h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Me.slice().reverse().map(T=>h.jsxs("div",{className:"p-4 bg-white/5 border border-white/5 rounded-2xl hover:border-white/10 transition-all",children:[h.jsx("div",{className:"text-white font-bold font-bungee text-sm truncate",children:T.hostName||"DAY_SHOW"}),h.jsx("div",{className:"text-[var(--neon-cyan)] font-mono text-[10px] mt-1",children:new Date(T.startedAt).toLocaleString()}),T.endedAt&&h.jsxs("div",{className:"text-slate-500 text-[10px] font-righteous mt-0.5",children:["DURATION: ",Math.round((T.endedAt-T.startedAt)/6e4),"m"]})]},T.id))})})]}),h.jsx("div",{className:"sticky top-4 z-50",children:h.jsxs("div",{className:"glass-panel p-4 rounded-[2.5rem] border border-white/20 shadow-[0_20px_50px_rgba(0,0,0,0.5)] flex flex-col gap-3 backdrop-blur-3xl",children:[h.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[h.jsxs("div",{className:"flex gap-3 p-2 bg-black/40 rounded-[2rem] border border-white/5",children:[h.jsxs("button",{onClick:()=>c(!0),className:"px-8 py-4 bg-[var(--neon-pink)] text-black font-black hover:bg-white transition-all active:scale-95 rounded-[1.5rem] shadow-[0_0_25px_rgba(255,42,109,0.4)] text-lg uppercase tracking-[0.2em] font-righteous flex items-center gap-3 group",children:[h.jsx("span",{className:"text-3xl group-hover:rotate-90 transition-transform",children:""})," ADD SONG"]}),h.jsxs("button",{onClick:()=>{k(!0),_e()},disabled:!!(e!=null&&e.currentRound&&e.currentRound.length>0),className:`px-8 py-4 font-black uppercase tracking-[0.2em] text-lg rounded-[1.5rem] flex items-center gap-3 transition-all font-righteous ${e!=null&&e.currentRound&&e.currentRound.length>0?"bg-slate-800 text-slate-500 cursor-not-allowed border border-white/10":"bg-[var(--neon-blue)] text-black hover:bg-white active:scale-95 shadow-[0_0_25px_rgba(5,217,232,0.4)] group"}`,children:[h.jsx("span",{className:`text-3xl ${e!=null&&e.currentRound&&e.currentRound.length>0?"":"group-hover:animate-spin"}`,children:""})," NEXT ROUND"]})]}),h.jsx("div",{className:"w-[1px] h-12 bg-white/10 mx-2"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>{er(null),_(!0)},className:"w-14 h-14 flex items-center justify-center text-[var(--neon-yellow)] border border-[var(--neon-yellow)]/30 bg-[var(--neon-yellow)]/5 hover:bg-[var(--neon-yellow)] hover:text-black transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(255,200,87,0.1)] group",children:h.jsx("span",{className:"text-4xl group-hover:scale-110 transition-transform",children:""})}),h.jsx("button",{onClick:()=>B(!0),className:"w-14 h-14 flex items-center justify-center text-[var(--neon-blue)] border border-[var(--neon-blue)]/30 bg-[var(--neon-blue)]/5 hover:bg-[var(--neon-blue)] hover:text-black transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(5,217,232,0.1)] group",children:h.jsx("span",{className:"text-4xl group-hover:scale-110 transition-transform",children:""})}),h.jsx("button",{onClick:()=>le(!0),className:"w-14 h-14 flex items-center justify-center text-rose-500 border border-rose-500/30 bg-rose-500/5 hover:bg-rose-500 hover:text-white transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(244,63,94,0.1)] group",children:h.jsx("span",{className:"text-4xl group-hover:rotate-12 transition-transform",children:""})}),r&&h.jsxs("button",{onClick:r,title:"ADMIN PORTAL",className:"w-14 h-14 flex items-center justify-center text-[var(--neon-purple)] border border-[var(--neon-purple)]/30 bg-[var(--neon-purple)]/5 hover:bg-[var(--neon-purple)] hover:text-black transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(147,51,234,0.1)] group ml-4 relative",children:[h.jsx("span",{className:"text-4xl group-hover:scale-110 transition-transform",children:""}),h.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-[var(--neon-pink)] rounded-full animate-pulse border-2 border-black"})]}),h.jsxs("button",{onClick:()=>{yt("Are you sure you want to sign out?",async()=>{await Am(),window.location.reload()})},title:"SIGN OUT",className:"px-6 h-14 flex items-center justify-center gap-3 text-rose-500 border border-rose-500/30 bg-rose-500/5 hover:bg-rose-500 hover:text-white transition-all rounded-[1.2rem] shadow-[0_0_15px_rgba(244,63,94,0.1)] group ml-2",children:[h.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),h.jsx("polyline",{points:"16 17 21 12 16 7"}),h.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest font-righteous",children:"SIGN_OUT"})]})]})]}),h.jsx("div",{className:"flex gap-1.5 overflow-x-auto no-scrollbar border-t border-white/5 pt-3",children:["COMMAND","ROTATION","PERFORMERS","LIBRARY","SESSION"].map(T=>h.jsx("button",{onClick:()=>Kr(T),className:`px-6 py-2.5 rounded-full font-bungee text-sm tracking-widest transition-all whitespace-nowrap border-2 ${Wt===T?"bg-white text-black border-white shadow-[0_0_20px_rgba(255,255,255,0.3)]":"bg-transparent text-slate-400 border-white/20 hover:border-white/40 hover:text-white"}`,children:T==="COMMAND"?"DECK":T==="ROTATION"?"ROTATION":T==="PERFORMERS"?"PERFORMERS":T==="LIBRARY"?"LIBRARY":"SESSION"},T))})]})}),h.jsxs(iV,{sensors:Qi,collisionDetection:u6,onDragStart:hs,onDragEnd:Mr,children:[h.jsxs("main",{className:"min-h-[600px] animate-in fade-in duration-500",children:[Wt==="COMMAND"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 animate-in slide-in-from-bottom-2",children:[h.jsxs("div",{className:"lg:col-span-8 space-y-10",children:[e.currentRound&&h.jsxs("section",{className:"relative rounded-[3rem] p-1 overflow-hidden shadow-[0_0_100px_rgba(255,42,109,0.3)] zoom-in-95 duration-500",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-orange)] opacity-20 animate-pulse"}),h.jsxs("div",{className:"relative bg-[#150030]/90 p-10 rounded-[2.8rem] backdrop-blur-xl border-2 border-[var(--neon-green)]/50",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8",children:[h.jsxs("h2",{className:"text-4xl font-bold font-bungee text-white uppercase flex items-center gap-4 neon-glow-green",children:[h.jsx("span",{className:"text-6xl animate-pulse",children:""})," NOW PLAYING"]}),h.jsx("button",{onClick:async()=>{await UM(),await _e()},className:"px-8 py-3 bg-[var(--neon-pink)] text-black text-base font-bold uppercase hover:bg-white transition-all rounded-[1rem] tracking-widest font-righteous shadow-[0_0_20px_var(--neon-pink)] active:scale-95",children:"END ROUND"})]}),h.jsx("div",{className:"flex flex-col gap-3",children:h.jsx(tc,{items:e.currentRound.map(T=>`round-${T.id}`),strategy:ec,children:e.currentRound.map((T,ne)=>{const G=e.participants.find(We=>We.id===T.participantId),ue=(G==null?void 0:G.status)===dn.READY,be=e.currentRound.findIndex(We=>We.status!==Fe.DONE),De=ne===(be===-1?0:be);return h.jsxs(Lf,{id:`round-${T.id}`,data:{item:T,type:"ROUND"},className:`p-3 pl-6 pr-4 rounded-xl border-l-8 transition-all duration-300 flex items-center justify-between gap-4 w-full shadow-lg relative overflow-hidden group cursor-pointer ${De?"bg-[#001005] border-l-[var(--neon-green)] border-y border-r border-[#1a3320] z-10 scale-[1.01]":"bg-[#0a0a10] border-l-slate-700 border-y border-r border-white/10 opacity-70 hover:opacity-100"}`,children:[h.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_49%,rgba(255,255,255,0.03)_50%,transparent_51%)] bg-[length:50px_100%] pointer-events-none"}),h.jsxs("div",{className:"flex items-center gap-6 min-w-0 flex-1 z-10",children:[h.jsxs("div",{className:"relative",children:[De&&h.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 px-2 py-0.5 bg-[var(--neon-green)] text-black text-[8px] font-black uppercase tracking-[0.2em] rounded animate-pulse shadow-[0_0_10px_var(--neon-green)] z-20",children:"LIVE"}),h.jsx("button",{onClick:()=>{const We=T.type===Tt.SINGING?" Karaoke":" Lyric",vt=`${T.songName} ${T.artist}${We}`;navigator.clipboard.writeText(vt)},title:"Copy Command String",className:`w-16 h-16 flex flex-col justify-center items-center border-2 rounded-2xl transition-all shrink-0 active:scale-95 ${De?"border-[var(--neon-green)] bg-[var(--neon-green)]/10 text-[var(--neon-green)] shadow-[0_0_15px_rgba(0,255,157,0.2)]":"border-white/10 text-slate-400 hover:border-white/30 hover:bg-white/5"}`,children:h.jsx("span",{className:"text-2xl font-bold font-mono tracking-tighter",children:T.requestNumber})})]}),h.jsxs("div",{className:"flex items-baseline gap-6 min-w-0 flex-1",children:[h.jsx("h3",{className:`text-2xl font-black uppercase font-righteous tracking-tight leading-tight ${De?"text-white":"text-slate-300"}`,children:T.songName}),h.jsxs("div",{className:"flex items-center gap-3 opacity-80 shrink-0",children:[h.jsx("span",{className:"text-xl font-bold font-righteous text-[var(--neon-cyan)] uppercase tracking-wider",children:T.artist}),h.jsx("span",{className:"text-slate-600 font-mono text-lg",children:"/"}),h.jsxs("button",{onClick:()=>ms(T.participantId),className:"flex items-center gap-2 group/singer hover:underline",children:[h.jsx("div",{className:`w-2 h-2 rounded-full ${ue?"bg-[var(--neon-green)] shadow-[0_0_5px_var(--neon-green)]":"bg-slate-700"}`}),h.jsxs("span",{className:"text-xl font-bold font-righteous text-[var(--neon-pink)] uppercase tracking-wider",children:["@",T.participantName]})]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-3 z-10 pl-4 border-l border-white/10 bg-gradient-to-l from-black/80 to-transparent",children:[h.jsx("button",{onClick:async()=>{T.status===Fe.DONE?await yd(T.id,{status:Fe.APPROVED}):await FT(T.id),await _e()},title:T.status===Fe.DONE?"Undo Done":"Mark as Done",className:`p-2 rounded-xl transition-all border-2 ${T.status===Fe.DONE?"text-yellow-500 border-yellow-500/30 bg-yellow-500/10 shadow-[0_0_15px_rgba(234,179,8,0.2)]":"text-slate-600 border-white/5 hover:border-white/20 hover:text-white"}`,children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:h.jsx("polyline",{points:"20 6 9 17 4 12"})})}),h.jsx("button",{onClick:()=>{yt("Remove from active round?",async()=>{await Da(T.id),await _e()})},className:"w-8 h-8 flex items-center justify-center rounded bg-rose-500/10 hover:bg-rose-500 text-rose-500 hover:text-white transition-all border border-rose-500/20",title:"REMOVE",children:""})]})]},`round-${T.id}`)})})})]})]}),h.jsxs("section",{className:"bg-[#10002B]/80 border-2 border-[var(--neon-blue)]/30 rounded-[3rem] p-10 shadow-[0_0_60px_rgba(5,217,232,0.1)] relative overflow-hidden backdrop-blur-md",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8 px-2",children:[h.jsxs("h2",{className:"text-4xl font-bold font-bungee text-white uppercase flex items-center gap-4 neon-glow-cyan",children:[h.jsx("span",{className:"text-[var(--neon-blue)]",children:""})," REQUESTS"]}),h.jsxs("span",{className:"px-6 py-2 bg-[var(--neon-blue)]/10 border border-[var(--neon-blue)]/30 rounded-full text-base text-[var(--neon-blue)] font-bold tracking-widest font-righteous",children:[Xr.length," PENDING"]})]}),h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsx(tc,{items:Xr.map(T=>`pending-${T.id}`),strategy:ec,children:Xr.map((T,ne)=>h.jsxs(Lf,{id:`pending-${T.id}`,data:{item:T,type:"PENDING"},className:"bg-black/40 border border-white/5 p-4 rounded-3xl flex items-center gap-6 hover:border-[var(--neon-blue)] transition-all group cursor-pointer shadow-xl",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-1",children:[h.jsx("div",{className:"text-xs font-black font-righteous text-[var(--neon-pink)] uppercase tracking-[0.2em] bg-[var(--neon-pink)]/10 px-2 py-0.5 rounded-full border border-[var(--neon-pink)]/20 shrink-0",children:"NEW_SIGNAL"}),h.jsx("div",{className:"text-3xl font-black text-white uppercase truncate tracking-tighter font-bungee group-hover:text-[var(--neon-blue)] transition-colors",children:T.songName}),h.jsxs("div",{className:"text-slate-500 text-base font-black uppercase tracking-[0.2em] font-righteous truncate",children:["/ ",T.artist]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:()=>ms(T.participantId),className:"text-base font-bold text-[var(--neon-pink)] uppercase truncate hover:text-white transition-colors font-righteous tracking-[0.2em]",children:["@",T.participantName]}),T.message&&h.jsx("div",{className:"flex-1 max-w-md px-3 py-1 bg-black/40 border-l-2 border-[var(--neon-pink)] rounded-r-lg",children:h.jsxs("p",{className:"text-base text-white/60 font-medium italic truncate",children:['"',T.message,'"']})})]})]}),h.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[h.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx(Yu,{request:T}),h.jsx(Xu,{request:T}),h.jsx(ka,{url:T.youtubeUrl}),h.jsx("button",{onClick:()=>I(T),className:"p-3 bg-white/5 hover:bg-white/10 rounded-xl text-sm font-black uppercase tracking-widest transition-all font-righteous text-white/50 hover:text-white border border-white/5",children:"EDIT"})]}),h.jsxs("div",{className:"flex gap-2 bg-black/40 p-1 rounded-2xl border border-white/5",children:[h.jsx("button",{onClick:async()=>{await Zl(T.id),await _e()},className:"px-6 py-3 bg-[var(--neon-blue)] text-black text-sm font-black uppercase hover:bg-white transition-all rounded-xl tracking-[0.1em] shadow-[0_0_20px_rgba(5,217,232,0.3)]",children:"ACCEPT"}),h.jsx("button",{onClick:()=>{yt("Delete pending request?",async()=>{await Da(T.id),await _e()})},className:"w-11 h-11 flex items-center justify-center text-rose-500 hover:bg-rose-500/10 rounded-xl transition-all",children:""})]})]})]},`pending-${T.id}`))}),Xr.length===0&&h.jsx("div",{className:"col-span-full py-24 text-center border-4 border-dashed border-white/5 rounded-[2.5rem] opacity-30",children:h.jsx("p",{className:"text-4xl font-black font-righteous uppercase tracking-[0.4em] italic text-slate-500",children:"NO SIGNAL DETECTED"})})]})]}),h.jsxs("div",{className:"flex flex-col gap-10",children:[h.jsxs("section",{className:"bg-[#10002B]/60 border-2 border-[var(--neon-yellow)]/20 rounded-[3rem] p-10 shadow-2xl relative overflow-hidden backdrop-blur-sm",children:[h.jsxs("h3",{className:"text-5xl font-bold font-bungee text-white uppercase mb-8 px-2 neon-glow-yellow flex items-center gap-4",children:[h.jsx("span",{className:"text-[var(--neon-yellow)] animate-pulse",children:""})," QUEUE"]}),h.jsxs("div",{className:"flex flex-col gap-3",children:[h.jsx(tc,{items:cn.map(T=>`queue-${T.id}`),strategy:ec,children:cn.map((T,ne)=>h.jsxs(Lf,{id:`queue-${T.id}`,data:{item:T,type:"QUEUE"},className:"bg-black/40 border border-white/5 p-4 rounded-[2rem] flex items-center gap-6 group hover:border-[var(--neon-yellow)] transition-all cursor-pointer shadow-lg relative",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-black/40 rounded-2xl border border-white/5 text-[var(--neon-yellow)] font-bungee text-3xl shrink-0 group-hover:scale-110 transition-transform",children:ne+1}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-0.5",children:[h.jsx("div",{className:"text-2xl font-bold text-white truncate uppercase tracking-tight font-bungee group-hover:text-[var(--neon-yellow)] transition-colors",children:T.songName}),h.jsxs("div",{className:"text-sm text-slate-500 uppercase tracking-widest font-righteous",children:["/ ",T.artist]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:G=>{G.stopPropagation(),ms(T.participantId)},className:"text-sm font-black text-[var(--neon-yellow)] uppercase tracking-[0.2em] font-righteous hover:text-white transition-colors",children:["@",T.participantName]}),T.message&&h.jsxs("div",{className:"flex-1 max-w-sm px-2 py-0.5 bg-[var(--neon-yellow)]/5 border-l border-[var(--neon-yellow)]/30 rounded-r text-xs text-[var(--neon-yellow)]/70 italic truncate",children:['"',T.message,'"']})]})]}),h.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[h.jsxs("div",{className:"flex flex-col gap-0.5 px-2",children:[h.jsx("button",{onClick:async()=>{await GT(T.id,"up"),await _e()},className:"text-slate-700 hover:text-white transition-colors p-1 text-base",children:""}),h.jsx("button",{onClick:async()=>{await GT(T.id,"down"),await _e()},className:"text-slate-700 hover:text-white transition-colors p-1 text-base",children:""})]}),h.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx(Yu,{request:T}),h.jsx(Xu,{request:T}),h.jsx(ka,{url:T.youtubeUrl}),h.jsx("button",{onClick:()=>I(T),className:"p-2 text-slate-600 hover:text-white text-xs font-black uppercase tracking-widest font-righteous transition-colors border border-white/5 rounded-lg",children:"EDIT"})]}),h.jsxs("div",{className:"flex gap-2 bg-black/40 p-1 rounded-xl border border-white/5",children:[h.jsx("button",{onClick:()=>mn(T.id),className:"px-4 py-2 bg-[var(--neon-yellow)] text-black text-sm font-black uppercase rounded-lg hover:bg-white transition-all shadow-[0_0_15px_rgba(255,200,87,0.3)] tracking-wider",children:"STAGE"}),h.jsx("button",{onClick:()=>{yt("Remove from queue?",async()=>{await Da(T.id),await _e()})},className:"w-9 h-9 flex items-center justify-center text-rose-500/20 hover:text-rose-500 hover:bg-rose-500/10 rounded-lg transition-all",children:""})]})]})]},`queue-${T.id}`))}),cn.length===0&&h.jsx("div",{className:"flex-1 py-12 flex items-center justify-center border-2 border-dashed border-white/5 rounded-[2rem] opacity-30 w-full",children:h.jsx("p",{className:"text-xl font-black font-righteous uppercase tracking-[0.3em] text-slate-500",children:"QUEUE EMPTY"})})]})]}),h.jsxs("section",{className:"bg-[#10002B]/60 border-2 border-[var(--neon-blue)]/20 rounded-[3rem] p-10 shadow-2xl relative overflow-hidden backdrop-blur-sm",children:[h.jsxs("h3",{className:"text-3xl font-bold font-bungee text-white uppercase mb-8 px-2 neon-glow-blue flex items-center gap-4",children:[h.jsx("span",{className:"text-[var(--neon-blue)] animate-pulse",children:""})," TO HEAR (",Vr.length,")"]}),h.jsxs("div",{className:"flex flex-col gap-3",children:[Vr.map((T,ne)=>h.jsxs("div",{className:"bg-black/40 border border-white/5 p-4 rounded-[2rem] flex items-center gap-6 group hover:border-[var(--neon-blue)] transition-all relative",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-black/40 rounded-2xl border border-white/5 text-[var(--neon-blue)] font-bungee text-xl shrink-0",children:ne+1}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-0.5",children:[h.jsx("div",{className:"text-xl font-bold text-white truncate uppercase tracking-tight font-bungee group-hover:text-[var(--neon-blue)] transition-colors",children:T.songName}),h.jsxs("div",{className:"text-sm text-slate-500 uppercase tracking-widest font-righteous",children:["/ ",T.artist]})]}),h.jsxs("div",{className:"text-xs font-black text-[var(--neon-pink)] uppercase tracking-[0.2em] font-righteous",children:["@",T.participantName]})]}),h.jsx("div",{className:"flex gap-2 bg-black/40 p-1 rounded-xl border border-white/5 opacity-0 group-hover:opacity-100 transition-opacity",children:h.jsx("button",{onClick:async()=>{await Da(T.id),await _e()},className:"px-4 py-2 text-rose-500 hover:bg-rose-500 hover:text-white rounded-lg transition-all font-black text-xs uppercase tracking-widest font-righteous",children:"REMOVE"})})]},T.id)),Vr.length===0&&h.jsx("div",{className:"flex-1 py-8 flex items-center justify-center border-2 border-dashed border-white/5 rounded-[2rem] opacity-30 w-full",children:h.jsx("p",{className:"text-base font-black font-righteous uppercase tracking-[0.3em] text-slate-500",children:"NO LISTENING TRACKS"})})]})]}),h.jsxs("section",{className:"bg-[#10002B]/60 border-2 border-[var(--neon-green)]/20 rounded-[3rem] p-10 shadow-2xl relative overflow-hidden backdrop-blur-sm",children:[h.jsxs("h3",{className:"text-3xl md:text-4xl font-bold font-bungee text-white uppercase mb-8 px-2 neon-glow-green flex items-center gap-4 flex-wrap",children:[h.jsx("span",{className:"text-[var(--neon-green)] animate-pulse",children:""})," ATMOSPHERE"]}),h.jsxs("div",{className:"space-y-10",children:[h.jsxs("div",{className:"p-6 bg-black/40 rounded-3xl border border-white/5 space-y-6",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[h.jsx("label",{className:"text-sm md:text-base font-black text-[var(--neon-cyan)] uppercase tracking-[0.2em] font-righteous opacity-80 break-words",children:"REQUEST LIMIT"}),h.jsx("span",{className:"text-4xl font-black text-white font-bungee neon-glow-cyan",children:e.maxRequestsPerUser||5})]}),h.jsx("input",{type:"range",min:"1",max:"20",value:e.maxRequestsPerUser||5,onChange:async T=>{await jM(parseInt(T.target.value)),await _e()},className:"w-full accent-[var(--neon-cyan)] bg-white/5 rounded-lg appearance-none h-2 cursor-pointer transition-all"}),h.jsxs("div",{className:"flex justify-between text-xs font-black text-slate-600 font-righteous uppercase tracking-widest",children:[h.jsx("span",{children:"STRICT (1)"}),h.jsx("span",{children:"UNLIMITED (20)"})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-base font-black text-[var(--neon-pink)] uppercase tracking-[0.4em] mb-4 flex items-center gap-4 font-righteous opacity-80",children:"BACKGROUND THREADS"}),h.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar custom-scrollbar-h",children:[[...Vr].reverse().map(T=>h.jsxs(gy,{id:`atmos-${T.id}`,data:{item:T},className:"bg-black/60 p-5 rounded-[2rem] border border-white/10 flex flex-col justify-between group hover:border-[var(--neon-pink)] transition-all shadow-lg min-w-[280px] max-w-[280px] cursor-pointer",children:[h.jsxs("div",{className:"min-w-0 mb-4 cursor-pointer",onClick:()=>Yt(T.songName,T.artist,T.type),children:[h.jsx("div",{className:"text-2xl font-black text-white truncate uppercase tracking-tight font-bungee group-hover:text-[var(--neon-pink)] transition-all",children:T.songName}),h.jsx("div",{className:"text-base text-slate-500 uppercase tracking-widest mt-1 font-righteous opacity-60 truncate",children:T.artist})]}),h.jsxs("div",{className:"flex items-center justify-between border-t border-white/5 pt-4",children:[h.jsx(ka,{url:T.youtubeUrl}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>mn(T.id),className:"px-4 py-2 bg-[var(--neon-purple)] text-white text-sm font-black uppercase rounded-lg hover:bg-white hover:text-black transition-all shadow-[0_0_10px_var(--neon-purple)] tracking-[0.1em]",children:"BOOST"}),h.jsx("button",{onClick:()=>{yt("Remove from atmosphere?",async()=>{await Da(T.id),await _e()})},className:"text-rose-500/20 hover:text-rose-500 p-2 font-black",children:""})]})]})]},`atmos-${T.id}`)),Vr.length===0&&h.jsx("p",{className:"text-base text-slate-700 italic px-4 font-righteous uppercase tracking-widest opacity-50",children:"NO BACKGROUND TRACKS"})]})]}),h.jsxs("div",{className:"pt-6 border-t border-white/5",children:[h.jsxs("h4",{className:"text-base font-black text-[var(--neon-cyan)] uppercase tracking-[0.4em] mb-6 flex justify-between items-center font-righteous opacity-80",children:[h.jsx("span",{children:"VERIFIED_LINKS"}),h.jsx("button",{onClick:()=>f(!0),className:"text-[var(--neon-cyan)] hover:text-white transition-colors underline decoration-dotted",children:"+ ADD NEW"})]}),h.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar custom-scrollbar-h",children:[[...it].reverse().map(T=>h.jsxs(gy,{id:`verif-${T.id}`,data:{item:T},className:"bg-black/80 p-5 rounded-[2rem] border border-white/5 flex flex-col justify-between group hover:border-[var(--neon-cyan)] transition-all shadow-lg min-w-[280px] max-w-[280px] cursor-pointer",children:[h.jsxs("div",{className:"min-w-0 mb-4",children:[h.jsx("div",{className:"text-2xl font-bold text-white uppercase truncate tracking-tight group-hover:text-[var(--neon-cyan)] transition-colors font-bungee mb-1",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-600 uppercase truncate tracking-widest font-righteous font-bold",children:T.artist})]}),h.jsxs("div",{className:"flex items-center justify-between border-t border-white/5 pt-4",children:[h.jsxs("div",{className:"flex gap-1",children:[h.jsx(oS,{url:T.youtubeUrl}),h.jsx("button",{onClick:()=>v(T),className:"text-slate-600 hover:text-white p-2",children:""})]}),h.jsxs("div",{className:"flex gap-2 shrink-0",children:[h.jsx("button",{onClick:()=>Yt(T.songName,T.artist,T.type),className:"px-3 py-1 bg-black border border-[var(--neon-cyan)] text-[var(--neon-cyan)] text-sm font-black uppercase rounded-md hover:bg-[var(--neon-cyan)] hover:text-black transition-all tracking-widest",children:"RUN"}),h.jsx("button",{onClick:()=>{c(!0)},className:"px-3 py-1 bg-[var(--neon-pink)] text-black text-sm font-black uppercase rounded-md hover:bg-white transition-all shadow-lg tracking-widest",children:"PUSH"}),h.jsx("button",{onClick:()=>{yt("Delete verified song?",async()=>{await UT(T.id),await _e()})},className:"text-rose-500/20 hover:text-rose-500 px-1 font-black",children:""})]})]})]},`verif-${T.id}`)),it.length===0&&h.jsx("p",{className:"text-xl text-slate-800 italic px-4 font-righteous uppercase tracking-widest opacity-30",children:"NO VERIFIED SONGS"})]})]})]})]})]})]}),h.jsxs("div",{className:"lg:col-span-4 space-y-8",children:[h.jsxs("section",{className:"bg-[#0a0a0a] border-4 border-white/5 rounded-[3rem] p-8 shadow-[0_0_40px_rgba(0,0,0,0.5)] relative overflow-hidden flex flex-col h-[600px]",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6 px-2",children:[h.jsx("h2",{className:"text-4xl font-bold font-bungee text-white uppercase tracking-tight opacity-90",children:"PERFORMERS"}),h.jsxs("div",{className:"flex items-center gap-2 bg-white/5 px-3 py-1 rounded-full border border-white/5",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--neon-cyan)] animate-pulse"}),h.jsxs("span",{className:"text-sm text-[var(--neon-cyan)] font-bold uppercase tracking-widest",children:[Ji," ONLINE"]})]})]}),h.jsxs("div",{className:"space-y-3 overflow-y-auto custom-scrollbar pr-2 flex-1",children:[h.jsx(tc,{items:e.participants.map(T=>`participant-side-${T.id}`),strategy:ec,children:e.participants.map(T=>{const ne=T.status===dn.READY,ue=e.requests.filter(be=>be.participantId===T.id).filter(be=>be.status===Fe.APPROVED&&be.type===Tt.SINGING).length;return h.jsxs(aS,{id:`participant-side-${T.id}`,data:{item:T,type:"PARTICIPANT"},activeData:On,className:`flex items-center justify-between p-4 rounded-[1.5rem] transition-all border ${ne?"bg-[#002a1a]/30 border-[var(--neon-green)] shadow-[0_0_15px_rgba(0,255,157,0.2)]":"bg-black/40 border-white/5 hover:bg-white/5"}`,children:[h.jsxs("div",{className:"min-w-0 flex items-center gap-4",children:[h.jsx("button",{onClick:async()=>{await Ba(T.id,ne?dn.STANDBY:dn.READY),await _e()},className:`w-3 h-3 rounded-full shrink-0 transition-all ${ne?"bg-[var(--neon-green)] shadow-[0_0_10px_var(--neon-green)]":"bg-slate-800"}`}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("button",{onClick:()=>ms(T.id),className:`text-xl font-black uppercase truncate text-left transition-colors font-righteous ${ne?"text-white":"text-slate-500 hover:text-[var(--neon-green)]"}`,children:T.name}),ue>0&&h.jsxs("span",{className:"block text-xs text-[var(--neon-cyan)] font-black mt-0.5 tracking-[0.2em]",children:[ue," REQUESTS"]})]})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:()=>M(T),className:"p-2 hover:text-[var(--neon-cyan)] transition-colors text-slate-600",children:"+"}),h.jsx("button",{onClick:()=>{yt(`Remove ${T.name}?`,async()=>{await lv(T.id),await _e()})},className:"p-2 text-rose-500/20 hover:text-rose-500 transition-colors",children:""})]})]},`participant-side-${T.id}`)})}),e.participants.length===0&&h.jsx("div",{className:"text-center py-20 opacity-20",children:h.jsx("p",{className:"text-lg font-righteous uppercase tracking-widest",children:"NO DATA"})})]})]}),h.jsxs("section",{className:"bg-[#0a0a0a] border-4 border-white/5 rounded-[3rem] p-8 shadow-[0_0_40px_rgba(0,0,0,0.5)] relative overflow-hidden flex flex-col h-[400px]",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6 px-2",children:[h.jsx("h2",{className:"text-4xl font-bold font-bungee text-white uppercase tracking-tight opacity-90",children:"LOG"}),e.history.length>0&&h.jsx("button",{onClick:async()=>{await qT(),await _e()},className:"text-sm font-bold text-rose-500/40 hover:text-rose-500 uppercase tracking-widest transition-all",children:"CLEAR"})]}),h.jsxs("div",{className:"space-y-3 overflow-y-auto custom-scrollbar pr-2 flex-1",children:[e.history.map((T,ne)=>h.jsxs(gy,{id:`hist-${ne}`,data:{item:T},className:"bg-black/40 p-4 rounded-2xl border border-white/5 flex flex-col group hover:border-[var(--neon-purple)] transition-all cursor-pointer",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsxs("div",{className:"min-w-0 pr-2",children:[h.jsx("div",{className:"text-xl font-bold text-white uppercase truncate tracking-tight group-hover:text-[var(--neon-purple)] transition-colors font-bungee",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-600 uppercase truncate tracking-widest font-righteous",children:T.artist})]}),h.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-all",children:[h.jsx(Yu,{request:T}),h.jsx(Xu,{request:T}),h.jsx(ka,{url:T.youtubeUrl})]})]}),h.jsxs("div",{className:"flex items-center justify-between mt-2 border-t border-white/5 pt-2",children:[h.jsxs("span",{className:"text-base font-black text-[var(--neon-pink)] uppercase truncate",children:["@",T.participantName]}),h.jsx("button",{onClick:async()=>{await dy(T),await _e()},className:"opacity-0 group-hover:opacity-100 text-xs font-black text-[var(--neon-pink)] hover:underline transition-all uppercase tracking-widest",children:"RE-QUEUE"})]})]},`hist-${ne}`)),e.history.length===0&&h.jsx("div",{className:"text-center py-16 opacity-20",children:h.jsx("p",{className:"text-lg italic font-righteous uppercase tracking-widest text-slate-800",children:"EMPTY"})})]})]})]})]}),Wt==="ROTATION"&&h.jsxs("div",{className:"space-y-16 animate-in slide-in-from-bottom-2 pb-32",children:[e.currentRound&&e.currentRound.length>0&&h.jsxs("section",{className:"glass-panel border-4 rounded-[4rem] p-12 shadow-[0_0_100px_rgba(0,255,157,0.3)] relative overflow-hidden neon-sign-border-green",children:[h.jsxs("div",{className:"flex items-center gap-8 mb-12",children:[h.jsx("div",{className:"w-8 h-8 bg-[var(--neon-green)] rounded-full animate-ping shadow-[0_0_25px_var(--neon-green)]"}),h.jsx("h3",{className:"text-6xl font-black text-white uppercase tracking-tighter font-righteous neon-glow-green",children:"NOW PLAYING"})]}),h.jsx("div",{className:"flex flex-col gap-4",children:h.jsx(tc,{items:e.currentRound.map(T=>`round-rot-${T.id}`),strategy:ec,children:e.currentRound.map((T,ne)=>{const G=e.currentRound.findIndex(be=>be.status!==Fe.DONE),ue=ne===(G===-1?0:G);return h.jsxs(Lf,{id:`round-rot-${T.id}`,data:{item:T,type:"ROUND"},className:`p-3 pl-6 pr-4 rounded-xl border-l-8 transition-all duration-300 flex items-center justify-between gap-4 w-full shadow-lg relative overflow-hidden group cursor-pointer ${ue?"bg-[#001005] border-l-[var(--neon-green)] border-y border-r border-[#1a3320] z-10 scale-[1.01]":"bg-[#0a0a10] border-l-slate-700 border-y border-r border-white/10 opacity-70 hover:opacity-100"}`,children:[h.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_49%,rgba(255,255,255,0.03)_50%,transparent_51%)] bg-[length:50px_100%] pointer-events-none"}),h.jsxs("div",{className:"flex items-center gap-6 min-w-0 flex-1 z-10",children:[h.jsx("div",{className:"w-16 h-full flex flex-col justify-center items-center border-r border-white/10 pr-4 shrink-0",children:h.jsx("span",{className:`text-xl font-bold font-mono tracking-tighter ${ue?"text-[var(--neon-green)]":"text-slate-400"}`,children:T.requestNumber})}),h.jsxs("div",{className:"flex items-baseline gap-6 min-w-0 flex-1",children:[h.jsx("h3",{className:`text-3xl font-black uppercase truncate font-righteous tracking-tight ${ue?"text-white":"text-slate-300"}`,children:T.songName}),h.jsxs("div",{className:"flex items-center gap-3 opacity-80 shrink-0",children:[h.jsx("span",{className:"text-xl font-bold font-righteous text-[var(--neon-cyan)] uppercase tracking-wider",children:T.artist}),h.jsx("span",{className:"text-slate-600 font-mono text-lg",children:"/"}),h.jsxs("span",{className:"text-xl font-bold font-righteous text-[var(--neon-pink)] uppercase tracking-wider",children:["@",T.participantName]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-3 z-10 pl-6 border-l border-white/10 bg-gradient-to-l from-black/80 to-transparent",children:[ue&&h.jsx("div",{className:"px-3 py-1 bg-[var(--neon-green)] text-black text-[10px] font-black uppercase tracking-[0.2em] rounded animate-pulse shadow-[0_0_10px_var(--neon-green)] mr-2 shrink-0",children:"LIVE"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(Yu,{request:T}),h.jsx(Xu,{request:T}),h.jsx(ka,{url:T.youtubeUrl}),h.jsx("button",{onClick:()=>I(T),className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white/5 hover:bg-white hover:text-black border border-white/10 transition-all text-slate-400 group",title:"EDIT",children:h.jsx("span",{className:"text-sm font-black font-righteous",children:"EDIT"})}),h.jsx("button",{onClick:()=>ds(T),className:"w-10 h-10 flex items-center justify-center rounded-lg bg-black border border-white/20 hover:bg-white hover:text-black hover:border-white transition-all group",title:"RESET TRACK",children:h.jsx("span",{className:"text-lg",children:""})}),h.jsxs("button",{disabled:T.status===Fe.DONE,onClick:async()=>{await FT(T.id),await _e()},className:`h-10 px-6 rounded-lg text-sm font-black uppercase tracking-widest font-righteous transition-all flex items-center gap-2 ${T.status===Fe.DONE?"bg-white/10 text-white/40 cursor-not-allowed border border-white/5":"bg-[var(--neon-cyan)]/10 hover:bg-[var(--neon-cyan)] text-[var(--neon-cyan)] hover:text-black border border-[var(--neon-cyan)]/50"}`,children:[h.jsx("span",{children:T.status===Fe.DONE?"COMPLETED":"DONE"}),T.status!==Fe.DONE&&h.jsx("span",{className:"text-lg leading-none",children:""})]})]})]})]},`round-rot-${T.id}`)})})})]}),h.jsxs("section",{className:"bg-[#050510] border-4 border-[var(--neon-cyan)]/30 rounded-[3rem] p-10 shadow-[0_0_80px_rgba(0,229,255,0.15)] relative overflow-hidden backdrop-blur-md",children:[h.jsxs("div",{className:"flex items-center gap-6 mb-10",children:[h.jsx("div",{className:"w-4 h-4 bg-[var(--neon-cyan)] shadow-[0_0_20px_var(--neon-cyan)] rounded-full animate-pulse"}),h.jsx("h3",{className:"text-4xl font-bold text-white uppercase tracking-tight font-bungee neon-glow-cyan",children:"UPCOMING"})]}),h.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-2 gap-6",children:[cn.map(T=>h.jsxs("div",{className:"relative group perspective-1000",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--neon-purple)] to-[var(--neon-blue)] rounded-[2.5rem] blur-xl opacity-20 group-hover:opacity-40 transition-opacity"}),h.jsxs("div",{className:"relative bg-[#101015] p-8 rounded-[2.5rem] border border-white/10 flex justify-between items-center group-hover:border-[var(--neon-cyan)] transition-all shadow-2xl h-full",children:[h.jsxs("div",{className:"min-w-0 pr-6 flex-1",children:[h.jsx("div",{className:"text-white font-black uppercase truncate text-4xl font-bungee tracking-tight mb-2 group-hover:text-[var(--neon-cyan)] transition-colors",children:T.songName}),h.jsxs("div",{className:"text-lg text-slate-500 uppercase flex items-center gap-3 font-righteous tracking-[0.2em] opacity-80",children:[h.jsxs("span",{className:"text-[var(--neon-green)] font-black",children:["@",T.participantName]}),h.jsx("span",{className:"opacity-20",children:"|"}),h.jsx("span",{className:"truncate",children:T.artist})]})]}),h.jsxs("div",{className:"flex gap-3 shrink-0 flex-col",children:[h.jsx("button",{onClick:()=>mn(T.id),className:"px-6 py-3 bg-[var(--neon-green)] text-black text-base font-black rounded-xl uppercase tracking-[0.2em] font-righteous shadow-[0_0_20px_var(--neon-green)] transition-all hover:bg-white hover:scale-105",children:"STAGE"}),h.jsx("button",{onClick:async()=>{await Da(T.id),await _e()},className:"px-6 py-3 border border-white/10 text-white/40 hover:text-rose-500 hover:border-rose-500/50 rounded-xl transition-all text-lg font-black uppercase tracking-[0.2em]",children:"REMOVE"})]})]})]},T.id)),cn.length===0&&h.jsx("div",{className:"col-span-full py-32 text-center border-4 border-dashed border-white/5 rounded-[4rem] opacity-30",children:h.jsx("p",{className:"text-5xl font-black uppercase tracking-[0.5em] italic font-righteous text-slate-700",children:"NO DATA STREAM"})})]})]}),h.jsxs("section",{className:"bg-[#050510] border-4 border border-white/5 rounded-[3.5rem] p-8 shadow-[0_0_60px_rgba(157,0,255,0.15)] relative overflow-hidden max-w-[800px] mx-auto w-full mt-10",children:[h.jsxs("div",{className:"flex justify-between items-center mb-10 px-2",children:[h.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter font-bungee neon-glow-purple",children:"SESSION LOG"}),e.history.length>0&&h.jsx("button",{onClick:async()=>{await qT(),await _e()},className:"text-sm font-black text-rose-500/40 hover:text-rose-500 uppercase tracking-[0.3em] font-righteous transition-all",children:"CLEAR ALL"})]}),h.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:[e.history.filter(T=>(T.playedAt||0)>=(e.startedAt||0)).map((T,ne)=>h.jsxs("div",{className:"bg-black/40 p-5 rounded-[1.5rem] border border-white/5 group hover:border-[var(--neon-purple)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-3",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-2xl font-black text-white uppercase truncate font-bungee tracking-tight group-hover:text-[var(--neon-purple)] transition-colors",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-600 font-bold uppercase truncate font-righteous tracking-widest mt-1",children:T.artist})]}),h.jsx(ka,{url:T.youtubeUrl})]}),h.jsxs("div",{className:"flex items-center justify-between border-t border-white/5 pt-3 mt-1",children:[h.jsxs("button",{onClick:()=>ms(T.participantId),className:"text-sm font-black text-[var(--neon-pink)] uppercase truncate hover:text-white font-righteous tracking-widest transition-colors mb-0",children:["@",T.participantName]}),h.jsx("button",{onClick:async()=>{await dy(T),await _e()},className:"opacity-0 group-hover:opacity-100 text-xs font-black text-[var(--neon-cyan)] hover:text-white transition-all font-righteous tracking-widest uppercase ml-auto",children:"RELOAD"})]})]},ne)),e.history.length===0&&h.jsx("div",{className:"text-center py-20 opacity-20",children:h.jsx("p",{className:"text-lg italic font-righteous uppercase tracking-widest text-slate-700",children:"EMPTY"})})]})]})]}),Wt==="PERFORMERS"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 animate-in slide-in-from-bottom-2 pb-32",children:[h.jsxs("section",{className:"lg:col-span-8 bg-[#0a0a0a] border-4 border-[var(--neon-cyan)]/20 rounded-[3rem] p-10 shadow-[0_0_60px_rgba(0,229,255,0.1)] relative overflow-hidden backdrop-blur-md",children:[h.jsxs("div",{className:"flex justify-between items-center mb-10 px-2",children:[h.jsx("h2",{className:"text-4xl font-bold text-white uppercase tracking-tight font-bungee neon-glow-cyan",children:"SINGERS"}),h.jsxs("div",{className:"flex items-center gap-4 px-6 py-2 bg-black/40 border border-[var(--neon-cyan)]/30 rounded-full shadow-lg",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--neon-cyan)] animate-pulse"}),h.jsxs("span",{className:"text-lg font-bold text-[var(--neon-cyan)] uppercase tracking-widest font-righteous",children:[Ji," ACTIVE"]})]})]}),h.jsxs("div",{className:"grid gap-6",children:[h.jsx(tc,{items:e.participants.map(T=>`participant-${T.id}`),strategy:ec,children:e.participants.map(T=>{const ne=T.status===dn.READY,ue=e.requests.filter(be=>be.participantId===T.id).filter(be=>be.status===Fe.APPROVED&&be.type===Tt.SINGING).length;return h.jsxs(aS,{id:`participant-${T.id}`,data:{item:T,type:"PARTICIPANT"},activeData:On,className:`flex items-center justify-between p-6 rounded-[2rem] transition-all border-2 ${ne?"bg-[#002a1a]/30 border-[var(--neon-green)] shadow-[0_0_30px_rgba(0,255,157,0.15)]":"bg-black/40 border-white/5 hover:border-white/20"}`,children:[h.jsxs("div",{className:"min-w-0 flex items-center gap-6 text-left",children:[h.jsx("button",{onClick:async()=>{await Ba(T.id,ne?dn.STANDBY:dn.READY),await _e()},className:`w-12 h-12 rounded-full shrink-0 border-2 transition-all flex items-center justify-center ${ne?"bg-[var(--neon-green)] border-[var(--neon-green)] shadow-[0_0_20px_var(--neon-green)]":"bg-slate-900 border-white/10 hover:border-white/50"}`,children:ne&&h.jsx("div",{className:"w-4 h-4 bg-white rounded-full animate-pulse"})}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("button",{onClick:()=>ms(T.id),className:`font-bold text-4xl uppercase truncate font-bungee tracking-tight transition-colors ${ne?"text-white":"text-slate-600 hover:text-[var(--neon-green)]"}`,children:T.name}),ue>0&&h.jsxs("div",{className:"text-base font-bold text-[var(--neon-cyan)] uppercase mt-1 tracking-widest font-righteous opacity-90",children:[ue," TRACKS READY"]})]})]}),h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("button",{onClick:()=>M(T),className:"px-6 py-3 bg-[var(--neon-cyan)]/10 text-[var(--neon-cyan)] rounded-xl border border-[var(--neon-cyan)]/50 transition-all font-righteous text-base font-black uppercase tracking-[0.2em] hover:bg-[var(--neon-cyan)] hover:text-black hover:shadow-[0_0_20px_var(--neon-cyan)]",children:"ADD TRACK"}),h.jsx("button",{onClick:()=>{yt(`Remove ${T.name}?`,async()=>{await lv(T.id),await _e()})},className:"text-rose-500/30 hover:text-rose-500 p-3 transition-colors text-3xl font-black",children:""})]})]},`participant-${T.id}`)})}),e.participants.length===0&&h.jsx("div",{className:"py-32 text-center border-4 border-dashed border-white/5 rounded-[3rem] opacity-30",children:h.jsx("p",{className:"text-5xl font-black uppercase tracking-[0.6em] italic font-righteous text-slate-800",children:"NO SIGNALS"})})]})]}),h.jsxs("section",{className:"lg:col-span-4 h-[800px] flex flex-col bg-[#050510] border-4 border border-white/5 rounded-[3.5rem] p-8 shadow-[0_0_60px_rgba(157,0,255,0.15)] relative overflow-hidden",children:[h.jsxs("div",{className:"flex flex-col gap-6 mb-6",children:[h.jsx("h2",{className:"text-4xl font-black text-white uppercase tracking-tighter font-bungee py-2 neon-glow-cyan text-center",children:"LIBRARY"}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"text",placeholder:"SEARCH VERIFIED TRACKS...",value:ln,onChange:T=>qt(T.target.value),className:"w-full bg-[#151520] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-mono focus:border-[var(--neon-cyan)] outline-none transition-all shadow-inner text-sm uppercase"}),ln&&h.jsx("button",{onClick:()=>qt(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-500 hover:text-white font-black",children:""})]})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar space-y-4",children:[it.filter(T=>T.songName.toLowerCase().includes(ln.toLowerCase())||T.artist.toLowerCase().includes(ln.toLowerCase())).map(T=>h.jsxs("div",{className:"bg-[#151520] p-4 rounded-2xl border border-white/10 flex flex-col group hover:border-[var(--neon-cyan)] transition-all",children:[h.jsx("div",{className:"flex justify-between items-start mb-2",children:h.jsxs("div",{className:"min-w-0 pr-2",children:[h.jsx("div",{className:"text-lg font-bold text-white uppercase truncate tracking-tight group-hover:text-[var(--neon-cyan)] transition-colors font-bungee",children:T.songName}),h.jsx("div",{className:"text-xs text-slate-500 uppercase truncate tracking-widest font-righteous",children:T.artist})]})}),h.jsxs("div",{className:"flex items-center justify-between border-t border-white/5 pt-3 mt-1",children:[h.jsx(oS,{url:T.youtubeUrl}),h.jsxs("div",{className:"flex gap-2 shrink-0",children:[h.jsx("button",{onClick:()=>Yt(T.songName,T.artist,T.type),className:"px-3 py-1 bg-black border border-[var(--neon-cyan)] text-[var(--neon-cyan)] text-[10px] font-black uppercase rounded-md hover:bg-[var(--neon-cyan)] hover:text-black transition-all tracking-widest",children:"RUN"}),h.jsx("button",{onClick:()=>{c(!0)},className:"px-3 py-1 bg-[var(--neon-pink)] text-black text-[10px] font-black uppercase rounded-md hover:bg-white transition-all shadow-lg tracking-widest",children:"PUSH"})]})]})]},T.id)),it.length===0&&h.jsx("p",{className:"text-sm text-slate-600 italic text-center py-10 font-righteous uppercase tracking-widest",children:"LIBRARY EMPTY"})]})]})]}),Wt==="LIBRARY"&&h.jsxs("section",{className:"animate-in fade-in slide-in-from-bottom-2 space-y-10 pb-32",children:[h.jsx("div",{className:"sticky top-0 z-40 pt-4 -mt-4",children:h.jsxs("div",{className:"relative group p-1 rounded-[2.5rem] bg-[#050510]/90 shadow-2xl backdrop-blur-xl border border-white/10",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--neon-pink)]/20 via-[var(--neon-purple)]/20 to-[var(--neon-cyan)]/20 blur-xl opacity-0 group-focus-within:opacity-100 transition-opacity duration-500"}),h.jsx("input",{type:"text",placeholder:"SEARCH SONGBOOK...",value:ln,onChange:T=>qt(T.target.value),className:"w-full bg-black/50 border-2 border-white/10 rounded-[2.3rem] py-6 pl-16 pr-32 text-2xl font-bold tracking-widest text-white placeholder:text-slate-600 focus:outline-none focus:border-[var(--neon-pink)] transition-all font-righteous uppercase"}),h.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-slate-600 group-focus-within:text-[var(--neon-pink)] transition-colors pointer-events-none",children:h.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[h.jsx("circle",{cx:"11",cy:"11",r:"8"}),h.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}),h.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex gap-2",children:h.jsx("button",{onClick:()=>f(!0),className:"px-6 py-3 bg-[var(--neon-cyan)] text-black rounded-[2rem] font-black text-base uppercase tracking-widest shadow-[0_0_15px_rgba(0,229,255,0.4)] active:scale-95 transition-all font-righteous hover:bg-white hover:scale-105",children:"+ ADD NEW"})})]})}),h.jsx("div",{className:"flex flex-col gap-3",children:(()=>{const ne=((e==null?void 0:e.verifiedSongbook)||[]).map(G=>({...G,isVerified:!0,title:G.songName,source:"VERIFIED"})).filter(G=>{if(!ln)return!0;const ue=ln.toLowerCase();return G.title.toLowerCase().includes(ue)||G.artist.toLowerCase().includes(ue)});return ne.length===0?h.jsxs("div",{className:"col-span-full text-center py-40 opacity-30 border-4 border-dashed border-white/5 rounded-[4rem]",children:[h.jsx("div",{className:"text-8xl mb-6 opacity-50 grayscale animate-pulse",children:ln?"":""}),h.jsx("p",{className:"text-5xl font-black uppercase tracking-[0.5em] font-righteous text-slate-600",children:ln?"NO MATCH FOUND":"SONGBOOK EMPTY"})]}):ne.map((G,ue)=>h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 p-4 rounded-[2rem] flex items-center justify-between group hover:border-[var(--neon-cyan)] transition-all relative hover:z-50 shadow-lg",children:[h.jsxs("div",{className:"flex items-center gap-6 flex-1 min-w-0",children:[h.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-black rounded-lg border border-white/10 text-[var(--neon-cyan)] text-2xl",children:""}),h.jsx("div",{className:"min-w-0 pr-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[G.isVerified&&h.jsx("div",{className:"px-2 py-0.5 bg-[var(--neon-pink)] text-black rounded-full text-[10px] font-black uppercase tracking-widest font-righteous shrink-0",children:"VERIFIED"}),h.jsx("h4",{className:"text-3xl font-black text-white uppercase truncate tracking-tighter font-bungee group-hover:text-[var(--neon-cyan)] transition-colors",children:G.title}),h.jsxs("span",{className:"text-base text-slate-600 font-bold uppercase font-righteous tracking-widest truncate",children:["/ ",G.artist]})]})})]}),h.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[h.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx(Yu,{request:G}),h.jsx(Xu,{request:G}),h.jsx(ka,{url:G.youtubeUrl}),h.jsx("button",{onClick:async()=>{await UT(G.id).then(_e)},className:"p-2 text-rose-500/20 hover:text-rose-500 transition-all text-xl",children:""})]}),h.jsxs("div",{className:"flex gap-2 bg-black/40 p-1 rounded-xl border border-white/5 ml-4",children:[h.jsxs("div",{className:"relative group/assign",children:[h.jsx("button",{className:"px-6 py-2.5 bg-white text-black text-sm font-black uppercase rounded-lg hover:bg-[var(--neon-cyan)] transition-all font-righteous tracking-wider",children:"ASSIGN"}),h.jsxs("div",{className:"absolute bottom-full right-0 mb-4 bg-[#0a0a0a] border-2 border-[var(--neon-cyan)]/30 rounded-[1.5rem] shadow-2xl opacity-0 invisible group-hover/assign:opacity-100 group-hover/assign:visible transition-all p-4 z-50 backdrop-blur-xl w-[200px]",children:[h.jsx("p",{className:"text-base text-[var(--neon-cyan)] font-black uppercase mb-3 border-b border-white/10 pb-2 font-righteous tracking-widest",children:"TRANSMIT TO:"}),h.jsxs("div",{className:"space-y-1 max-h-48 overflow-y-auto custom-scrollbar pr-2",children:[e.participants.map(be=>h.jsx("button",{onClick:async()=>{const De=await Oi({participantId:be.id,participantName:be.name,songName:G.title,artist:G.artist,youtubeUrl:G.youtubeUrl,type:Tt.SINGING});De&&await Zl(De.id),await _e()},className:"w-full text-left p-2 rounded-lg hover:bg-white/10 hover:text-[var(--neon-cyan)] text-lg font-black text-slate-400 uppercase truncate font-righteous transition-all",children:be.name},be.id)),h.jsx("div",{className:"h-[1px] bg-white/10 my-2"}),h.jsx("button",{onClick:async()=>{const be=await Oi({participantId:"DJ-MANUAL",participantName:"GUEST",songName:G.title,artist:G.artist,youtubeUrl:G.youtubeUrl,type:Tt.SINGING});be&&await Zl(be.id),await _e()},className:"w-full text-left p-2 rounded-lg bg-[var(--neon-cyan)]/20 text-[var(--neon-cyan)] hover:bg-[var(--neon-cyan)] hover:text-black text-sm font-black uppercase font-righteous transition-all",children:"+ GUEST"})]})]})]}),h.jsxs("div",{className:"relative group/star",children:[h.jsx("button",{className:"px-4 py-2.5 bg-black border border-white/10 text-[var(--neon-pink)] rounded-lg font-black text-sm uppercase tracking-widest hover:border-[var(--neon-pink)] transition-all font-righteous",children:""}),h.jsxs("div",{className:"absolute bottom-full right-0 mb-4 bg-[#0a0a0a] border-2 border-[var(--neon-pink)]/30 rounded-[1.5rem] shadow-2xl opacity-0 invisible group-hover/star:opacity-100 group-hover/star:visible transition-all p-4 z-50 backdrop-blur-xl w-[180px]",children:[h.jsx("p",{className:"text-base text-[var(--neon-pink)] font-black uppercase mb-3 border-b border-white/10 pb-2 font-righteous tracking-widest",children:"ADD FAVORITE:"}),h.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto custom-scrollbar pr-2",children:e.participants.map(be=>h.jsx("button",{onClick:async()=>{await AM(be.id,{songName:G.title,artist:G.artist,youtubeUrl:G.youtubeUrl,type:G.type}),await _e()},className:"w-full text-left p-2 rounded-lg hover:bg-white/10 hover:text-[var(--neon-pink)] text-lg font-black text-slate-400 uppercase truncate font-righteous transition-all",children:be.name},be.id))})]})]})]})]})]},ue))})()})]})]}),S&&h.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-6 z-[100] backdrop-blur-xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-2xl bg-[#0a0a0a] border-4 border-[var(--neon-pink)]/30 rounded-[3rem] p-10 shadow-[0_0_100px_rgba(255,42,109,0.2)] animate-in zoom-in-95 duration-500 relative overflow-hidden",children:[h.jsxs("div",{className:"flex justify-between items-start mb-8",children:[h.jsx("h2",{className:"text-5xl font-bold text-white uppercase tracking-tight leading-none font-bungee neon-glow-pink",children:"REVIEW LINEUP"}),h.jsx("button",{onClick:()=>k(!1),className:"text-slate-600 hover:text-white font-bold text-5xl px-2 transition-all transform hover:scale-110",children:""})]}),h.jsx("div",{className:"mb-8 text-lg text-[var(--neon-cyan)] font-bold uppercase tracking-widest font-righteous opacity-80 decoration-dotted underline underline-offset-4",children:"OPERATIONAL READY CHECK"}),h.jsx("div",{className:"space-y-4 mb-10 max-h-[400px] overflow-y-auto pr-4 custom-scrollbar",children:(()=>{var ne;const T=e.participants.filter(G=>{var ue;return(ue=e.requests)==null?void 0:ue.some(be=>be.participantId===G.id&&be.status===Fe.APPROVED&&be.type===Tt.SINGING&&!be.isInRound)}).sort((G,ue)=>(ue.joinedAt||0)-(G.joinedAt||0));if(T.length>0)return T.map(G=>{var De;const ue=G.status===dn.READY,be=(De=e.requests)==null?void 0:De.find(We=>We.participantId===G.id&&We.status===Fe.APPROVED&&We.type===Tt.SINGING&&!We.isInRound);return h.jsxs("div",{className:`flex items-center justify-between p-4 rounded-[1.5rem] border-2 transition-all duration-300 ${ue?"bg-[#150030] border-[var(--neon-green)] shadow-[0_0_20px_rgba(57,255,20,0.15)]":"bg-black/40 border-white/5 opacity-50"}`,children:[h.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[h.jsx("button",{onClick:async()=>{await Ba(G.id,ue?dn.STANDBY:dn.READY),await _e()},className:`w-6 h-6 rounded-full shrink-0 flex items-center justify-center transition-all border-2 ${ue?"bg-[var(--neon-green)] border-[var(--neon-green)] shadow-[0_0_10px_var(--neon-green)]":"bg-slate-900 border-white/10 hover:border-slate-600"}`,children:ue&&h.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-ping"})}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("div",{className:`font-bold uppercase text-2xl truncate tracking-tight font-bungee ${ue?"text-white":"text-slate-600"}`,children:G.name}),ue?be?h.jsx("div",{className:"text-[var(--neon-cyan)] text-base font-black uppercase tracking-[0.2em] font-righteous mt-0.5 opacity-90",children:be.songName}):h.jsx("div",{className:"text-rose-500 text-sm font-black uppercase tracking-[0.1em] font-righteous mt-0.5",children:" NO SIGNAL"}):h.jsx("div",{className:"text-slate-700 text-sm font-black uppercase tracking-[0.2em] font-righteous mt-0.5",children:"STANDBY"})]})]}),ue&&be&&h.jsx("div",{className:"shrink-0 text-sm bg-[var(--neon-cyan)] text-black px-4 py-1.5 rounded-full font-black uppercase tracking-widest font-righteous shadow-[0_0_10px_var(--neon-cyan)] animate-in fade-in zoom-in",children:"READY"})]},G.id)});{const G=((ne=e.requests)==null?void 0:ne.filter(ue=>ue.status===Fe.APPROVED&&ue.type===Tt.LISTENING&&!ue.isInRound).sort((ue,be)=>ue.createdAt-be.createdAt).slice(0,5))||[];return G.length>0?h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"p-4 bg-white/5 rounded-xl border border-dashed border-white/10 text-center",children:h.jsx("p",{className:"text-[var(--neon-blue)] font-black uppercase tracking-widest font-righteous",children:"FALLBACK: LISTENING MODE"})}),G.map(ue=>h.jsxs("div",{className:"flex items-center justify-between p-4 rounded-[1.5rem] border-2 bg-[#0a0a20] border-[var(--neon-blue)]/30",children:[h.jsxs("div",{className:"min-w-0",children:[h.jsx("div",{className:"text-[var(--neon-blue)] text-xl font-black uppercase tracking-tight font-bungee",children:ue.songName}),h.jsx("div",{className:"text-slate-500 text-sm font-bold uppercase tracking-widest font-righteous",children:ue.artist})]}),h.jsxs("div",{className:"text-xs font-black uppercase tracking-widest text-[var(--neon-pink)] font-righteous",children:["@",ue.participantName]})]},ue.id))]}):h.jsx("div",{className:"text-center py-24 bg-black/20 rounded-[2.5rem] border-4 border-dashed border-white/5 animate-in fade-in duration-700",children:h.jsx("p",{className:"text-slate-700 text-2xl font-black uppercase tracking-[0.4em] font-righteous",children:"NO DATA"})})}})()}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-4 bg-black hover:bg-white hover:text-black text-white border border-white/10 rounded-xl font-black uppercase text-base tracking-widest transition-all font-righteous",children:"CANCEL"}),(()=>{var be;const T=e.participants.filter(De=>{var We;return(We=e.requests)==null?void 0:We.some(vt=>vt.participantId===De.id&&vt.status===Fe.APPROVED&&vt.type===Tt.SINGING&&!vt.isInRound)}).length,ne=((be=e.requests)==null?void 0:be.filter(De=>De.status===Fe.APPROVED&&De.type===Tt.LISTENING&&!De.isInRound).length)||0,G=T>0?T:ne,ue=T>0?"ACTIVATE ROUND":"ACTIVATE LISTENING";return h.jsx("button",{onClick:ps,disabled:G===0,className:`flex-[2] py-4 rounded-xl font-black uppercase text-base tracking-widest transition-all flex items-center justify-center gap-3 shadow-lg font-righteous ${G>0?"bg-[var(--neon-green)] hover:bg-white hover:text-black text-black hover:scale-105":"bg-slate-900 text-slate-800 cursor-not-allowed border border-white/5"}`,children:G>0?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-1.5 h-1.5 bg-current rounded-full animate-ping"}),ue," (",G,")"]}):"IDLE"})})()]}),h.jsxs("div",{className:"bg-[#151520] p-6 rounded-[2rem] border border-white/5 mt-8",children:[h.jsxs("h3",{className:"text-xl font-black text-white uppercase tracking-widest font-righteous mb-4 flex items-center gap-3",children:[h.jsx("span",{className:"text-[var(--neon-purple)]",children:""})," Priority Protocol"]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.values(si).map(T=>h.jsxs("button",{onClick:()=>{VM(T)},className:`p-4 rounded-xl border-2 text-left transition-all relative overflow-hidden group ${e.queueStrategy===T?"bg-[var(--neon-purple)]/20 border-[var(--neon-purple)] text-white shadow-[0_0_15px_var(--neon-purple)]":"bg-black/40 border-white/5 text-slate-500 hover:border-white/20 hover:text-slate-300"}`,children:[h.jsx("div",{className:"font-bold font-righteous uppercase tracking-wider relative z-10",children:T.replace("_"," ")}),h.jsxs("div",{className:"text-[10px] uppercase font-mono mt-1 opacity-60 relative z-10",children:[T==="FRESH_MEAT"&&"New Singers First",T==="FAIR_ROTATION"&&"Fewest Songs + Oldest Wait",T==="FIFO"&&"Strict First In First Out",T==="OLDEST_MEMBER"&&"Oldest Singers First",T==="RANDOM"&&"Chaotic Shuffle"]}),e.queueStrategy===T&&h.jsx("div",{className:"absolute top-2 right-2 w-2 h-2 rounded-full bg-[var(--neon-green)] animate-pulse"})]},T))})]})]})}),ee&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[200] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-md bg-[#050510] border-4 border-rose-500/30 rounded-[3rem] p-10 text-center shadow-[0_0_100px_rgba(244,63,94,0.3)] animate-in zoom-in-95 duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-rose-500 shadow-[0_0_20px_rgba(244,63,94,0.8)]"}),h.jsx("div",{className:"w-20 h-20 bg-rose-500/10 text-rose-500 rounded-[2rem] border-2 border-rose-500/20 flex items-center justify-center mx-auto mb-6 text-4xl font-black shadow-[0_0_30px_rgba(244,63,94,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-text-glow-rose",children:"SYSTEM RESET"}),h.jsxs("p",{className:"text-slate-400 text-lg mb-8 leading-relaxed font-black font-righteous uppercase tracking-widest",children:["This will ",h.jsx("span",{className:"text-rose-500 underline decoration-2 underline-offset-4 decoration-rose-500",children:"TERMINATE ALL SESSIONS"}),", clear requests, and wipe history logs."]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>le(!1),className:"flex-1 py-4 bg-black border-2 border-white/10 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous transition-all hover:bg-white/5",children:"ABORT"}),h.jsx("button",{onClick:Yr,className:"flex-[2] py-4 bg-rose-500 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous shadow-[0_0_30px_rgba(244,63,94,0.4)] transition-all hover:bg-rose-400 hover:scale-105",children:"EXECUTE WIPE"})]})]})}),(L||we)&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[70] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-6xl bg-[#0a0a0a] border-4 border-white/10 rounded-[4rem] overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] flex flex-col max-h-[90vh] relative",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsxs("div",{className:"p-8 border-b-2 border-white/5 flex justify-between items-center bg-black/40 backdrop-blur-xl",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-5xl font-black text-white font-bungee uppercase tracking-tight neon-glow-purple",children:"User Directory"}),h.jsx("p",{className:"text-base text-[var(--neon-cyan)] uppercase font-black tracking-[0.3em] font-righteous opacity-80 mt-1",children:"Authenticated Identities & Signal History"})]}),h.jsxs("div",{className:"flex gap-3",children:[we&&h.jsx("button",{onClick:()=>Ht(null),className:"px-6 py-3 bg-black border border-white/10 text-white rounded-xl text-sm font-black uppercase tracking-widest font-righteous hover:bg-white/10 transition-all",children:" ALL ACCOUNTS"}),h.jsx("button",{onClick:()=>{yt("DANGER: This will permanently delete ALL GUEST ACCOUNTS and DUPLICATE ENTRIES from the Firestore database. Proceed?",async()=>{const T=await AA();T.success?(alert(`DATABASE CLEANUP SUCCESS: Removed ${T.deletedCount} orphan records.`),await _e()):alert(`CLEANUP FAILED: ${T.error}`)})},className:"px-6 py-3 bg-rose-500/10 border border-rose-500/50 text-rose-500 rounded-xl text-sm font-black uppercase tracking-widest font-righteous hover:bg-rose-500 hover:text-white transition-all hover:scale-105",children:"PURGE GUESTS"}),h.jsx("button",{onClick:()=>Sn(!0),className:"px-6 py-3 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-black uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white transition-all hover:scale-105",children:"+ NEW ACCOUNT"}),h.jsx("button",{onClick:Yi,className:"text-slate-600 hover:text-white p-2 ml-2 font-black text-4xl transition-colors transform hover:scale-110",children:""})]})]}),h.jsx("div",{className:"p-6 border-b-2 border-white/5 bg-black/20",children:h.jsxs("div",{className:"relative group max-w-2xl mx-auto",children:[h.jsx("input",{type:"text",placeholder:"SCANNING DIRECTORY RECORDS...",value:Be,onChange:T=>Je(T.target.value),className:"w-full bg-[#050510] border-2 border-white/10 rounded-2xl px-10 py-4 text-white font-black uppercase font-righteous tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all shadow-inner placeholder:text-slate-700 text-xl"}),h.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-700 group-focus-within:text-[var(--neon-pink)] transition-colors",children:h.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[h.jsx("circle",{cx:"11",cy:"11",r:"8"}),h.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]})}),h.jsx("div",{className:"flex-1 overflow-y-auto p-10 space-y-12 custom-scrollbar bg-black/20",children:we?h.jsxs("div",{className:"animate-in slide-in-from-right-4 duration-500 grid lg:grid-cols-12 gap-8",children:[h.jsx("div",{className:"lg:col-span-4 space-y-6",children:h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[3rem] p-8 shadow-2xl relative overflow-hidden group hover:border-[var(--neon-purple)] transition-all",children:[h.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-[var(--neon-purple)]/10 blur-[60px] rounded-full -mr-24 -mt-24 group-hover:bg-[var(--neon-purple)]/20 transition-all"}),h.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[h.jsx("div",{className:"scale-125 mb-4",children:h.jsx(Jr,{name:we.name,isActive:e.participants.some(T=>T.id===we.id)})}),h.jsxs("div",{className:"mt-4",children:[h.jsx("div",{className:"text-sm font-bold text-[var(--neon-cyan)] uppercase tracking-widest mb-2 font-righteous",children:"SINGER PROFILE"}),h.jsx("h3",{className:"text-5xl font-bold text-white uppercase tracking-tight leading-none font-bungee break-words",children:we.name})]}),h.jsxs("div",{className:"w-full mt-8 space-y-3 pt-6 border-t border-white/5",children:[h.jsxs("div",{className:"flex justify-between items-center text-sm uppercase font-black font-righteous tracking-widest",children:[h.jsx("span",{className:"text-slate-600",children:"SINGER ID"}),h.jsxs("span",{className:"text-[var(--neon-pink)] font-mono opacity-80",children:[we.id.slice(0,8),"..."]})]}),h.jsxs("div",{className:"flex justify-between items-center text-sm uppercase font-black font-righteous tracking-widest",children:[h.jsx("span",{className:"text-slate-600",children:"SECURITY"}),h.jsx("span",{className:`px-2 py-0.5 rounded-full ${we.password?"bg-[var(--neon-pink)]/10 text-[var(--neon-pink)]":"bg-slate-900 text-slate-600"}`,children:we.password?"SECURE PIN":"OPEN LINK"})]})]}),h.jsxs("div",{className:"w-full mt-10 space-y-3",children:[h.jsx("button",{onClick:()=>fs(we),className:"w-full py-3 bg-black border border-white/10 hover:border-[var(--neon-pink)] text-white rounded-xl text-sm font-black uppercase tracking-widest transition-all font-righteous",children:"CHANGE PASSWORD"}),h.jsx("button",{onClick:async()=>{er(we),_(!0),await Ko(we.id),await _e()},className:"w-full py-3 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-black uppercase tracking-widest transition-all shadow-[0_0_15px_rgba(0,229,255,0.3)] font-righteous hover:bg-white",children:"SYNC QR CODE"}),h.jsx("div",{className:"pt-2 border-t border-white/5 mt-2 space-y-2"}),h.jsx("button",{onClick:()=>{yt("Permanently delete this account?",async()=>{await op(we.id),Ht(null),await _e()})},className:"w-full py-3 bg-rose-500/5 hover:bg-rose-500 text-rose-500/40 hover:text-white rounded-xl text-sm font-black uppercase tracking-widest transition-all border border-transparent hover:border-rose-500/30 font-righteous mt-2",children:"TERMINATE ACCOUNT"})]})]})]})}),h.jsx("div",{className:"lg:col-span-8 space-y-6",children:h.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[2.5rem] p-8 relative overflow-hidden",children:[h.jsxs("h4",{className:"text-sm font-black text-[var(--neon-pink)] uppercase tracking-[0.3em] mb-6 font-righteous",children:["LIBRARY STARS (",we.favorites.length,")"]}),h.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[we.favorites.map(T=>h.jsxs("div",{className:"bg-black/40 border border-white/5 p-4 rounded-xl flex justify-between items-center group hover:border-[var(--neon-pink)] transition-all",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-xl font-black text-white truncate uppercase tracking-tight font-righteous group-hover:text-[var(--neon-pink)] transition-colors",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-500 font-bold uppercase tracking-widest mt-0.5 font-righteous opacity-60",children:T.artist})]}),h.jsxs("div",{className:"flex gap-2 shrink-0",children:[h.jsx("button",{onClick:async()=>{await Oi({participantId:we.id,participantName:we.name,songName:T.songName,artist:T.artist,youtubeUrl:T.youtubeUrl,type:T.type}),await _e()},className:"px-3 py-1.5 bg-[var(--neon-cyan)]/10 border border-[var(--neon-cyan)]/30 text-[var(--neon-cyan)] rounded-lg text-xs font-black uppercase font-righteous hover:bg-[var(--neon-cyan)] hover:text-black transition-all",children:"ADD"}),h.jsx("button",{onClick:()=>U({type:"favorite",itemId:T.id}),className:"p-1.5 text-slate-700 hover:text-white transition-colors",children:""}),h.jsx("button",{onClick:()=>{yt("Remove from stars?",async()=>{await NM(we.id,T.id),await _e()})},className:"p-1.5 text-rose-500/30 hover:text-rose-500 transition-colors",children:""})]})]},T.id)),we.favorites.length===0&&h.jsxs("div",{className:"flex flex-col items-center py-20 opacity-20",children:[h.jsx("span",{className:"text-4xl mb-3 grayscale",children:""}),h.jsx("p",{className:"text-sm font-black uppercase tracking-[0.3em] font-righteous text-slate-600",children:"Catalog is empty"})]})]})]}),h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[2.5rem] p-8 relative overflow-hidden",children:[h.jsxs("h4",{className:"text-sm font-black text-[var(--neon-cyan)] uppercase tracking-[0.3em] mb-6 font-righteous",children:["PERFORMANCE LOG (",we.personalHistory.length,")"]}),h.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[we.personalHistory.map((T,ne)=>h.jsxs("div",{className:"bg-black/40 border border-white/5 p-4 rounded-xl group hover:border-[var(--neon-cyan)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-xl font-bold text-white truncate uppercase tracking-tight font-righteous group-hover:text-[var(--neon-cyan)] transition-colors",children:T.songName}),h.jsx("div",{className:"text-sm text-slate-500 font-bold uppercase tracking-widest mt-0.5 font-righteous opacity-60",children:T.artist})]}),h.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-all transform translate-x-2 group-hover:translate-x-0",children:[h.jsx("button",{onClick:()=>U({type:"history",itemId:T.id}),className:"p-1.5 text-slate-700 hover:text-white transition-colors",children:""}),h.jsx("button",{onClick:()=>{yt("Erase from history?",async()=>{await CM(we.id,T.id),await _e()})},className:"p-1.5 text-rose-500/30 hover:text-rose-500 transition-colors",children:""})]})]}),h.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-white/5",children:[h.jsx("span",{className:"text-xs text-slate-700 font-black uppercase font-righteous tracking-widest",children:new Date(T.createdAt).toLocaleDateString()}),h.jsx("button",{onClick:async()=>{await dy(T),await _e()},className:"px-3 py-1.5 bg-[var(--neon-pink)]/10 border border-[var(--neon-pink)]/30 text-[var(--neon-pink)] rounded-lg text-xs font-black uppercase font-righteous hover:bg-[var(--neon-pink)] hover:text-black transition-all",children:"RE-QUEUE"})]})]},ne)),we.personalHistory.length===0&&h.jsxs("div",{className:"flex flex-col items-center py-20 opacity-20",children:[h.jsx("span",{className:"text-4xl mb-3 grayscale",children:""}),h.jsx("p",{className:"text-sm font-black uppercase tracking-[0.3em] font-righteous text-slate-600",children:"No transmissions recorded"})]})]})]})]})})]}):Bt?h.jsxs("form",{onSubmit:gn,className:"max-w-xl mx-auto bg-[#101015] border-2 border-white/10 p-10 rounded-[3rem] space-y-6 shadow-[0_0_60px_rgba(255,0,127,0.1)] animate-in fade-in zoom-in-95 duration-500",children:[h.jsx("h3",{className:"text-5xl font-bold text-white uppercase tracking-tight font-bungee neon-glow-pink mb-2 text-center",children:"SECURITY UPDATE"}),h.jsxs("p",{className:"text-center text-slate-400 font-righteous uppercase tracking-widest mb-8",children:["UPDATING KEY FOR: ",h.jsx("span",{className:"text-[var(--neon-cyan)]",children:Le==null?void 0:Le.name})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-500 uppercase mb-2 ml-4 tracking-widest font-righteous",children:"NEW ENCRYPTION PIN"}),h.jsx("input",{required:!0,type:"password",value:Fn,onChange:T=>{pn(T.target.value),xt("")},className:"w-full bg-black border border-white/10 rounded-2xl px-6 py-4 text-white font-bold uppercase font-righteous tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all",placeholder:"ENTER NEW PIN"})]}),Qe&&h.jsx("div",{className:"mb-4 animate-pulse",children:h.jsxs("p",{className:"text-[var(--neon-pink)] font-bold uppercase text-sm tracking-widest flex items-center gap-2",children:[h.jsx("span",{className:"text-lg",children:""})," ",Qe]})})]}),h.jsxs("div",{className:"flex gap-4 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>{Kt(!1),Ht(Le),et(null)},className:"flex-1 py-4 bg-black border border-white/10 text-white rounded-xl text-sm font-bold uppercase tracking-widest font-righteous hover:bg-white/5",children:"ABORT"}),h.jsx("button",{type:"submit",className:"flex-[2] py-4 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-bold uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white",children:"UPDATE KEY"})]})]}):nr?h.jsxs("form",{onSubmit:Ki,className:"max-w-xl mx-auto bg-[#101015] border-2 border-white/10 p-10 rounded-[3rem] space-y-6 shadow-[0_0_60px_rgba(255,0,127,0.1)] animate-in fade-in zoom-in-95 duration-500",children:[h.jsx("h3",{className:"text-5xl font-bold text-white uppercase tracking-tight font-bungee neon-glow-pink mb-2 text-center",children:Le?"Modify Profile":"New User Account"}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-500 uppercase mb-2 ml-4 tracking-widest font-righteous",children:"IDENTITY HANDLE"}),h.jsx("input",{required:!0,type:"text",value:$t.name,onChange:T=>{kn({...$t,name:T.target.value}),xt("")},className:"w-full bg-black border border-white/10 rounded-2xl px-6 py-4 text-white font-bold uppercase font-righteous tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all"})]}),Qe&&h.jsx("div",{className:"mb-4 animate-pulse",children:h.jsxs("p",{className:"text-[var(--neon-pink)] font-bold uppercase text-sm tracking-widest flex items-center gap-2",children:[h.jsx("span",{className:"text-lg",children:""})," ",Qe]})}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-500 uppercase mb-2 ml-4 tracking-widest font-righteous",children:"ENCRYPTION PIN (OPTIONAL)"}),h.jsx("input",{type:"password",value:$t.password,onChange:T=>kn({...$t,password:T.target.value}),className:"w-full bg-black border border-white/10 rounded-2xl px-6 py-4 text-white font-bold uppercase font-righteous tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all"})]})]}),h.jsxs("div",{className:"flex gap-4 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>{Sn(!1),et(null)},className:"flex-1 py-4 bg-black border border-white/10 text-white rounded-xl text-sm font-bold uppercase tracking-widest font-righteous hover:bg-white/5",children:"ABORT"}),h.jsx("button",{type:"submit",className:"flex-[2] py-4 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-bold uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white",children:"AUTHORIZE ACCOUNT"})]})]}):h.jsx("div",{className:"space-y-16",children:(()=>{const T=n.filter(G=>!G.password&&e.participants.some(ue=>ue.id===G.id)&&(G.name.toLowerCase().includes(Be.toLowerCase())||G.id.toLowerCase().includes(Be.toLowerCase()))),ne=n.filter(G=>(G.password||!e.participants.some(ue=>ue.id===G.id))&&(G.name.toLowerCase().includes(Be.toLowerCase())||G.id.toLowerCase().includes(Be.toLowerCase())));return h.jsxs(h.Fragment,{children:[T.length>0&&h.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-500",children:[h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsx("h3",{className:"text-base font-black text-[var(--neon-green)] uppercase tracking-[0.5em] font-righteous whitespace-nowrap",children:"ACTIVE SIGNALS"}),h.jsx("div",{className:"h-[2px] w-full bg-gradient-to-r from-[var(--neon-green)]/30 to-transparent"})]}),h.jsx("div",{className:"flex flex-col gap-4",children:T.map(G=>h.jsxs("div",{className:"bg-[#151520] border-2 border-white/5 rounded-[2rem] p-4 flex items-center justify-between hover:border-[var(--neon-green)] transition-all shadow-lg group relative overflow-hidden",children:[h.jsxs("div",{className:"flex items-center gap-6 min-w-0 pr-4",children:[h.jsx(Jr,{name:G.name,isActive:!0}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("button",{onClick:()=>Ht(G),className:"text-white font-bold text-3xl uppercase truncate tracking-tight text-left block hover:text-[var(--neon-green)] transition-colors font-bungee",children:G.name}),h.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[h.jsx("span",{className:"text-[10px] bg-[var(--neon-green)] text-black px-2 py-0.5 rounded-full font-black uppercase tracking-widest font-righteous shrink-0",children:"LIVE"}),h.jsxs("span",{className:"text-sm text-slate-600 uppercase font-black font-righteous tracking-widest truncate",children:[G.favorites.length,"   ",G.personalHistory.length," TX"]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-4 shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-4 py-2 px-4 bg-black/40 rounded-2xl border border-white/5",children:[h.jsx("button",{onClick:()=>Ht(G),className:"py-2.5 px-4 bg-white/5 hover:bg-white/10 text-white rounded-lg text-xs font-black uppercase tracking-widest transition-all font-righteous",children:"LOG"}),h.jsx("button",{onClick:()=>yr(G),className:"py-2.5 px-4 bg-white/5 hover:bg-white/10 text-white rounded-lg text-xs font-black uppercase transition-all font-righteous",children:"EDIT"}),h.jsx("button",{onClick:()=>Qn(G),className:"py-2.5 px-6 bg-[var(--neon-cyan)]/20 text-[var(--neon-cyan)] hover:text-black rounded-lg text-xs font-black uppercase tracking-widest transition-all font-righteous hover:bg-[var(--neon-cyan)]",children:"AUTO_SET"}),h.jsx("button",{onClick:()=>st(G),className:"py-2.5 px-6 bg-[var(--neon-pink)]/20 text-[var(--neon-pink)] hover:text-white rounded-lg text-xs font-black uppercase tracking-widest transition-all font-righteous hover:bg-[var(--neon-pink)]",children:"MANUAL"})]}),h.jsx("button",{onClick:()=>{yt("Terminate temporary link?",async()=>{await op(G.id),await _e()})},className:"w-10 h-10 flex items-center justify-center text-rose-500/20 hover:text-rose-500 hover:bg-rose-500/10 rounded-xl transition-all font-black",children:""})]})]},G.id))})]}),h.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-4 duration-700",children:[h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsx("h3",{className:"text-base font-black text-slate-600 uppercase tracking-[0.5em] font-righteous whitespace-nowrap",children:"ARCHIVE DIRECTORY"}),h.jsx("div",{className:"h-[1px] w-full bg-white/5"})]}),h.jsx("div",{className:"flex flex-col gap-4",children:ne.map(G=>{const ue=e.participants.some(be=>be.id===G.id);return h.jsxs("div",{className:`bg-[#101015] border-2 ${ue?"border-[var(--neon-cyan)] shadow-[0_0_20px_rgba(0,229,255,0.1)]":"border-white/5"} rounded-[2.5rem] p-6 flex flex-col justify-between hover:border-[var(--neon-purple)] transition-all group`,children:[h.jsxs("div",{className:"flex justify-between items-start gap-4 mb-3",children:[h.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-2xl font-black border-2 ${G.password?"bg-indigo-900/50 border-[var(--neon-purple)] text-white shadow-[0_0_15px_rgba(167,139,250,0.3)]":"bg-slate-800 border-white/10 text-slate-500"}`,children:G.name.charAt(0).toUpperCase()}),G.isAdmin&&h.jsx("div",{className:"absolute -top-2 -right-2 bg-[var(--neon-pink)] text-black text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg border border-white/20",children:"ADMIN"})]}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("div",{className:"flex justify-between items-start gap-2",children:h.jsx("button",{onClick:()=>Ht(G),className:"text-white font-bold text-2xl uppercase truncate tracking-tight text-left block hover:text-[var(--neon-purple)] transition-colors font-bungee",children:G.name})}),h.jsxs("p",{className:"text-xs text-slate-500 uppercase font-black tracking-[0.2em] mt-1 font-righteous",children:[G.password?" AUTHENTICATED":"GUEST ID","  ",G.favorites.length," "]})]})]}),h.jsx("button",{onClick:()=>{er(G),_(!0)},className:"p-3 bg-white/5 border border-white/10 rounded-xl hover:bg-[var(--neon-cyan)]/20 hover:border-[var(--neon-cyan)] hover:text-[var(--neon-cyan)] transition-all group/qr",title:"Generate SINC QR",children:h.jsxs("div",{className:"w-6 h-6 flex flex-col justify-between items-center p-0.5",children:[h.jsx("div",{className:"w-full h-[2px] bg-current"}),h.jsxs("div",{className:"w-full flex justify-between",children:[h.jsx("div",{className:"w-[2px] h-[2px] bg-current"}),h.jsx("div",{className:"w-[2px] h-[2px] bg-current"})]}),h.jsx("div",{className:"w-full h-[2px] bg-current"}),h.jsxs("div",{className:"w-full flex justify-between",children:[h.jsx("div",{className:"w-[2px] h-[2px] bg-current"}),h.jsx("div",{className:"w-[2px] h-[2px] bg-current"})]}),h.jsx("div",{className:"w-full h-[2px] bg-current"})]})})]}),h.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>Ht(G),className:"flex-1 py-2.5 bg-black border border-white/10 hover:border-[var(--neon-purple)] text-white rounded-lg text-xs font-black uppercase transition-all font-righteous",children:"LOG"}),h.jsx("button",{onClick:()=>yr(G),className:"flex-1 py-2.5 bg-black border border-white/10 hover:border-[var(--neon-purple)] text-white rounded-lg text-xs font-black uppercase transition-all font-righteous",children:"EDIT"}),h.jsx("button",{onClick:()=>Qn(G),className:"flex-[2] py-2.5 bg-[var(--neon-cyan)]/20 text-[var(--neon-cyan)] hover:text-black rounded-lg text-xs font-black uppercase transition-all font-righteous hover:bg-[var(--neon-cyan)]",children:"AUTO-SET"})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>st(G),className:"flex-[4] py-2.5 bg-slate-900 border border-white/5 hover:border-[var(--neon-pink)] text-slate-500 hover:text-white rounded-lg flex items-center justify-center gap-2 transition-all text-xs font-black uppercase font-righteous",children:"MANUAL SELECT"}),h.jsx("button",{onClick:()=>{yt("Erase this record permanently?",async()=>{await op(G.id),await _e()})},className:"flex-1 py-2.5 bg-rose-500/5 text-rose-500/20 hover:text-rose-500 border border-transparent hover:border-rose-500/30 rounded-lg transition-all flex items-center justify-center",children:""})]})]})]},G.id)})}),ne.length===0&&T.length===0&&h.jsx("div",{className:"text-center py-24 bg-black/20 rounded-[3rem] border-2 border-dashed border-white/5",children:h.jsx("p",{className:"text-slate-800 text-base font-black uppercase tracking-[0.5em] font-righteous",children:"EMPTY DIRECTORY - NO SIGNALS DETECTED"})})]})]})})()})})]})}),(o||C||R||D||d||m)&&h.jsx("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center p-4 z-[100] backdrop-blur-xl",children:h.jsx("div",{className:"w-full max-w-md",children:(()=>{let T={singerName:"",songName:"",artist:"",youtubeUrl:"",type:Tt.SINGING},ne="Global Track Input";if(R&&we)if(R.type==="favorite"){const G=we.favorites.find(ue=>ue.id===R.itemId);G&&(T={singerName:we.name,songName:G.songName,artist:G.artist,youtubeUrl:G.youtubeUrl||"",type:G.type},ne=`Edit Permanent Favorite for ${we.name}`)}else{const G=we.personalHistory.find(ue=>ue.id===R.itemId);G&&(T={singerName:we.name,songName:G.songName,artist:G.artist,youtubeUrl:G.youtubeUrl||"",type:G.type},ne=`Edit History Entry for ${we.name}`)}else C?(T={singerName:C.participantName,songName:C.songName,artist:C.artist,youtubeUrl:C.youtubeUrl||"",type:C.type},ne="Modify Track"):m?(T={singerName:"",songName:m.songName,artist:m.artist,youtubeUrl:m.youtubeUrl||"",type:m.type},ne="Edit Verified Song"):d?(T={singerName:"",songName:"",artist:"",youtubeUrl:"",type:Tt.SINGING},ne="Add to Verified Songbook"):D&&(T.singerName=D.name,ne=`Song for ${D.name}`);return h.jsx(PA,{title:ne,showSingerName:!R&&!m&&!d,initialSingerName:T.singerName,initialSongName:T.songName,initialArtist:T.artist,initialYoutubeUrl:T.youtubeUrl,initialType:T.type,submitLabel:C||R||m?"Save Update":d?"Add to Library":"Queue Track",onSubmit:Gn,onCancel:Yi,participants:e.participants},(C==null?void 0:C.id)||(R==null?void 0:R.itemId)||(D==null?void 0:D.id)||(m==null?void 0:m.id)||(d?"new-verified":"new-request"))})()})}),(b||Tn)&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[200] backdrop-blur-3xl animate-in fade-in duration-500",children:h.jsxs("div",{className:"w-full max-w-2xl bg-[#0a0a0a] border-4 border-white/10 rounded-[3rem] p-8 relative overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] animate-in zoom-in-95 duration-500",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-cyan)] via-[var(--neon-purple)] to-[var(--neon-pink)] animate-gradient-x"}),h.jsxs("div",{className:"flex justify-between items-start mb-6",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tight font-bungee neon-glow-white",children:Tn?"USER SINC":"JOIN ROOM"}),Tn&&h.jsxs("p",{className:"text-[var(--neon-cyan)] text-xs font-black uppercase tracking-widest font-righteous mt-1",children:["TARGET: ",Tn.name]})]}),h.jsx("button",{onClick:()=>{_(!1),er(null)},className:"text-slate-600 hover:text-white p-2 font-black text-3xl transition-colors",children:""})]}),h.jsx("div",{className:"flex flex-col items-center gap-4",children:(()=>{const T=Bp(),ne=T.includes("localhost")||T.includes("127.0.0.1"),G=De=>{const We=De.replace(/\/$/,"")+"/";return Tn?`${We}?userId=${Tn.id}&room=${vn||""}`:`${We}?room=${vn||""}`};if(!ne){const De=G(T);return h.jsxs(h.Fragment,{children:[h.jsx("p",{className:"text-[var(--neon-green)] font-black uppercase tracking-[0.2em] text-[10px] font-righteous self-start",children:" LIVE URL  SCAN TO JOIN"}),h.jsx("div",{className:"bg-white p-4 rounded-2xl w-full max-w-sm mx-auto shadow-[0_0_40px_rgba(255,255,255,0.1)] hover:scale-105 transition-transform",children:h.jsx(C1,{value:De,size:300,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}),h.jsx("div",{className:"w-full p-3 bg-[var(--neon-green)]/10 border border-[var(--neon-green)]/30 rounded-xl",children:h.jsx("p",{className:"text-[10px] font-mono text-[var(--neon-green)] break-all text-center",children:De})})]})}const ue=Ne.trim()?Ne.trim().startsWith("http")?Ne.trim():`http://${Ne.trim()}:5173/SingMode-v.2/`:null,be=ue?G(ue):"http://enter-your-ip-below";return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"w-full p-3 bg-rose-500/20 border border-rose-500/40 rounded-xl",children:[h.jsx("p",{className:"text-rose-400 text-[10px] font-black uppercase tracking-widest text-center",children:" LOCALHOST  phones can't connect via this URL"}),h.jsx("p",{className:"text-slate-500 text-[10px] text-center mt-1 font-mono",children:"Deploy to GitHub Pages for automatic public URLs, or enter your LAN IP below"})]}),h.jsx("p",{className:"text-[var(--neon-yellow)] font-black uppercase tracking-[0.2em] text-[10px] font-righteous self-start",children:"MANUAL NETWORK IP"}),h.jsx("div",{className:"bg-white p-4 rounded-2xl w-full max-w-sm mx-auto shadow-[0_0_40px_rgba(255,255,255,0.1)] hover:scale-105 transition-transform",children:h.jsx(C1,{value:be,size:300,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256"})}),h.jsx("div",{className:"w-full p-3 bg-black/60 border border-white/10 rounded-xl",children:h.jsx("p",{className:"text-[10px] font-mono text-[var(--neon-cyan)] break-all text-center",children:ue?be:"Enter IP below to generate URL"})}),h.jsx("input",{type:"text",value:Ne,onChange:De=>Re(De.target.value),placeholder:"e.g. 192.168.0.160",className:"w-full bg-black border-2 border-[var(--neon-yellow)]/40 focus:border-[var(--neon-yellow)] rounded-xl px-4 py-3 text-white font-mono text-sm outline-none transition-all placeholder:text-slate-600"}),h.jsx("button",{onClick:()=>{uv(Ne.trim())},className:"w-full py-3 bg-[var(--neon-yellow)] text-black rounded-xl font-black text-xs uppercase tracking-widest hover:bg-white transition-all font-righteous",children:"SAVE & USE THIS IP"})]})})()}),h.jsx("div",{className:"mt-6 p-3 bg-white/5 rounded-2xl border border-white/5 text-center",children:h.jsx("p",{className:"text-[var(--neon-cyan)] font-black uppercase tracking-widest text-sm font-righteous",children:Tn?"AUTO-LOGIN ENABLED":`ROOM ID: ${vn}`})})]})}),gt&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[200] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-xl bg-[#050510] border-4 border-white/10 p-12 rounded-[3.5rem] shadow-[0_0_100px_rgba(0,0,0,0.8)] relative overflow-hidden animate-in zoom-in-95 duration-300",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsx("h3",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-glow-purple",children:"Signal Origin"}),h.jsx("p",{className:"text-base text-[var(--neon-cyan)] font-black uppercase tracking-[0.4em] mb-12 font-righteous opacity-80",children:"Set the endpoint for guest terminal connections"}),h.jsxs("div",{className:"space-y-8",children:[h.jsxs("div",{className:"bg-black/40 p-8 rounded-[2rem] border-2 border-white/5 border-dashed",children:[h.jsx("p",{className:"text-sm text-slate-500 uppercase font-black mb-3 tracking-[0.3em] font-righteous",children:"LOCAL ENVIRONMENT DETECTION"}),h.jsxs("div",{className:"text-xl text-[var(--neon-cyan)] font-mono font-black tracking-widest",children:[window.location.hostname," ",h.jsx("span",{className:"text-sm text-slate-700 opacity-60",children:"(CURRENT HOST)"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-black text-slate-500 uppercase mb-4 ml-4 tracking-[0.3em] font-righteous",children:"TERMINAL ADDRESS / PUBLIC TUNNEL URL"}),h.jsx("input",{type:"text",value:Ne,onChange:T=>Re(T.target.value),placeholder:"E.G. 192.168.1.15 OR HTTPS://SIGNAL.NGROK.APP",className:"w-full bg-black border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-black uppercase font-mono tracking-widest outline-none focus:border-[var(--neon-pink)] transition-all placeholder:text-slate-800 text-lg"})]}),h.jsx("div",{className:"bg-[var(--neon-pink)]/5 border border-[var(--neon-pink)]/10 p-6 rounded-2xl",children:h.jsx("p",{className:"text-sm text-[var(--neon-pink)]/60 font-black leading-relaxed uppercase tracking-widest font-righteous italic",children:"Note: Cross-network connectivity requires tunneling (ngrok) for public-private bridge."})}),h.jsxs("div",{className:"flex gap-4 pt-6",children:[h.jsx("button",{onClick:()=>Z(!1),className:"flex-1 py-4 bg-black border border-white/10 text-white rounded-xl text-sm font-black uppercase tracking-widest font-righteous hover:bg-white/5",children:"ABORT"}),h.jsx("button",{onClick:ao,className:"flex-[2] py-4 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-black uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white transition-all hover:scale-105",children:"AUTHORIZE CONFIG"})]})]})]})}),_t&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[200] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-4xl bg-[#0a0a0a] border-4 border-white/10 rounded-[4rem] overflow-hidden shadow-[0_0_100px_rgba(0,0,0,0.8)] flex flex-col max-h-[90vh] relative animate-in zoom-in-95 duration-300",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsxs("div",{className:"p-8 border-b-2 border-white/5 flex justify-between items-center bg-black/40 backdrop-blur-xl",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-5xl font-black text-white font-bungee uppercase tracking-tight neon-glow-pink",children:"Signal Selection"}),h.jsxs("p",{className:"text-base text-[var(--neon-cyan)] font-black uppercase tracking-[0.4em] mt-1 font-righteous opacity-80",children:["Verified Catalog  Target: ",h.jsx("span",{className:"text-[var(--neon-pink)]",children:_t.name})]})]}),h.jsx("button",{onClick:()=>st(null),className:"text-slate-600 hover:text-white p-3 font-black text-4xl transition-colors transform hover:scale-110",children:""})]}),h.jsx("div",{className:"p-6 bg-black/20 border-b-2 border-white/5",children:h.jsxs("div",{className:"relative group",children:[h.jsx("input",{type:"text",placeholder:"FILTER VERIFIED TRANSMISSIONS...",value:on,onChange:T=>zt(T.target.value),className:"w-full bg-[#050510] border-2 border-white/10 rounded-2xl px-12 py-4 text-white font-black uppercase tracking-widest font-righteous outline-none focus:border-[var(--neon-pink)] transition-all shadow-inner placeholder:text-slate-700 text-xl"}),h.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-700 group-focus-within:text-[var(--neon-pink)] transition-colors",children:h.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[h.jsx("circle",{cx:"11",cy:"11",r:"8"}),h.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]})}),h.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6",children:[on&&Ks.length===0&&h.jsx("div",{className:"text-center py-20 opacity-50",children:h.jsx("p",{className:"text-xl font-black uppercase tracking-widest text-slate-600 font-righteous",children:"NO MATCHING TRANSMISSIONS"})}),!on&&it.length===0&&h.jsx("div",{className:"text-center py-20 opacity-50",children:h.jsx("p",{className:"text-xl font-black uppercase tracking-widest text-slate-600 font-righteous",children:"NO VERIFIED SONGS IN LIBRARY"})}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(on?Ks:it).map(T=>h.jsxs("div",{className:"bg-black/40 border-2 border-white/5 rounded-2xl p-4 relative overflow-hidden group hover:border-[var(--neon-pink)] transition-all",children:[h.jsx("h3",{className:"text-lg font-black text-white uppercase truncate font-righteous",children:T.songName}),h.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-wider mb-4 font-righteous",children:T.artist}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>vr(T),className:"flex-1 py-2 bg-[var(--neon-pink)]/20 text-[var(--neon-pink)] hover:text-black rounded-lg text-xs font-black uppercase transition-all font-righteous hover:bg-[var(--neon-pink)]",children:"SELECT"}),h.jsx("button",{onClick:()=>Wi(T),className:"flex-1 py-2 bg-black border border-white/10 hover:border-[var(--neon-pink)] text-white rounded-lg text-xs font-black uppercase transition-all font-righteous",children:"EDIT"})]})]},T.id))})]}),h.jsx("div",{className:"p-6 border-t-2 border-white/5 flex justify-end bg-black/40 backdrop-blur-xl",children:h.jsx("button",{onClick:()=>f(!0),className:"py-3 px-6 bg-[var(--neon-cyan)] text-black rounded-xl text-sm font-black uppercase tracking-widest font-righteous shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white transition-all hover:scale-105",children:"ADD NEW VERIFIED SONG"})})]})}),h.jsx("style",{children:`
        @keyframes gradient-x {
          0%, 100% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
        }
        .animate-gradient-x {
          background-size: 200% 200%;
          animation: gradient-x 3s ease infinite;
        }
        .neon-glow-pink {
          text-shadow: 0 0 10px rgba(255, 0, 255, 0.5), 0 0 20px rgba(255, 0, 255, 0.3);
        }
        .neon-glow-cyan {
          text-shadow: 0 0 10px rgba(0, 229, 255, 0.5), 0 0 20px rgba(0, 229, 255, 0.3);
        }
        .neon-glow-purple {
          text-shadow: 0 0 10px rgba(167, 139, 250, 0.5), 0 0 20px rgba(167, 139, 250, 0.3);
        }
        .neon-glow-green {
           text-shadow: 0 0 10px rgba(0, 255, 157, 0.5), 0 0 20px rgba(0, 255, 157, 0.3);
        }
        .neon-glow-white {
           text-shadow: 0 0 10px rgba(255, 255, 255, 0.5), 0 0 20px rgba(255, 255, 255, 0.3);
        }
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: rgba(255, 255, 255, 0.02);
          border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: rgba(255, 255, 255, 0.1);
          border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 255, 255, 0.2);
        }
      `}),Wt==="ADMIN"&&h.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:h.jsxs("div",{className:"bg-[#0a0a10]/90 backdrop-blur-2xl rounded-[3rem] p-10 border border-white/5 shadow-2xl relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-[var(--neon-green)]/10 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/4 pointer-events-none"}),h.jsx("div",{className:"flex justify-between items-center mb-10 relative z-10",children:h.jsxs("div",{children:[h.jsxs("h2",{className:"text-4xl font-bold font-bungee text-white uppercase flex items-center gap-4 neon-glow-green",children:[h.jsx("span",{className:"text-5xl",children:""})," SESSION CONTROL"]}),h.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest mt-2 font-righteous",children:"MANAGE ACTIVE INSTANCES"})]})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[Zt.map(T=>h.jsxs("div",{className:"bg-black/40 border-2 border-white/5 rounded-[2rem] p-6 relative overflow-hidden group hover:border-[var(--neon-green)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsx("div",{className:"w-12 h-12 bg-black rounded-xl border border-white/10 flex items-center justify-center text-2xl",children:T.id===(e==null?void 0:e.id)?"":""}),h.jsx("div",{className:`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest border ${T.id===(e==null?void 0:e.id)?"bg-[var(--neon-cyan)]/20 text-[var(--neon-cyan)] border-[var(--neon-cyan)]":"bg-slate-800 text-slate-400 border-white/10"}`,children:T.id===(e==null?void 0:e.id)?"CURRENT":"REMOTE"})]}),h.jsx("h3",{className:"text-xl font-black text-white uppercase truncate font-bungee mb-1",children:T.venueName||"Unknown Venue"}),h.jsxs("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-wider mb-6 font-righteous",children:["HOST: ",T.hostName,"  ID: ",T.id]}),h.jsx("button",{onClick:()=>{yt(`Force close session "${T.venueName}"? This cannot be undone.`,async()=>{await jA(T.id)})},className:"w-full py-3 bg-rose-500/10 text-rose-500 hover:bg-rose-500 hover:text-white border border-rose-500/30 rounded-xl font-black uppercase tracking-widest text-xs transition-all font-righteous",children:"FORCE CLOSE"})]},T.id)),Zt.length===0&&h.jsx("div",{className:"col-span-full text-center py-20 opacity-50",children:h.jsx("p",{className:"text-xl font-black uppercase tracking-widest text-slate-600 font-righteous",children:"NO ACTIVE SESSIONS FOUND"})})]})]})}),Wt==="SESSION"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10 animate-in slide-in-from-bottom-4 duration-500 pb-32",children:[h.jsx("div",{className:"lg:col-span-8 flex flex-col gap-10",children:h.jsxs("div",{className:"bg-[#0a0a10]/90 backdrop-blur-2xl rounded-[3rem] p-10 border-4 border-[var(--neon-purple)]/20 shadow-2xl relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-[var(--neon-purple)]/10 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/4 pointer-events-none"}),h.jsxs("div",{className:"flex justify-between items-center mb-10 relative z-10",children:[h.jsxs("div",{children:[h.jsxs("h2",{className:"text-4xl font-bold font-bungee text-white uppercase flex items-center gap-4 neon-glow-purple",children:[h.jsx("span",{className:"text-5xl",children:""})," ",((oo=e.brandIdentity)==null?void 0:oo.venueName)||"KARAOKE LOUNGE"," SESSION"]}),h.jsx("p",{className:"text-slate-400 mt-2 font-mono",children:"Monitor all connected devices and manage active synchronization."})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("div",{className:"px-6 py-3 bg-white/5 rounded-2xl border border-white/10 flex items-center gap-3",children:[h.jsx("span",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest font-righteous",children:"STATUS"}),h.jsx("span",{className:`text-xl font-black ${vn?"text-[var(--neon-green)]":"text-rose-500"} uppercase font-bungee`,children:vn?"ACTIVE":"OFFLINE"})]}),h.jsxs("div",{className:"px-6 py-3 bg-white/5 rounded-2xl border border-white/10 flex items-center gap-3",children:[h.jsx("span",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest font-righteous",children:"ROOM"}),h.jsx("span",{className:"text-2xl font-black text-white font-mono",children:vn||"----"})]})]})]}),vn?h.jsxs("div",{className:"space-y-8 relative z-10 w-full",children:[h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>Te(!0),className:"flex-1 py-4 bg-white/5 hover:bg-white/10 rounded-2xl border border-white/10 flex items-center justify-center gap-3 text-xs font-black text-slate-400 hover:text-white transition-all uppercase tracking-[0.2em] font-righteous shadow-inner",children:" VIEW ARCHIVE"}),h.jsxs("button",{onClick:()=>yt("Terminate current session?",()=>Yr()),className:"flex-1 py-4 bg-rose-500/10 hover:bg-rose-500 rounded-2xl border border-rose-500/20 text-rose-500 hover:text-white font-black uppercase tracking-[0.3em] font-righteous transition-all shadow-[0_0_20px_rgba(244,63,94,0.1)] group flex justify-center items-center gap-2",children:[h.jsx("span",{className:"text-xl",children:""})," TERMINATE SESSION"]})]}),h.jsxs("div",{className:"flex items-center gap-3 mt-12 mb-6 border-b border-white/5 pb-4",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-[var(--neon-yellow)] animate-pulse"}),h.jsx("h3",{className:"text-xl font-bold font-bungee text-white uppercase tracking-widest neon-text-glow-yellow",children:"DEVICE CONNECTIVITY LOG"}),h.jsxs("span",{className:"ml-auto text-slate-500 font-mono text-sm",children:[((Zi=e.deviceConnections)==null?void 0:Zi.length)||0," TOTAL"]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[(ks=e.deviceConnections)==null?void 0:ks.map(T=>{var be;const ne=T.status==="connected",G=T.userId?n.find(De=>De.id===T.userId)||((be=e.participants)==null?void 0:be.find(De=>De.id===T.userId)):null,ue=T.isGuest||(G&&"isGuest"in G?G.isGuest:!1);return h.jsxs("div",{className:`p-6 rounded-[2rem] border transition-all relative overflow-hidden group ${ne?"bg-[#151520] border-[var(--neon-purple)]/30 hover:border-[var(--neon-purple)]":"bg-[#05050A] border-white/5 opacity-60"}`,children:[h.jsx("div",{className:`absolute top-6 right-6 w-3 h-3 rounded-full ${ne?"bg-[var(--neon-green)] shadow-[0_0_10px_var(--neon-green)]":"bg-rose-500"}`}),h.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[h.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center text-3xl shadow-lg ${G?ue?"bg-[var(--neon-orange)]/20 text-[var(--neon-orange)]":"bg-[var(--neon-blue)]/20 text-[var(--neon-blue)]":"bg-white/5 text-slate-500"}`,children:G?ue?"":"":""}),h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xl font-bold text-white font-righteous tracking-wide flex items-center gap-3",children:[T.id,ue&&h.jsx("span",{className:"px-2 py-0.5 rounded bg-rose-500 text-[8px] font-black text-white",children:"GUEST"})]}),h.jsxs("div",{className:"text-xs font-mono text-slate-500 mt-1 flex flex-col gap-1",children:[h.jsx("div",{className:"truncate max-w-[150px]",title:T.peerId,children:T.peerId}),T.userAgent&&h.jsx("div",{className:"text-[10px] text-[var(--neon-cyan)]/60 font-black uppercase flex items-center gap-1",children:T.userAgent.toLowerCase().includes("mobile")?" MOBILE":" DESKTOP"})]}),h.jsx("div",{className:`mt-2 text-xs font-bold uppercase tracking-widest px-2 py-0.5 rounded inline-block ${ne?"bg-[var(--neon-green)]/10 text-[var(--neon-green)]":"bg-rose-500/10 text-rose-500"}`,children:T.status})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"p-4 bg-black/40 rounded-xl border border-white/5",children:[h.jsx("div",{className:"text-[10px] uppercase text-slate-500 font-bold tracking-widest mb-1",children:"Assigned Session"}),h.jsx("div",{className:"text-white font-medium truncate",children:G?G.name:h.jsx("span",{className:"text-slate-600 italic",children:"Unassigned"})})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>{const De=prompt("Enter User Name to link (must exist in Directory):");if(De){const We=n.find(vt=>vt.name.toLowerCase()===De.toLowerCase());We?(xM(T.id,We.id,We.isGuest),_e()):alert("User not found!")}},className:"flex-1 py-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 hover:border-white/20 text-sm font-bold text-white transition-all",children:G?"CHANGE":"LINK USER"}),h.jsx("button",{onClick:()=>{yt("Forget this device?",async()=>{await _M(T.id),_e()})},className:"px-4 py-3 rounded-xl bg-rose-500/10 hover:bg-rose-500/20 border border-rose-500/20 text-rose-500 transition-all",children:"Forget"})]})]})]},T.id)}),(!e.deviceConnections||e.deviceConnections.length===0)&&h.jsx("div",{className:"col-span-full py-20 text-center text-slate-500 font-mono",children:"No devices detected yet. Scan the QR code to connect."})]}),h.jsxs("div",{className:"mt-10 p-8 bg-black/40 rounded-[2.5rem] border border-white/5 relative overflow-hidden animate-in slide-in-from-bottom-4 duration-700",children:[h.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[var(--neon-cyan)]/5 blur-[80px] rounded-full -mr-32 -mt-32 pointer-events-none"}),h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsx("h3",{className:"text-xl font-black text-white uppercase tracking-tight font-bungee neon-text-glow-cyan",children:"Live Session Log"}),h.jsx("span",{className:"px-3 py-1 rounded-full bg-[var(--neon-cyan)]/10 border border-[var(--neon-cyan)]/30 text-[9px] font-black text-[var(--neon-cyan)] uppercase tracking-widest animate-pulse",children:" REALTIME_FEED"})]}),h.jsxs("div",{className:"space-y-3 max-h-64 overflow-y-auto pr-4 no-scrollbar custom-scrollbar",children:[(lo=e.logs)==null?void 0:lo.slice().reverse().map((T,ne)=>h.jsxs("div",{className:"flex gap-4 items-start animate-in slide-in-from-left-2 duration-300 group",children:[h.jsxs("span",{className:"text-[10px] font-mono text-slate-600 shrink-0 mt-0.5 group-hover:text-slate-400 transition-colors",children:["[",new Date(T.timestamp).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),"]"]}),h.jsx("span",{className:`text-xs font-righteous uppercase tracking-wide px-2 py-0.5 rounded ${T.type==="error"?"text-rose-500 bg-rose-500/5":T.type==="warn"?"text-[var(--neon-yellow)] bg-[var(--neon-yellow)]/5":"text-slate-300 group-hover:text-white transition-colors"}`,children:T.message})]},ne)),(!e.logs||e.logs.length===0)&&h.jsx("div",{className:"text-center py-10 text-slate-700 font-black uppercase tracking-widest text-[10px] italic",children:"AWAITING_INITIAL_SYNC_EVENTS..."})]})]})]}):h.jsx("div",{className:"flex items-center justify-center py-20",children:h.jsxs("div",{className:"max-w-xl w-full bg-[#0a0a0a] border-4 border-dashed border-white/5 rounded-[4rem] p-16 text-center",children:[h.jsx("div",{className:"w-24 h-24 bg-[var(--neon-purple)]/10 text-[var(--neon-purple)] rounded-[2.5rem] flex items-center justify-center text-5xl mx-auto mb-10 shadow-[0_0_50px_rgba(180,0,255,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-4xl font-black text-white uppercase mb-4 font-bungee tracking-tight",children:"OPEN BROADCAST"}),h.jsxs("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs mb-10 font-righteous leading-relaxed",children:["ACTIVATE THE WORLDWIDE SYNC PROTOCOL. ",h.jsx("br",{}),"ALLOW SINGER CONNECTIONS AND REMOTE COMMANDS."]}),h.jsx("button",{onClick:()=>Te(!0),className:"mb-10 px-6 py-3 bg-white/5 hover:bg-white/10 rounded-2xl border border-white/10 flex items-center justify-center gap-3 text-xs font-black text-slate-400 hover:text-white transition-all uppercase tracking-[0.2em] font-righteous mx-auto shadow-inner",children:" VIEW SESSION HISTORY"}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] font-black text-[var(--neon-purple)] uppercase tracking-[0.3em] mb-3 font-righteous text-left ml-4",children:"SESSION NAME / ROOM ID"}),h.jsx("input",{type:"text",value:V,onChange:T=>te(T.target.value.toUpperCase().replace(/\s+/g,"_")),className:"w-full bg-black border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-mono text-center text-2xl tracking-widest focus:border-[var(--neon-purple)] outline-none transition-all"})]}),h.jsx("button",{onClick:()=>mr(),disabled:pe||!V,className:"w-full py-6 bg-[var(--neon-purple)] text-white rounded-[1.5rem] font-black uppercase tracking-[0.2em] text-xl shadow-[0_0_40px_rgba(180,0,255,0.4)] hover:scale-105 hover:bg-fuchsia-500 transition-all disabled:opacity-50 disabled:scale-100 font-righteous",children:pe?"INITIALIZING...":"OPEN SESSION"}),tr&&tr!==V&&h.jsxs("button",{onClick:()=>mr(tr),disabled:pe,className:"w-full py-4 bg-black border-2 border-[var(--neon-cyan)] text-[var(--neon-cyan)] rounded-[1.5rem] font-black uppercase tracking-[0.2em] text-sm shadow-[0_0_20px_rgba(0,229,255,0.2)] hover:bg-[var(--neon-cyan)]/10 transition-all font-righteous mt-4",children:["RECONNECT TO PREVIOUS: ",tr]})]})]})})]})}),h.jsx("div",{className:"lg:col-span-4 space-y-10",children:h.jsxs("section",{className:"bg-black/40 border-4 border-[var(--neon-cyan)]/20 rounded-[3rem] p-8 h-[800px] flex flex-col relative overflow-hidden shadow-[0_0_60px_rgba(0,229,255,0.1)] sticky top-36",children:[h.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-[var(--neon-cyan)]/5 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/2 pointer-events-none"}),h.jsx("div",{className:"flex justify-between items-center mb-8 px-2 shrink-0 relative z-10",children:h.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-tighter font-bungee neon-glow-cyan",children:"COMPLETED ROUNDS"})}),h.jsx("div",{className:"flex-1 overflow-y-auto pr-2 custom-scrollbar relative z-10",children:h.jsx("div",{className:"grid gap-8",children:(()=>{const T={};e.history.filter(G=>(G.playedAt||0)>=(e.startedAt||0)).forEach(G=>{const ue=G.playedAt||0;T[ue]||(T[ue]=[]),T[ue].push(G)});const ne=Object.keys(T).map(Number).sort((G,ue)=>ue-G);return ne.length===0?h.jsx("div",{className:"text-center py-24 border-4 border-dashed border-white/5 rounded-[2.5rem] opacity-20",children:h.jsx("p",{className:"text-2xl font-black uppercase tracking-[0.4em] font-righteous text-slate-500",children:"HISTORY_NULL"})}):ne.map((G,ue)=>h.jsxs("div",{className:"bg-[#050510] border-2 border-[var(--neon-cyan)]/30 rounded-[2.5rem] p-6 relative group hover:border-[var(--neon-cyan)] transition-all shadow-[0_0_30px_rgba(0,229,255,0.05)]",children:[h.jsxs("div",{className:"absolute top-0 left-6 py-1 px-4 bg-[var(--neon-cyan)] text-black text-[10px] font-black uppercase tracking-widest rounded-b-lg font-righteous shadow-[0_0_15px_rgba(0,229,255,0.4)]",children:["ROUND_",ne.length-ue,"  ",new Date(G).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),h.jsx("div",{className:"grid grid-cols-1 gap-4 mt-6",children:T[G].map((be,De)=>h.jsxs("div",{className:"flex flex-col p-4 bg-black/40 rounded-2xl border border-white/5 group/song hover:bg-white/5 transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsx("div",{className:"text-lg font-black text-white uppercase truncate font-bungee tracking-tight group-hover/song:text-[var(--neon-cyan)] transition-colors pr-2 break-words max-w-full overflow-hidden text-ellipsis",children:be.songName}),h.jsx(ka,{url:be.youtubeUrl})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-xs font-black text-[var(--neon-pink)] uppercase tracking-widest font-righteous max-w-[150px] truncate",children:["@",be.participantName]}),h.jsxs("span",{className:"text-[10px] font-bold text-slate-700 uppercase tracking-tighter shrink-0",children:["POS_",De+1]})]})]},be.id))})]},G))})()})})]})})]}),he&&h.jsx("div",{className:"fixed inset-0 bg-black/98 flex items-center justify-center p-6 z-[400] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-4xl bg-[#050510] border-4 border-[var(--neon-purple)]/30 rounded-[4rem] p-12 shadow-[0_0_100px_rgba(180,0,255,0.2)] flex flex-col max-h-[85vh] relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-[var(--neon-purple)]/5 blur-[100px] rounded-full -mr-48 -mt-48 pointer-events-none"}),h.jsxs("div",{className:"flex justify-between items-center mb-12",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-5xl font-black text-white uppercase tracking-tight font-bungee neon-text-glow-purple",children:"SESSION_HISTORY"}),h.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-[0.2em] text-xs mt-2 font-righteous",children:"ARCHIVE OF PREVIOUS SINGMODE BETA BROADCASTS"})]}),h.jsx("button",{onClick:()=>Te(!1),className:"w-16 h-16 rounded-full bg-white/5 hover:bg-white/10 border border-white/10 flex items-center justify-center text-2xl transition-all",children:""})]}),h.jsx("div",{className:"flex-1 overflow-y-auto pr-4 space-y-4 no-scrollbar",children:Me.length===0?h.jsx("div",{className:"py-32 text-center text-slate-600 font-black uppercase tracking-widest font-righteous italic",children:"NO PREVIOUS SESSIONS RECORDED"}):h.jsx("div",{className:"grid gap-4",children:Me.map(T=>h.jsxs("div",{className:"p-8 bg-white/5 rounded-[2.5rem] border border-white/5 hover:border-white/10 transition-all group flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-8",children:[h.jsx("div",{className:"w-20 h-20 rounded-2xl bg-[var(--neon-purple)]/10 border border-[var(--neon-purple)]/20 flex flex-col items-center justify-center",children:h.jsx("span",{className:"text-2xl",children:""})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-2xl font-black text-white uppercase tracking-tight font-righteous",children:T.venueName||"Main Lounge"}),h.jsxs("div",{className:"flex items-center gap-4 mt-1 text-slate-500 font-mono text-sm",children:[h.jsxs("span",{children:["ID: ",T.id]}),h.jsx("span",{children:""}),h.jsx("span",{children:new Date(T.startedAt).toLocaleDateString()})]})]})]}),h.jsxs("div",{className:"text-right",children:[h.jsx("div",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 mb-1 font-righteous",children:"Duration"}),h.jsx("div",{className:"text-white font-mono text-xl",children:T.endedAt?Math.floor((T.endedAt-T.startedAt)/(60*1e3))+" MINS":"---"})]})]},T.id))})})]})}),h.jsx(wV,{zIndex:9999,dropAnimation:{sideEffects:aC({styles:{active:{opacity:"0.4"}}})},children:Jc&&On?On.type==="PARTICIPANT"?h.jsx(LV,{name:((Ds=On.item)==null?void 0:Ds.name)||On.name}):h.jsx(VV,{songName:((sr=On.item)==null?void 0:sr.songName)||On.songName,artist:((co=On.item)==null?void 0:co.artist)||On.artist,participantName:((ea=On.item)==null?void 0:ea.participantName)||On.participantName}):null})]}),Qt.isOpen&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[300] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-md bg-[#050510] border-4 border-[var(--neon-pink)]/30 rounded-[3rem] p-10 text-center shadow-[0_0_100px_rgba(255,42,109,0.3)] animate-in zoom-in-95 duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-[var(--neon-pink)] shadow-[0_0_20px_rgba(255,42,109,0.8)]"}),h.jsx("div",{className:"w-20 h-20 bg-[var(--neon-pink)]/10 text-[var(--neon-pink)] rounded-[2rem] border-2 border-[var(--neon-pink)]/20 flex items-center justify-center mx-auto mb-6 text-4xl font-black shadow-[0_0_30px_rgba(255,42,109,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-text-glow-pink",children:"CONFIRM"}),h.jsx("p",{className:"text-slate-400 text-lg mb-8 leading-relaxed font-black font-righteous uppercase tracking-widest",children:Qt.message}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>Dn(T=>({...T,isOpen:!1})),className:"flex-1 py-4 bg-black border-2 border-white/10 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous transition-all hover:bg-white/5",children:"CANCEL"}),h.jsx("button",{onClick:async()=>{Dn(T=>({...T,isOpen:!1})),await Qt.onConfirm()},className:"flex-[2] py-4 bg-[var(--neon-pink)] text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous shadow-[0_0_30px_rgba(255,42,109,0.4)] transition-all hover:bg-rose-400 hover:scale-105",children:"PROCEED"})]})]})})]})},BV=({onJoin:r,filterHostName:e})=>{const[t,n]=j.useState([]),[i,o]=j.useState(!0);j.useEffect(()=>{const d=kb(f=>{n(f),o(!1)});return()=>d()},[]);const c=e?t.filter(d=>{var f;return((f=d.hostName)==null?void 0:f.toLowerCase())===e.toLowerCase()}):t;return i?h.jsx("div",{className:"text-center py-20 animate-pulse",children:h.jsx("div",{className:"text-[var(--neon-cyan)] text-xl font-black uppercase tracking-widest font-righteous",children:"SEARCHING FOR STAGES..."})}):c.length===0?h.jsxs("div",{className:"text-center py-20 px-6 bg-black/20 rounded-[3rem] border-2 border-dashed border-white/5 mx-auto max-w-2xl",children:[h.jsx("p",{className:"text-[var(--neon-pink)] text-2xl font-black uppercase tracking-widest font-bungee mb-4",children:"NO STAGES FOUND"}),h.jsx("p",{className:"text-slate-500 font-righteous uppercase tracking-wider text-sm",children:"There are no active sessions nearby."})]}):h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 space-y-6 animate-in fade-in slide-in-from-bottom-8 duration-700",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[h.jsx("div",{className:"w-3 h-3 bg-[var(--neon-green)] rounded-full animate-ping"}),h.jsx("h2",{className:"text-[var(--neon-green)] font-black uppercase tracking-[0.3em] font-righteous text-lg",children:"LIVE STAGES"})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:c.map(d=>h.jsxs("div",{className:"group relative bg-[#101015] border-2 border-white/5 hover:border-[var(--neon-cyan)] p-8 rounded-[2.5rem] transition-all hover:-translate-y-2 hover:shadow-[0_0_50px_rgba(0,229,255,0.15)] overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--neon-cyan)]/0 via-transparent to-[var(--neon-purple)]/0 group-hover:from-[var(--neon-cyan)]/5 group-hover:to-[var(--neon-purple)]/5 transition-all duration-500"}),h.jsxs("div",{className:"relative z-10",children:[h.jsxs("div",{className:"flex justify-between items-start mb-6",children:[h.jsx("div",{className:"w-16 h-16 bg-black border border-white/10 rounded-2xl flex items-center justify-center text-3xl shadow-xl group-hover:scale-110 transition-transform duration-500 group-hover:border-[var(--neon-cyan)]",children:""}),h.jsx("div",{className:"px-3 py-1 bg-[var(--neon-green)]/10 text-[var(--neon-green)] border border-[var(--neon-green)]/20 rounded-lg text-[10px] font-black uppercase tracking-widest font-righteous",children:"ONLINE"})]}),h.jsx("h3",{className:"text-3xl font-bold text-white mb-2 font-bungee uppercase tracking-tight group-hover:text-[var(--neon-cyan)] transition-colors truncate",children:d.venueName||"OPEN MIC"}),h.jsxs("div",{className:"flex items-center gap-2 mb-8 text-slate-400 font-righteous uppercase tracking-wider text-xs",children:[h.jsx("span",{className:"text-[var(--neon-pink)]",children:"HOST:"})," ",d.hostName]}),h.jsx("button",{onClick:()=>r(d.id),className:"w-full py-4 bg-white text-black font-black uppercase tracking-[0.2em] rounded-xl hover:bg-[var(--neon-cyan)] transition-all font-righteous hover:scale-[1.02] active:scale-95 shadow-lg",children:"JOIN STAGE"})]})]},d.id))})]})},FV=({size:r="md",className:e=""})=>{const t={sm:"w-10 h-10 text-[10px]",md:"w-14 h-14 text-sm",lg:"w-28 h-28 text-2xl"};return h.jsxs("div",{className:`flex items-center gap-4 ${e} group cursor-pointer`,children:[h.jsx("div",{className:`${t[r]} bg-black border-2 border-cyan-400 rounded-2xl flex items-center justify-center font-black text-cyan-400 shadow-[0_0_20px_rgba(34,211,238,0.2)] transition-all group-hover:neon-border-pink group-hover:text-pink-500 group-hover:scale-110 font-bungee`,children:"SM"}),h.jsxs("div",{className:"font-bungee tracking-tighter flex flex-col leading-none",children:[h.jsx("span",{className:"text-pink-500 text-[0.5em] tracking-[0.5em] mb-1 font-righteous uppercase",children:"Terminal"}),h.jsx("span",{className:"text-white uppercase group-hover:neon-glow-pink transition-all",children:"Singmode Beta"})]})]})},lS=({url:r})=>r?h.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",title:"Open Video Link",className:"p-2 rounded-lg text-[var(--neon-cyan)] hover:bg-[var(--neon-cyan)]/20 border border-[var(--neon-cyan)]/30 transition-all shadow-[0_0_10px_rgba(0,229,255,0.2)]",children:h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),h.jsx("polyline",{points:"15 3 21 3 21 9"}),h.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})}):null,GV=()=>{var us;const[r,e]=j.useState(null),[t,n]=j.useState(null),[i,o]=j.useState(!0),[c,d]=j.useState(""),[f,m]=j.useState(""),[v,b]=j.useState(""),[_,S]=j.useState(""),[k,L]=j.useState(""),[B,X]=j.useState(null),[re,ee]=j.useState(!1),[le,fe]=j.useState(null),[ce,C]=j.useState(null),[I,R]=j.useState("ROTATION"),[U,D]=j.useState(!1),[M,O]=j.useState(""),[qe,gt]=j.useState(!1),[Z,he]=j.useState(0),[Te,Me]=j.useState(!1),[Ve,V]=j.useState("connecting"),[te,pe]=j.useState(void 0),[ye,Ne]=j.useState([]),[Re,Be]=j.useState(null),Je=pt.getRoomId(),rt=Bp()+(Je?`?room=${Je}`:"");new URLSearchParams(window.location.search).get("room")||new URLSearchParams(window.location.search).get("userId"),j.useEffect(()=>{Je&&zp().then(K=>{const ve=K.find(Oe=>Oe.id===Je);ve&&pe(ve.hostName)})},[Je]);const[$e,Zn]=j.useState({isOpen:!1,message:"",onConfirm:()=>{}}),En=(K,ve)=>{Zn({isOpen:!0,message:K,onConfirm:ve})};j.useEffect(()=>{const K=new URLSearchParams(window.location.search).get("room"),ve=Je||K;(async()=>{console.log(`[Participant] Initializing sync. Room from URL/Storage: ${ve||"None, using auto-discovery"}`),await gc("PARTICIPANT",ve||void 0);const we=new URLSearchParams(window.location.search).get("userId");if(we){console.log(`[Participant] SINC Login detected for userId: ${we}`);const Sn=await DM(we);if(Sn.success&&Sn.profile){n(Sn.profile),o(!1);const $t=Je||K;window.history.replaceState({},"",window.location.pathname+($t?`?room=${$t}`:""))}}const Ht=Je||K,nr=await Or();if(nr){n(nr);const Sn=await nt(Ht||void 0);X(Sn);const $t=Sn.participants.find(kn=>kn.id===nr.id);if($t)e($t);else{console.log(`[Participant] Auto-joining session ${Ht} for profile ${nr.id}`);try{const kn=await Ko(nr.id);e(kn)}catch(kn){console.error("Auto-join failed:",kn)}}}else{const Sn=await nt(Ht||void 0);X(Sn)}Ke()})(),pt.onConnectionStatus=et=>{V(et),et==="connected"&&ve&&localStorage.setItem("kstar_last_room",ve)};const Le=kb(et=>{et.length>0&&Be(et[0].id)});return()=>{Le()}},[Je]);const fr=async()=>{V("connecting");try{const ve=(await zp()).sort((Oe,Le)=>(Le.lastHeartbeat||0)-(Oe.lastHeartbeat||0))[0];if(ve)console.log(`[Participant] Smart Reconnect joining latest session: ${ve.id}`),localStorage.setItem("kstar_last_room",ve.id),window.location.search=`?room=${ve.id}`;else{const Oe=localStorage.getItem("kstar_last_room");Oe?window.location.search=`?room=${Oe}`:(console.log("[Participant] Smart Reconnect: No active session or last room found. Initializing sync for auto-discovery."),await gc("PARTICIPANT"))}}catch(K){console.error("Smart Reconnect failed:",K),Me(!0),V("disconnected")}},Ke=async()=>{const K=await nt();X(K);const ve=await Or();if(n(ve),!ve)e(null);else{const Oe=K.participants.find(Le=>Le.id===ve.id);e(Oe||(Le=>Le||null))}Ne(pt.getPendingActions())};j.useEffect(()=>(window.addEventListener("kstar_sync",Ke),window.addEventListener("storage",Ke),window.addEventListener("online",Ke),window.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&Ke()}),()=>{window.removeEventListener("kstar_sync",Ke),window.removeEventListener("storage",Ke),window.removeEventListener("online",Ke),window.removeEventListener("visibilitychange",Ke)}),[]);const Ar=async K=>{K.preventDefault(),d(""),V("connecting");const ve=async Oe=>{await Ke(),await new Promise(we=>setTimeout(we,500));let Le=3,et=null;for(;Le>0&&!et;)try{console.log(`[Participant] Attempting auth join, retries left: ${Le}`),et=await Ko(Oe)}catch(we){if(console.warn(`[Participant] Auth join attempt failed: ${we.message}`),Le--,Le===0)throw new Error("Could not reach session host. Please refresh and try again.");await new Promise(Ht=>setTimeout(Ht,1e3))}et&&(e(et),V("connected"))};try{if(i){const Oe=await kM(f,_);Oe.success&&Oe.profile?(n(Oe.profile),await ve(Oe.profile.id)):(d(Oe.error||"Authorization failed."),V("disconnected"))}else{if(_!==k){d("PASSWORDS_DO_NOT_MATCH"),V("disconnected");return}const Oe=await Lc({name:f,email:v||void 0,password:_||void 0},!0);Oe.success&&Oe.profile?(n(Oe.profile),await ve(Oe.profile.id)):(d(Oe.error||"Initialization failed."),V("disconnected"))}}catch(Oe){console.error("[Participant] Fatal auth join error:",Oe),d(Oe.message||"An unexpected network error occurred."),V("disconnected")}},Bn=async K=>{r&&(await Ba(r.id,K),await Ke())},Cs=async K=>{r&&(le?(await yd(le.id,{songName:K.songName,artist:K.artist,youtubeUrl:K.youtubeUrl,type:K.type,message:K.message}),fe(null),await Ke()):(await Oi({participantId:r.id,participantName:r.name,songName:K.songName,artist:K.artist,youtubeUrl:K.youtubeUrl,type:K.type,message:K.message}),ee(!1),await Ke(),r.status!==dn.READY&&await Ba(r.id,dn.READY)),C(null),await Ke())},Rs=()=>{ee(!1),fe(null),C(null)},_t=async()=>{d(""),V("connecting");try{const K=`Guest-${Math.floor(Math.random()*1e4)}`,ve=await Lc({name:K},!0);if(ve.success&&ve.profile){n(ve.profile),await Ke(),await new Promise(et=>setTimeout(et,500));let Oe=3,Le=null;for(;Oe>0&&!Le;)try{console.log(`[Participant] Attempting join for ${K}, retries left: ${Oe}`),Le=await Ko(ve.profile.id)}catch(et){if(console.warn(`[Participant] Join attempt failed: ${et.message}`),Oe--,Oe===0)throw new Error("Could not reach session host. Please refresh and try again.");await new Promise(we=>setTimeout(we,1e3))}Le&&(e(Le),C(null),ee(!0),V("connected"),await Ba(ve.profile.id,dn.READY))}else d(ve.error||"Guest initialization failed."),V("disconnected")}catch(K){console.error("[Participant] Fatal join error:",K),d(K.message||"An unexpected network error occurred."),V("disconnected")}};if(!r)return h.jsxs("div",{className:"max-w-2xl mx-auto p-8 flex flex-col items-center justify-center min-h-[90vh] text-center animate-in fade-in duration-1000 relative",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black via-[#10002B] to-black -z-10"}),h.jsxs("div",{className:"w-48 h-48 flex items-center justify-center mb-12 relative group",children:[h.jsx("div",{className:"absolute inset-0 bg-[var(--neon-pink)] blur-[60px] opacity-40 group-hover:opacity-60 transition-opacity"}),h.jsx("div",{className:"p-3 rounded-full border-4 border-white/10 relative z-10 bg-black shadow-2xl",children:h.jsx("div",{className:"rounded-full overflow-hidden border-4 border-[var(--neon-pink)] shadow-[0_0_40px_rgba(255,0,127,0.5)] w-full h-full",children:h.jsx("img",{src:"IGK.jpeg",alt:"Island Groove",className:"w-full h-full object-cover opacity-90 group-hover:opacity-100 transition-opacity"})})})]}),h.jsx("h1",{className:"text-6xl md:text-8xl font-bold font-bungee text-white mb-6 uppercase tracking-tight neon-text-glow-purple leading-none",children:"Singmode Beta"}),h.jsx("p",{className:"text-[var(--neon-cyan)] font-righteous mb-16 uppercase tracking-[0.6em] text-lg font-black neon-glow-cyan",children:"SINGER LOGIN"}),h.jsxs("div",{className:"w-full max-w-lg mb-12 relative z-20",children:[h.jsx("button",{onClick:_t,className:"w-full py-8 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-blue)] text-white rounded-[2.5rem] font-black text-4xl shadow-[0_0_60px_rgba(255,0,127,0.4)] uppercase tracking-[0.1em] active:scale-95 transition-all font-bungee hover:brightness-110 border-4 border-white/10 animate-pulse",children:"SING!"}),h.jsx("p",{className:"text-slate-500 font-righteous uppercase tracking-widest text-xs mt-4",children:"GUEST PASS"})]}),h.jsxs("div",{className:"relative w-full max-w-lg",children:[h.jsx("div",{className:"absolute inset-0 flex items-center mb-8",children:h.jsx("div",{className:"w-full border-t border-white/10"})}),h.jsx("div",{className:"relative flex justify-center mb-8",children:h.jsx("span",{className:"bg-black px-4 text-slate-500 font-righteous uppercase tracking-widest text-sm",children:"MEMBER LOGIN"})})]}),h.jsxs("form",{onSubmit:Ar,className:"w-full space-y-8 bg-[#050510] p-10 md:p-14 rounded-[4rem] border-4 border-white/5 shadow-[0_0_100px_rgba(0,0,0,0.8)] relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)]"}),c&&h.jsx("div",{className:"bg-rose-500/10 border border-rose-500/30 text-rose-500 text-base py-4 px-6 rounded-2xl font-black uppercase tracking-widest animate-pulse font-righteous",children:c}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-base font-black text-slate-500 uppercase tracking-[0.3em] mb-3 text-left font-righteous ml-4",children:"STAGE NAME"}),h.jsx("input",{type:"text",required:!0,value:f,onChange:K=>m(K.target.value),placeholder:"Stage Name",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-bold focus:border-[var(--neon-cyan)] outline-none transition-all shadow-inner text-2xl uppercase tracking-wider placeholder:text-slate-600 font-righteous"})]}),!i&&h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-base font-black text-slate-500 uppercase tracking-[0.3em] mb-3 text-left font-righteous ml-4",children:"EMAIL (OPTIONAL)"}),h.jsx("input",{type:"email",value:v,onChange:K=>b(K.target.value),placeholder:"myname@emailserver.com",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-bold focus:border-[var(--neon-purple)] outline-none transition-all shadow-inner text-xl tracking-wider placeholder:text-slate-600 font-righteous"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-base font-black text-slate-500 uppercase tracking-[0.3em] mb-3 text-left font-righteous ml-4",children:"PASSWORD"}),h.jsx("input",{type:"password",required:!i,value:_,onChange:K=>S(K.target.value),placeholder:"",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-bold focus:border-[var(--neon-pink)] outline-none transition-all shadow-inner text-3xl tracking-wider placeholder:text-slate-600 font-righteous"})]}),!i&&h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-base font-black text-slate-500 uppercase tracking-[0.3em] mb-3 text-left font-righteous ml-4",children:"CONFIRM PASSWORD"}),h.jsx("input",{type:"password",required:!0,value:k,onChange:K=>L(K.target.value),placeholder:"",className:"w-full bg-[#101015] border-2 border-white/10 rounded-2xl px-8 py-5 text-white font-bold focus:border-[var(--neon-pink)] outline-none transition-all shadow-inner text-3xl tracking-wider placeholder:text-slate-600 font-righteous"})]}),h.jsx("button",{type:"submit",className:"w-full py-6 mt-6 bg-[var(--neon-pink)] hover:bg-white hover:text-black text-white rounded-2xl font-black text-3xl shadow-[0_0_40px_rgba(255,0,127,0.3)] transition-all uppercase tracking-[0.2em] font-bungee hover:scale-[1.02] active:scale-95",children:i?"SIGN IN":"CREATE PROFILE"}),h.jsx("button",{type:"button",onClick:()=>{o(!i),d("")},className:"text-slate-600 hover:text-[var(--neon-cyan)] text-sm font-black uppercase tracking-[0.3em] pt-6 block mx-auto transition-colors font-righteous border-b-2 border-transparent hover:border-[var(--neon-cyan)] pb-1",children:i?"CREATE ACCOUNT":"BACK TO START"})]})]});if(!B||!r)return j.useEffect(()=>{let K;return(Ve==="connecting"||!r)&&(K=setTimeout(()=>{console.warn("[Participant] Connecting timeout reached. Forcing disconnect."),d("Connection timed out. Please check your signal and try again."),V("disconnected"),e(null)},8e3)),()=>clearTimeout(K)},[Ve,r]),h.jsxs("div",{className:"min-h-screen bg-[#050510] flex flex-col items-center justify-center p-8 space-y-12",children:[h.jsx("div",{className:"scale-125 mb-8",children:h.jsx(FV,{})}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute -inset-4 bg-[var(--neon-cyan)]/10 rounded-full blur-xl animate-pulse"}),h.jsxs("div",{className:"relative w-32 h-32",children:[h.jsx("div",{className:"absolute inset-0 border-4 border-[var(--neon-cyan)]/10 border-t-[var(--neon-cyan)] rounded-full animate-spin shadow-[0_0_20px_rgba(0,229,255,0.4)]"}),h.jsx("div",{className:"absolute inset-4 border-4 border-[var(--neon-pink)]/10 border-b-[var(--neon-pink)] rounded-full animate-spin shadow-[0_0_20px_rgba(255,42,109,0.4)]",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),h.jsx("div",{className:"absolute inset-8 border-4 border-white/5 border-l-white/40 rounded-full animate-spin",style:{animationDuration:"3s"}})]})]}),h.jsxs("div",{className:"text-center space-y-4 max-w-xs transition-all",children:[h.jsx("h2",{className:"text-3xl font-black text-white uppercase tracking-[0.4em] font-bungee animate-pulse drop-shadow-[0_0_10px_rgba(255,255,255,0.3)]",children:"Connecting"}),h.jsx("div",{className:"h-1 w-24 bg-gradient-to-r from-transparent via-[var(--neon-cyan)] to-transparent mx-auto opacity-50"}),h.jsx("p",{className:"text-slate-400 font-righteous tracking-[0.2em] text-xs uppercase leading-relaxed",children:pt.getRoomId()?h.jsxs(h.Fragment,{children:["Syncing with Room",h.jsx("br",{}),h.jsx("span",{className:"text-[var(--neon-cyan)] font-bold",children:pt.getRoomId()})]}):"Waiting for session data..."})]}),h.jsx("div",{className:"fixed bottom-12 left-0 right-0 flex justify-center",children:h.jsxs("div",{className:"px-4 py-2 bg-black/40 backdrop-blur-md border border-white/5 rounded-full flex items-center space-x-3",children:[h.jsx("div",{className:`w-2 h-2 rounded-full animate-ping ${Ve==="connected"?"bg-green-500":"bg-amber-500"}`}),h.jsxs("span",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:["Network: ",Ve]})]})})]});const st=B.requests.filter(K=>K.participantId===r.id&&K.status!==Fe.DONE),Wt=B.requests.filter(K=>K.status===Fe.APPROVED&&K.type===Tt.SINGING&&!K.isInRound),Kr=B.participants.filter(K=>Wt.some(ve=>ve.participantId===K.id)).sort((K,ve)=>(ve.joinedAt||0)-(K.joinedAt||0)),on={};Wt.forEach(K=>{on[K.participantId]||(on[K.participantId]=[]),on[K.participantId].push(K)}),Object.keys(on).forEach(K=>{on[K].sort((ve,Oe)=>ve.createdAt-Oe.createdAt)});const zt=[];let Tn=0,er=!0;for(;er;)er=!1,Kr.forEach(K=>{on[K.id]&&on[K.id][Tn]&&(zt.push(on[K.id][Tn]),er=!0)}),Tn++;const qt=zt.findIndex(K=>K.participantId===r.id)+1,tr=(us=B.currentRound)==null?void 0:us.some(K=>K.participantId===r.id&&K.status!==Fe.DONE);return h.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-10 relative",children:[h.jsxs("header",{className:"relative rounded-[3rem] p-1 overflow-hidden shadow-2xl group",children:[h.jsx("div",{className:"absolute inset-0 bg-[#0a0a0a] rounded-[2.9rem]"}),h.jsx("div",{className:"absolute top-0 inset-x-0 h-32 bg-[var(--neon-purple)]/10 blur-[50px]"}),h.jsxs("div",{className:"relative p-8 flex flex-col items-center text-center",children:[h.jsx("div",{className:"absolute top-6 right-6 z-20"}),h.jsxs("div",{className:"w-24 h-24 p-1 rounded-full border-2 border-white/10 mb-6 relative",children:[h.jsx("div",{className:"absolute inset-0 rounded-full bg-[var(--neon-pink)]/20 blur-xl"}),h.jsx("img",{src:"IGK.jpeg",alt:"Logo",className:"w-full h-full rounded-full object-cover relative z-10"}),h.jsx("div",{className:"absolute bottom-0 right-0 w-6 h-6 bg-black rounded-full flex items-center justify-center border-2 border-black z-20",children:h.jsx("div",{className:`w-3 h-3 rounded-full animate-pulse shadow-[0_0_10px_currentColor] ${Ve==="connected"?"bg-[var(--neon-green)] text-[var(--neon-green)]":Ve==="connecting"?"bg-[var(--neon-yellow)] text-[var(--neon-yellow)]":"bg-rose-500 text-rose-500"}`})}),h.jsx("div",{className:"absolute -bottom-2 -left-2 bg-[#101015] border border-white/10 rounded-lg px-2 py-0.5 text-[8px] font-black tracking-widest text-[var(--neon-cyan)] shadow-xl z-30 uppercase font-righteous",children:Ve==="connected"?"P2P+CLOUD":"CLOUD-ONLY"})]}),h.jsx("h2",{className:"text-4xl font-bold text-white tracking-tight uppercase leading-none font-bungee mb-2",children:r.name}),qt>0&&!tr&&h.jsxs("div",{className:"mb-4 px-6 py-2 bg-[var(--neon-cyan)]/10 border border-[var(--neon-cyan)]/30 rounded-full inline-flex items-center gap-3",children:[h.jsx("span",{className:"w-2 h-2 bg-[var(--neon-cyan)] rounded-full animate-pulse"}),h.jsx("span",{className:"text-[var(--neon-cyan)] font-black text-xs uppercase tracking-[0.2em] font-righteous",children:qt===1?"NEXT UP IN ROTATION":`${qt}${qt===2?"ND":qt===3?"RD":"TH"} IN LINE`})]}),tr&&h.jsxs("div",{className:"mb-4 px-6 py-2 bg-[var(--neon-green)]/10 border border-[var(--neon-green)]/30 rounded-full inline-flex items-center gap-3 shadow-[0_0_20px_rgba(0,255,157,0.2)]",children:[h.jsx("span",{className:"w-2 h-2 bg-[var(--neon-green)] rounded-full animate-blink"}),h.jsx("span",{className:"text-[var(--neon-green)] font-black text-xs uppercase tracking-[0.2em] font-righteous",children:"LIVE ON STAGE"})]}),h.jsx("div",{className:"flex items-center gap-3",children:h.jsxs("button",{onClick:()=>{En("Are you sure you want to sign out?",async()=>{await Am(),window.location.reload()})},className:"flex items-center gap-2 px-4 py-2 bg-rose-500/10 hover:bg-rose-500 text-rose-500 hover:text-white rounded-xl transition-all font-black uppercase text-[10px] tracking-widest font-righteous border border-rose-500/20 hover:border-transparent",children:[h.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),h.jsx("polyline",{points:"16 17 21 12 16 7"}),h.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"SIGN OUT"]})})]})]}),B.currentRound&&B.currentRound.length>0&&h.jsxs("section",{className:"animate-in fade-in slide-in-from-top-4",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4 px-4",children:[h.jsx("div",{className:"w-2 h-2 bg-[var(--neon-green)] rounded-full animate-blink"}),h.jsx("h3",{className:"text-[var(--neon-green)] font-black uppercase tracking-[0.3em] text-base font-righteous",children:"ON STAGE"})]}),h.jsx("div",{className:"flex flex-col gap-3",children:B.currentRound.filter(K=>K.status!==Fe.DONE).map((K,ve)=>h.jsxs("div",{className:`p-3 pl-6 pr-4 rounded-xl border-l-8 transition-all duration-300 flex items-center justify-between gap-4 w-full shadow-lg relative overflow-hidden group ${ve===0?"bg-[#001005] border-l-[var(--neon-green)] border-y border-r border-[#1a3320] z-10 scale-[1.01]":"bg-[#0a0a10] border-l-slate-700 border-y border-r border-white/10 opacity-70 hover:opacity-100"}`,children:[h.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_49%,rgba(255,255,255,0.03)_50%,transparent_51%)] bg-[length:50px_100%] pointer-events-none"}),h.jsxs("div",{className:"flex items-center gap-6 min-w-0 flex-1 z-10",children:[h.jsxs("div",{className:"relative",children:[ve===0&&h.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 px-2 py-0.5 bg-[var(--neon-green)] text-black text-[8px] font-black uppercase tracking-[0.2em] rounded animate-pulse shadow-[0_0_10px_var(--neon-green)] z-20",children:"LIVE"}),h.jsx("div",{className:`w-14 h-14 flex flex-col justify-center items-center border-2 rounded-xl transition-all shrink-0 ${ve===0?"border-[var(--neon-green)] bg-[var(--neon-green)]/10 text-[var(--neon-green)]":"border-white/10 text-slate-400"}`,children:h.jsx("span",{className:"text-xl font-bold font-mono tracking-tighter",children:K.requestNumber})})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-baseline gap-1 sm:gap-6 min-w-0 flex-1",children:[h.jsx("h3",{className:`text-xl sm:text-2xl font-black uppercase font-righteous tracking-tight leading-tight ${ve===0?"text-white":"text-slate-300"}`,children:K.songName}),h.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 opacity-80 shrink-0",children:[h.jsx("span",{className:"text-sm sm:text-lg font-bold font-righteous text-[var(--neon-cyan)] uppercase tracking-wider",children:K.artist}),h.jsx("span",{className:"text-slate-600 font-mono text-lg hidden sm:inline",children:"/"}),h.jsxs("span",{className:"text-sm sm:text-lg font-bold font-righteous text-[var(--neon-pink)] uppercase tracking-wider",children:["@",K.participantName]})]})]})]}),h.jsx("div",{className:"flex items-center gap-3 z-10 pl-4 border-l border-white/10 bg-gradient-to-l from-black/80 to-transparent",children:ve===0&&h.jsx(lS,{url:K.youtubeUrl})})]},K.id))})]}),h.jsx("div",{className:"grid grid-cols-5 gap-2 bg-[#0a0a0a] p-2 rounded-2xl border border-white/5 shadow-inner",children:["ROTATION","REQUESTS","FAVORITES","HISTORY","VOCALS"].map(K=>h.jsxs("button",{onClick:()=>R(K),className:`py-3 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all font-righteous flex flex-col items-center justify-center gap-1.5 ${I===K?"bg-[#151520] text-white shadow-[0_0_20px_rgba(255,255,255,0.05)] border border-white/10":"text-slate-600 hover:text-white hover:bg-white/5"}`,children:[h.jsx("span",{className:`text-2xl mb-0.5 ${I===K?"text-[var(--neon-pink)]":"grayscale opacity-50"}`,children:K==="ROTATION"?"":K==="REQUESTS"?"":K==="FAVORITES"?"":K==="HISTORY"?"":""}),K==="ROTATION"?"STAGE":K==="REQUESTS"?"MY SONGS":K==="FAVORITES"?"SONGBOOK":K==="HISTORY"?"LOG":"MIC SETUP"]},K))}),h.jsx("button",{onClick:()=>{C(null),ee(!0)},className:"w-full py-8 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-blue)] text-white rounded-[2.5rem] font-black text-4xl shadow-[0_0_60px_rgba(255,0,127,0.4)] uppercase tracking-[0.1em] active:scale-95 transition-all font-bungee hover:brightness-110 border-4 border-white/10 animate-pulse",children:"SING!"}),h.jsxs("div",{className:"flex gap-4 pt-2",children:[h.jsx("button",{onClick:()=>Bn(dn.READY),className:`flex-1 py-4 rounded-[1.5rem] font-bold text-xl uppercase tracking-wider transition-all border-2 flex items-center justify-center gap-2 group relative overflow-hidden font-bungee ${r.status===dn.READY?"bg-[#051005] border-[var(--neon-green)] shadow-[0_0_30px_rgba(0,255,157,0.2)] text-[var(--neon-green)]":"bg-[#101015] border-white/5 text-slate-700 hover:border-white/10"}`,children:h.jsx("span",{className:"relative z-10",children:"READY"})}),h.jsx("button",{onClick:()=>Bn(dn.STANDBY),className:`flex-1 py-4 rounded-[1.5rem] font-bold text-xl uppercase tracking-wider transition-all border-2 flex items-center justify-center gap-2 group relative overflow-hidden font-bungee ${r.status===dn.STANDBY?"bg-[#150505] border-rose-500 shadow-[0_0_30px_rgba(244,63,94,0.2)] text-rose-500":"bg-[#101015] border-white/5 text-slate-700 hover:border-white/10"}`,children:h.jsx("span",{className:"relative z-10",children:"NOT YET"})})]}),(re||le)&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-50 overflow-y-auto backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsx("div",{className:"w-full max-w-lg space-y-6",children:h.jsx(PA,{title:le?"Remix Request":"New Transmission",submitLabel:le?"Save Remix":"Transmit",initialSongName:(le==null?void 0:le.songName)||(ce==null?void 0:ce.songName)||"",initialArtist:(le==null?void 0:le.artist)||(ce==null?void 0:ce.artist)||"",initialYoutubeUrl:(le==null?void 0:le.youtubeUrl)||(ce==null?void 0:ce.youtubeUrl)||"",initialType:(le==null?void 0:le.type)||(ce==null?void 0:ce.type)||Tt.SINGING,onSubmit:Cs,onCancel:Rs,participants:B.participants,currentUserId:r.id},(le==null?void 0:le.id)||"new-request")})}),h.jsxs("main",{className:"min-h-[300px] pb-32",children:[I==="ROTATION"&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-6",children:[h.jsx("h3",{className:"text-[var(--neon-green)] font-black uppercase tracking-[0.3em] text-sm px-4 font-righteous opacity-80",children:"COMING UP"}),h.jsx("div",{className:"space-y-4",children:zt.length===0?h.jsx("div",{className:"text-center py-16 opacity-30 border-2 border-dashed border-white/5 rounded-[2.5rem] bg-black/20",children:h.jsx("p",{className:"text-sm font-black uppercase tracking-[0.4em] font-righteous text-slate-600",children:"QUEUE EMPTY"})}):zt.map((K,ve)=>h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 p-6 rounded-[2rem] flex justify-between items-center group hover:border-[var(--neon-blue)] transition-all",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-white font-bold uppercase truncate text-2xl font-bungee tracking-tight mb-1 group-hover:text-[var(--neon-blue)] transition-colors",children:K.songName}),h.jsxs("div",{className:"text-base text-[var(--neon-cyan)] uppercase tracking-[0.2em] flex items-center gap-2 font-righteous",children:[K.artist," ",h.jsx("span",{className:"text-white/20",children:"|"})," ",h.jsx("span",{className:"text-slate-400",children:K.participantName})]})]}),h.jsx("div",{className:"shrink-0 w-12 h-12 rounded-full border border-[var(--neon-blue)]/50 bg-[var(--neon-blue)]/10 flex items-center justify-center text-[var(--neon-blue)] text-xl font-black font-bungee shadow-[0_0_15px_rgba(5,217,232,0.2)]",children:ve+1})]},K.id))})]}),I==="REQUESTS"&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-4",children:[ye.filter(K=>K.type==="ADD_REQUEST"&&K.payload.participantId===(r==null?void 0:r.id)).map((K,ve)=>h.jsx("div",{className:"relative group opacity-60",children:h.jsxs("div",{className:"bg-[#151520] border-2 border-dashed border-[var(--neon-cyan)]/30 p-6 rounded-[2rem]",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"flex items-center gap-3 mb-2",children:h.jsx("div",{className:"font-bold text-white tracking-tight uppercase truncate font-bungee text-3xl italic",children:K.payload.songName})}),h.jsx("div",{className:"text-base text-slate-400 font-bold uppercase tracking-[0.2em] truncate font-righteous",children:K.payload.artist})]}),h.jsxs("div",{className:"shrink-0 flex flex-col items-end gap-2",children:[h.jsx("div",{className:"px-3 py-1 rounded-lg border border-[var(--neon-cyan)]/30 text-[var(--neon-cyan)] text-xs font-black uppercase tracking-widest animate-pulse",children:"SENDING..."}),h.jsx("div",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-tight",children:"Trying direct link & cloud backup"})]})]}),h.jsx("div",{className:"mt-4 text-[10px] text-[var(--neon-cyan)] font-bold tracking-widest uppercase opacity-60 font-mono",children:"CLOUD BUFFERED // AUTO-RETRYING"})]})},`pending-${ve}`)),st.map(K=>h.jsx("div",{className:"relative group",children:h.jsxs("div",{className:"bg-[#151520] border-2 border-white/5 p-6 rounded-[2rem] hover:border-[var(--neon-pink)] transition-all",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsxs("div",{className:"font-bold text-white tracking-tight uppercase truncate font-bungee text-3xl group-hover:text-[var(--neon-pink)] transition-colors",children:[h.jsxs("span",{className:"text-slate-500 mr-2 text-[11px] font-mono tracking-widest",children:["#",K.requestNumber]}),K.songName]}),h.jsx(lS,{url:K.youtubeUrl})]}),h.jsx("div",{className:"text-base text-slate-400 font-bold uppercase tracking-[0.2em] truncate font-righteous",children:K.artist})]}),h.jsx("div",{className:`shrink-0 px-3 py-1 rounded-lg border text-xs font-black uppercase tracking-widest ${K.status===Fe.APPROVED?K.isInRound?"bg-[var(--neon-green)] border-[var(--neon-green)] text-black animate-pulse shadow-[0_0_15px_var(--neon-green)]":"bg-[var(--neon-cyan)]/10 border-[var(--neon-cyan)] text-[var(--neon-cyan)]":"border-white/10 text-slate-600"}`,children:K.status===Fe.APPROVED?K.isInRound?"LIVE":"QUEUED":"PENDING"})]}),(K.status===Fe.PENDING||K.status===Fe.APPROVED)&&h.jsxs("div",{className:"flex gap-3 pt-4 border-t border-white/5",children:[h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:async()=>{await cv(r.id,K.id,"up"),await Ke()},className:"w-10 h-10 bg-white/5 hover:bg-white/10 rounded-xl flex items-center justify-center text-white transition-all text-xl",title:"Move Up",children:""}),h.jsx("button",{onClick:async()=>{await cv(r.id,K.id,"down"),await Ke()},className:"w-10 h-10 bg-white/5 hover:bg-white/10 rounded-xl flex items-center justify-center text-white transition-all text-xl",title:"Move Down",children:""})]}),h.jsx("button",{onClick:()=>fe(K),className:"flex-1 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-sm font-black uppercase tracking-widest transition-all font-righteous text-white",children:"EDIT"}),h.jsx("button",{onClick:async()=>{await Da(K.id),await Ke()},className:"flex-1 py-3 bg-rose-500/10 hover:bg-rose-500/20 rounded-xl text-sm font-black uppercase tracking-widest transition-all font-righteous text-rose-500",children:"CANCEL"})]})]})},K.id)),st.length===0&&h.jsx("div",{className:"text-center py-20 bg-black/20 rounded-[3rem] border-2 border-dashed border-white/5",children:h.jsx("p",{className:"text-base font-black uppercase tracking-[0.5em] font-righteous text-slate-700",children:"NO REQUESTS"})})]}),I==="FAVORITES"&&t&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-6",children:[h.jsxs("div",{className:"relative group",children:[h.jsx("input",{type:"text",placeholder:"SEARCH SONGBOOK...",value:M,onChange:K=>O(K.target.value),className:"w-full bg-[#101015] border-2 border-white/10 rounded-[2rem] py-5 px-6 pl-14 text-xl font-bold uppercase tracking-wider text-white focus:outline-none focus:border-[var(--neon-pink)] transition-all font-righteous placeholder:text-slate-600 shadow-inner"}),h.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-2xl text-slate-600 group-focus-within:text-[var(--neon-pink)] transition-colors",children:""})]}),h.jsx("div",{className:"grid gap-3",children:(()=>{const K=[...t.favorites.map(ve=>({...ve,isFavorite:!0})),...((B==null?void 0:B.verifiedSongbook)||[]).filter(ve=>!t.favorites.some(Oe=>Oe.songName===ve.songName&&Oe.artist===ve.artist)).map(ve=>({...ve,isFavorite:!1}))].filter(ve=>!M||ve.songName.toLowerCase().includes(M.toLowerCase())||ve.artist.toLowerCase().includes(M.toLowerCase()));return K.length===0?h.jsx("div",{className:"text-center py-20 opacity-30 font-righteous text-sm uppercase tracking-widest text-slate-500",children:"NO_MATCHES"}):K.map(ve=>h.jsxs("div",{className:"bg-[#101015] p-5 rounded-[2rem] flex justify-between items-center group border-2 border-white/5 hover:border-[var(--neon-yellow)] transition-all",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("div",{className:"text-white font-bold uppercase truncate text-2xl font-bungee tracking-tight group-hover:text-[var(--neon-yellow)] transition-colors",children:ve.songName}),ve.isFavorite&&h.jsx("span",{className:"text-lg text-[var(--neon-yellow)] animate-pulse",children:""})]}),h.jsx("div",{className:"text-sm text-slate-400 font-bold uppercase tracking-[0.2em] font-righteous",children:ve.artist})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>{C({...ve}),ee(!0)},className:"bg-[var(--neon-pink)] text-black px-4 py-2 rounded-xl font-black text-xs uppercase tracking-widest hover:bg-white transition-all font-righteous shadow-[0_0_15px_rgba(255,0,127,0.3)] hover:scale-105 active:scale-95",children:"ADD"}),h.jsx("button",{onClick:async()=>{await CA(ve),await Ke()},className:`px-2 transition-colors ${ve.isFavorite?"text-rose-500":"text-slate-700 hover:text-[var(--neon-yellow)]"}`,children:ve.isFavorite?"":""})]})]},ve.id))})()})]}),I==="HISTORY"&&t&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-4",children:[t.personalHistory.map((K,ve)=>h.jsxs("div",{className:"bg-[#101015] p-6 rounded-[2rem] flex justify-between items-center border-2 border-white/5 hover:border-[var(--neon-purple)] group transition-all",children:[h.jsxs("div",{className:"min-w-0 pr-4",children:[h.jsx("div",{className:"text-white font-bold uppercase truncate text-2xl font-bungee tracking-tight mb-1 group-hover:text-[var(--neon-purple)] transition-colors",children:K.songName}),h.jsx("div",{className:"text-base text-[var(--neon-cyan)]/70 font-bold uppercase tracking-[0.2em] font-righteous",children:K.artist})]}),h.jsx("button",{onClick:()=>{C({...K,type:Tt.SINGING}),ee(!0)},className:"text-slate-600 hover:text-white border border-white/5 hover:border-white px-4 py-2 rounded-xl font-black text-xs uppercase tracking-widest transition-all font-righteous",children:"AGAIN"})]},ve)),t.personalHistory.length===0&&h.jsx("div",{className:"text-center py-20 opacity-30 border-2 border-dashed border-white/5 rounded-[2.5rem] bg-black/20",children:h.jsx("p",{className:"text-sm font-black uppercase tracking-[0.4em] font-righteous text-slate-600",children:"NO HISTORY FOUND"})})]}),I==="VOCALS"&&h.jsxs("section",{className:"animate-in slide-in-from-bottom-8 duration-500 space-y-6",children:[h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[2.5rem] p-8 relative overflow-hidden group hover:border-[var(--neon-cyan)] transition-all",children:[h.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20 group-hover:opacity-100 transition-opacity",children:h.jsx("span",{className:"text-5xl",children:""})}),h.jsx("h3",{className:"text-[var(--neon-cyan)] font-black uppercase tracking-[0.3em] font-righteous mb-6",children:"VOCAL SETUP"}),h.jsxs("div",{className:"flex flex-col items-center gap-6",children:[h.jsxs("div",{className:"w-full bg-black/40 border border-white/10 rounded-2xl p-6 flex flex-col items-center",children:[h.jsx("span",{className:"text-sm font-black text-slate-500 uppercase tracking-widest font-righteous mb-2",children:"SINGER RANGE"}),h.jsx("span",{className:"text-4xl font-bold text-white uppercase font-bungee tracking-tight neon-text-glow-cyan",children:(t==null?void 0:t.vocalRange)||"UNKNOWN"})]}),qe?h.jsxs("div",{className:"w-full space-y-3 py-2",children:[h.jsx("div",{className:"h-2 bg-white/5 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-[var(--neon-cyan)] animate-pulse shadow-[0_0_10px_var(--neon-cyan)]",style:{width:`${Z}%`}})}),h.jsx("div",{className:"text-xs text-[var(--neon-cyan)] font-black animate-pulse font-righteous text-center tracking-[0.2em]",children:"CALIBRATING VOICE..."})]}):h.jsx("button",{onClick:async()=>{gt(!0);let K=0;const ve=setInterval(()=>{K+=5,he(K),K>=100&&(clearInterval(ve),setTimeout(async()=>{const Oe=["Soprano","Alto","Tenor","Baritone","Bass"],Le=Oe[Math.floor(Math.random()*Oe.length)];t&&await OM(t.id,Le),gt(!1),he(0),await Ke()},500))},100)},className:"px-8 py-4 bg-[var(--neon-cyan)]/10 hover:bg-[var(--neon-cyan)] text-[var(--neon-cyan)] hover:text-black rounded-xl font-black uppercase tracking-[0.2em] transition-all font-righteous border border-[var(--neon-cyan)]/30 hover:shadow-[0_0_20px_var(--neon-cyan)]",children:"START_CALIBRATION_SEQUENCE"})]})]}),h.jsxs("div",{className:"bg-[#101015] border-2 border-white/5 rounded-[2.5rem] p-8 opacity-50 relative overflow-hidden border-dashed",children:[h.jsx("h3",{className:"text-slate-500 font-black uppercase tracking-[0.3em] font-righteous mb-2",children:"MICROPHONE_TOOLS"}),h.jsx("p",{className:"text-slate-600 font-mono text-xs uppercase tracking-wider",children:"HARDWARE_LINK_OFFLINE // COMING_SOON"})]})]})]}),h.jsxs("footer",{className:"fixed bottom-6 left-6 right-6 z-40 flex gap-4 pointer-events-none",children:[h.jsx("div",{className:"flex-1 pointer-events-auto",children:(Ve!=="connected"||Re&&Je!==Re)&&h.jsxs("button",{onClick:fr,disabled:Ve==="connecting",className:`w-full border-2 p-4 rounded-[2rem] flex items-center justify-between px-8 shadow-2xl transition-all group ${Ve==="connecting"?"bg-amber-500/10 border-amber-500/30 text-amber-500":"bg-[#101015] border-[var(--neon-green)]/30 text-[var(--neon-green)] hover:bg-[var(--neon-green)] hover:text-black hover:border-[var(--neon-green)]"}`,children:[h.jsx("span",{className:"text-sm font-black uppercase tracking-[0.3em] font-righteous",children:Ve==="connecting"?"CONNECTING...":"RECONNECT"}),h.jsx("span",{className:`text-2xl transition-transform ${Ve==="connecting"?"animate-spin":"group-hover:scale-125"}`,children:Ve==="connecting"?"":""})]})}),h.jsx("div",{className:"shrink-0 pointer-events-auto",children:h.jsx("button",{onClick:()=>D(!0),className:"w-14 h-14 bg-[#101015] border-2 border-white/10 rounded-[1.2rem] flex items-center justify-center shadow-2xl hover:border-[var(--neon-pink)] transition-all group relative overflow-hidden",title:"SYSTEM LINK",children:h.jsxs("div",{className:"w-8 h-8 grid grid-cols-2 gap-0.5 p-1 bg-white/5 rounded-md group-hover:bg-[var(--neon-pink)]/20 transition-colors",children:[h.jsx("div",{className:"border border-white/40 rounded-[2px] bg-white/10"}),h.jsx("div",{className:"border border-white/40 rounded-[2px] bg-white/10"}),h.jsx("div",{className:"border border-white/40 rounded-[2px] bg-white/10"}),h.jsx("div",{className:"relative",children:h.jsx("div",{className:"absolute inset-0.5 bg-[var(--neon-pink)] animate-pulse rounded-[1px]"})})]})})})]}),Te&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-8 z-[200] animate-in zoom-in-95 duration-300",children:h.jsxs("div",{className:"w-full max-w-4xl text-center relative bg-[#050510] border-4 border-white/10 rounded-[3rem] p-4 md:p-10 overflow-hidden max-h-[90vh] overflow-y-auto",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-green)] via-[var(--neon-cyan)] to-[var(--neon-blue)] animate-gradient-x"}),h.jsx("button",{onClick:()=>Me(!1),className:"absolute top-6 right-6 text-slate-700 hover:text-white text-3xl transition-colors z-50",children:""}),h.jsx("h3",{className:"text-4xl md:text-5xl font-black text-white uppercase tracking-tight mb-8 font-bungee neon-glow-green mt-8",children:"RECONNECT"}),h.jsx(BV,{onJoin:K=>{window.location.search=`?room=${K}`},filterHostName:"SingMode DJ"})]})}),U&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-8 z-[200] animate-in zoom-in-95 duration-300",children:h.jsxs("div",{className:"w-full max-w-sm text-center relative bg-[#050510] border-4 border-white/10 rounded-[3rem] p-10 overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] animate-gradient-x"}),h.jsx("button",{onClick:()=>D(!1),className:"absolute top-6 right-6 text-slate-700 hover:text-white text-3xl transition-colors",children:""}),h.jsx("div",{className:"bg-white p-4 rounded-[2rem] inline-block shadow-[0_0_40px_rgba(255,255,255,0.1)]",children:h.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(rt)}&bgcolor=ffffff`,alt:"Room QR",className:"w-48 h-48"})})]})}),$e.isOpen&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[300] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-md bg-[#050510] border-4 border-[var(--neon-pink)]/30 rounded-[3rem] p-10 text-center shadow-[0_0_100px_rgba(255,42,109,0.3)] animate-in zoom-in-95 duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-[var(--neon-pink)] shadow-[0_0_20px_rgba(255,42,109,0.8)]"}),h.jsx("div",{className:"w-20 h-20 bg-[var(--neon-pink)]/10 text-[var(--neon-pink)] rounded-[2rem] border-2 border-[var(--neon-pink)]/20 flex items-center justify-center mx-auto mb-6 text-4xl font-black shadow-[0_0_30px_rgba(255,42,109,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-text-glow-pink",children:"CONFIRM"}),h.jsx("p",{className:"text-slate-400 text-lg mb-8 leading-relaxed font-black font-righteous uppercase tracking-widest",children:$e.message}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>Zn(K=>({...K,isOpen:!1})),className:"flex-1 py-4 bg-black border-2 border-white/10 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous transition-all hover:bg-white/5",children:"CANCEL"}),h.jsx("button",{onClick:async()=>{Zn(K=>({...K,isOpen:!1})),await $e.onConfirm()},className:"flex-[2] py-4 bg-[var(--neon-pink)] text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous shadow-[0_0_30px_rgba(255,42,109,0.4)] transition-all hover:bg-rose-400 hover:scale-105",children:"PROCEED"})]})]})})]})},nc=({title:r,icon:e,description:t,items:n})=>h.jsxs("div",{className:"bg-[#101015] border border-white/5 p-10 rounded-[3.5rem] hover:border-[var(--neon-pink)] transition-all backdrop-blur-xl group relative overflow-hidden shadow-2xl",children:[h.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[var(--neon-pink)]/5 blur-3xl rounded-full -mr-16 -mt-16 group-hover:bg-[var(--neon-pink)]/10 transition-colors"}),h.jsx("div",{className:"w-20 h-20 bg-black border border-white/10 rounded-2xl flex items-center justify-center text-4xl mb-8 group-hover:scale-110 group-hover:border-[var(--neon-pink)] group-hover:text-white transition-all shadow-2xl relative z-10",children:e}),h.jsx("h3",{className:"text-3xl font-bold text-white font-bungee uppercase mb-4 tracking-tight group-hover:text-[var(--neon-pink)] transition-colors relative z-10 leading-none",children:r}),h.jsx("p",{className:"text-[var(--neon-cyan)]/70 mb-8 font-bold uppercase text-[10px] tracking-[0.2em] font-righteous leading-relaxed relative z-10 transition-opacity",children:t}),h.jsx("ul",{className:"space-y-4 relative z-10",children:n.map((i,o)=>h.jsxs("li",{className:"flex items-start gap-3 text-[11px] text-slate-500 font-bold uppercase tracking-widest font-righteous group-hover:text-[var(--neon-cyan)] transition-colors",children:[h.jsx("span",{className:"text-[var(--neon-cyan)] font-bold",children:""}),i]},o))})]}),qV=({onBack:r,onAdminLogin:e})=>{const t=()=>{prompt("Enter Admin Password:")==="Organized"?e():alert("Access Denied: Incorrect Password")};return h.jsxs("div",{className:"min-h-screen bg-[#050510] text-slate-200 p-6 md:p-16 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] z-50 animate-gradient-x"}),h.jsx("div",{className:"absolute -top-[500px] -right-[500px] w-[1000px] h-[1000px] bg-[var(--neon-pink)]/5 blur-[200px] rounded-full"}),h.jsx("div",{className:"absolute -bottom-[500px] -left-[500px] w-[1000px] h-[1000px] bg-[var(--neon-cyan)]/5 blur-[200px] rounded-full"}),h.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('/grid.svg')] opacity-5 pointer-events-none"}),h.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[h.jsxs("div",{className:"flex justify-between items-center mb-24 animate-in fade-in slide-in-from-top-4 duration-700",children:[h.jsx("div",{onClick:r,className:"cursor-pointer hover:scale-105 transition-transform",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("img",{src:"IGK.jpeg",alt:"Logo",className:"w-10 h-10 rounded-full border border-[var(--neon-pink)]"}),h.jsx("span",{className:"font-bungee text-xl text-white tracking-widest",children:"Singmode Beta"})]})}),h.jsx("button",{onClick:r,className:"px-8 py-4 bg-black border border-white/10 hover:border-[var(--neon-pink)] text-slate-400 hover:text-white rounded-2xl font-bold text-[9px] uppercase tracking-widest font-righteous transition-all",children:"RETURN TO HUB"})]}),h.jsxs("div",{className:"text-center max-w-4xl mx-auto mb-32 animate-in fade-in zoom-in duration-700 delay-100",children:[h.jsxs("h1",{className:"text-6xl md:text-8xl font-bold font-bungee text-white mb-8 tracking-tight uppercase leading-none neon-text-glow-purple",children:["The ultimate ",h.jsx("span",{className:"text-[var(--neon-cyan)]",children:"karaoke"})," os"]}),h.jsx("p",{className:"text-[10px] md:text-xs text-[var(--neon-cyan)]/80 font-bold uppercase tracking-[0.4em] font-righteous leading-relaxed max-w-2xl mx-auto border-y border-[var(--neon-cyan)]/20 py-4",children:"Singmode Beta transforms any arena into a high-fidelity visual theater. Connect instantly, dominate the queue, and emit your signal."})]}),h.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-32 animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-200",children:[h.jsx(nc,{title:"DJ Console",icon:"",description:"The command center for your sessions. Maintain signal flow.",items:["Real-time Queue Logic","Drag & Drop Sequencer","Instant Signal Auth","Master Output Control"]}),h.jsx(nc,{title:"Singer Web",icon:"",description:"A personal terminal for every guest. Eliminate analog friction.",items:["Identity Transmission","Smart Vector Search","High-Speed Requests","Live Sync Lyrics"]}),h.jsx(nc,{title:"Theater Box",icon:"",description:"A stunning visual matrix for the main screen. Pure aesthetics.",items:["Ultra-HD Playback","Generative Backgrounds","Active HUD Overlays","QR Signal Entrance"]}),h.jsx(nc,{title:"Hybrid AI",icon:"",description:"Gemini integration enhances the arena with predictive logic.",items:["Vibe-Matched Vectors","Dynamic Visual Synthesis","Automated Interstitials","Identity Verification"]}),h.jsx(nc,{title:"Sync Matrix",icon:"",description:"Real-time P2P technology keeps the cluster in perfect sync.",items:["Zero-Latency State","Decentralized Design","Instant Node Creation","Omni-Device Support"]}),h.jsx(nc,{title:"Prime Suite",icon:"",description:"Unlock premium protocols for venues and power units.",items:["Broadcast Protocols","Branding Overlays","Logic Routing","Priority Channel"]}),h.jsxs("div",{className:"md:col-span-2 lg:col-span-1 border-2 border-dashed border-white/10 rounded-[3.5rem] flex flex-col items-center justify-center p-10 group hover:border-[var(--neon-cyan)] transition-all",children:[h.jsx("p",{className:"text-[10px] text-slate-700 font-black uppercase tracking-[0.4em] mb-6 font-righteous group-hover:text-[var(--neon-cyan)]",children:"ADMIN LOGIN"}),h.jsx("button",{onClick:t,className:"p-6 bg-black border border-white/5 rounded-2xl text-[10px] font-black uppercase tracking-widest font-righteous text-white/40 hover:text-white hover:border-white transition-all shadow-xl",children:" ENTER ADMIN MODE"})]})]}),h.jsx("div",{className:"text-center animate-in fade-in duration-700 delay-500 pb-32",children:h.jsx("button",{onClick:r,className:"px-16 py-8 bg-[var(--neon-cyan)] hover:bg-white text-black rounded-[3rem] font-bold text-2xl uppercase tracking-widest font-righteous shadow-[0_0_50px_rgba(34,211,238,0.4)] hover:scale-105 transition-all",children:"START SINGING"})})]})]})},HV=({onBack:r})=>{const[e,t]=j.useState(null),[n,i]=j.useState(""),[o,c]=j.useState(!1),[d,f]=j.useState({primary:"#ff007f",secondary:"#05d9e8",accent:"#feff3f"}),[m,v]=j.useState({isOpen:!1,message:"",onConfirm:()=>{}}),b=(S,k)=>{v({isOpen:!0,message:S,onConfirm:k})};j.useEffect(()=>{(async()=>{const k=await nt();t(k),k.brandIdentity&&(i(k.brandIdentity.venueName),c(k.brandIdentity.isBusinessAccount)),k.customTheme&&f({primary:k.customTheme.primaryNeon,secondary:k.customTheme.secondaryNeon,accent:k.customTheme.accentNeon})})()},[]);const _=async()=>{var k;if(!e)return;const S={...e};S.brandIdentity={venueName:n,isBusinessAccount:o,logoUrl:(k=S.brandIdentity)==null?void 0:k.logoUrl},S.customTheme={primaryNeon:d.primary,secondaryNeon:d.secondary,accentNeon:d.accent},await Ct(S),document.documentElement.style.setProperty("--neon-pink",d.primary),document.documentElement.style.setProperty("--neon-cyan",d.secondary),document.documentElement.style.setProperty("--neon-yellow",d.accent),alert("Configurations locked in.")};return e?h.jsxs("div",{className:"min-h-screen bg-[#050510] text-white p-6 md:p-16 relative overflow-hidden font-righteous",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-pink)] via-[var(--neon-purple)] to-[var(--neon-cyan)] z-50 animate-gradient-x"}),h.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[h.jsxs("header",{className:"flex justify-between items-center mb-20 animate-in fade-in slide-in-from-top-4 duration-700",children:[h.jsxs("div",{onClick:r,className:"cursor-pointer group flex items-center gap-4",children:[h.jsx("img",{src:"IGK.jpeg",alt:"Logo",className:"w-12 h-12 rounded-full border-2 border-[var(--neon-pink)] group-hover:scale-110 transition-all"}),h.jsx("h1",{className:"text-3xl font-bungee tracking-tight",children:"ADMIN SETTINGS"})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:r,className:"px-6 py-3 bg-black border border-white/10 hover:border-white text-slate-500 hover:text-white rounded-xl text-[10px] uppercase tracking-widest transition-all",children:"DJ VIEW"}),h.jsxs("button",{onClick:()=>{b("Are you sure you want to sign out?",async()=>{await Am(),window.location.reload()})},className:"px-6 py-3 bg-rose-500/10 border border-rose-500/30 hover:bg-rose-500 text-rose-500 hover:text-white rounded-xl text-[10px] uppercase tracking-widest transition-all flex items-center gap-2",children:[h.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:[h.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),h.jsx("polyline",{points:"16 17 21 12 16 7"}),h.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"LOG OUT"]})]})]}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-10",children:[h.jsxs("section",{className:"bg-black/40 border-2 border-white/5 rounded-[3rem] p-10 space-y-8 shadow-2xl",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bungee text-[var(--neon-cyan)] mb-2 uppercase",children:"Venue Settings"}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-widest font-black opacity-60",children:"VENUE DISPLAY"})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[9px] text-slate-500 uppercase tracking-widest mb-2 ml-4",children:"Venue Display Name"}),h.jsx("input",{type:"text",value:n,onChange:S=>i(S.target.value),placeholder:"Enter Venue Name",className:"w-full bg-black/60 border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-bold outline-none focus:border-[var(--neon-cyan)] transition-all uppercase"})]}),h.jsxs("div",{className:"flex items-center justify-between p-6 bg-white/5 rounded-2xl border border-white/5",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-xs font-black uppercase tracking-widest mb-1",children:"Business Account"}),h.jsx("p",{className:"text-[9px] text-slate-500 uppercase font-bold",children:"Unlocks Revenue Stream Matrix"})]}),h.jsx("button",{onClick:()=>c(!o),className:`w-14 h-8 rounded-full transition-all relative ${o?"bg-[var(--neon-cyan)]":"bg-slate-800"}`,children:h.jsx("div",{className:`absolute top-1 w-6 h-6 rounded-full bg-white transition-all ${o?"right-1":"left-1"}`})})]})]})]}),h.jsxs("section",{className:"bg-black/40 border-2 border-white/5 rounded-[3rem] p-10 space-y-8 shadow-2xl",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bungee text-[var(--neon-pink)] mb-2 uppercase",children:"Theme Matrix"}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-widest font-black opacity-60",children:"THEME COLORS"})]}),h.jsx("div",{className:"space-y-6",children:h.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[h.jsxs("div",{className:"flex items-center justify-between bg-white/5 p-4 rounded-xl border border-white/5",children:[h.jsx("label",{className:"text-[10px] uppercase font-black tracking-widest",children:"Primary Neon"}),h.jsx("input",{type:"color",value:d.primary,onChange:S=>f({...d,primary:S.target.value}),className:"bg-transparent border-none w-10 h-10 cursor-pointer"})]}),h.jsxs("div",{className:"flex items-center justify-between bg-white/5 p-4 rounded-xl border border-white/5",children:[h.jsx("label",{className:"text-[10px] uppercase font-black tracking-widest",children:"Secondary Neon"}),h.jsx("input",{type:"color",value:d.secondary,onChange:S=>f({...d,secondary:S.target.value}),className:"bg-transparent border-none w-10 h-10 cursor-pointer"})]}),h.jsxs("div",{className:"flex items-center justify-between bg-white/5 p-4 rounded-xl border border-white/5",children:[h.jsx("label",{className:"text-[10px] uppercase font-black tracking-widest",children:"Accent Neon"}),h.jsx("input",{type:"color",value:d.accent,onChange:S=>f({...d,accent:S.target.value}),className:"bg-transparent border-none w-10 h-10 cursor-pointer"})]})]})})]}),h.jsxs("section",{className:"bg-black/40 border-2 border-white/5 rounded-[3rem] p-10 space-y-8 shadow-2xl col-span-full",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bungee text-rose-500 mb-2 uppercase",children:"System Maintenance"}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase tracking-widest font-black opacity-60",children:"DATABASE PURGE OPERATIONS"})]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[h.jsxs("div",{className:"flex-1 p-6 bg-white/5 rounded-2xl border border-white/5",children:[h.jsx("h4",{className:"text-xs font-black uppercase tracking-widest mb-1 text-white",children:"Account Optimization"}),h.jsx("p",{className:"text-[9px] text-slate-500 uppercase font-bold mb-4",children:"Deletes all guests and duplicate entries"}),h.jsx("button",{onClick:()=>{b("DANGER: This will permanently delete all guest accounts and duplicate stage names. Proceed?",async()=>{const S=await AA();S.success?alert(`Cleanup complete. Deleted ${S.deletedCount} items.`):alert(`Cleanup failed: ${S.error}`)})},className:"px-6 py-3 bg-rose-500/10 border border-rose-500 hover:bg-rose-500 text-rose-500 hover:text-white rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:"PURGE GUESTS & DUPLICATES"})]}),h.jsxs("div",{className:"flex-1 p-6 bg-white/5 rounded-2xl border border-white/5",children:[h.jsx("h4",{className:"text-xs font-black uppercase tracking-widest mb-1 text-white",children:"Signal Maintenance"}),h.jsx("p",{className:"text-[9px] text-slate-500 uppercase font-bold mb-4",children:"Cleans up dead or abandoned stage signals"}),h.jsx("button",{onClick:()=>{b("This will remove all inactive or stale stage sessions from the public list. Proceed?",async()=>{const S=await HM();S.success?alert(`Signal cleanup complete. Removed ${S.deletedCount} stale sessions.`):alert(`Cleanup failed: ${S.error}`)})},className:"px-6 py-3 bg-[var(--neon-purple)]/10 border border-[var(--neon-purple)] hover:bg-[var(--neon-purple)] text-[var(--neon-purple)] hover:text-white rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:"PURGE STALE SIGNALS"})]})]})]})]}),h.jsx("div",{className:"mt-12 flex justify-center",children:h.jsx("button",{onClick:_,className:"px-16 py-6 bg-white text-black rounded-[2rem] font-bold text-xl uppercase tracking-widest font-bungee hover:bg-[var(--neon-cyan)] transition-all shadow-2xl hover:scale-105 active:scale-95",children:"SAVE CHANGES"})})]}),m.isOpen&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-4 z-[300] backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-md bg-[#050510] border-4 border-[var(--neon-pink)]/30 rounded-[3rem] p-10 text-center shadow-[0_0_100px_rgba(255,42,109,0.3)] animate-in zoom-in-95 duration-300 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-[var(--neon-pink)] shadow-[0_0_20px_rgba(255,42,109,0.8)]"}),h.jsx("div",{className:"w-20 h-20 bg-[var(--neon-pink)]/10 text-[var(--neon-pink)] rounded-[2rem] border-2 border-[var(--neon-pink)]/20 flex items-center justify-center mx-auto mb-6 text-4xl font-black shadow-[0_0_30px_rgba(255,42,109,0.2)] animate-pulse",children:""}),h.jsx("h2",{className:"text-5xl font-black text-white uppercase mb-4 tracking-tight font-bungee neon-text-glow-pink",children:"CONFIRM"}),h.jsx("p",{className:"text-slate-400 text-lg mb-8 leading-relaxed font-black font-righteous uppercase tracking-widest",children:m.message}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>v(S=>({...S,isOpen:!1})),className:"flex-1 py-4 bg-black border-2 border-white/10 text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous transition-all hover:bg-white/5",children:"CANCEL"}),h.jsx("button",{onClick:async()=>{v(S=>({...S,isOpen:!1})),await m.onConfirm()},className:"flex-[2] py-4 bg-[var(--neon-pink)] text-white rounded-xl text-base font-black uppercase tracking-widest font-righteous shadow-[0_0_30px_rgba(255,42,109,0.4)] transition-all hover:bg-rose-400 hover:scale-105",children:"PROCEED"})]})]})})]}):null},$V=()=>{const[r,e]=j.useState("SELECT"),[t,n]=j.useState(!0),[i,o]=j.useState(null),[c,d]=j.useState(!1),[f,m]=j.useState(!1),[v,b]=j.useState("");j.useEffect(()=>{(async()=>{var C;const re=new URLSearchParams(window.location.search),ee=(C=re.get("view"))==null?void 0:C.toUpperCase(),le=re.get("userId"),fe=re.get("room");(fe||le)&&d(!0);try{const I=localStorage.getItem("kstar_last_room"),R=fe||le||I||void 0;fe||le?(e("PARTICIPANT"),await gc("PARTICIPANT",fe||void 0)):ee==="DJ"?e("DJ"):ee==="PARTICIPANT"||ee==="STAGE"?(e("PARTICIPANT"),await gc("PARTICIPANT",void 0)):e("SELECT")}catch(I){console.error("[App] Init Error:",I),o(I.message),e("SELECT")}const ce=await nt();ce.customTheme&&(document.documentElement.style.setProperty("--neon-pink",ce.customTheme.primaryNeon),document.documentElement.style.setProperty("--neon-cyan",ce.customTheme.secondaryNeon),document.documentElement.style.setProperty("--neon-yellow",ce.customTheme.accentNeon)),await BM(),n(!1)})()},[]);const _=async X=>{n(!0),o(null);try{e(X),X==="PARTICIPANT"&&await gc(X)}catch(re){o(re.message),e("SELECT")}finally{n(!1)}},S=()=>{v.trim()&&(uv(v.trim()),m(!1),b(""))},k=Bp(),L=pt.getRoomId(),B=`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(k+(L?`?room=${L}`:""))}&bgcolor=ffffff`;if(t)return h.jsxs("div",{className:"min-h-screen bg-[#050510] flex flex-col items-center justify-center space-y-8 relative overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-[#10002B] to-black"}),h.jsxs("div",{className:"w-24 h-24 relative",children:[h.jsx("div",{className:"absolute inset-0 border-4 border-[var(--neon-pink)]/30 rounded-full animate-ping"}),h.jsx("div",{className:"absolute inset-0 border-4 border-[var(--neon-cyan)]/30 rounded-full animate-ping delay-75"}),h.jsx("div",{className:"relative z-10 w-full h-full border-4 border-t-[var(--neon-pink)] border-r-[var(--neon-purple)] border-b-[var(--neon-cyan)] border-l-[var(--neon-yellow)] rounded-full animate-spin"})]}),h.jsx("h2",{className:"text-2xl font-black font-bungee text-white uppercase tracking-widest animate-pulse z-10",children:"INITIALIZING"})]});if(r==="FEATURES")return h.jsx(qV,{onBack:()=>e("SELECT"),onAdminLogin:()=>e("ADMIN")});if(r==="ADMIN")return h.jsx(HV,{onBack:()=>e("SELECT")});if(r==="SELECT"){const X=MA(),re=k.includes("localhost")||k.includes("127.0.0.1");return h.jsxs("div",{className:"min-h-screen flex items-center justify-center p-6 bg-[#050510] relative overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-[#10002B] to-black -z-10"}),h.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('/grid.svg')] opacity-10"}),h.jsxs("div",{className:"max-w-7xl w-full z-10",children:[h.jsxs("div",{className:"text-center mb-20 animate-in fade-in slide-in-from-top-4 duration-1000",children:[h.jsxs("div",{className:"flex justify-center mb-10 relative",children:[h.jsx("div",{className:"absolute inset-0 bg-[var(--neon-pink)]/20 blur-[100px] rounded-full"}),h.jsx("div",{className:"p-3 rounded-full border-4 border-white/10 bg-black shadow-2xl relative z-10",children:h.jsx("div",{className:"rounded-full overflow-hidden border-4 border-[var(--neon-pink)] shadow-[0_0_50px_rgba(255,0,127,0.5)] w-48 h-48",children:h.jsx("img",{src:"IGK.jpeg",alt:"Island Groove",className:"w-full h-full object-cover"})})})]}),h.jsx("h1",{className:"text-6xl md:text-9xl font-bold font-bungee text-white mb-6 uppercase tracking-tight neon-text-glow-purple leading-none drop-shadow-2xl",children:"Singmode Beta"}),h.jsx("p",{className:"text-[var(--neon-yellow)] text-xl md:text-2xl font-bold tracking-widest uppercase neon-glow-yellow font-righteous",children:"KARAOKE_LOUNGE_SYSTEM"})]}),i&&h.jsxs("div",{className:"mb-12 p-10 bg-[#150005] border-4 border-rose-500 rounded-[3rem] text-center animate-in zoom-in duration-500 max-w-3xl mx-auto shadow-[0_0_60px_rgba(244,63,94,0.4)] relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-rose-500 animate-pulse"}),h.jsx("div",{className:"text-6xl mb-6",children:""}),h.jsx("h3",{className:"text-rose-500 font-bold uppercase tracking-widest text-3xl mb-4 font-bungee",children:"SYSTEM_CONFLICT"}),h.jsx("p",{className:"text-white text-xl font-bold leading-relaxed font-righteous",children:i}),h.jsx("p",{className:"text-rose-500/50 text-xs mt-8 uppercase font-bold tracking-widest font-righteous",children:"SINGLE_DJ_PROTOCOL_ACTIVE"})]}),h.jsxs("div",{className:`grid gap-8 ${c?"grid-cols-1 max-w-2xl mx-auto":"md:grid-cols-2"}`,children:[!c&&h.jsxs("button",{onClick:()=>_("DJ"),className:"group relative p-12 bg-[#101015] border-4 border-white/5 rounded-[4rem] text-left transition-all hover:border-[var(--neon-pink)] hover:-translate-y-2 hover:shadow-[0_0_80px_rgba(255,0,127,0.2)] overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--neon-pink)]/0 to-[var(--neon-pink)]/5 group-hover:to-[var(--neon-pink)]/10 transition-all"}),h.jsxs("div",{className:"relative z-10",children:[h.jsx("div",{className:"w-24 h-24 bg-black border-2 border-white/10 rounded-3xl flex items-center justify-center text-5xl mb-8 group-hover:scale-110 transition-all group-hover:border-[var(--neon-pink)] shadow-2xl",children:""}),h.jsx("h2",{className:"text-5xl font-bold mb-4 font-bungee uppercase tracking-tight text-white group-hover:text-[var(--neon-pink)] transition-colors",children:"DJ_CONSOLE"}),h.jsx("p",{className:"text-sm font-medium font-righteous uppercase tracking-widest text-[var(--neon-cyan)] opacity-90 leading-relaxed",children:"COORDINATE ROTATION. APPROVE REQUESTS. COMMAND ATMOSPHERE."})]})]}),h.jsxs("button",{onClick:()=>_("PARTICIPANT"),className:"group relative p-12 bg-[#101015] border-4 border-white/5 rounded-[4rem] text-left transition-all hover:border-[var(--neon-cyan)] hover:-translate-y-2 hover:shadow-[0_0_80px_rgba(0,229,255,0.2)] overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[var(--neon-cyan)]/0 to-[var(--neon-cyan)]/5 group-hover:to-[var(--neon-cyan)]/10 transition-all"}),h.jsxs("div",{className:"relative z-10",children:[h.jsx("div",{className:"w-24 h-24 bg-black border-2 border-white/10 rounded-3xl flex items-center justify-center text-5xl mb-8 group-hover:scale-110 transition-all group-hover:border-[var(--neon-cyan)] shadow-2xl",children:""}),h.jsx("h2",{className:"text-5xl font-bold mb-4 font-bungee uppercase tracking-tight text-white group-hover:text-[var(--neon-cyan)] transition-colors",children:"SINGER_UI"}),h.jsx("p",{className:"text-sm font-medium font-righteous uppercase tracking-widest text-[var(--neon-yellow)] opacity-90 leading-relaxed",children:"REQUEST SONGS. FAVORITE VIBES. ACCESS SONGBOOK."})]})]})]}),h.jsxs("div",{className:"mt-16 p-10 bg-[#080808] border-2 border-white/5 rounded-[3rem] flex flex-col md:flex-row items-center gap-10 relative overflow-hidden group hover:border-[var(--neon-green)] transition-all",children:[h.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[var(--neon-green)]/5 blur-[80px] rounded-full -mr-32 -mt-32 pointer-events-none"}),h.jsx("div",{className:"bg-white p-4 rounded-3xl shrink-0 shadow-[0_0_40px_rgba(0,255,157,0.2)] border-4 border-white/10 group-hover:scale-105 transition-transform",children:h.jsx("img",{src:B,alt:"Join QR Code",width:"140",height:"140",className:"block"})}),h.jsxs("div",{className:"text-center md:text-left flex-1 relative z-10",children:[h.jsx("strong",{className:"text-[var(--neon-green)] block mb-3 uppercase tracking-[0.3em] text-xs font-black font-righteous",children:"SCAN TO JOIN"}),h.jsx("div",{className:"text-white text-xl font-mono break-all mb-4 bg-black/50 px-4 py-2 rounded-lg inline-block border border-white/5",children:k}),re&&h.jsxs("div",{className:"p-4 bg-amber-500/5 border border-amber-500/10 rounded-2xl",children:[h.jsx("p",{className:"text-amber-500 text-[10px] font-black uppercase tracking-widest mb-2 font-righteous",children:" LOCALHOST DETECTED"}),h.jsx("button",{onClick:()=>{m(!0),b(X||"")},className:"text-[10px] font-black text-white hover:text-[var(--neon-cyan)] uppercase tracking-[0.2em] underline decoration-white/30 hover:decoration-[var(--neon-cyan)] transition-all font-righteous",children:"CONFIGURE NETWORK IP"})]})]})]})]}),f&&h.jsx("div",{className:"fixed inset-0 bg-black/95 flex items-center justify-center p-6 z-50 backdrop-blur-3xl animate-in fade-in duration-300",children:h.jsxs("div",{className:"w-full max-w-lg bg-[#0a0a0a] border-2 border-white/10 rounded-[3rem] p-10 space-y-8 shadow-[0_0_60px_rgba(0,0,0,0.8)] relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[var(--neon-cyan)] to-[var(--neon-blue)]"}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-3xl font-bold text-white mb-2 font-bungee uppercase tracking-tight",children:"Network Config"}),h.jsx("p",{className:"text-slate-500 text-[10px] uppercase tracking-widest font-righteous",children:"ESTABLISH REMOTE CONNECTION PROTOCOLS"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"block text-[11px] font-bold text-[var(--neon-cyan)] uppercase tracking-[0.2em] ml-4 font-righteous",children:"Network IP Address"}),h.jsx("input",{type:"text",value:v,onChange:ee=>b(ee.target.value),placeholder:"e.g. 192.168.0.x OR https://....ngrok.io",className:"w-full bg-[#151520] border-2 border-white/10 rounded-2xl px-6 py-4 text-white font-mono focus:border-[var(--neon-cyan)] outline-none transition-all shadow-inner text-sm"}),h.jsxs("p",{className:"text-slate-500 text-[9px] uppercase tracking-widest font-righteous ml-4 opacity-60",children:[h.jsx("span",{className:"text-[var(--neon-yellow)]",children:"PRO TIP:"})," Use ",h.jsx("span",{className:"text-white",children:"ngrok"})," for secure external tunneling."]})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsx("button",{onClick:()=>m(!1),className:"flex-1 py-4 bg-black border border-white/10 hover:bg-white/5 text-slate-400 hover:text-white rounded-xl font-bold text-[10px] uppercase tracking-widest transition-all font-righteous",children:"Cancel"}),h.jsx("button",{onClick:S,className:"flex-1 py-4 bg-[var(--neon-cyan)] text-black rounded-xl font-bold text-[10px] uppercase tracking-widest shadow-[0_0_20px_rgba(0,229,255,0.3)] hover:bg-white transition-all font-righteous hover:scale-105",children:"Save Configuration"})]})]})})]})}return h.jsxs("div",{className:"min-h-screen bg-[#050510] text-white selection:bg-[var(--neon-pink)] selection:text-white",children:[h.jsx("nav",{className:"fixed top-0 inset-x-0 z-[100] backdrop-blur-xl bg-black/80 border-b border-white/5 transition-all duration-300",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-6 h-20 flex items-center justify-between",children:[h.jsxs("div",{onClick:()=>e("SELECT"),className:"cursor-pointer group flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-[var(--neon-pink)] p-0.5 group-hover:shadow-[0_0_20px_rgba(255,0,127,0.4)] transition-all",children:h.jsx("img",{src:"IGK.jpeg",alt:"Logo",className:"w-full h-full rounded-full"})}),h.jsx("span",{className:"font-bungee text-xl text-white tracking-widest group-hover:text-[var(--neon-cyan)] transition-colors",children:"Singmode Beta"})]}),h.jsx("div",{className:"flex items-center gap-6",children:h.jsxs("button",{onClick:()=>{e("SELECT"),o(null)},className:"text-[9px] font-bold uppercase tracking-widest px-5 py-2.5 rounded-xl transition-all font-righteous bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white border border-white/5 hover:border-white/20",children:["EXIT ",r]})})]})}),h.jsx("main",{className:"pb-20",children:r==="DJ"?h.jsx(zV,{onAdminAccess:()=>e("ADMIN")}):h.jsx(GV,{})})]})},fC=document.getElementById("root");if(!fC)throw new Error("Could not find root element to mount to");const KV=tk.createRoot(fC);KV.render(h.jsx(sn.StrictMode,{children:h.jsx($V,{})}));
